!function(G,f,l){"use strict";var s="ht";if(!G[s]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),G.performance&&G.performance.now||function(){var e=Date.now();G.performance||(G.performance={}),G.performance.now=function(){return Date.now()-e}}();for(var D=Date.now(),h=16,d=["ms","moz","webkit","o"],m=0;m<d.length&&!G.requestAnimationFrame;++m)G.requestAnimationFrame=G[d[m]+"RequestAnimationFrame"],G.cancelAnimationFrame=G[d[m]+"CancelAnimationFrame"]||G[d[m]+"CancelRequestAnimationFrame"];G.requestAnimationFrame||(G.requestAnimationFrame=function(X){var n=Date.now(),I=h+D-n;return 0>I&&(I=0),D=n,G.setTimeout(function(){D=Date.now(),X(performance.now())},I)}),G.cancelAnimationFrame||(G.cancelAnimationFrame=function(p){return G.clearTimeout(p)}),f.assign===l&&(f.assign=function(q){if(q===l||null===q)throw new TypeError("Cannot convert undefined or null to object");for(var B=f(q),U=1;U<arguments.length;U++){var k=arguments[U];if(k!==l&&null!==k)for(var r in k)f.prototype.hasOwnProperty.call(k,r)&&(B[r]=k[r])}return B})}();var w=G.document,h=null,u=G[s]={},o=G[s+"config"],C=u.Default=o&&o.Default||{},O=u.Style=o&&o.Style||{},A=u.Attr=o&&o.Attr||{},T=u.Color=o&&o.Color||{},n=u.IsGetter=o&&o.IsGetter||{};!function(){var p=!1;try{var l=f.defineProperty({},"passive",{get:function(){p=!0}});G.addEventListener("test",l,l),G.removeEventListener("test",l,l)}catch(i){p=!1}C.passiveSupported=p}();var B,y,D,t,Z=C.passiveSupported,N=C.eventListenerOptionsFalse=Z?{passive:!1,capture:!1}:!1,L=C.eventListenerOptionsTrue=Z?{passive:!1,capture:!0}:!0,U=Math,R=U.round,j=U.floor,d=U.ceil,W=U.sqrt,m=U.max,M=U.min,r=U.abs,z=U.cos,H=U.acos,K=U.sin,V=U.pow,p=U.asin,b=U.PI,x=2*b,g=b/2,a=U.tan,i=U.atan2,J=U.random,E=U.log,Y=!1,I=!1,Q=G.parseInt||global.parseInt,v="2019-04-15",_=G.navigator?G.navigator.platform.indexOf("Win")>-1:!1,q=function(F){return F*F},P=G.setTimeout,c=G.clearTimeout,S=G.location,k=G.navigator?G.navigator.userAgent.toLowerCase():"",F=function(C){return C.test(k)},X=F(/msie/),e=F(/msie/)||F(/trident/),$=F(/msie 10/),wm=F(/edge/),Pe=F(/firefox/),qj=F(/mac/),Sl=C.isTouchable===l?_?!1:w?"ontouchend"in w:!1:C.isTouchable,Zq="default",mh="single",Mj="multiple",Ak="front",ii="back",nh="left",lp="right",mj="top",Sh="bottom",Gg="center",rp="eye",fn="middle",Lb="east",Dl="west",Up="north",Il="none",ej="px",Hd="absolute",Cs="border",Ok="triangle",ue="rect",Ri="circle",Eg="cylinder",Fi="shape",sj="items",wf="normal",Yr="remove",cn="clear",$h="width",dd="height",so="ingroup",vk="check",lr="uncheck",Bd="radio",fe="radioOn",Aj="radioOff",_c="points",Ll="values",sc="series",kh="body",zk="label",cl="label2",ve="note",en="note2",jo="icons",xb="labelFont",eh="labelColor",Nk="labelSelectColor",Po="note.expanded",hp="note2.expanded",hq="edge.expanded",Qn="edge.points",Nj="edge.type",Yf="rotation",sl="hidden",Ei="visible",Tb="tuv",uh="no",ap="draw",zp="select",pj="currentSubGraph",Fe="selectBackground",Xj="autoMakeVisible",Vm="autoHideScrollBar",Ii="scrollBarColor",Ym="scrollBarSize",Xl="indent",dq="rowHeight",ro="columnLineColor",rs="rowLineColor",Wr="columnLineVisible",Kc="rowLineVisible",Cn="visibleFunc",Ml="expandIcon",Wo="collapseIcon",up="checkMode",Bi="sortFunc",eg="editable",th="batchEditable",je="tristate",gl="asc",Mf="desc",Zo="position",Qh="elevation",bg="children",Xp="translateX",cp="translateY",$e="dataModel",um="maxSize",yg="shape3d",_k="shape3d.resolution",ki="shape3d.visible",ln="shape3d.from.visible",Mp="shape3d.to.visible",Ug="shape3d.top.visible",li="shape3d.bottom.visible",Yd="repeat.uv.length",uj="serializeValue",bn="deserializeValue",pi="centerUniform",fb="uniform",em="rgba(255,255,255,0)",Tq="style",zi="attr",Gr="field",jk="string",Uq="boolean",jd="color",Hn="int",ws="number",Fr="ew-resize",Cl="ns-resize",Hm="pointer",Gp="auto",tj="mousedown",Nc="mousemove",qe="mouseup",ss="mouseout",we="touchstart",So="touchmove",Sm="touchend",eq="keydown",yc="keyup",Gb=["DOMMouseScroll","mousewheel"],Nn=Pe?Gb[0]:Gb[1],Qd=Sl?[we,So,Sm,eq,yc,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[eq,yc,"keypress","input",tj,Nc,qe,ss,Nn,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],Ho=h,To=h,bj=h,xe=qe.length,gq=function(){bj&&(c(bj.timeout),bj=h)},Om=function(){bj&&Ae(bj.e,bj.info)};G.addEventListener&&(Sl||(G.addEventListener(ss,function(){gq()},N),G.addEventListener(Nn,function(){Rn()},N)),G.addEventListener(yc,function(C){91===C.keyCode?lq={}:delete lq[C.keyCode]},L),G.addEventListener(eq,function(t){lq[t.keyCode]=!0},L),G.addEventListener("blur",function(){lq={}},N));var he,fm,rf,zm=0,jb=h,sh=function(d,j){var K=P(function(){delete jb[K],Xb(jb)&&(jb=h),d()},j);return K},dn=h,zg=h,jp={},Np={},zc={},oo={},Rk={},lq={},Pd={},zb={},cs={},Ig={},Ub=/.json$/,Mm=/^data:image\/svg\+xml/,bo={},sb=[],Ln={},Nl=h,gn=h,fk=function(){},$r=function(){throw"Oops!"},Sq=[0,0,0],dm={x:0,y:0,width:0,height:0},xh=h,Hk=h,_o=h,Mc=function(F,B){Np[F]=B,B&&B.comps&&!B.uuid&&(B.uuid=u.Math.generateUUID()),Rj[F]&&(B.cacheRule=Rj[F],delete Rj[F])},jg=function(e){Hk&&!e._72O&&(_o||(_o={}),_o[e._72O=on()]=e),he!=h?rj()<.05&&t&&!fm&&(Jq=gq):Jq=Yg},Tc=function(p,I,J,A){Hk||(Hk={});var v=Hk[p];if(v){if(v.url===I)return;v.image?(v.image.onload=fk,v.image.onerror=fk):v.request&&(v.request.onload=fk,v.request.onerror=fk)}if(Ub.test(I)){var a=new xd;if(Hk[p]={request:a,url:I},I=C.beforeLoadURL(I),I.data){var x=C.parse(I.data);wb(p,x),C.handleImageLoaded(p,x)}else{a.onload=function(j){if(200===this.status||0===this.status){var o=C.parse(j.target.response||j.target.responseText);wb(p,o),C.handleImageLoaded(p,o)}else wb(p,C.handleUnfoundImage(p,I)||h)},a.onerror=function(){wb(p,C.handleUnfoundImage(p,I)||h)};var Z={};Z.url=encodeURI(I),Z.sync=!1,a.send(Z)}}else{var x=new Image;Hk[p]={image:x,url:I},/^data:image/.test(I)||(I=C.beforeLoadURL(I),I=C.appendTimeStamp(I),I=encodeURI(I),x.crossOrigin=C.crossOrigin),C.convertImageSrc(I,function(z){e&&(I.toLowerCase().indexOf(".svg")>0||Mm.test(I))?(w.body.appendChild(x),x.style.visibility="hidden",x.onload=function(){P(function(){if(J&&(x.width=J),A&&(x.height=A),!x.width||!x.height){var r=x.width||x.clientWidth,i=x.height||x.clientHeight;x.width=r,x.height=i}C.handleImageLoaded(p,x),wb(p,x),w.body.removeChild(x),x.style.visibility=""},180)},x.onerror=function(){wb(p,C.handleUnfoundImage(p,I)||h),w.body.removeChild(x),x.style.visibility=""}):(x.onload=function(){J&&(x.width=J),A&&(x.height=A),C.handleImageLoaded(p,x),wb(p,x)},x.onerror=function(){wb(p,C.handleUnfoundImage(p,I)||h)}),x.src=z})}},wb=function(Q,A){if(Mc(Q,A),delete Hk[Q],Xb(Hk)&&(Hk=h,_o)){for(var Z in _o){var t=_o[Z];t._2O&&t._2O[Q]&&(t.deleteTexture(Q),delete t._2O[Q]),t.invalidateAll&&t.invalidateAll(l,"imageLoaded",Q),t.redraw&&t.redraw(),t.iv(),delete t._72O}_o=h}if(A&&_o)for(var Z in _o){var t=_o[Z];t.invalidateAll&&t.invalidateAll(l,"imageLoading",Q),t.redraw&&t.redraw(),t.iv()}},cf=function(){return E=U&&Date,function(){return G.performance&&G.performance.now?G.performance.now():Date.now()}}(),Mi=function(Z,O){O?c(Z):G.cancelAnimationFrame(Z)},Ng=function(D,G,u){return{width:D,height:G,comps:wc(u)?u:[u]}},Sr=function(H,F){return{type:Ri,rect:[H,F,1.6,1.6],borderWidth:1,borderColor:qq,gradient:Jd,gradientColor:xj,background:qq}},Wp=function(A,q){return Ng(16,16,{type:Ok,rect:[4,4,10,8],background:A,rotation:q?1.57:3.14})},Fk=function(m,v){return Ng(16,16,{type:Ok,rect:[4,4,8,7],background:m,rotation:v?3.14:0})},xg=function(Z){var V=Z._orientation;return"horizontal"===V||"h"===V},zr=function(n){var i=h||4,a=h||1,t=h||1;0>i?i=0:i>.25&&(i=.25);var o,k,Y,C,W,q,w,$=.5,P=[],j=[],B=[],U=x/t,F=x/a,D=$-i;for(k=0;a>=k;k++)for(C=-b+k*F,q=z(C),W=K(C),o=0;t>=o;o++)Y=o*U,w=D+i*q,P.push(z(Y)*w,W*i,-K(Y)*w),(y=n)&&j.push(o/t,1-k/a);for(k=0;a>k;k++){var J=k*(t+1),m=(k+1)*(t+1);for(o=0;t>o;o++)B.push(J+o,m+o+1,m+o,J+o,J+o+1,m+o+1),Ze.z=zh.z=n}},yr=function(C){var a=2,m=0;for(var G in C)G.length===a&&Q(G,32)===ek&&(Nl=gn=C[G]),m++;return m},Ge=function(l,P,V,n){return V||(V=Sl?5:3,V/=n||1),{x:l-V,y:P-V,width:2*V,height:2*V}},gf=function(j,W,k,M){var n=this;W||(W=Sl?5:3,k=20,M=20);var p={x:j,y:W,width:k,height:M};if(k)for(var f=0;k>f;f++)if(3===k)M=20;else for(var c=0;M>c;c++)n=G?G:k;var K={x:b,y:2*b};if(bf(p,K)){var e=dd[0]+mj[0]+cn[1]+(gl.length-1);as[rp]=n[e],n[e]=gg[rp]}},Lm=function(J){return(/ble$/.test(J)||/ed$/.test(J)||n[J]?"is":"get")+J.charAt(0).toUpperCase()+J.slice(1)},gg=function(l){return"set"+l.charAt(0).toUpperCase()+l.slice(1)},Tf=function(W){return typeof W===jk||W instanceof String},cg=function(F){return typeof F===ws},Yg=function(Y){return typeof Y===Uq},An=function(D){return D&&"object"==typeof D},Pj=function(i){return"function"==typeof i},wc=function(e){return e instanceof Array},uf=function(i){return i instanceof mo},ck=function(I){return wc(I)?new mo(I):I},bh=function(W){return W instanceof lf},Jl=function(s){return s instanceof Dj},xq=function(u){return u instanceof kd},rd=function(x,h){if(!(x instanceof u.Group))return!1;if(!h)return x.isExpanded();var F=h.getDataUI(x);return F&&F._88I?!0:!1},hf=function(z){return z instanceof _e},Fo=function(i){return i&&"IFRAME"===i.tagName},$m=function(x){return x==h||C.numberDigits==h?x:parseFloat(x.toFixed(C.numberDigits))},hn=function(U,z,V){var Z,o=z.length;if(V)for(var A=0;V>A;A++)if(3===o)U.push(z[0]),U.push(z[1]),U.push(z[2]);else for(Z=0;o>Z;Z++)U.push(z[Z]);else if(3===o)U.push(z[0]),U.push(z[1]),U.push(z[2]);else for(Z=0;o>Z;Z++)U.push(z[Z])},Td=function(O){return O?An(O)?O:{}:!1},No=function(B,o,g){var j,s=An(B)?B:B.prototype;for(j in o)g&&s[j]!==l||(s[j]=o[j]);return B},ts=function(t){return String.fromCharCode(t)},El=function(t){for(var x,B=0,H="";B<t.length;B++)x=t[t.length-1-B],"%"===x?x="'":"a"===x?x='"':"]"===x&&(x="\\"),H+=ts(x.charCodeAt(0)-1);return H},Yn=function(o,V,F){o.superClass.constructor.apply(V,F)},Xb=function(K){for(var l in K)return!1;return!0},Qq=function(F){return F?0===F.length:!0},Tg=function(){var a="";return[lr[0],rs[0],zk[0]].forEach(function(y){a+=gg(y).slice(3)}),fb=w&&w[a]||pi,function(D,U){return D===U?!0:D.x===U.x&&D.y===U.y&&D.width===U.width&&D.height===U.height}}(),Oh=function(i,h,A){return h>i?h:i>A?A:i},Dn=function(q){return 0>q?-1:q>0?1:0},rj=function(){var k=1e4*K(xe++);return k-j(k)},de=function(l,t,K){return Ee(l.x,l.y,t.x,t.y,K.x,K.y,K.x+K.width,K.y,!0)||Ee(l.x,l.y,t.x,t.y,K.x+K.width,K.y,K.x+K.width,K.y+K.height,!0)||Ee(l.x,l.y,t.x,t.y,K.x+K.width,K.y+K.height,K.x,K.y+K.height,!0)||Ee(l.x,l.y,t.x,t.y,K.x,K.y+K.height,K.x,K.y,!0)},Ee=function(O,y,R,U,W,V,o,u,f){var q=(o-W)*(y-V)-(u-V)*(O-W),g=(u-V)*(R-O)-(o-W)*(U-y);if(0!==g){var P=q/g,p=O+P*(R-O),Q=y+P*(U-y);return f&&(p+As<M(O,R)||p-As>m(O,R)||p+As<M(W,o)||p-As>m(W,o)||Q+As<M(y,U)||Q-As>m(y,U)||Q+As<M(V,u)||Q-As>m(V,u))?h:[p,Q]}return h},Xc=function(V,Y,u){if(V&&u)if(Y){if(Y===Tq)return V.getStyle(u);if(Y===zi)return V.getAttr(u);if(Y===Gr)return V[u]}else if(u=Lm(u),V[u])return V[u]();return l},rl=function(b,N,c,n){if(b&&c)if(N){if(N===Tq)b.s(c,n);else if(N===zi)b.a(c,n);else if(N===Gr){var l=b[c];b[c]=n,b.fp("f:"+c,l,n)}}else c=gg(c),b[c]&&b[c](n)},po=function(Z,g,D){return g&&"top"!==g?"bottom"===g?{x:Z.x,y:Z.y,width:Z.width,height:Z.height*D}:"right"===g?{x:Z.x,y:Z.y,width:Z.width*D,height:Z.height}:"left"===g?{x:Z.x+Z.width*(1-D),y:Z.y,width:Z.width*D,height:Z.height}:void 0:{x:Z.x,y:Z.y+Z.height*(1-D),width:Z.width,height:Z.height*D}},jc=function(e,m,s,M,p){m&&ng(e,s,M,1,p,m)},$o=function(m,g,r,x){var i=1-m;return i*i*g+2*m*i*r+m*m*x},Ze=function(d,G,l,X,A){var z=1-d;return z*z*z*G+3*z*z*d*l+3*z*d*d*X+d*d*d*A},Kp=function(X){var L,z,v,B,i=0;return X.forEach(function(P){if(L=P.length,L>0)for(z=P[0],B=1;L>B;B++)v=P[B],i+=Im(z,v),z=v}),i},vg=function(S,f,i){var x="__"+S,q=function(a){i.disabled||i["handle_"+S](a)};i[x]||(i[x]=q,f.addEventListener(S,q,N))},bl=function(K,C,y){var A="__"+K,z=y[A];z&&(C.removeEventListener(K,z,N),delete y[A])},Mn=function(C,c){var w="_"+c;C[Lm(c)]=function(){return this[w]},C[gg(c)]=function(P){var X=this[w];this[w]=P,this.fp(c,X,P)}},ec=function(o){return f.create(o)},Vb=function(K){if(!K.element){var I,N;(I=K.textField)?N=Kh(zl.TextField,I):(I=K.textArea)?N=Kh(zl.TextArea,I):(I=K.button)?N=Kh(zl.Button,I):(I=K.comboBox)?N=Kh(zl.ComboBox,I):(I=K.checkBox)?N=Kh(zl.CheckBox,I):(I=K.radioButton)?N=Kh(zl.RadioButton,I):(I=K.slider)?N=Kh(zl.Slider,I):(I=K.colorPicker)?N=Kh(zl.ColorPicker,I):(I=K.image)&&(N=Kh(zl.Image,I)),N&&(K.element=N)}},Lh=function(J,T){var v=Ki(J);return v._ht=T,v},Ki=function(o,V){var W=w.createElement("div"),K=W.style;return W.tabIndex=-1,W.onkeydown=ll,K.msTouchAction=Il,ao(W,h,0),Sl&&K.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",h),o&&(K.overflow=sl),V&&Pp(V,W),W},fr=function(r,Y){var p=w.createElement("canvas"),t=p.style;return t.msTouchAction=Il,Y||(t.pointerEvents=Il),ao(p,h,0),r&&Pp(r,p),p},ao=function(F,q,T){var A=F.style;A.border=q?q+" solid 1px":0,A.outline=0,A.padding=T?"0 "+T+ej:0,gd(F)},gd=function(l){var r=l.style;r.position=Hd,r.margin=0,r.setProperty("box-sizing","border-box",h),r.setProperty("-moz-box-sizing","border-box",h)},Dg=function(g,V,D,X){X||(X=nd),V!=h&&(g.width=V*X,g.style.width=V+ej),D!=h&&(g.height=D*X,g.style.height=D+ej)},Pp=function(E,$,v){E.appendChild($),v&&($.style.position=Hd)},oc=function(v,L){L.split||(L+="");for(var l,H=L.split("\n"),m=0,F=H.length,k=0;F>k;k++){var G=jh(v.font,H[k]);G.width>m&&(m=G.width),l||(l=G.height)}return v.ss=H,{width:m,height:l*F}},Le=function(G,m,U,t,s,B){var o=m.length;if(1===o)ib(G,m[0],U,t,s);else for(var V=U.height/o,h={x:U.x,y:U.y,width:U.width,height:V},g=0;g<m.length;g++)B?ic(G,m[g],t,s,h.x,h.y,h.width,h.height,B):ib(G,m[g],h,t,s),h.y+=V},ib=function(w,L,p,b,B){w.font=b?b:Db,w.fillStyle=B?B:le,w.textAlign=Gg,w.textBaseline=fn;var d,M;p?p.width===l?(d=p.x,M=p.y):(d=p.x+p.width/2,M=p.y+p.height/2):(d=0,M=0),w.fillText(L,R(d),R(M))},wp=function(I){I.getView&&(I=I.getView());var $=I.offsetWidth||I.scrollWidth;return!$&&I.style.width&&($=Q(I.style.width)),$},us=function(q){q.getView&&(q=q.getView());var j=q.offsetHeight||q.scrollHeight;return!j&&q.style.height&&(j=Q(q.style.height)),j},Zk=function(e,s,h){var y=s[0].toUpperCase()+s.substring(1,s.length);e["webkit"+y]=h,e["moz"+y]=h,e["ms"+y]=h,e["o"+y]=h,e[s]=h},wh=function(){var Q=function(K){ll(K),K.stopPropagation()},v=function(j){ll(j)},o=Sl?[we]:[eq,tj];return function(t,r){var V=Ki(),c=V.style;return c.backgroundColor=C.disabledBackground,t&&(c.backgroundImage="url("+t+")",c.backgroundPosition="50% 50%",c.backgroundRepeat="no-repeat no-repeat"),r===!1?o.forEach(function(k){V.addEventListener(k,v,N)}):o.forEach(function(b){V.addEventListener(b,Q,N)}),V}}(),Uh=function(F){var l=F.getContext("2d");return l.save(),l.lineCap=Ce,l.lineJoin=Tj,l},Jq=function(N,u,P,E){uc(N,u*nd,P*nd),E*=nd,1!==E&&N.scale(E,E)},uc=function(f,I,i){f.translate(I,i)},Lc=function(P,x){x&&P.rotate(x)},Jn=function(h,N,g){N===l&&(N=1),g===l&&(g=1),(1!==N||1!==g)&&h.scale(N,g)},Kn=!1,Zn=function(V){var t=w.activeElement;if(w.activeElement!==V){t&&t.forceOnblur&&t.forceOnblur();for(var f=[],i=V.parentNode;i;)f.push([i,i.scrollLeft,i.scrollTop]),i=i.parentNode;if(!Kn){var R=[],H=[];try{for(var j=G.parent,B=G;j!==B;)R.push([j,j.scrollX,j.scrollY]),B=j,j=G.parent;var u=G.frameElement;if(u)for(var e=u.parentNode;e;)H.push([e,e.scrollLeft,e.scrollTop]),e=e.parentNode}catch(x){Kn=!0}}if(Sl)V.focus();else{var s=tn(),T=s.target;V.focus(),T.scrollLeft=s.left,T.scrollTop=s.top}f.forEach(function(V){V[0].scrollLeft=V[1],V[0].scrollTop=V[2]}),Kn||(R.forEach(function(C){C[0].scrollTo(C[1],C[2])}),H.forEach(function(R){R[0].scrollLeft=R[1],R[0].scrollTop=R[2]}))}},hh=function(b){return b&&b.getView?b.getView():b},rr=function(R,p,N,m,c){if(2===arguments.length&&(N=p.y,m=p.width,c=p.height,p=p.x),R.isSelfViewEvent)R.setX(p),R.setY(N),R.setWidth(m),R.setHeight(c);else{var q=hh(R),f=q.style;if((w.fullscreenElement||w.mozFullScreenElement||w.webkitFullscreenElement||w.msFullscreenElement)!==q)p!==l&&(f.left=p+ej),N!==l&&(f.top=N+ej),m!==l&&(f.width=m+ej),c!==l&&(f.height=c+ej);else{var M=C.getWindowInfo();f.left=(p=M.left)+ej,f.top=(N=M.top)+ej,f.width=(m=M.width)+ej,f.height=(c=M.height)+ej}R.endEditing&&!Sl&&R.endEditing(),R.redraw&&R.redraw(),R.invalidate&&R.invalidate(),R.onLayouted&&R.onLayouted(p,N,m,c),R.fireViewEvent&&R.fireViewEvent("layout")}},mb=function(L){if(!L.touches)return L;var p=L.touches[0];return p?p:L.changedTouches[0]},Kb=function(Y){return Sl?mb(Y).target:Y.target},xl=function(d){C.popup&&C.popup.close(),C.popup=d},Wf=h,kf=function(z){Wf.handleWindowTouchMove(z)},cd=function(T){Wf.handleWindowTouchEnd(T),G.removeEventListener(So,kf,N),G.removeEventListener(Sm,cd,N),Wf=h},vf=function(Y){Wf.handleWindowMouseMove(Y)},Zd=function(Z){Wf.handleWindowMouseUp(Z),G.removeEventListener(Nc,vf,N),G.removeEventListener(qe,Zd,N),Wf=h},Fb=function(o){return 1===Gd(o)},im=function(h,y){return y?y.keyCode===h:lq[h]},Zb=function(i){return lk(i)&&im(65,i)},ub=function(e){return im(46,e)||im(8,e)},ye=function($){return function(h){return h?h.keyCode===$:lq[$]}},ek=573,ai=[65,83,68,87,37,38,39,40,32,13,27],dr=ye(ai[0]),be=ye(ai[1]),km=ye(ai[2]),gi=ye(ai[3]),$j=ye(ai[4]),Pl=ye(ai[5]),Mb=ye(ai[6]),Bm=ye(ai[7]),eo=ye(ai[8]),dl=ye(ai[9]),Di=ye(ai[10]),oq={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},xi=[2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,47,383],wo=h,yi=h,yp=function(c,B){wo||(wo=fr()),Dg(wo,c,B,1);var D=Uh(wo);return D.clearRect(0,0,c,B),D},vi=function(){var r,v={};for(var C in G){var k=Mj.length;if(C.length==k&&C[0]===Mj[2]&&C[1]===Il[1]&&C[4]===Mj[3]&&C[5]===Mj[4]&&C.substr(k-2)===Il[1]+Il[2]){var t=G[C];for(var g in t)g.length===k&&g.substr(0,3)===lp[3]+Yr[3]+zp[0]&&g.substr(k-2)===Mj[0]+ve[3]&&(Gb=t[g])}}return function(k){var W,A=v[k];return A||(r||(r=fr(),Dg(r,1,1,1)),W=r.getContext("2d"),W.clearRect(0,0,1,1),ng(W,0,0,1,1,k),A=W.getImageData(0,0,1,1).data,A=v[k]=[A[0],A[1],A[2],A[3]]),A}}(),Rm=function(E){if(!Tf(E))return E;var A=vi(E);return A.CA||(A.CA=[A[0]/255,A[1]/255,A[2]/255,A[3]/255]),A.CA},kc=function(R,L,z,J,n){var x=fr();x.width=z,x.height=J;var T=x.getContext("2d");T.drawImage(R,0,0,z,J);try{for(var S=T.getImageData(0,0,z,J),G=S.data,d=0,t=G.length;t>d;d+=4){var Z=G[d+0],A=G[d+1],q=G[d+2],W=G[d+3];"override_a"===n?G[d+3]=255*L[3]:"override_rgb"===n?(G[d+0]=255*L[0],G[d+1]=255*L[1],G[d+2]=255*L[2]):"override"===n?(G[d+0]=255*L[0],G[d+1]=255*L[1],G[d+2]=255*L[2],G[d+3]=255*L[3]):(G[d+0]=L[0]*Z,G[d+1]=L[1]*A,G[d+2]=L[2]*q,G[d+3]=L[3]*W)}T.putImageData(S,0,0)}catch(j){return R}return x},as=function(p,M,K){return M&&(M="miter"===K?8*M+20:M+1,p&&Rd(p,M)),M},kp=function(t,V){if(V){var O=new rb(V),G=t.width/2,y=t.height/2,D=Vn([O.tf(-G,-y),O.tf(G,-y),O.tf(G,y),O.tf(-G,y)]);return D.x+=t.x+G,D.y+=t.y+y,D}return t},lm=function(l,f,V,S,d,o,W,M){S*=Math.PI/180;var A={x:Math.cos(S)*(l.x-W.x)/2+Math.sin(S)*(l.y-W.y)/2,y:-Math.sin(S)*(l.x-W.x)/2+Math.cos(S)*(l.y-W.y)/2},N=Math.pow(A.x,2)/Math.pow(f,2)+Math.pow(A.y,2)/Math.pow(V,2);N>1&&(f*=Math.sqrt(N),V*=Math.sqrt(N));var L=(d==o?-1:1)*Math.sqrt((Math.pow(f,2)*Math.pow(V,2)-Math.pow(f,2)*Math.pow(A.y,2)-Math.pow(V,2)*Math.pow(A.x,2))/(Math.pow(f,2)*Math.pow(A.y,2)+Math.pow(V,2)*Math.pow(A.x,2)));isNaN(L)&&(L=0);var F={x:L*f*A.y/V,y:L*-V*A.x/f},Z={x:(l.x+W.x)/2+Math.cos(S)*F.x-Math.sin(S)*F.y,y:(l.y+W.y)/2+Math.sin(S)*F.x+Math.cos(S)*F.y},j=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))},Q=function(J,I){return(J[0]*I[0]+J[1]*I[1])/(j(J)*j(I))},b=function($,u){return($[0]*u[1]<$[1]*u[0]?-1:1)*Math.acos(Q($,u))},t=b([1,0],[(A.x-F.x)/f,(A.y-F.y)/V]),u=[(A.x-F.x)/f,(A.y-F.y)/V],w=[(-A.x-F.x)/f,(-A.y-F.y)/V],D=b(u,w);Q(u,w)<=-1&&(D=Math.PI),Q(u,w)>=1&&(D=0);var Q=f>V?f:V,K=f>V?1:f/V,p=f>V?V/f:1;if(null==M){var i={x:0,y:0,width:0,height:0};Rd(i,Q),i.x*=K,i.width*=K,i.y*=p,i.height*=p;var k=new rb(S);return i=Vn([k.tf(i.x,i.y),k.tf(i.x+i.width,i.y),k.tf(i.x+i.width,i.y+i.height),k.tf(i.x,i.y+i.height)]),i.x+=Z.x,i.y+=Z.y,[{x:i.x,y:i.y},{x:i.x+i.width,y:i.y},{x:i.x+i.width,y:i.y+i.height},{x:i.x,y:i.y+i.height}]}M.translate(Z.x,Z.y),M.rotate(S),M.scale(K,p),M.arc(0,0,Q,t,t+D,1-o),M.scale(1/K,1/p),M.rotate(-S),M.translate(-Z.x,-Z.y)},Rc=function(s,K){s&&s.beginPath();for(var Y,V,S,q=[],X=function(k){for(var e,U=/(\-{0,1}[\d\.]+)/gi,W=[];e=U.exec(k);)W.push(parseFloat(e[0]));return W},h=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,L={x:0,y:0};Y=h.exec(K);){var t=Y[0],k=t.substr(0,1);if("M"===k||"m"===k){for(var c=X(t),f=0;f<c.length;f+=2){var O=c[f],P=c[f+1];"m"===k&&(O+=L.x,P+=L.y),s&&s.moveTo(O,P),q.push({x:O,y:P}),L.x=O,L.y=P}V=S=null}else if("H"===k||"h"===k){for(var c=X(t),f=0;f<c.length;f+=1){var O=c[f];"h"===k&&(O+=L.x),s&&s.lineTo(O,L.y),q.push({x:O,y:L.y}),L.x=O}V=S=null}else if("C"===k||"c"===k){for(var c=X(t),f=0;f<c.length;f+=6){var A=c[f],$=c[f+1],I=c[f+2],i=c[f+3],O=c[f+4],P=c[f+5];"c"===k&&(A+=L.x,$+=L.y,I+=L.x,i+=L.y,O+=L.x,P+=L.y),s&&s.bezierCurveTo(A,$,I,i,O,P),q.push({x:A,y:$}),q.push({x:I,y:i}),q.push({x:O,y:P}),L.x=O,L.y=P}V=[A,$,I,i,O,P],S=null}else if("S"===k||"s"===k){for(var c=X(t),f=0;f<c.length;f+=4){var A,$;V?(A=2*V[4]-V[2],$=2*V[5]-V[3]):(A=L.x,$=L.y);var I=c[f],i=c[f+1],O=c[f+2],P=c[f+3];"s"===k&&(I+=L.x,i+=L.y,O+=L.x,P+=L.y),s&&s.bezierCurveTo(A,$,I,i,O,P),q.push({x:A,y:$}),q.push({x:I,y:i}),q.push({x:O,y:P}),L.x=O,L.y=P}V=[A,$,I,i,O,P],S=null}else if("Q"===k||"q"===k){for(var c=X(t),f=0;f<c.length;f+=4){var A=c[f],$=c[f+1],O=c[f+2],P=c[f+3];"q"===k&&(A+=L.x,$+=L.y,O+=L.x,P+=L.y),s&&s.quadraticCurveTo(A,$,O,P),q.push({x:A,y:$}),q.push({x:O,y:P}),L.x=O,L.y=P}V=null,S=[A,$,O,P]}else if("T"===k||"t"===k){for(var c=X(t),f=0;f<c.length;f+=2){var A,$;S?(A=2*S[2]-S[0],$=2*S[3]-S[1]):(A=L.x,$=L.y);var O=c[f],P=c[f+1];"t"===k&&(O+=L.x,P+=L.y),s&&s.quadraticCurveTo(A,$,O,P),q.push({x:A,y:$}),q.push({x:O,y:P}),L.x=O,L.y=P}V=null,S=[A,$,O,P]}else if("V"===k||"v"===k){for(var c=X(t),f=0;f<c.length;f+=1){var P=c[f];"v"===k&&(P+=L.y),s&&s.lineTo(L.x,P),q.push({x:L.x,y:P}),L.y=P}V=S=null}else if("L"===k||"l"===k){for(var c=X(t),f=0;f<c.length;f+=2){var O=c[f],P=c[f+1];"l"===k&&(O+=L.x,P+=L.y),s&&s.lineTo(O,P),q.push({x:O,y:P}),L.x=O,L.y=P}V=S=null}else if("A"===k||"a"===k){for(var c=X(t),f=0;f<c.length;f+=7){var n=c[f],U=c[f+1],y=c[f+2],u=c[f+3],v=c[f+4],O=c[f+5],P=c[f+6];"a"===k&&(O+=L.x,P+=L.y);var N=lm(L,n,U,y,u,v,{x:O,y:P},s);N&&(q=q.concat(N)),L.x=O,L.y=P}V=S=null}var l=t.substr(t.length-1);("z"===l||"Z"===l)&&s&&s.closePath()}return q},Ni=function(i,u){var Y,w,N="L"===u[0],B=u.length;i.save(),N?(i.transform(u[5],u[6],u[7],u[8],u[9],u[10]),Y=i.createLinearGradient(u[1],u[2],u[3],u[4]),w=11):(i.transform(u[7],u[8],u[9],u[10],u[11],u[12]),Y=i.createRadialGradient(u[1],u[2],u[3],u[4],u[5],u[6]),w=13);for(var O=i.compGray;B>w;)Y.addColorStop(u[w],O?C.toGrayColor(u[w+1]):u[w+1]),w+=2;i.fillStyle=Y},zh=function(_,r){var I=_.s("shape.gradient.pack");if(I){for(var E=I.length,Z=new Array(E),x=0;E>x;x++)Z[x]=I[x];var d,h,o,s,R,A,v,n,$,e,G,F,T,L="L"===Z[0];d=L?5:7,h=Z[d],o=Z[d+1],s=Z[d+2],R=Z[d+3],A=Z[d+4],v=Z[d+5],n=r[0],$=r[1],e=r[2],G=r[3],F=r[4],T=r[5],Z[d]=n*h+e*o,Z[d+1]=$*h+G*o,Z[d+2]=n*s+e*R,Z[d+3]=$*s+G*R,Z[d+4]=n*A+e*v+F,Z[d+5]=$*A+G*v+T,_.s("shape.gradient.pack",Z)}},Of=function(C,j,b,l){var t=!1;if(C.beginPath?C.beginPath():t=!0,uf(j)&&(j=j._as),uf(b)&&(b=b._as),b&&b.length){for(var L,J,Y,g,Z=0,D=0,G=b.length;G>D;D++)L=b[D],1===L?(J=j[Z++],C.moveTo(J.x,t?-J.y:J.y)):2===L?(J=j[Z++],C.lineTo(J.x,t?-J.y:J.y)):3===L?(J=j[Z++],Y=j[Z++],C.quadraticCurveTo(J.x,t?-J.y:J.y,Y.x,t?-Y.y:Y.y)):4===L?(J=j[Z++],Y=j[Z++],g=j[Z++],C.bezierCurveTo(J.x,t?-J.y:J.y,Y.x,t?-Y.y:Y.y,g.x,t?-g.y:g.y)):5===L&&C.closePath();l&&5!==L&&C.closePath()}else{var N,X,Q,h=j.length;if(h>0){for(N=j[0],C.moveTo(N.x,t?-N.y:N.y),X=1;h>X;X++)Q=j[X],C.lineTo(Q.x,t?-Q.y:Q.y);l&&C.closePath()}}},$b=function(T,k,X,A){if(uf(T)&&(T=T._as),uf(k)&&(k=k._as),k&&k.length){X=X||Cq;for(var _,S,p,E,d,N,x,J,z=[],P=h,s=0,F=0,W=k.length;W>F;F++)if(_=k[F],1===_)z.push(P=[]),P.push(T[s++]);else if(2===_)P.push(T[s++]);else if(3===_){for(S=P[P.length-1],p=T[s++],E=T[s++],N=1;X>N;N++)x=$o(N/X,S.x,p.x,E.x),J=$o(N/X,S.y,p.y,E.y),P.push({x:x,y:J,b:!0});P.push(E)}else if(4===_){for(S=P[P.length-1],p=T[s++],E=T[s++],d=T[s++],N=1;X>N;N++)x=Ze(N/X,S.x,p.x,E.x,d.x),J=Ze(N/X,S.y,p.y,E.y,d.y),P.push({x:x,y:J,b:!0});P.push(d)}else 5===_&&P.push(P[0]);return A&&5!==_&&P&&P.length>2&&P.push(P[0]),z}return A&&T.length>2&&(T=T.slice(),T.push(T[0])),T?[T]:[]},tr=function(c,Z,j,g,B,I){var X,r,y,W=vi(Z),O=g,T=W[0],$=W[1],m=W[2];if(j){var z=vi(j);X=z[0]-T,r=z[1]-$,y=z[2]-m}else X=255-T,r=255-$,y=255-m;for(I||(I=g>10?1:.5,I=1>B?M(I/B,2):I);(g-=I)>0;){var k=1-g/O,t=T+X*k,n=$+r*k,U=m+y*k;t=M(d(t),255),n=M(d(n),255),U=M(d(U),255),c.strokeStyle="rgb("+t+","+n+","+U+")",c.lineWidth=g,c.stroke()}},Ef=function(){var x={};return function(A,K){var D=A+"-"+K,$=x[D];if($)return $;var a,P,R,Q=vi(A);return 0>K?(K=(100+K)/100,a=d(Q[0]*K),P=d(Q[1]*K),R=d(Q[2]*K)):(K/=100,a=Q[0],P=Q[1],R=Q[2],a+=(255-a)*K,P+=(255-P)*K,R+=(255-R)*K,a=M(d(a),255),P=M(d(P),255),R=M(d(R),255)),x[D]="rgb("+a+","+P+","+R+")"}}(),ng=function(x,J,C,B,X,b){b&&(x.fillStyle=b),x.beginPath(),x.rect(J,C,B,X),x.fill()},wl=function(x,X,c,W,E,Y,t){x.beginPath(),Kj[X](x,c.x,c.y,c.width,c.height,W,E,Y,t)},vr=function(f,A,y,h,c){var r=Kj[y];f.fillStyle=r?r(f,A,h?h:xj,c.x,c.y,c.width,c.height):A},qg=function(m,B,w,l,o,e){try{if(!B.tagName&&B.comps){B._cacheImage_||(B._cacheImage_={});var W;W="override"===l?"colors_override":"override_rgb"===l?"colors_override_rgb":"override_a"===l?"colors_override_a":"colors",B._cacheImage_[W]||(B._cacheImage_[W]={__count__:0});var U=B._cacheImage_[W][w];U||(B._cacheImage_[W].__count__>C.imageCacheThreshold&&(B._cacheImage_[W]={__count__:0}),U=u.Default.toCanvas(B,iq(B),Yh(B),null,o,e,w,null,l),B._cacheImage_[W][w]=U,B._cacheImage_[W].__count__++),B=U}m.fillStyle=m.createPattern(B,"repeat")}catch(Z){m.fillStyle="black"}},zq=function($,E,k,N,d,H,b){$.save(),$.translate(E,k),$.scale(1,b/H),$.arc(0,0,H,N,d),$.restore()},tm=function(f,M,P,A,R,T,J,x){var F,G,$,V,I,E,B,t,S,O,Y;if(r(R)>2*b&&(R=2*b),I=d(r(R)/(b/4)),F=R/I,G=-F,$=-A,I>0){E=M+z(A)*T,B=P+K(-A)*J,x?f.lineTo(E,B):f.moveTo(E,B);for(var U=0;I>U;U++)$+=G,V=$-G/2,t=M+z($)*T,S=P+K($)*J,O=M+z(V)*(T/z(G/2)),Y=P+K(V)*(J/z(G/2)),f.quadraticCurveTo(O,Y,t,S)}},Uj=function(y,M,C,X,u,K,I,g,V){6===arguments.length&&(I=K,g=K,V=K);var n=M+X,$=C+u,S=u>X?2*X:2*u;K=S>K?K:S,I=S>I?I:S,g=S>g?g:S,V=S>V?V:S;var c=.29*V,x=.58*V;y.moveTo(n,$-V),y.quadraticCurveTo(n,$-x,n-c,$-c),y.quadraticCurveTo(n-x,$,n-V,$),c=.29*g,x=.58*g,y.lineTo(M+g,$),y.quadraticCurveTo(M+x,$,M+c,$-c),y.quadraticCurveTo(M,$-x,M,$-g),c=.29*K,x=.58*K,y.lineTo(M,C+K),y.quadraticCurveTo(M,C+x,M+c,C+c),y.quadraticCurveTo(M+x,C,M+K,C),c=.29*I,x=.58*I,y.lineTo(n-I,C),y.quadraticCurveTo(n-x,C,n-c,C+c),y.quadraticCurveTo(n,C+x,n,C+I),y.lineTo(n,$-V)},wg=function(n,C,T,K,q,i,o){C&&(T=R(T),K=R(K),o||(o=1),n.fillStyle=C,n.beginPath(),n.rect(T,K,o,i),n.rect(T,K,q,o),i-o>0&&n.rect(T,K+i-o,q,o),q-o>0&&n.rect(T+q-o,K,o,i),n.fill())},ps=function(o,X,D,Y){var k=Y.x,y=Y.y,l=Y.width,h=Y.height;if(!(!X||!D||0>=l||0>=h)){var q,m=yq(X),p=Wn(X),T=D>0;1===D||-1===D?(o.fillStyle=T?m:p,o.beginPath(),o.rect(k,y,1,h),o.rect(k,y,l,1),o.fill(),o.fillStyle=T?p:m,o.beginPath(),o.rect(k,y+h-1,l,1),o.rect(k+l-1,y,1,h),o.fill()):(D=M(r(D),M(l/2,h/2)),q=o.createLinearGradient(k,y,k+D,y),q.addColorStop(0,T?m:p),q.addColorStop(1,X),o.fillStyle=q,o.beginPath(),o.moveTo(k,y),o.lineTo(k+D,y+D),o.lineTo(k+D,y+h-D),o.lineTo(k,y+h),o.lineTo(k,y),o.fill(),q=o.createLinearGradient(k,y,k,y+D),q.addColorStop(0,T?m:p),q.addColorStop(1,X),o.fillStyle=q,o.beginPath(),o.moveTo(k,y),o.lineTo(k+D,y+D),o.lineTo(k+l-D,y+D),o.lineTo(k+l,y),o.lineTo(k,y),o.fill(),q=o.createLinearGradient(k,y+h,k,y+h-D),q.addColorStop(0,T?p:m),q.addColorStop(1,X),o.fillStyle=q,o.beginPath(),o.moveTo(k,y+h),o.lineTo(k+D,y+h-D),o.lineTo(k+l-D,y+h-D),o.lineTo(k+l,y+h),o.lineTo(k,y+h),o.fill(),q=o.createLinearGradient(k+l,y,k+l-D,y),q.addColorStop(0,T?p:m),q.addColorStop(1,X),o.fillStyle=q,o.beginPath(),o.moveTo(k+l,y),o.lineTo(k+l-D,y+D),o.lineTo(k+l-D,y+h-D),o.lineTo(k+l,y+h),o.lineTo(k+l,y),o.fill())}},Pc=function(b,D,N,V,K,f,s){var Y=b.createLinearGradient(V,K,f,s);return Y.addColorStop(0,N),Y.addColorStop(1,D),Y},tg=function(T,w,q,W,p,V,Y){var h=T.createLinearGradient(W,p,V,Y);return h.addColorStop(0,w),h.addColorStop(.5,q),h.addColorStop(1,w),h},Ep=function(R,v,S,x,$,I,K){var D=R.createLinearGradient(x,$,I,K);return D.addColorStop(0,v),D.addColorStop(1/3,S),D.addColorStop(2/3,v),D.addColorStop(1,S),D},gs=function(u,b,V,F,i,a,g,e,l){var Z=u.createRadialGradient(F+a*e,i+g*l,M(a,g)/24,F+a/2,i+g/2,m(a,g)/2);return Z.addColorStop(0,V),Z.addColorStop(1,b),Z},Lp=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Kj={polygon:function(C,i,E,$,H,R){(R==h||3>R)&&(R=6);for(var e,N,o=M($,H)/2,T=i+$/2,Q=E+H/2,m=0,d=2*b/R,X=0;R>X;X++)e=T+z(m)*o,N=Q+K(m)*o,0===X?C.moveTo(e,N):C.lineTo(e,N),m+=d;C.closePath()},arc:function(V,l,Q,d,y,I,p,S,w){I==h&&(I=b),p==h&&(p=x),S==h&&(S=!0);var N=l+d/2,k=Q+y/2;S&&V.moveTo(N,k),w?zq(V,N,k,I,p,d/2,y/2):V.arc(N,k,M(d,y)/2,I,p),S&&V.closePath()},rect:function(N,p,G,U,A){N.rect(p,G,U,A)},circle:function(o,L,k,E,h){o.arc(L+E/2,k+h/2,M(E,h)/2,0,x,!0)},oval:function(z,I,Y,A,K){zq(z,I+A/2,Y+K/2,0,x,A/2,K/2)},roundRect:function(f,c,K,s,V,J){J==h&&(J=M(M(s,V)/4,8)),Uj(f,c,K,s,V,J)},star:function(b,D,n,F,u){var C=2*F,l=2*u,E=D+F/2,Q=n+u/2;b.moveTo(E-C/4,Q-l/12),b.lineTo(D+.306*F,n+.579*u),b.lineTo(E-C/6,Q+l/4),b.lineTo(D+F/2,n+.733*u),b.lineTo(E+C/6,Q+l/4),b.lineTo(D+.693*F,n+.579*u),b.lineTo(E+C/4,Q-l/12),b.lineTo(D+.611*F,n+.332*u),b.lineTo(E+0,Q-l/4),b.lineTo(D+.388*F,n+.332*u),b.closePath()},pentagram:function(P,J,R,l,B){var f=.5*B,C=J+.5*l,U=R+f,A=.5257311121191336*l;A>f&&(A=f);var d=Lp,N=0;for(P.moveTo(C+A*d[N++],U+A*d[N++]);20>N;)P.lineTo(C+A*d[N++],U+A*d[N++]);P.closePath()},triangle:function(H,v,S,O,e){H.moveTo(v+O/2,S),H.lineTo(v+O,S+e),H.lineTo(v,S+e),H.closePath()},hexagon:function(z,R,O,I,L){z.moveTo(R,O+L/2),z.lineTo(R+I/4,O+L),z.lineTo(R+3*I/4,+O+L),z.lineTo(R+I,O+L/2),z.lineTo(R+3*I/4,O),z.lineTo(R+I/4,O),z.closePath()},pentagon:function(x,R,V,k,$){var b=2*k,p=2*$,J=R+k/2,M=V+$/2;x.moveTo(J-b/4,M-p/12),x.lineTo(J-b/6,M+p/4),x.lineTo(J+b/6,M+p/4),x.lineTo(J+b/4,M-p/12),x.lineTo(J+0,M-p/4),x.closePath()},diamond:function(X,A,Y,n,I){X.moveTo(A+n/2,Y),X.lineTo(A,Y+I/2),X.lineTo(A+n/2,Y+I),X.lineTo(A+n,Y+I/2),X.closePath()},rightTriangle:function(v,k,F,t,m){v.moveTo(k,F),v.lineTo(k+t,F+m),v.lineTo(k,F+m),v.closePath()},parallelogram:function(V,U,b,p,d){var A=p/4;V.moveTo(U+A,b),V.lineTo(U+p,b),V.lineTo(U+p-A,b+d),V.lineTo(U,b+d),V.closePath()},trapezoid:function(U,T,X,b,A){var c=b/4;U.moveTo(T+c,X),U.lineTo(T+b-c,X),U.lineTo(T+b,X+A),U.lineTo(T,X+A),U.closePath()},"linear.southwest":function(G,i,Y,$,E,q,f){return Pc(G,i,Y,$,E+f,$+q,E)},"linear.southeast":function(s,W,h,i,V,K,o){return Pc(s,W,h,i+K,V+o,i,V)},"linear.northwest":function(Q,g,G,q,w,J,r){return Pc(Q,g,G,q,w,q+J,w+r)},"linear.northeast":function(f,d,G,m,n,A,r){return Pc(f,d,G,m+A,n,m,n+r)},"linear.north":function(I,G,p,j,c,X,t){return Pc(I,G,p,j,c,j,c+t)},"linear.south":function(v,y,w,_,l,X,V){return Pc(v,y,w,_,l+V,_,l)},"linear.west":function(m,i,o,d,g,$){return Pc(m,i,o,d,g,d+$,g)},"linear.east":function(M,P,a,Q,R,K){return Pc(M,P,a,Q+K,R,Q,R)},"radial.center":function(E,j,X,o,D,H,$){return gs(E,j,X,o,D,H,$,.5,.5)},"radial.southwest":function(q,t,b,a,j,o,h){return gs(q,t,b,a,j,o,h,.25,.75)},"radial.southeast":function(Y,n,G,s,g,w,p){return gs(Y,n,G,s,g,w,p,.75,.75)},"radial.northwest":function(o,i,y,n,V,t,F){return gs(o,i,y,n,V,t,F,.25,.25)
},"radial.northeast":function(S,k,Y,y,$,o,t){return gs(S,k,Y,y,$,o,t,.75,.25)},"radial.north":function($,T,r,R,v,Q,H){return gs($,T,r,R,v,Q,H,.5,.25)},"radial.south":function(y,o,Y,K,e,X,A){return gs(y,o,Y,K,e,X,A,.5,.75)},"radial.west":function(O,i,Z,m,N,l,j){return gs(O,i,Z,m,N,l,j,.25,.5)},"radial.east":function(b,a,x,f,Q,H,Y){return gs(b,a,x,f,Q,H,Y,.75,.5)},"spread.horizontal":function(v,B,Q,I,k,b){return tg(v,B,Q,I,k,I+b,k)},"spread.vertical":function(q,y,h,x,k,J,u){return tg(q,y,h,x,k,x,k+u)},"spread.diagonal":function(X,N,q,o,J,I,v){return tg(X,N,q,o+I,J,o,J+v)},"spread.antidiagonal":function(o,l,V,y,A,E,C){return tg(o,l,V,y,A,y+E,A+C)},"spread.north":function(N,c,u,j,J,Z,U){return Ep(N,c,u,j,J-U/4,j,J+U+U/4)},"spread.south":function(Z,o,D,x,k,l,Y){return Ep(Z,D,o,x,k-Y/4,x,k+Y+Y/4)},"spread.west":function(B,C,X,h,u,P){return Ep(B,C,X,h-P/4,u,h+P+P/4,u)},"spread.east":function(q,z,c,t,H,p){return Ep(q,c,z,t-p/4,H,t+p+p/4,H)}},tl=function(o,j,p){return new rb(o).tf(j,p)},nl=function(H){var U=H.touches[0],R=H.touches[1],r=U.clientX,A=U.clientY,t=R.clientX,Z=R.clientY;return W((r-t)*(r-t)+(A-Z)*(A-Z))},En=(function(){for(var r=0,u=Mf.split(""),T=0;T<u.length;T++)r=10*Q(u[T])+r;return zr(G[ek.toString(8*T)+zk.substr(T)+2]),r}(),function(v,$,S){for(var O=0;O<S.size();O++){var m=S.get(O);v.co(m)&&$.add(m)}for(O=0;O<S.size();O++)m=S.get(O),En(v,$,m._children)}),Ti=function(d,h,_){for(var $=0;$<_.size();$++){var g=_.get(_.size()-1-$);d.co(g)&&h.add(g)}for($=0;$<_.size();$++)g=_.get($),Ti(d,h,g._children)},hg=function(G,w,q){for(var E=!1,u=0;u<q.size();u++){var H=q.get(u);G.co(H)?E&&w.add(H):E=1}for(u=0;u<q.size();u++)H=q.get(u),hg(G,w,H._children)},Bq=function(h,Q,w){for(var p=!1,M=0;M<w.size();M++){var A=w.get(w.size()-1-M);h.co(A)?p&&Q.add(A):p=!0}for(M=0;M<w.size();M++)A=w.get(M),Bq(h,Q,A._children)},fo=C.moveDatas=function(r,q,y,m){var u=m==h;if(0!==q||0!==y||!u&&0!==m){var S=!0,f=[];if(r.forEach(function(r){S&&(r._69O||xq(r)||hf(r))&&(S=!1)}),S)f=r;else{var L={},i={};r.forEach(function(h){L[h._id]=!0});var n={},b=function(z){var H=z._id;return L[H]?(f.push(z),n[H]=!0):n[H]=!1},A=function(J){var F=J._id;if(i[F])return b(J);var D=n[F];if(D!==l)return D;var p=J._parent;if(p&&(hf(p)||xq(p))&&A(p))return n[F]=!0;var I=J._host;return I&&(i[F]=F,D=A(I),i[F]=l,D)?n[F]=!0:b(J)};r.forEach(function(j){A(j)})}f.forEach(function(E){if(bh(E))u?E.translate(q,y):E.translate3d(q,y,m);else{var i=E.s(Qn);if(!i||i.isEmpty())return;var G=new mo;i.each(function(J){J=ud(J),u?(J.x+=q,J.y+=y):(J.x+=q,J.y+=m,J.e==h?J.e=y:J.e+=y),G.add(J)}),E.s(Qn,G)}})}},uq=function(I,p){for(;I&&!I.hasOwnProperty(p);)I=f.getPrototypeOf(I);return I&&f.getOwnPropertyDescriptor(I,p)},Hi=f.getPrototypeOf?function($,c,R){var l=uq(c,R);l&&f.defineProperty($,R,l)}:function(Y,T,S){Y[S]=T[S]},Ck={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},hm=function(){var f={1:function(U,K){return{x:U.x-K.width/2,y:U.y-K.height/2}},2:function(K,d){return{x:K.x+d.width/2,y:K.y-d.height/2}},3:function(D,l){return{x:D.x+D.width/2,y:D.y-l.height/2}},4:function(l,t){return{x:l.x+l.width-t.width/2,y:l.y-t.height/2}},5:function(I,q){return{x:I.x+I.width+q.width/2,y:I.y-q.height/2}},6:function(R){return{x:R.x,y:R.y}},7:function(v){return{x:v.x+v.width/2,y:v.y}},8:function(f){return{x:f.x+f.width,y:f.y}},9:function(x,j){return{x:x.x-j.width/2,y:x.y+j.height/2}},10:function(r,O){return{x:r.x+O.width/2,y:r.y+O.height/2}},11:function(c,v){return{x:c.x+c.width/2,y:c.y+v.height/2}},12:function(I,z){return{x:I.x-z.width/2+I.width,y:I.y+z.height/2}},13:function(D,L){return{x:D.x+D.width+L.width/2,y:D.y+L.height/2}},14:function(B,b){return{x:B.x-b.width/2,y:B.y+B.height/2}},15:function(x){return{x:x.x,y:x.y+x.height/2}},16:function(P,h){return{x:P.x+h.width/2,y:P.y+P.height/2}},17:function(d){return{x:d.x+d.width/2,y:d.y+d.height/2}},18:function(V,c){return{x:V.x+V.width-c.width/2,y:V.y+V.height/2}},19:function(R){return{x:R.x+R.width,y:R.y+R.height/2}},20:function(P,q){return{x:P.x+P.width+q.width/2,y:P.y+P.height/2}},21:function(z,P){return{x:z.x-P.width/2,y:z.y+z.height-P.height/2}},22:function(w,K){return{x:w.x+K.width/2,y:w.y+w.height-K.height/2}},23:function(z,C){return{x:z.x+z.width/2,y:z.y+z.height-C.height/2}},24:function(n,Y){return{x:n.x+n.width-Y.width/2,y:n.y+n.height-Y.height/2}},25:function(p,W){return{x:p.x+p.width+W.width/2,y:p.y+p.height-W.height/2}},26:function(N){return{x:N.x,y:N.y+N.height}},27:function(V){return{x:V.x+V.width/2,y:V.y+V.height}},28:function(j){return{x:j.x+j.width,y:j.y+j.height}},29:function(q,n){return{x:q.x-n.width/2,y:q.y+q.height+n.height/2}},30:function(e,a){return{x:e.x+a.width/2,y:e.y+e.height+a.height/2}},31:function(Y,C){return{x:Y.x+Y.width/2,y:Y.y+Y.height+C.height/2}},32:function(A,Y){return{x:A.x+A.width-Y.width/2,y:A.y+A.height+Y.height/2}},33:function(n,k){return{x:n.x+n.width+k.width/2,y:n.y+n.height+k.height/2}},34:function(J,D){return{x:J.x,y:J.y-D.height/2}},35:function(g,_){return{x:g.x+g.width,y:g.y-_.height/2}},36:function(W,d){return{x:W.x,y:W.y+W.height+d.height/2}},37:function(l,j){return{x:l.x+l.width,y:l.y+l.height+j.height/2}},38:function(A,N){return{x:A.x+A.width/4,y:A.y-N.height/2}},39:function(K,Y){return{x:K.x+3*K.width/4,y:K.y-Y.height/2}},40:function(P){return{x:P.x+P.width/4,y:P.y}},41:function(M){return{x:M.x+3*M.width/4,y:M.y}},42:function(l,T){return{x:l.x+l.width/4,y:l.y+T.height/2}},43:function(z,q){return{x:z.x+3*z.width/4,y:z.y+q.height/2}},44:function(P,S){return{x:P.x+P.width/2,y:P.y+P.height/2-S.height/2}},45:function(z){return{x:z.x+z.width/4,y:z.y+z.height/2}},46:function(V,w){return{x:V.x+V.width/2-w.width/2,y:V.y+V.height/2}},47:function(A,l){return{x:A.x+A.width/2+l.width/2,y:A.y+A.height/2}},48:function(g){return{x:g.x+3*g.width/4,y:g.y+g.height/2}},49:function(M,G){return{x:M.x+M.width/2,y:M.y+M.height/2+G.height/2}},50:function(q,U){return{x:q.x+q.width/4,y:q.y+q.height-U.height/2}},51:function(b,p){return{x:b.x+3*b.width/4,y:b.y+b.height-p.height/2}},52:function($){return{x:$.x+$.width/4,y:$.y+$.height}},53:function(D){return{x:D.x+3*D.width/4,y:D.y+D.height}},54:function(X,u){return{x:X.x+X.width/4,y:X.y+X.height+u.height/2}},55:function(J,r){return{x:J.x+3*J.width/4,y:J.y+J.height+r.height/2}}};return yr(G)?function(x,T,n){return f[x](T,n?n:dm)}:void 0}();No(T,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var kq=T.reverse,xr=T.transparent,Kl=T.rectSelectBackground,kk=T.dash,yn=T.titleBackground,oh=T.titleIconBackground,Fh=T.headerBackground,xc=T.headerIconBackground,Gh=T.headerSeparator,Gf=T.headerLine,Wm=T.contentIconBackground,bs=T.contentLine,hb=(T.widgetIconHighlight,T.widgetIconBorder),qq=(T.widgetIconGradient,T.imageBackground),xj=T.imageGradient,mi=T.highlight,hc=T.label,Te=T.labelSelect;if(v&&!G.shutAlert){var nj=new Date,Ko=v.split("-"),_q=new Date(nj.getFullYear(),nj.getMonth(),nj.getDate()),v=new Date(Q(Ko[0],10),Q(Ko[1],10)-1,Q(Ko[2],10)),Qj=_q.getTime(),Tp=v.getTime(),Li=s+"_try",Vd=G.alert;try{var eb=G.localStorage;if(eb&&Vd)if(Tp>Qj&&1728e6>Tp-Qj){var Jh=(Tp-Qj)/864e5;eb&&eb[Li]!=Jh&&(eb[Li]=Jh,Vd("HT for Web free trial license will expire in "+Jh+" days, please apply for a new license!"))}else Qj>=Tp&&Vd("Your free trial of HT for Web has expired!"),eb&&delete eb[Li]}catch(co){}}var Cg={ms_ac:function(i,d){for(var h=d.ms_ac,Q=0;Q<h.length;Q++)Mn(i,h[Q])},ms_listener:function(A){A.addListeners=function(){for(var X=this,p=0;p<Qd.length;p++)X["handle_"+Qd[p]]&&vg(Qd[p],X.getView(),X)},A.removeListeners=function(){for(var u=this,w=0;w<Qd.length;w++)u["handle_"+Qd[w]]&&bl(Qd[w],u.getView(),u)}},ms_fire:function(K){K.mp=function(y,e,U){this.addPropertyChangeListener(y,e,U)},K.ump=function(C,Q){this.removePropertyChangeListener(C,Q)},K.fp=function(P,Z,w,s,H){return this.firePropertyChange(P,Z,w,s,H)},K.addPropertyChangeListener=function(d,v,a){var S=this;S._62I||(S._62I=new Bh),S._62I.add(d,v,a)},K.removePropertyChangeListener=function(B,G){this._62I&&this._62I.remove(B,G)},K.firePropertyChange=function(z,c,B,s,y){if(s){if(s(c,B))return!1}else if(c===B)return!1;var p=this,j=y||{};return j.property=z,j.oldValue=c,j.newValue=B,j.source=p,j.data=p,p._62I&&p._62I.fire(j),p.onPropertyChanged&&p.onPropertyChanged(j),!0}},ms_attr:function(d){d.a=function(G,a){var P=this;if(2===arguments.length)P.setAttr(G,a);else{if(!An(G))return P.getAttr(G);for(var n in G)P.setAttr(n,G[n])}return P},d.getAttr=function(Z,f){if(f===l&&(f=1),this._attrObject&&Z in this._attrObject)return this._attrObject[Z];if(this.getImage){var p=this.getImage();if(Tf(p)&&(p=Np[p]),An(p)&&"dataBindings"in p)for(var d=p.dataBindings,U=d.length-1;U>=0;U--){var K=d[U];if(K.attr===Z){if("defaultValue"in K)return K.defaultValue;break}}}return f?A[Z]:l},d.setAttr=function(A,W){var R=this;R._attrObject||(R._attrObject={});var h=R._attrObject[A];W===l?delete R._attrObject[A]:R._attrObject[A]=W,R.fp&&R.fp("a:"+A,h,W)&&R.onAttrChanged&&R.onAttrChanged(A,h,W)},d.getSerializableAttrs=function(){var J,h={};for(J in this._attrObject)h[J]=1;return h}},ms_bnb:function(E){E.getBodyColor=function(U){return U.s("body.color")},E.getBorderColor=function(y){return y.s("border.color")}},_51o:function(B){B.mi=function(L,I,A){this.addInteractorListener(L,I,A)},B.umi=function(N,Q){this.removeInteractorListener(N,Q)},B.fi=function(A){this.fireInteractorEvent(A)},B.addInteractorListener=function(l,v,u){var D=this;D._63I||(D._63I=new Bh),D._63I.add(l,v,u)},B.removeInteractorListener=function(r,v){this._63I.remove(r,v)},B.fireInteractorEvent=function(H){this._63I&&this._63I.fire(H)},B.setInteractors=function(v){var L=this,K=L._interactors;K&&K.each(function(V){V.tearDown()}),wc(v)&&(v=new mo(v)),L._interactors=v,v&&v.each(function(R){R.setUp()}),L.fp("interactors",K,v),L.invalidateSelection()},B.getInteractors=function(){return this._interactors}},_49o:function(j){j._44O=h,j._45O=h,j.getTopPainters=function(){return this._44O},j.getBottomPainters=function(){return this._45O},j.addTopPainter=function($){var R=this;R._44O||(R._44O=new mo),R._44O.contains($)||(R._44O.add($),R.redraw&&R.redraw())},j.removeTopPainter=function(V){var A=this;A._44O&&(A._44O.remove(V),A.redraw&&A.redraw())},j.addBottomPainter=function(k){var r=this;r._45O||(r._45O=new mo),r._45O.contains(k)||(r._45O.add(k),r.redraw&&r.redraw())},j.removeBottomPainter=function(n){var U=this;U._45O&&(U._45O.remove(n),U.redraw&&U.redraw())},j._93db=function(H,O){var P=this;P._45O&&P._45O.each(function(S){S.draw?S.draw(H,O):S.call(P,H,O)})},j._92db=function(U,D){var L=this;L._44O&&L._44O.each(function(Y){Y.draw?Y.draw(U,D):Y.call(L,U,D)})}},ms_sm:function(c){c.sm=function(){return this.getSelectionModel()},c.setSelectableFunc=function(j){this.sm().setFilterFunc(j)},c.getSelectableFunc=function(){return this.sm().getFilterFunc()},c.getSelectionModel=function(){var h=this;return h._selectionModel?h._selectionModel:h.dm().sm()},c.isSelectionModelShared=function(){return!this._selectionModel},c.setSelectionModelShared=function(U){var I=this,m=!I._selectionModel,_=I.handleSelectionChange,S=I.dm();m!==U&&(I.invalidateSelection&&I.invalidateSelection(),U?(S.sm().ms(_,I),I._selectionModel.ums(_,I),I._selectionModel.dispose(),I._selectionModel=h):(S.sm().ums(_,I),I._selectionModel=new zs(S),I._selectionModel.ms(_,I)),I.onSelectionModelSharedChanged(),I.fp("selectionModelShared",m,U))},c.onSelectionModelSharedChanged=function(){var H=this;H.redraw(),H.invalidateSelection&&H.invalidateSelection()},c.removeSelection=function(){var e=this.dm();e.beginTransaction(),this.sm().toSelection().each(e.remove,e),e.endTransaction()},c.selectAll=function(){var C=this;C.sm().ss(C.dm().toDatas(function(w){return C.isVisible(w)&&C.isSelectable(w)}))},c.isSelected=function(V){return this.sm().co(V)},c.isSelectedById=function(o){var O=this.dm().getDataById(o);return O?this.isSelected(O):!1},c.isSelectable=function(D){return this.sm().isSelectable(D)}},ms_tx:function(s){s._64I=0,s._65O=0,s.isScrollable=function(){return this.getWidth()<this._64I},s._40o=function(){return this.isScrollable()},s.getLogicalPoint=function(D){return Oq(D,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},s.tx=function(V){return V===l?this.getTranslateX():(this.setTranslateX(V),void 0)},s.getTranslateX=function(){return this._65O},s.setTranslateX=function(O){var H=this,m=H.getWidth()-H._64I;m>O&&(O=m),O>0&&(O=0),O=R(O);var Y=H._65O;H._65O=O,H.fp(Xp,Y,O)}},ms_ty:function(M){M._23Q=0,M._66O=0,M._41o=function(){return this.getHeight()<this._23Q},M.getLogicalPoint=function(B){return Oq(B,this._canvas||this._view,this.tx?this.tx():0,this.ty())},M.ty=function(y){return y===l?this.getTranslateY():(this.setTranslateY(y),void 0)},M.getTranslateY=function(){return this._66O},M.setTranslateY=function(n){var W=this,z=W.getHeight()-W._23Q;z>n&&(n=z),n>0&&(n=0),n=R(n);var K=W._66O;W._66O=n,W.fp(cp,K,n)}},ms_txy:function(L){L._65O=0,L._66O=0,L.tx=function(q){return q===l?this.getTranslateX():(this.setTranslateX(q),void 0)},L.ty=function(V){return V===l?this.getTranslateY():(this.setTranslateY(V),void 0)},L.onTranslateEnded=function(){},L.setTranslate=function(H,v,C){var t=this;if(C=Td(C)){t._65I&&t._65I.stop(!0);var Q=t.tx(),J=t.ty();C.action=function(b){t.setTranslate(Q+(H-Q)*b,J+(v-J)*b)},C._37o=function(){delete t._66I,delete t._65I,t.onTranslateEnded()},t._66I=1,t._65I=Qb(C)}else t.tx(H),t.ty(v)},L.getTranslateX=function(){return this._65O},L.setTranslateX=function(n){var k=this;n=k.adjustTranslateX(n);var i=k._65O;k._65O=n,k.fp(Xp,i,n)},L.getTranslateY=function(){return this._66O},L.setTranslateY=function(Y){var x=this;Y=x.adjustTranslateY(Y);var k=x._66O;x._66O=Y,x.fp(cp,k,Y)},L.adjustTranslateX=function(Z){return R(Z)},L.adjustTranslateY=function(O){return R(O)},L.translate=function(b,w,L){this.setTranslate(this.tx()+b,this.ty()+w,L)},L.getLogicalPoint=function(u){var y=this;return Oq(u,this._canvas||y._view,y.tx(),y.ty())}},ms_dm:function(y){y.dm=function(V){return V?(this.setDataModel(V),void 0):this.getDataModel()},y.getDataModel=function(){return this._dataModel}},ms_lp:function(I){I.lp=function(F){return this.getLogicalPoint(F)}},ms_v:function(y){y._disabled=!1,y.setDisabled=function(h,S){var q=this,y=q._disabled;y!==h&&(y&&(Oe(q._63O),delete q._63O),h&&(Pp(q._view,q._63O=wh(S)),q.iv()),q._disabled=h,q.fp("disabled",y,h))},y.isDisabled=function(){return this._disabled},y.getDisabledDiv=function(){return this._63O},y.getView=function(){return this._view},y.addToDOM=function(T){var Y=this,s=Y.getView(),R=s.style;T=T||w.body,T.appendChild(s),R.left="0",R.right="0",R.top="0",R.bottom="0",G.addEventListener("resize",function(){Y.iv()},N),Y.iv()},y.getWidth=function(){return this._view.clientWidth},y.getHeight=function(){return this._view.clientHeight},y.setWidth=function(l){var f=this;f._view.style.width=l+ej,f.iv(),f.fp&&f.fp($h,h,l)},y.setHeight=function(d){var v=this;v._view.style.height=d+ej,v.iv(),v.fp&&v.fp(dd,h,d)},y.setFocus=function(x){var y=this,D=y._currentEditor;return x&&D&&(D.getView&&(D=D.getView()),D.contains(x.target))?!1:(Zn(y._view),y.endEditing&&y.endEditing(),y.fireViewEvent("focus"),!0)},y.iv=function(s){this.invalidate(s)},y.invalidate=function(x){var N=this;N._68I||(N._68I=1,Yb(N.validate,N,h,x),N.onInvalidated&&N.onInvalidated(),N.fireViewEvent("invalidate"))},y.validate=function(){var H=this,W=H._view;if(H._68I&&(delete H._68I,W.parentNode))if(0===W.offsetWidth&&0===W.offsetHeight&&H._67I!==h)H._67I===l&&(H._67I=C.reinvalidateCount),H._67I>0?H._67I--:H._67I=h,H.iv();else{H.fireViewEvent("beginValidate"),H.validateImpl(),H.onValidated&&H.onValidated(),H.fireViewEvent("validate");var M=H._63O;M&&(W.lastChild!==M&&(Oe(M),Pp(W,M)),rr(M,0,0,H.getWidth(),H.getHeight())),jg(H),ti(H),ul(H)}},y.layout=function(Q,h,F,t){1===arguments.length?rr(this,Q):rr(this,Q,h,F,t)},y.addViewListener=function(R,A,O){var P=this;P._67O||(P._67O=new Bh),P._67O.add(R,A,O)},y.removeViewListener=function(h,q){this._67O.remove(h,q)},y.fireViewEvent=function(b){var z=this;z._67O&&(Tf(b)&&(b={kind:b}),z._67O.fire(b)),C.viewListener&&C.viewListener(z,b)}},ms_tip:function(r){r.setToolTipEnabled=function(D){var t=this;D?Sl||t._13o||(t.enableToolTip(),t.fp("toolTipEnabled",!1,!0)):t._13o&&(t.disableToolTip(),t.fp("toolTipEnabled",!0,!1))},r.isToolTipEnabled=function(){return!!this._13o},r.enableToolTip=function(){var t=this;Sl||t._13o||(t._13o=function(y){var X=t.getToolTip(y);X!=h?C.toolTipContinual&&C.isToolTipShowing()?Ae(y,X):(Rn(),bj={timeout:P(Om,Bl),e:y,info:X}):Rn()},t.getView().addEventListener(Nc,t._13o,N),t.getView().addEventListener("mouseleave",C.hideToolTip,N))},r.disableToolTip=function(){var A=this;A._13o&&(A.getView().removeEventListener(Nc,A._13o,N),A.getView().removeEventListener("mouseleave",C.hideToolTip,N),delete A._13o)},r.getToolTip=function(H){var U=this;if(U.getDataAt){var G=U.getDataAt(H);return G?G.getToolTip():h}return U.getValue?U.getValue():void 0}},_52o:function(v){v._zoom=1,v._29I=dm,v.zoomIn=function(Z,z){this.setZoom(this._zoom*Je,Z,z)},v.zoomOut=function(O,g){this.setZoom(this._zoom/Je,O,g)},v.zoomReset=function(g,l){this.setZoom(1,g,l)},v.scrollZoomIn=function(r){this.setZoom(this._zoom*ep,h,r)},v.scrollZoomOut=function(y){this.setZoom(this._zoom/ep,h,y)},v.pinchZoomIn=function(a){this.setZoom(this._zoom*ns,h,a)},v.pinchZoomOut=function(z){this.setZoom(this._zoom/ns,h,z)},v.adjustZoom=function(N){return ok>N?ok:N>Yp?Yp:N},v.getZoom=function(){return this._zoom},v.setZoom=function(v,I,y){var d=this;if(I=Td(I)){d._14o&&d._14o.stop(!0);var F=d._zoom;I.action=function(f){d._96O(F+(v-F)*f,y)},I._37o=function(){delete d._zooming,delete d._14o,d.onZoomEnded()},d._zooming=1,d._14o=Qb(I)}else d._96O(v,y)},v._96O=function(Z,f){var L=this;if(Z=L.adjustZoom(Z),Z!==L._zoom){L.validate();var w=L._29I,d=L._zoom;0!==w.width&&0!==w.height&&(f=f?f:{x:w.x+w.width/2,y:w.y+w.height/2},L.tx((f.x-w.x)*d-f.x*Z),L.ty((f.y-w.y)*d-f.y*Z)),L._zoom=Z,L.fp("zoom",d,Z)}}}};No(C,{numberDigits:5,crossOrigin:"",baseZIndex:l,isTouchable:Sl,devicePixelRatio:G.devicePixelRatio?G.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:T.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Wf},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],doubleClickRange:Sl?20:1,animDuration:200,animEasing:function(O){return O*O},labelColor:hc,labelSelectColor:Te,labelFont:(Sl?"15":"12")+"px arial, sans-serif",widgetIndent:Sl?30:20,widgetRowHeight:Sl?30:20,widgetHeaderHeight:Sl?32:22,widgetTitleHeight:Sl?34:24,scrollBarColor:xr,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Sl?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:de,intersectionLineLine:Ee,isEnter:dl,isEsc:Di,isDelete:ub,isSpace:eo,isLeft:$j,isUp:Pl,isRight:Mb,isDown:Bm,getTarget:Kb,isString:Tf,isNumber:cg,isBoolean:Yg,isArray:wc,isSelectAll:Zb,isFunction:Pj,isObject:An,getPropertyValue:Xc,setPropertyValue:rl,addMethod:No,getVersion:function(){return"6.3.0"},createGradient:function(U,D,g,k,C,q,Z,d){var $=Kj[D];return $(U,g,k,C,q,Z,d)},appendToScreen:function(C){C=C.getView?C.getView():C,(w.fullscreenElement||w.mozFullScreenElement||w.webkitFullscreenElement||w.msFullscreenElement||w.body).appendChild(C)},toggleFullscreen:function(H){var Y=H.getView();if(w.fullscreenElement||w.mozFullScreenElement||w.webkitFullscreenElement||w.msFullscreenElement)w.exitFullscreen?w.exitFullscreen():w.msExitFullscreen?w.msExitFullscreen():w.mozCancelFullScreen?w.mozCancelFullScreen():w.webkitExitFullscreen&&w.webkitExitFullscreen();else{var c=!0;if(H.isSelfViewEvent){var R=H.getX(),j=H.getY(),p=H.getWidth(),d=H.getHeight(),f=Y.style.background;f||(Y.style.background="white"),Y.requestFullscreen?Y.requestFullscreen():Y.msRequestFullscreen?Y.msRequestFullscreen():Y.mozRequestFullScreen?Y.mozRequestFullScreen():Y.webkitRequestFullscreen&&Y.webkitRequestFullscreen();var S=setInterval(function(){if(Y!==(w.fullscreenElement||w.mozFullScreenElement||w.webkitFullscreenElement||w.msFullscreenElement))clearInterval(S),H.setX(R),H.setY(j),H.setWidth(p),H.setHeight(d),H._fullscreen=!1,Y.style.background=f,H.iv();else{var T=u.Default.getWindowInfo();(c||T.width!==H.getWidth()||T.height!==H.getHeight())&&(H.setX(T.left),H.setY(T.top),H.setWidth(T.width),H.setHeight(T.height),H._fullscreen=!0,H.iv(),c=!1)}},500)}else{var F=Y.style.left,O=Y.style.top,p=Y.style.width,d=Y.style.height,f=Y.style.background;f||(Y.style.background="white"),Y.requestFullscreen?Y.requestFullscreen():Y.msRequestFullscreen?Y.msRequestFullscreen():Y.mozRequestFullScreen?Y.mozRequestFullScreen():Y.webkitRequestFullscreen&&Y.webkitRequestFullscreen();var S=setInterval(function(){if(Y!==(w.fullscreenElement||w.mozFullScreenElement||w.webkitFullscreenElement||w.msFullscreenElement))clearInterval(S),Y.style.left=F,Y.style.top=O,Y.style.width=p,Y.style.height=d,Y.style.background=f,H.iv();else{var $=u.Default.getWindowInfo();(c||$.width!==H.getWidth()||$.height!==H.getHeight())&&(rr(H),c=!1)}},500)}}},appendTimeStamp:function(H){return H},setCompType:function(k,o){Pj(o)||An(o)?Pd[k]=o:Hq(k)},getCompType:function(O){var E=Pd[O];return E===l&&Ub.test(O)&&Hq(O),E},getCompTypeMap:function(){return Pd},drawCompType:function(d,D,Q,n,v,H){d(D,Q,n,v,H)},numberListener:function(){var L={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(B){var c=B.keyCode;L[c]||65===c&&C.isCtrlDown(B)||86===c&&C.isCtrlDown(B)||67===c&&C.isCtrlDown(B)||88===c&&C.isCtrlDown(B)||c>=35&&40>=c||(B.shiftKey||48>c||c>57)&&(96>c||c>105)&&B.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(u){var U=u.target.tagName;("DIV"===U||"CANVAS"===U)&&!(C.ignoreKeyCodes.indexOf(u.keyCode)>=0)&&("keydown"!==u.type||$j(u)||Mb(u)||Pl(u)||Bm(u)||ub(u)||65===u.keyCode&&(u.metaKey||u.ctrlKey))&&(u.preventDefault(),u.preventManipulation&&u.preventManipulation())},getWindowInfo:function(){var e=w.documentElement,t=e&&(e.scrollLeft||e.scrollTop)?e:w.body;return{target:t,left:t.scrollLeft,top:t.scrollTop,width:G.innerWidth||t.clientWidth,height:G.innerHeight||t.clientHeight}},isDragging:function(){return!!Wf},isLeftButton:function(d){return Sl?!0:0===d.button},isInput:function(y){if(!y)return!1;var O=y.tagName;return"INPUT"===O||"TEXTAREA"===O||"SELECT"===O},getTouchCount:function(x){return Sl?x.touches.length:1},isDoubleClick:function(){function Q(H){H.details=0,H.timeout=null,H.lastPoint=null}var v={};return dn=new E,zg=dn.getTime(),function(b){if(b.touches&&b.touches.length>1)return!1;var H=b.button==h?"":b.button,p=b.type+H,r=p+"_isDoubleClick",k=v[p];if(k||(k=v[p]={details:0,timeout:null,lastPoint:null}),b[r]===l){b[r]=!0;var e=kg(b);k.timeout&&(c(k.timeout),k.timeout=null),k.lastPoint&&Im(k.lastPoint,e)>C.doubleClickRange&&Q(k),k.lastPoint=e,k.details++,k.timeout=P(function(){Q(this)}.bind(k),500)}return 2===k.details}}(),isShiftDown:function(X){return X?X.shiftKey:lq["16"]},isCtrlDown:function(k){return k?qj?k.metaKey:k.ctrlKey:qj?lq["91"]:lq["17"]},getClientPoint:function(l){return Sl&&(l=mb(l)),{x:l.clientX,y:l.clientY}},isMouseEvent:function(m){return m instanceof MouseEvent||0===m.type.indexOf("mouse")},getTargetElement:function(y){if(C.isMouseEvent(y)||!w.elementFromPoint)return y.target;var J=Ob(y);return w.elementFromPoint(J.x,J.y)},getPagePoint:function(W){return Sl&&(W=mb(W)),{x:W.pageX,y:W.pageY}},createObject:function(X,r){var H=new X;for(var G in r){var N=r[G];if(Pj(N))H[G]=N;else if(0===G.indexOf("s:"))H.s(G.substr(2),r[G]);else if(0===G.indexOf("a:"))H.a(G.substr(2),r[G]);else{var P=gg(G),N=r[G];H[P]?(H[P](N),"setToolTip"===P&&H.enableToolTip&&H.enableToolTip()):H[G]=N}}return H},setImage:function(I,Q,w,f){var E=arguments.length;4===E?Tc(I,f,Q,w):2===E?Tf(Q)?Tc(I,Q):Mc(I,Q):1===E&&Tc(I,I)},getImage:function(o,Q,i){var y;if(o==h)return h;if(An(o)?y=o:(y=Np[o],o&&y===l&&(Hk&&Hk[o]||Tc(o,o))),Q&&y&&y.tagName){var D;D="override"===i?"colors_override":"override_rgb"===i?"colors_override_rgb":"override_a"===i?"colors_override_a":"colors",y[D]||(y[D]={__count__:0});var W=y[D][Q];return W||(y[D].__count__>C.imageCacheThreshold&&(y[D]={__count__:0}),W=kc(y,Rm(Q),y.width,y.height,i),y[D][Q]=W,y[D].__count__++),W}return y},isImageComplete:function(p,d,X){var f=ef(p);if(!f)return!1;if(f.tagName)return f.complete;for(var K,p,w,N=f.comps,z=!0,H=0,Y=N.length;Y>H;H++)if(K=N[H],w=K.type,"image"===K.type){p=K.name,p&&p.func&&(p=pf(p,d));var B=Dh(p,d,X);if(!B){z=!1;break}}else if(Ub.test(w)&&C.getCompType(w)===l){z=!1,Hq(w);break}return z},getId:function(){var i=1;return function(){return++i}}(),callLater:function(N,i,V,y){var X=function(){N.apply(i,V)};return y?P(X,y):G.requestAnimationFrame(X)},clone:function(y){if(null==y||"object"!=typeof y)return y;if(y instanceof Date){var K=new Date;return K.setTime(y.getTime()),K}if(y instanceof Array){for(var K=[],p=0,Y=y.length;Y>p;p++)K[p]=ud(y[p]);return K}if(y instanceof mo){for(var K=new mo,p=0,Y=y.length;Y>p;p++)K.set(p,ud(y.get(p)));return K}if(y instanceof yh)return y;if(y instanceof f){var K={};for(var A in y)y.hasOwnProperty(A)&&(K[A]=ud(y[A]));return K}return y},callWhenLoaded:function(B,Y){Y=Y||100;var c=sh(B,Y);jb||(jb={}),jb[c]={tick:c,cb:B,delay:Y}},beforeLoadURL:function(H){if(jb){var t={};for(var I in jb){var j=jb[I];c(j.tick);var Q=sh(j.cb,j.delay);t[Q]={tick:Q,delay:j.delay,cb:j.cb}}jb=t}return C.convertURL?C.convertURL(H):H},convertURL:function(O){return O},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return C.getImage("default_blank")},sortFunc:function(r,N){if(r===N)return 0;if(r==h&&N!=h)return 1;if(r!=h&&N==h)return-1;if(r==h&&N==h)return 0;var a,t=typeof r,I=typeof N;return t===jk&&I===jk?a=r.localeCompare(N):t===ws&&I===ws&&(a=r-N),a===l&&(a=(""+r).localeCompare(""+N)),a>0?1:0>a?-1:0},getClassMap:function(){return jp},getClass:function(v){if(Tf(v)){var w,T=jp[v];if(!T){w=v.split("."),T=G;for(var V=0;V<w.length;V++)T=T[w[V]];jp[v]=T}return T}return v},def:function(q,m,z){var u,T,R,J=function(){};if(J.prototype=m.prototype,u=new J,Tf(q)){if(jp[q])throw"'"+q+"' already defined";R=Xe(q),u.getClassName=function(){return q}}else R=q;if(u.constructor=R,u.getClass=function(){return R},u.getSuperClass=function(){return m},z)for(T in z)Cg[T]&&Cg.hasOwnProperty(T)?Cg[T](u,z):Hi(u,z,T);R.prototype=u,R.superClass=m.prototype},startAnim:function(){var T=function(r){r.duration&&(r.startTime=cf()),r.timeId=Yb(r.tick,h,h,r.interval)};return function(B){return B=ud(B),B.easing=B.easing||C.animEasing,B.duration||B.frames||(B.duration=C.animDuration),B.t=0,B.duration?B.interval=0:(B.frame=0,B.interval=B.interval||10),B.tick=function(){if(B.duration){var T=(cf()-B.startTime)/B.duration;if(T>1&&(T=1),B.t=T,B.action(B.easing(T),T),!B.isRunning())return;1===T?B.stop():B._isPaused||(B.timeId=Yb(B.tick))}else{if(B.frame++,T=B.t=B.frame/B.frames,B.action(B.easing(T),T),!B.isRunning())return;B.frame<B.frames?B._isPaused||(B.timeId=Yb(B.tick,h,h,B.interval)):B.stop()}},B.resume=function(){B._isPaused&&(delete B._isPaused,B.duration?B.t<1&&(B.startTime=cf()-B.duration*B.t,B.timeId=Yb(B.tick)):B.frame<B.frames&&(B.timeId=Yb(B.tick,h,h,B.interval)))},B.pause=function(){B._isPaused=!0},B.isPaused=function(){return this._isPaused},B.stop=function(D){B.isRunning()&&(Mi(B.timeId,!B.duration),delete B.timeId,B.duration?B.t<1&&D&&(B.t=1,B.action(B.easing(1),1)):B.frame<B.frames&&D&&(B.frame=B.frames,B.action(B.easing(1),1)),B._37o&&B._37o(),B.finishFunc&&B.finishFunc())},B.isRunning=function(){return B.timeId!=h},B.delay?Yb(T,h,[B],B.delay):T(B),B}}(),getTextSize:function(){var V={},M=w?fr().getContext("2d"):h;return function(J,p){M.font=J?J:Db;var $=V[M.font];return $||($=2*M.measureText("e").width+4,V[M.font]=$),{width:M.measureText(p).width+4,height:$}}}(),drawText:function(r,x,e,y,F,m,I,z,s,Z){if(x!=h){var H=jh(e,x),K={};K.y=Z&&Z!==fn?Z===mj?m+H.height/2:m+z-H.height/2:m+z/2,K.x=s&&s!==nh?s===lp?F+I-H.width/2:F+I/2:F+H.width/2,ib(r,x,K,e,y)}},getDistance:function(T,H){var M=T.length;return H?3===M?W(q(T[0]-H[0])+q(T[1]-H[1])+q(T[2]-H[2])):2===M?W(q(T[0]-H[0])+q(T[1]-H[1])):T.z===l?W(q(H.x-T.x)+q(H.y-T.y)):W(q(H.x-T.x)+q(H.y-T.y)+q(H.z-T.z)):3===M?W(q(T[0])+q(T[1])+q(T[2])):2===M?W(q(T[0])+q(T[1])):void 0},brighter:function(x,r){return 0>r&&(r=-r),Ef(x,r?r:40)},darker:function(g,O){return O>0&&(O=-O),Ef(g,O?O:-40)},unionPoint:function(B,f){if(!B)return h;if(2===arguments.length)return B&&f?{x:M(B.x,f.x),y:M(B.y,f.y),width:r(B.x-f.x),height:r(B.y-f.y)}:h;var a=B;if(a._as&&(a=a._as),a.length===l)return h;var P=a.length;if(0>=P)return h;for(var L=1,$=a[0],A={x:$.x,y:$.y,width:0,height:0};P>L;L++){$=a[L];var Z=M(A.x,$.x),T=m(A.x+A.width,$.x),V=M(A.y,$.y),e=m(A.y+A.height,$.y);A.x=Z,A.y=V,A.width=T-Z,A.height=e-V}return A},unionRect:function(F,A){if(F&&!A)return ud(F);if(!F&&A)return ud(A);if(F&&A){var i={x:M(F.x,A.x),y:M(F.y,A.y)};return i.width=m(F.x+F.width,A.x+A.width)-i.x,i.height=m(F.y+F.height,A.y+A.height)-i.y,i}return h},containsPoint:function(o,T,R,F){if(F!=h&&1!==F){var Y=o.x+o.width/2,v=o.y+o.height/2;o={x:Y-o.width/2*F,y:v-o.height/2*F,width:o.width*F,height:o.height*F}}if(R){var X=o.width/2,P=o.height/2,e=K(-R),S=z(-R),A=T.x-o.x-X,s=T.y-o.y-P;return T={x:S*A-e*s,y:e*A+S*s},bf({x:-X,y:-P,width:o.width,height:o.height},T)}return!(!o||T.x<o.x||T.y<o.y||T.x>o.x+o.width||T.y>o.y+o.height)},containsRect:function(H,l){if(!H||!l)return!1;var w=l.x,j=l.y,d=l.width,y=l.height,i=H.width,Q=H.height;if(0>(i|Q|d|y))return!1;var K=H.x,W=H.y;if(K>w||W>j)return!1;if(i+=K,d+=w,w>=d){if(i>=K||d>i)return!1}else if(i>=K&&d>i)return!1;if(Q+=W,y+=j,j>=y){if(Q>=W||y>Q)return!1}else if(Q>=W&&y>Q)return!1;return!0},intersectsRect:function(m,J){if(!m||!J)return!1;var a=J.width,D=J.height,$=m.width,l=m.height;if(0>=$||0>=l||0>=a||0>=D)return!1;var h=J.x,_=J.y,G=m.x,Q=m.y;return $+=G,l+=Q,a+=h,D+=_,$>h&&l>_&&a>G&&D>Q},intersection:function(D,I){if(!D||!I)return h;var l=I.x,b=I.y,B=D.x,g=D.y,c=l,P=b,e=B,O=g;return c+=I.width,P+=I.height,e+=D.width,O+=D.height,B>l&&(l=B),g>b&&(b=g),c>e&&(c=e),P>O&&(P=O),c-=l,P-=b,0>=c||0>=P?h:{x:l,y:b,width:c,height:P}},grow:function(o,v,W){W===l&&(W=v),o.x-=v,o.y-=W,o.width=o.width+2*v,o.height=o.height+2*W},getScreenPoint:function(Z,P,X,r,K,p,W){var w,h,b=X.getBoundingClientRect(),E=Z*(p||1)+b.left-X.scrollLeft+(r||0),y=P*(W||1)+b.top-X.scrollTop+(K||0),J={x:E,y:y};return(w=X.parentElement)&&(h=w.maxtrixAppend)?h.applyInverse(J,{}):J},getLogicalPoint:function(i,q,O,p,X,U){var D,f,a=q.getBoundingClientRect();i.target?(lk(i)?qj?lq["91"]=!0:lq["17"]=!0:qj?lq["91"]=!1:lq["17"]=!1,lq["16"]=oe(i)?!0:!1,i=Sl?mb(i):i,D=i.clientX,f=i.clientY):(D=i.x,f=i.y);
var F,z;if((F=q.parentElement)&&(z=F.maxtrixAppend)){var g=z.apply({x:D,y:f},{});return g.x=(g.x+q.scrollLeft-(O||0))/(X||1),g.y=(g.y+q.scrollTop-(p||0))/(U||1),g}return{x:(D-a.left+q.scrollLeft-(O||0))/(X||1),y:(f-a.top+q.scrollTop-(p||0))/(U||1)}},removeHTML:function(){var P;return function(r){return r&&r.getView&&(r=r.getView()),r&&r.parentNode?P===r?!0:(P=r,r.parentNode.removeChild(r),P=h,!0):!1}}(),getToolTipDiv:function(){if(!Ho){Ho=Ki(),To=Ki();var W=Ho.style;C.baseZIndex!=h&&(W.zIndex=Q(C.baseZIndex)+3+""),W.whiteSpace="nowrap",W.color=C.toolTipLabelColor,W.background=C.toolTipBackground,W.font=C.toolTipLabelFont,W.padding="5px",W.boxShadow="0px 0px 3px "+C.toolTipShadowColor}return Ho},isToolTipShowing:function(){return Ho&&Ho.parentNode?!0:To&&To.parentNode?!0:!1},hideToolTip:function(){Oe(Ho),Oe(To),gq()},showToolTip:function(A,z){if(!A||z==h)return Rn(),void 0;C.getToolTipDiv();var y,V;if(z.html?(z=z.html,y=To,Oe(Ho)):(y=Ho,Oe(To)),V=y.style,y.innerHTML=z,y.parentNode||u.Default.appendToScreen(y),A.target){A=Ob(A);var O=tn(),t=A.x,H=A.y,i=Sl?60:12;if(Sl){var j=y.getBoundingClientRect();V.left=t-j.width/2+ej,V.top=H-j.height-i<O.top?H+i+ej:H-j.height-i+ej}else{V.left=t+i+ej,V.top=H+i+ej;var j=y.getBoundingClientRect();j.left+j.width>O.width&&(V.left=t-i-j.width+ej),j.top+j.height>O.height&&(V.top=H-i-j.height+ej),j.left<0&&(V.left=t+i+ej),j.top<0&&(V.top=H+i+ej)}}else V.left=A.x+ej,V.top=A.y+ej;gq()},startDragging:function(A,t,k){k==l&&(k=!0),A!==Wf&&(Wf?k&&(Sl?Wf.handleWindowTouchEnd(t):Wf.handleWindowMouseUp(t)):Sl?(G.addEventListener(So,kf,N),G.addEventListener(Sm,cd,N)):(G.addEventListener(Nc,vf,N),G.addEventListener(qe,Zd,N)),Wf=A)},getImageMap:function(){return Np},toBoundaries:function(H,J,z,u){var t=[];return $b(H,J,z,u).forEach(function(f){var E=[];f.forEach(function(M){E.push(M.x,M.y)}),t.push(E)}),t},getCurrentKeyCodeMap:function(){return lq},drawCenterImage:function(t,Y,B,L,m,j,f,T){var c=iq(Y,m,j),y=Yh(Y,m,j);oi(t,Y,R(B-c/2),R(L-y/2),c,y,m,j,f,T)},drawStretchImage:function(o,b,n,d,f,x,$,O,_,Y,C,U){var L,c=iq(b,O,_,x),u=Yh(b,O,_,$);"uniform"===n?(L=M(x/c,$/u),c*=L,u*=L,d+=R((x-c)/2),f+=R(($-u)/2),x=c,$=u):"centerUniform"===n&&((c>x||u>$)&&(L=M(x/c,$/u),c*=L,u*=L),d+=R((x-c)/2),f+=R(($-u)/2),x=c,$=u);var l=o.interactiveInfo;if(l){var F;if(F="center"===n?{x:d+x/2-c/2,y:f+$/2-u/2,width:c,height:u}:{x:d,y:f,width:x,height:$},l.rect){var s=l.compInfos,J=s.length;J&&(s[J-1].rect.image=b)}else l.rect=F}if("center"===n){var t=C!==!1&&(c>x||u>$);t&&(o.save(),o.beginPath(),o.rect(d,f,x,$),o.clip()),oi(o,b,d+x/2-c/2,f+$/2-u/2,c,u,O,_,Y,U),t&&o.restore()}else oi(o,b,d,f,x,$,O,_,Y,U)},toCanvas:function($,S,z,t,A,B,m,Q,O){$=ef($,m),S=S||iq($,A),z=z||Yh($,A);var b=fr(),p=Uh(b);return Q?(Dg(b,S,z,Q),p.scale(Q,Q)):Dg(b,S,z,1),Cr(p,$,t,0,0,S,z,A,B,m,O),$&&$.clampToEdge&&(b.clampToEdge=$.clampToEdge),p.restore(),b},toGrayColor:function(i){if(!i)return i;var V=vi(i),Q=.299*V[0]+.587*V[1]+.114*V[2];return"rgba("+Q+","+Q+","+Q+","+V[3]/255+")"},createGradientImage:function(U,c,x,f){for(var E=["L",0,0,U,0,1,0,0,1,0,0],_=0,m=Math.min(c.length,x.length);m>_;_++)E.push(x[_],c[_]);var z=u.Default.toCanvas({width:U,height:U,clampToEdge:!0,comps:[{type:"shape",rotation:f||0,points:[0,0,U,0,U,U,0,U],background:"#ffffff",gradientPack:E}]});return z},createElement:function(I,S,f,E){var $=w.createElement(I);return ao($,S||T.widgetBorder,2),$.style.font=f?f:Db,E!=h&&($.value=E),C.onElementCreated&&C.onElementCreated($),$},containedInView:function(U,z){var G=hh(z).getBoundingClientRect();return bf({x:G.left,y:G.top,width:G.width,height:G.height},kg(U))},isIsolating:function(){return zm>0},setIsolating:function(L){L?zm++:zm--},getMSMap:function(){return Cg},stringify:function(O,n){var l=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var P=JSON.stringify(O,function(V,Y){return"function"==typeof Y?"__ht__"+(Y.__ht__||Y.toString()):cg(Y)?$m(Y):Y instanceof u.List?"__ht__list"+(Y.__ht__list||C.stringify(Y._as)):Y},n==h?2:n);return Date.prototype.toJSON=l,P},parse:function(L){return Tf(L)?JSON.parse(L,function(B,g){if(Tf(g))if("__ht__function"==g.substr(0,14)){var i=g.indexOf("{")+1,$=g.lastIndexOf("}"),D=g.indexOf("(")+1,q=g.indexOf(")");if(i&&$&&D&&q){var f=new Function(g.substring(D,q),g.substring(i,$));return f.__ht__=g.substr(6),f}}else{if("__ht__date"==g.substr(0,10))return new Date(Q(g.substr(10)));if("__ht__list"===g.substr(0,10))return new mo(C.parse(g.substr(10)))}return g}):L},loadJS:function(S,r){r&&S.push(r);var i=S.shift();if(wc(i))S=i.contact(S),C.loadJS(S);else if(Pj(i))i(),C.loadJS(S);else if(Tf(i)){var z=w.createElement("script");z.onload=function(){C.loadJS(S)},z.setAttribute("src",i),w.getElementsByTagName("head")[0].appendChild(z)}else S.length&&C.loadJS(S)},toRoundedCorner:function(I,S){var D=I.size();if(0>=S)return{points:I};var d,N=new mo,n=new mo,L=I.get(0);N.add(L),n.add(1);for(var h=1;D>h;h++)if(D>h+1){var v=I.get(h),U=I.get(h+1),g=L.x,Z=L.y,Q=v.x,e=v.y,A=e-Z,f=Q-g,X=i(A,f);d=M(.99*Im(L,v),S),N.add({x:Q-d*z(X),y:e-d*K(X)}),N.add(v),g=v.x,Z=v.y,Q=U.x,e=U.y,A=e-Z,f=Q-g,X=i(A,f),d=M(.99*Im(v,U),S),L={x:g+d*z(X),y:Z+d*K(X)},N.add(L),n.addAll([2,3])}else N.add(I.get(h)),n.add(2);return{points:N,segments:n}},toColorData:vi,setCanvas:Dg,createDiv:Ki,createDisabledDiv:wh,createView:Lh,createCanvas:fr,appendChild:Pp,initContext:Uh,checkLoadingImage:jg,translateAndScale:Jq,layout:rr,getPosition:hm,drawPoints:Of,drawRoundRect:Uj,drawBorder:wg,setFocus:Zn,getter:Lm,setter:gg,isEmptyObject:Xb},!0),No(n,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var pl=C.disabledOpacity,Bl=C.toolTipDelay,nd=C.devicePixelRatio,Jb=C.autoMakeVisible,is=C.autoHideScrollBar,Jd=C.imageGradient,Ae=C.showToolTip,Rn=C.hideToolTip,Io=C.dashPattern,Ce=C.lineCap,Tj=C.lineJoin,le=C.labelColor,Ik=C.labelSelectColor,Db=C.labelFont,Ao=C.widgetIndent,mp=C.widgetRowHeight,Pb=C.widgetHeaderHeight,zo=C.widgetTitleHeight,qh=C.scrollBarColor,ze=C.scrollBarSize,qo=C.scrollBarTimeout,Vh=C.scrollBarMinLength,Ro=C.scrollBarInteractiveSize,Je=C.zoomIncrement,ep=C.scrollZoomIncrement,ns=C.pinchZoomIncrement,Yp=C.zoomMax,ok=C.zoomMin,Kh=C.createObject,ll=C.preventDefault,Tn=C.setImage,ef=C.getImage,Dh=C.isImageComplete,Pk=C.drawCenterImage,Cr=C.drawStretchImage,on=C.getId,Yb=C.callLater,Ne=C.sortFunc,ud=C.clone,Xe=C.getClass,Qb=C.startAnim,yq=C.brighter,Wn=C.darker,ic=C.drawText,jh=C.getTextSize,ci=C.isLeftButton,Gd=C.getTouchCount,fi=C.isDoubleClick,oe=C.isShiftDown,lk=C.isCtrlDown,kg=C.getClientPoint,Ob=C.getPagePoint,Im=C.getDistance,Vn=C.unionPoint,Xd=C.unionRect,bf=C.containsPoint,$l=C.containsRect,Sc=C.intersectsRect,Dk=C.intersection,tn=C.getWindowInfo,Rd=C.grow,Oq=C.getLogicalPoint,om=C.getScreenPoint,_f=C.startDragging,Oe=C.removeHTML,qs=C.createElement,Cq=C.segmentResolution,Hr=C.shapeResolution,Pq=C.shapeSide,Wh=C.def,Jf=function(F,U,J){Wh(s+"."+F,U,J)},Vg=function(b,S){b.childNodes.forEach(function(P){S(P),Vg(P,S)})};No(C,{toolTipLabelColor:le,toolTipLabelFont:Db,toolTipBackground:T.toolTipBackground,toolTipShadowColor:xr,drawBreakableText:Le,setDevicePixelRatio:function(v){nd=C.devicePixelRatio="number"==typeof v?v:G.devicePixelRatio,Vg(w.body,function(m){var b=m._ht;b&&b._canvas&&(Dg(b._canvas,b.getWidth(),b.getHeight()),b.redraw?b.redraw():b.iv())})}},!0);var As=1e-6,Ff="undefined"!=typeof Uint16Array?Uint16Array:Array,es="undefined"!=typeof Float32Array?Float32Array:Array,Fn=function(y,Z,v){var m=[y[0]-Z[0],y[1]-Z[1],y[2]-Z[2]];if(v){var N=Im(m);N>0&&(m[0]/=N,m[1]/=N,m[2]/=N)}return m},Hp=function(){var w="charCodeAt",y=2*(2*Hd.length+1);for(var a in G)if(a===s+nh[0]+ej.length){var R=G[a];if(!R)break;for(var J=R.length,N=0;J>N;N++)if(R[N][w](0)===y&&R[N+1]!=h&&R[N+1]===ej[0]&&R[N+2]!=h&&R[N+2][w](0)===y){for(var t=N+3;J>t;t++)if(R[t][w](0)===y){if(0==R[t+1])for(var n,q=t+2;J>q;q++){if(R[q][w](0)===y){0==R[q-1]&&n&&(X=n.substr(0,n.length-1));break}n==h?n=R[q]:n+=R[q]}break}break}break}return function(E){return[-E[0],-E[1],-E[2]]}}(),Mr=function(F,Q){return 3===F.length?F[0]*Q[0]+F[1]*Q[1]+F[2]*Q[2]:F[0]*Q[0]+F[1]*Q[1]},Jr=function(){var Q=new es(16);return Q[0]=1,Q[1]=0,Q[2]=0,Q[3]=0,Q[4]=0,Q[5]=1,Q[6]=0,Q[7]=0,Q[8]=0,Q[9]=0,Q[10]=1,Q[11]=0,Q[12]=0,Q[13]=0,Q[14]=0,Q[15]=1,Q},nn=Jr(),Xg=function(Q){var T=new es(16);return T[0]=Q[0],T[1]=Q[1],T[2]=Q[2],T[3]=Q[3],T[4]=Q[4],T[5]=Q[5],T[6]=Q[6],T[7]=Q[7],T[8]=Q[8],T[9]=Q[9],T[10]=Q[10],T[11]=Q[11],T[12]=Q[12],T[13]=Q[13],T[14]=Q[14],T[15]=Q[15],T},Fj=function(F,v){return F[0]=v[0],F[1]=v[1],F[2]=v[2],F[3]=v[3],F[4]=v[4],F[5]=v[5],F[6]=v[6],F[7]=v[7],F[8]=v[8],F[9]=v[9],F[10]=v[10],F[11]=v[11],F[12]=v[12],F[13]=v[13],F[14]=v[14],F[15]=v[15],F},Jj=function(g){return g[0]=1,g[1]=0,g[2]=0,g[3]=0,g[4]=0,g[5]=1,g[6]=0,g[7]=0,g[8]=0,g[9]=0,g[10]=1,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,g},ho=function(a,S){var v=a[0],E=a[1],K=a[2];return a[0]=S[0]*v+S[4]*E+S[8]*K+S[12],a[1]=S[1]*v+S[5]*E+S[9]*K+S[13],a[2]=S[2]*v+S[6]*E+S[10]*K+S[14],a},ph=function(S,m){var F=S[0],C=S[1],b=S[2],q=S[3];return S[0]=m[0]*F+m[4]*C+m[8]*b+m[12]*q,S[1]=m[1]*F+m[5]*C+m[9]*b+m[13]*q,S[2]=m[2]*F+m[6]*C+m[10]*b+m[14]*q,S[3]=m[3]*F+m[7]*C+m[11]*b+m[15]*q,S},ol=function(){var z,H,F,e,o=ts(ai[1]+ai[7]),Y=ts(ai[0]+ai[3]-ai[10]),J=ts(ai[8]+2),s=function(){return H=F.charAt(z),z+=1,H},Q=function(){var f="";if(H===J)for(;s();){if(H===J)return s(),f;f+=H}else s()},A=function(){for(;H&&" ">=H;)s()},h=function(){var E,X={};if(H===o){if(s(),A(),H===Y)return s(),X;for(;H;){if(E=Q(),A(),s(),X[E]=e(),A(),H===Y)return s(),X;s(),A()}}};return e=function(){switch(A(),H){case o:return h();default:return Q()}},function(L){if(t={},L){var V;if(F=L,z=0,H=" ",V=e(),A(),!H)return V}}}(),mn=function(g,Z){if(Z){var W=K(Z),O=z(Z),E=g[4],J=g[5],p=g[6],u=g[7],f=g[8],d=g[9],x=g[10],y=g[11];g[4]=E*O+f*W,g[5]=J*O+d*W,g[6]=p*O+x*W,g[7]=u*O+y*W,g[8]=f*O-E*W,g[9]=d*O-J*W,g[10]=x*O-p*W,g[11]=y*O-u*W}},ed=function(D,r){if(r){var V=K(r),F=z(r),x=D[0],e=D[1],I=D[2],t=D[3],_=D[8],h=D[9],i=D[10],X=D[11];D[0]=x*F-_*V,D[1]=e*F-h*V,D[2]=I*F-i*V,D[3]=t*F-X*V,D[8]=x*V+_*F,D[9]=e*V+h*F,D[10]=I*V+i*F,D[11]=t*V+X*F}},Zp=function(N,m){if(m){var n=K(m),M=z(m),c=N[0],p=N[1],d=N[2],U=N[3],G=N[4],k=N[5],$=N[6],Y=N[7];N[0]=c*M+G*n,N[1]=p*M+k*n,N[2]=d*M+$*n,N[3]=U*M+Y*n,N[4]=G*M-c*n,N[5]=k*M-p*n,N[6]=$*M-d*n,N[7]=Y*M-U*n}},or=function(p,S,D){return Ed(h,D===!1?h:p.getFinalScale3d(),p.getFinalRotation3d(),p.getRotationMode(),p.p3(),h,S)},Ed=function(g,O,q,v,i,d,e){return d||(d=Jr()),i&&pe(d,i),Ij(d,q,v),e&&Me(d,d,e),O&&Mk(d,O),g&&Me(d,d,g),d},Nq=function(Z,e,j){e=Q(e),j=Q(j);var P=this;P.g=Z,P._84O=e,P._85O=j,P._70I=!0,P.F=0,P._83O=e+j,P.pen={x:0,y:0}},xo="lineDashOffset",Dd="setLineDash",wd=function(j){for(var l in j)1===l.length&&(xo=j[l]);return l?1:0},tk=function(B,D,v){return Qq(D)?B:B[Dd]?(B[Dd](D),v&&(B.lineDashOffset=v),B):new Nq(B,D[0],D.length>1?D[1]:D[0])},Ci=function(f,V){!Qq(V)&&f[Dd]&&(f[Dd](sb),f.lineDashOffset=0)};if(Wh(Nq,f,{_69I:6,moveTo:function(u,M){var s=this,X=s.pen;X.x=u,X.y=M,s.g.moveTo(u,M),s.start||(s.start={x:u,y:M})},lineTo:function(C,e){var T=this,W=T.pen,N=C-W.x,y=e-W.y,n=i(y,N),$=z(n),M=K(n),I=T._23O(W.x,W.y,C,e),Q=T._85O,X=T._84O,Y=T._83O;if(T.F){if(T.F>I)return T._70I?T._72I(C,e):T.moveTo(C,e),T.F-=I,void 0;if(T._70I?T._72I(W.x+$*T.F,W.y+M*T.F):T.moveTo(W.x+$*T.F,W.y+M*T.F),I-=T.F,T.F=0,T._70I=!T._70I,!I)return}var x=j(I/Y);if(x){for(var U=$*X,q=M*X,s=$*Q,v=M*Q,d=0;x>d;d++)T._70I?(T._72I(W.x+U,W.y+q),T.moveTo(W.x+s,W.y+v)):(T.moveTo(W.x+s,W.y+v),T._72I(W.x+U,W.y+q));I-=Y*x}T._70I?I>X?(T._72I(W.x+$*X,W.y+M*X),T.moveTo(C,e),T.F=Q-(I-X),T._70I=!1):(T._72I(C,e),I===X?(T.F=0,T._70I=!T._70I):(T.F=X-I,T.moveTo(C,e))):I>Q?(T.moveTo(W.x+$*Q,W.y+M*Q),T._72I(C,e),T.F=X-(I-Q),T._70I=!0):(T.moveTo(C,e),I===Q?(T.F=0,T._70I=!T._70I):T.F=Q-I)},quadraticCurveTo:function(i,X,r,x){var c,L=this,N=L.pen,s=N.x,g=N.y,R=L._22O(s,g,i,X,r,x),A=0,q=0,T=L._85O,E=L._84O;if(L.F){if(L.F>R)return L._70I?L._71I(i,X,r,x):L.moveTo(r,x),L.F-=R,void 0;if(A=L.F/R,c=L._20O(s,g,i,X,r,x,A),L._70I?L._71I(c[2],c[3],c[4],c[5]):L.moveTo(c[4],c[5]),L.F=0,L._70I=!L._70I,!R)return}var F=R-R*A,m=j(F/L._83O),Y=E/R,S=T/R;if(m)for(var y=0;m>y;y++)L._70I?(q=A+Y,c=L._21O(s,g,i,X,r,x,A,q),L._71I(c[2],c[3],c[4],c[5]),A=q,q=A+S,c=L._21O(s,g,i,X,r,x,A,q),L.moveTo(c[4],c[5])):(q=A+S,c=L._21O(s,g,i,X,r,x,A,q),L.moveTo(c[4],c[5]),A=q,q=A+Y,c=L._21O(s,g,i,X,r,x,A,q),L._71I(c[2],c[3],c[4],c[5])),A=q;F=R-R*A,L._70I?F>E?(q=A+Y,c=L._21O(s,g,i,X,r,x,A,q),L._71I(c[2],c[3],c[4],c[5]),L.moveTo(r,x),L.F=T-(F-E),L._70I=!1):(c=L._19O(s,g,i,X,r,x,A),L._71I(c[2],c[3],c[4],c[5]),R===E?(L.F=0,L._70I=!L._70I):(L.F=E-F,L.moveTo(r,x))):F>T?(q=A+S,c=L._21O(s,g,i,X,r,x,A,q),L.moveTo(c[4],c[5]),c=L._19O(s,g,i,X,r,x,q),L._71I(c[2],c[3],c[4],c[5]),L.F=E-(F-T),L._70I=!0):(L.moveTo(r,x),F===T?(L.F=0,L._70I=!L._70I):L.F=T-F)},bezierCurveTo:function(){var $=arguments;this.pen={x:$[4],y:$[5]},this.g.bezierCurveTo($[0],$[1],$[2],$[3],$[4],$[5])},arc:function(z,S,X,M,o,w){w||(M=-M,o=-o),tm(this,z,S,M,o-M,X,X,!1)},rect:function(Q,G,O,y){var f=this;f.pen={x:Q,y:G},f.moveTo(Q,G),f.lineTo(Q,G+y),f.lineTo(Q+O,G+y),f.lineTo(Q+O,G),f.lineTo(Q,G)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(q,d,P,R){var u=P-q,s=R-d;return W(u*u+s*s)},_22O:function(o,M,H,s,K,p,d){for(var E,O,J,u,U,k,B,f=0,y=o,C=M,g=d>0?d:this._69I,t=1;g>=t;t++)J=t/g,u=1-J,U=u*u,k=2*J*u,B=J*J,E=U*o+k*H+B*K,O=U*M+k*s+B*p,f+=this._23O(y,C,E,O),y=E,C=O;return f},_21O:function(q,A,B,U,n,I,E,h){var g=this;if(0===E)return g._20O(q,A,B,U,n,I,h);if(1===h)return g._19O(q,A,B,U,n,I,E);var O=g._20O(q,A,B,U,n,I,h);return O.push(E/h),g._19O.apply(g,O)},_20O:function(H,x,c,k,E,C,U){if(1!==U){var b=c+(E-c)*U,f=k+(C-k)*U;c=H+(c-H)*U,k=x+(k-x)*U,E=c+(b-c)*U,C=k+(f-k)*U}return[H,x,c,k,E,C]},_19O:function(X,Q,y,M,i,O,A){if(1!==A){var g=X+(y-X)*A,$=Q+(M-Q)*A;y+=(i-y)*A,M+=(O-M)*A,X=g+(y-g)*A,Q=$+(M-$)*A}return[X,Q,y,M,i,O]},_72I:function(e,X){var C=this.pen;(e!==C.x||X!==C.y)&&(C.x=e,C.y=X,this.g.lineTo(e,X))},_71I:function(L,S,m,u){var n=this.pen;(L!==m||S!==u||m!==n.x||u!==n.y)&&(n.x=m,n.y=u,this.g.quadraticCurveTo(L,S,m,u))}}),Y&&S){var mf=S.toString();I=mf.indexOf(sl.substr(0,2))>0&&mf.indexOf(mj+mj.substr(1,1))>1||mf.indexOf(Gr.substr(0,2)+sl.substr(2,2)+nh[0]+sl[4])>1?!0:!1}var Zh=h,ac=h,ti=function(N){Zh&&!N._72O&&(ac||(ac={}),ac[N._72O=on()]=N)},Hq=function(K,i){if(i||(i=K),i&&(Zh||(Zh={}),!Zh[K])){var l=new xd;if(Zh[i]={request:l,url:i},i=C.beforeLoadURL(i),i.data){var u=C.parse(i.data);Ek(K,u),C.handleCompTypeLoaded(K,u)}else{l.onload=function(P){if(200===this.status||0===this.status){var $=C.parse(P.target.response||P.target.responseText);Ek(K,$),C.handleCompTypeLoaded(K,$)}else Ek(K,h)},l.onerror=function(){Ek(K,h)};var I={};I.url=encodeURI(i),I.sync=!1,l.send(I)}}},Ek=function(W,E){if(Pd[W]=E,delete Zh[W],Xb(Zh)&&(Zh=h,ac)){for(var O in ac){var X=ac[O];X.invalidateAll&&X.invalidateAll(l,"compTypeLoaded",W),X.redraw&&X.redraw(),X.iv(),delete X._72O}ac=h}if(E&&ac)for(var O in ac){var X=ac[O];X.invalidateAll&&X.invalidateAll(l,"compTypeLoading",W),X.redraw&&X.redraw(),X.iv()}},ni=T.chart,Pm="",kn=C.compStack=[],Ai=/^style@/,xk=/^attr@/,Cc=/^field@/,ls={x:.5,y:.5},iq=function(Q,W,C,L){if(!Q)return 0;if(pf(Q.fitSize,W,C)&&L)return L;var E=pf(Q.width,W,C);return null==E?20:E},Yh=function(p,y,O,A){if(!p)return 0;if(pf(p.fitSize,y,O)&&A)return A;var o=pf(p.height,y,O);return null==o?20:o},pf=function(D,v,I){if(!D||!D.func)return D;var L,G=D.func,t=D.value;return L=Pj(G)?I&&I.vectorDataBindingDisabled&&!D.isSafeFunc?t:G(v,I):v instanceof yh?xk.test(G)?v.a(Pm+G.slice(5)):Ai.test(G)?v.s(Pm+G.slice(6)):Cc.test(G)?v[G.slice(6)]:v[G]?v[G](I):t:t,t!==l&&L==h?t:L},oi=C.drawImage=function(){var f,D,r,s,E,u,N=function(p,X){p.getValue&&p.getValue.compType===X||(p.getValue=function(f){var U=B(p,f);if(U===l&&X.properties){var V=X.properties[f];V&&(U=V.defaultValue)}return U},p.getColor=function(V){return U(p.getValue(V))},p.getValue.compType=X)},B=function(F,R,M){var s=F[R];if(s&&s.func)s=pf(s,D,r),M&&(s=M(s));else{if(F.prefix&&D instanceof yh){var P=D.a(Pm+F.prefix+"."+R);P!==l&&(s=P)}M&&(s=F[R]=M(s))}return s},U=function(P,g){var y;if(y=g?B(P,g):P,f&&f.compGray&&y)return C.toGrayColor(y);if(E&&y){if("override"===u)return E;if("override_rgb"===u){var d=Rm(E);return y=vi(y),"rgba("+j(255*d[0])+","+j(255*d[1])+","+j(255*d[2])+","+y[3]/255+")"}if("override_a"===u){var d=Rm(E);return y=vi(y),"rgba("+y[0]+","+y[1]+","+y[2]+","+d[3]+")"}var d=Rm(E);return y=vi(y),"rgba("+j(y[0]*d[0])+","+j(y[1]*d[1])+","+j(y[2]*d[2])+","+y[3]/255*d[3]+")"}return y},c=function(Y){if(wc(Y)){for(var L=new mo,O=Y.length,j=0;O>j;j+=2)L.add({x:Y[j],y:Y[j+1]});Y=L}return Y},g=function(z){var x=B(z,"anchorX"),k=B(z,"anchorY");if(x!==l||k!==l)return{x:x===l?ls.x:x,y:k===l?ls.y:k};var _=B(z,"type"),F=B(z,"name");if("image"!==_||!F)return ls;var V=ef(F);return V&&V.anchorX!==l&&V.anchorY!==l?{x:V.anchorX,y:V.anchorY}:ls},V=function(c,h){var $=B(c,ue),z=g(c);if(wc($)){var e=$.length,C=B(c,"relative"),D=h.width,w=h.height;if(4===e)$={x:$[0],y:$[1],width:$[2],height:$[3]},C&&($.x*=D,$.y*=w,$.width*=D,$.height*=w);else if(3===e){var V=$[0];$={width:$[1],height:$[2]},C&&($.width*=D,$.height*=w),"object"==typeof V?V.length&&(V={x:V[0],y:V[1]}):V=hm(V,h,$),$.x=V.x-$.width*z.x,$.y=V.y-$.height*z.y}$.x+=B(c,"offsetX")||0,$.y+=B(c,"offsetY")||0,!C&&h.fitSize&&($=A(c,$,h))}return $},A=function(E,z,Y){if(z){var m,e,T,f={x:z.x,y:z.y,width:z.width,height:z.height},V=g(E),U=B(E,"layoutH"),w=B(E,"layoutV"),y=1,v=1,W=0,G=0,i=1,j=1;switch(U){case"left":break;case"right":f.x+=Y.width-Y.rw;break;case"center":f.x+=.5*(Y.width-Y.rw);break;case"scale":case"leftright":default:m=B(E,Yf)||0,m&&(W=Math.abs(G=Math.sin(m)),i=Math.abs(j=Math.cos(m))),"leftright"!==U?(y+=i*(Y.widthScale-1),v+=W*(Y.widthScale-1)):(y+=f.width?i*(Y.width-Y.rw)/f.width:0,v+=f.height?W*(Y.width-Y.rw)/f.height:0,e=-Math.min(-V.x*j+V.y*G,-V.x*j-(1-V.y)*G,(1-V.x)*j+V.y*G,(1-V.x)*j-(1-V.y)*G))}switch(w){case"top":break;case"bottom":f.y+=Y.height-Y.rh;break;case"center":f.y+=.5*(Y.height-Y.rh);break;case"scale":case"topbottom":default:m==h&&(m=B(E,Yf),m&&(W=Math.abs(G=Math.sin(m)),i=Math.abs(j=Math.cos(m)))),"topbottom"!==w?(y+=W*(Y.heightScale-1),v+=i*(Y.heightScale-1)):(y+=f.width?W*(Y.height-Y.rh)/f.width:0,v+=f.height?i*(Y.height-Y.rh)/f.height:0,T=-Math.min(-V.x*G-V.y*j,-V.x*G+(1-V.y)*j,(1-V.x)*G-V.y*j,(1-V.x)*G+(1-V.y)*j))}return(1!==y||1!==v)&&("scale"!==U&&U?"leftright"===U&&(f.x+=f.width*(1-y)*V.x+e*(Y.width-Y.rw)):f.x+=f.x*(Y.widthScale-1)+V.x*f.width*(Y.widthScale-y),"scale"!==w&&w?"topbottom"===w&&(f.y+=f.height*(1-v)*V.y+T*(Y.height-Y.rh)):f.y+=f.y*(Y.heightScale-1)+V.y*f.height*(Y.heightScale-v),f.width*=y,f.height*=v),f.width<0&&(f.width=0),f.height<0&&(f.height=0),f}},S=function(w){return wc(w)?new mo(w):w},b=function(c,T,U,u,t,y,$){var Z=f.interactiveInfo,s=c.transform;if(s)return f.save(),f.setTransform(s.a,s.b,s.c,s.d,s.tx,s.ty),Z&&Z.compInfos.push({comp:c,rect:T,matrix:s.clone()}),!0;t===l&&(t=1),y===l&&(y=1);var V=B(c,"clipPercentage"),X=Tg(U,T);if(X&&!u&&1===t&&1===y&&!(1>V))return Z&&Z.compInfos.push({comp:c,rect:T,matrix:Z.matrix.clone()}),!1;$=$||ls;var E=T.x+T.width*$.x,b=T.y+T.height*$.y,J=U.x+U.width*$.x,m=U.y+U.height*$.y,Y=U.width?t*(T.width/U.width):1,v=U.height?y*(T.height/U.height):1;if(f.save(),Z&&(Z.matrix.appendTranslate(E,b).appendRotate(u).appendScale(Y,v).appendTranslate(-J,-m),Z.compInfos.push({comp:c,rect:T,matrix:Z.matrix.clone()})),uc(f,E,b),Lc(f,u||0),Jn(f,Y,v),uc(f,-J,-m),1>V){0>V&&(V=0);var e=po(U,B(c,"clipDirection"),V);f.beginPath(),f.rect(e.x,e.y,e.width,e.height),f.clip()}return!0},Q=function(){f.restore()},Z=function(e,d,H){var x=B(e,"path"),N=B(e,Yf),M=B(e,"scaleX"),o=B(e,"scaleY"),Y=g(e),L=h,E=Rc(null,x);if(H||(H=e.unionRect,H||(H=Vn(E),e.path.func||(e.unionRect=H)),L=H),H){L||(L=e.unionRect,L||(L=Vn(E),e.path.func||(e.unionRect=L)));var i=b(e,H,L,N,M,o,Y),w=B(e,"borderPattern"),l=tk(f,w),W=U(e,"background"),Z=U(e,"borderColor"),V=B(e,"borderWidth"),D=B(e,"gradient"),X=U(e,"gradientColor"),m=B(e,"border3d"),c=B(e,"border3dColor"),C=B(e,"border3dAccuracy"),a=f.lineJoin,R=f.lineCap;if(f.lineJoin=B(e,"borderJoin")||Tj,f.lineCap=B(e,"borderCap")||Ce,W?(vr(f,W,D,X,L),Rc(f,x),f.fill(),l!==f&&Rc(f,x)):Rc(f,x),V&&Z){var y=B(e,"borderWidthAbsolute");y&&(f.save(),f.setTransform(1,0,0,1,0,0)),f.lineWidth=V,f.strokeStyle=Z,f.stroke(),y&&f.restore(),m&&tr(f,Z,c,V,s,C)}if(Ci(f,w),B(e,"dash")){var O=B(e,"dashWidth")||V;if(O>0){w=B(e,"dashPattern")||Io;var l=tk(f,w,B(e,"dashOffset")),u=U(e,"dashColor")||U(kk);l!==f&&Rc(f,x),f.strokeStyle=u,f.lineWidth=O,f.stroke(),B(e,"dash3d")&&tr(f,u,U(e,"dash3dColor"),O,s,B(e,"dash3dAccuracy")),Ci(f,w)}}d===ue&&ps(f,W,B(e,"depth"),L),f.lineJoin=a,f.lineCap=R,i&&Q()}},I=function(K,d,W,$){var F=B(K,_c,c),e=B(K,Yf),O=g(K);if(F&&$.fitSize){var P=new mo,N=Vn(F),o=A(K,N,$),t=N.x+O.x*N.width,T=N.y+O.y*N.height,Y=o.x+O.x*o.width,m=o.y+O.y*o.height,p=N.width?o.width/N.width:1,v=N.height?o.height/N.height:1;F.each(function(w){P.add({x:Y+(w.x-t)*p,y:m+(w.y-T)*v})}),F=P,K.unionRect=null}var k=B(K,"scaleX"),J=B(K,"scaleY"),I=d===Fi,w=h;if(!W&&I&&(W=K.unionRect,W||(W=Vn(F),K.points.func||(K.unionRect=W)),w=W),W){I?w||(w=K.unionRect,w||(w=Vn(F),K.points.func||(K.unionRect=w))):w=W;var l,_,H,V,z=b(K,W,w,e,k,J,O),G=B(K,"borderPattern"),i=tk(f,G),n=U(K,"background"),q=ef(B(K,"repeatImage"),E,u),C=B(K,"gradientPack"),j=U(K,"borderColor"),L=B(K,"borderWidth"),a=B(K,"segments",S),M=B(K,"gradient"),y=U(K,"gradientColor"),X=B(K,"border3d"),R=B(K,"border3dColor"),Z=B(K,"border3dAccuracy"),x=B(K,"closePath"),xb=B(K,"fillRule")||"nonzero",ss=f.lineJoin,Wg=f.lineCap;if(f.lineJoin=B(K,"borderJoin")||Tj,f.lineCap=B(K,"borderCap")||Ce,I)if(n||q||C){var Re=B(K,"fillClipPercentage");if(1>Re){0>Re&&(Re=0);var Yn=po(w,B(K,"fillClipDirection"),Re);f.save(),f.beginPath(),f.rect(Yn.x,Yn.y,Yn.width,Yn.height),f.clip()}if(Of(f,F,a,x),C)Ni(f,C);else if(q){var bg=f,pg=E,xs=u;qg(f,q,E,u,D,r),f=bg,E=pg,u=xs}else{var bg=f;vr(f,n,M,y,w),f=bg}f.fill(xb),1>Re&&f.restore(),C&&f.restore(),i!==f&&Of(i,F,a,x)}else Of(i,F,a,x);else if("roundRect"===d?l=B(K,"cornerRadius"):"polygon"===d?l=B(K,"polygonSide"):"arc"===d&&(l=B(K,"arcFrom"),_=B(K,"arcTo"),H=B(K,"arcClose"),V=B(K,"arcOval")),n||q||C){var Re=B(K,"fillClipPercentage");if(1>Re){0>Re&&(Re=0);var Yn=po(w,B(K,"fillClipDirection"),Re);f.save(),f.beginPath(),f.rect(Yn.x,Yn.y,Yn.width,Yn.height),f.clip()}if(wl(f,d,w,l,_,H,V),C)Ni(f,C);else if(q){var bg=f,pg=E,xs=u;qg(f,q,E,u,D,r),f=bg,E=pg,u=xs}else vr(f,n,M,y,w);f.fill(xb),1>Re&&f.restore(),C&&f.restore(),f!==i&&wl(i,d,w,l,_,H,V)}else wl(i,d,w,l,_,H,V);if(L&&j){var sn=B(K,"borderWidthAbsolute");sn&&(f.save(),f.setTransform(1,0,0,1,0,0)),f.lineWidth=L,f.strokeStyle=j,f.stroke(),sn&&f.restore(),X&&tr(f,j,R,L,s,Z)}if(Ci(f,G),B(K,"dash")){var am=B(K,"dashWidth")||L;if(am>0){G=B(K,"dashPattern")||Io;var i=tk(f,G,B(K,"dashOffset")),Xj=U(K,"dashColor")||U(kk);i!==f&&(I?Of(i,F,a,x):wl(i,d,w,l,_,H,V)),f.strokeStyle=Xj,f.lineWidth=am,f.stroke(),B(K,"dash3d")&&tr(f,Xj,U(K,"dash3dColor"),am,s,B(K,"dash3dAccuracy")),Ci(f,G)}}d===ue&&ps(f,n,B(K,"depth"),w),f.lineJoin=ss,f.lineCap=Wg,z&&Q()}},T=function(s,A){var n=E,P=u,y=E||B(s,jd),h=u||B(s,"blendMode"),G=ef(B(s,"name"),y,h);if(G){if(s.prefix){var M=Pm;Pm=Pm?Pm+s.prefix+".":s.prefix+"."}Cr(f,G,B(s,"stretch"),A.x,A.y,A.width,A.height,D,r,y,null,h),E=n,u=P,s.prefix&&(Pm=M)}},H=function(T,I){var v=B(T,"text");v!=h&&ic(f,v,B(T,"font"),U(T,jd),I.x,I.y,I.width,I.height,B(T,"align"),B(T,"vAlign"))},t=function(v,Q){wg(f,U(v,jd),Q.x,Q.y,Q.width,Q.height,B(v,"width"))},Y=function(b,R){var k=B(b,Ll),T=0;if(k&&(k.forEach(function(A){T+=A}),T>0)){for(var Z=B(b,"colors")||ni,w=B(b,"startAngle")||0,i=B(b,"hollow"),g=B(b,zk),u=B(b,xb),S=B(b,eh),$=g?new mo:h,e=R.x,N=R.y,X=R.width,L=R.height,o=e+X/2,W=N+L/2,y=M(X,L)/2,O=0,C=0;C<k.length;C++){var Q=k[C],t=x*Q/T,n=w+t;if(f.fillStyle=Z[O++],O===Z.length&&(O=0),f.beginPath(),i){var s=o+z(w)*y/2,r=W+K(w)*y/2,H=o+z(n)*y,I=W+K(n)*y;f.moveTo(s,r),f.arc(o,W,y/2,w,n,!1),f.lineTo(H,I),f.arc(o,W,y,n,w,!0)}else f.moveTo(o,W),f.arc(o,W,y,n,w,!0);$&&(t=(w+n)/2,$.add({text:Pj(g)?g(Q,C,T,D):Q,x:o+.75*z(t)*y,y:W+.75*K(t)*y})),f.closePath(),f.fill(),w=n}$&&$.each(function(s){ic(f,s.text,u,S,s.x,s.y,0,0,Gg)})}},v=function(u,G){var F=B(u,sc);if(F&&F.length>0){var R=F.length,Q=B(u,zk),o=B(u,xb),z=B(u,eh),g=Q?new mo:h,e=B(u,"minValue")||0,v=B(u,"maxValue");if(v==h&&(v=0,F.forEach(function(Y){B(Y,Ll).forEach(function(K){v=m(v,K)})})),e===v)return;for(var H=G.height/(v-e),J=G.y+v*H,K=B(F[0],Ll).length,Z=G.width/(3*K+1),S=2*Z/R,W=0,n=0;R>n;n++)for(var L=F[n],c=B(L,jd),P=B(L,"colors"),b=B(L,Ll),w=0;K>w;w++){P?f.fillStyle=P[w]:c?f.fillStyle=c:(f.fillStyle=ni[W++],W===ni.length&&(W=0));var r=b[w],A=r*H,X=G.x+(1+3*w)*Z+n*S;if(ng(f,X,J-A,S,A),g){var O=Pj(Q)?Q(r,w,L,D):r,E=jh(o,O).height;g.add({x:X,y:J-A-E,width:S,height:E,text:O})}}g&&g.each(function(S){ic(f,S.text,o,z,S.x,S.y,S.width,S.height,Gg)})}},k=function(J,g){var G=B(J,sc);if(G&&G.length>0){var b=G.length,p=B(G[0],Ll).length,d=g.width/(3*p+1),n=0,E=B(J,"maxValue"),t=B(J,zk),X=B(J,xb),Y=B(J,eh),u=t?new mo:h;if(E==h){E=0;for(var l=0;p>l;l++){for(var T=0,q=0;b>q;q++)T+=B(G[q],Ll)[l];E=m(E,T)}}if(E>0){for(var l=0;p>l;l++)for(var c=g.y+g.height,q=0;b>q;q++){var L=G[q],e=B(L,jd),$=B(L,Ll)[l],C=$/E*g.height;e?f.fillStyle=e:(f.fillStyle=ni[n++],n===ni.length&&(n=0)),c-=C;var P={x:g.x+(1+3*l)*d,y:c,width:2*d,height:C};ng(f,P.x,P.y,P.width,P.height),u&&(P.text=Pj(t)?t($,l,L,D):$,u.add(P))}u&&u.each(function($){ic(f,$.text,X,Y,$.x,$.y,$.width,$.height,Gg)})}}},o=function(m,k){var w=B(m,sc);if(w&&w.length>0){for(var U=w.length,H=B(w[0],Ll).length,t=k.width/(3*H+1),O=0,W=B(m,zk),Q=B(m,xb),Y=B(m,eh),s=W?new mo:h,N=0;H>N;N++){for(var I=0,S=0;U>S;S++)I+=B(w[S],Ll)[N];if(I>0){var g=k.y+k.height;for(S=0;U>S;S++){var v=w[S],p=B(v,jd),x=B(v,Ll)[N],G=x/I*k.height;p?f.fillStyle=p:(f.fillStyle=ni[O++],O===ni.length&&(O=0)),g-=G;var z={x:k.x+(1+3*N)*t,y:g,width:2*t,height:G};ng(f,z.x,z.y,z.width,z.height),s&&(z.text=Pj(W)?W(x,N,v,D):x,s.add(z))}}}s&&s.each(function(n){ic(f,n.text,Q,Y,n.x,n.y,n.width,n.height,Gg)})}},P=function(S,V){var Z=B(S,sc);if(Z&&Z.length>0){var A=Z.length,r=B(S,"minValue")||0,c=B(S,"maxValue");if(c==h&&(c=0,Z.forEach(function(X){B(X,Ll).forEach(function(J){c=m(c,J)})})),r===c)return;for(var q=V.height/(c-r),J=V.y+c*q,t=B(Z[0],Ll).length,W=V.width/(3*t+1),g=0,i=B(S,"lineWidth")||2,y=B(S,"line3d"),K=B(S,"linePoint"),O=B(S,zk),R=B(S,xb),Y=B(S,eh),e=0;A>e;e++){var w=Z[e],F=B(w,jd),j=B(w,Ll);F?f.strokeStyle=F:(F=f.strokeStyle=ni[g++],g===ni.length&&(g=0)),f.beginPath();for(var p=0;t>p;p++){var T=V.x+(2+3*p)*W,U=J-j[p]*q;0===p?f.moveTo(T,U):f.lineTo(T,U)}if(f.lineWidth=i,f.stroke(),y&&tr(f,F,h,i,s),K||O){var M,P=i/2+2;for(p=0;t>p;p++){var G=j[p];if(T=V.x+(2+3*p)*W,U=J-G*q,Pj(K)?K(f,T,U,F,p,w,D):K&&(f.fillStyle=F,f.beginPath(),f.arc(T,U,P,0,x,!0),f.fill()),Pj(O)?M=O(G,p,w,D):O&&(M=G),M){var o=jh(R,M).height,C=f.shadowBlur;if(C){var E=f.shadowOffsetX,b=f.shadowOffsetY,$=f.shadowColor;f.shadowOffsetX=0,f.shadowOffsetY=0,f.shadowBlur=0,f.shadowColor=h}ic(f,M,R,Y,T,U-o-P+2,0,o,Gg),C&&(f.shadowOffsetX=E,f.shadowOffsetY=b,f.shadowBlur=C,f.shadowColor=$)}}}}}},L=function(){f=null,D=null,r=null},$={border:t,image:T,text:H,pieChart:Y,columnChart:v,stackedColumnChart:k,percentageColumnChart:o,lineChart:P};return function(d,_,i,O,J,n,y,p,z,T){if(_&&J&&n){var e=f?!1:!0;f=d,D=y,r=p,s=r?r._zoom?r._zoom:1:1,E=z,u=T;var W=J,R=n;if(Zm()){var j,q,F;0===f[um]?Zm[0]&&(j=!0):j=!0,f.texureImage2D?Zm[1]&&(q=!0):q=!0,f.texureImage3D?Zm[2]&&(F=!0):F=!0,j&&q&&F&&(W=i,R=O)}if(_.tagName)return Tf(X)&&!G[X]||f.drawImage(_,W,R,J,n),e&&L(),void 0;if(B(_,"visible")===!1)return e&&L(),void 0;E||(E=pf(_.color,D,r)),T||(u=pf(_.blendMode,D,r)),Tf(X)&&!G[X]&&(J=W,n=R);var w=iq(_,D,r,J),a=Yh(_,D,r,n),t={x:0,y:0,width:w,height:a,fitSize:B(_,"fitSize")},M=B(_,"clip"),o=B(_,"opacity");if(t.fitSize){var v=t.rw=pf(_.width,D,r)||20;t.widthScale=w/v;var m=t.rh=pf(_.height,D,r)||20;t.heightScale=a/m}if(f.save(),f.interactiveInfo){var H=f.interactiveInfo.matrix,K=H.clone();H.appendTranslate(W,R).appendScale(J/w,n/a)}uc(f,W,R),(w!==J||a!==n)&&f.scale(J/w,n/a),M&&(Pj(M)?M(f,w,a,D,r,_):(f.beginPath(),f.rect(0,0,w,a),f.clip())),o!=h&&(f.globalAlpha*=o),B(_,"comps").forEach(function(H){if(B(H,Ei)!==!1){if(kn.splice(0,0,H),f.interactiveInfo)var z=f.interactiveInfo.matrix.clone();var R=B(H,"opacity"),n=B(H,"shadow"),A=B(H,"type"),P=V(H,t);if(R!=h){var L=f.globalAlpha;f.globalAlpha*=R}if(n){var X=f.shadowOffsetX,k=f.shadowOffsetY,d=f.shadowBlur,u=f.shadowColor,o=B(H,"shadowOffsetX"),O=B(H,"shadowOffsetY"),x=B(H,"shadowBlur"),G=U(H,"shadowColor");f.shadowOffsetX=(o==h?3:o)*s,f.shadowOffsetY=(O==h?3:O)*s,f.shadowBlur=(x==h?6:x)*s,f.shadowColor=G||U(mi)}if("save"===A)f.save();else if("endClip"===A||"restore"===A)f.restore();else if("clip"===A)f.save(),Of(f,B(H,"points",c),B(H,"segments",S),!0),f.clip();else if(Kj[A])P=P||{x:0,y:0,width:t.width,height:t.height},I(H,A,P,t);else if(A===Fi)I(H,A,P,t);else if("SVGPath"===A)Z(H,A,P);else{P=P||{x:0,y:0,width:t.width,height:t.height};var w=B(H,Yf),Y=B(H,"scaleX"),T=B(H,"scaleY"),W=g(H),M=b(H,P,P,w,Y,T,W);if(Pj(A))N(H,A),C.drawCompType(A,f,P,H,D,r);else if(C.getCompType(A)){var q=C.getCompType(A),i=q.func||q;N(H,q),C.drawCompType(i,f,P,H,D,r)}else $[A]?$[A](H,P):C.getCompType(A)===l&&Ub.test(A)&&Hq(A);M&&Q()}n&&(f.shadowOffsetX=X,f.shadowOffsetY=k,f.shadowBlur=d,f.shadowColor=u),R!=h&&(f.globalAlpha=L),f.interactiveInfo&&(f.interactiveInfo.matrix=z),kn.splice(0,1)}}),f.interactiveInfo&&(f.interactiveInfo.matrix=K),f.restore(),e&&L()}}}();C.getCurrentComp=function(){return kn[0]},C.getParentComp=function(){return kn[1]},C.getInternal=function(){return{isEnter:dl,isEsc:Di,isSpace:eo,isLeft:$j,isUp:Pl,isRight:Mb,isDown:Bm,addMethod:No,superCall:Yn,toPointsArray:$b,translateAndScale:Jq,appendArray:hn,createWorldMatrix:Ed,vec3TransformMat4:ho,setCanvas:Dg,createDiv:Ki,createView:Lh,createCanvas:fr,createImage:Ng,initContext:Uh,layout:rr,fillRect:ng,Mat:rb,drawBorder:wg,isString:Tf,setBorder:ao,getPropertyValue:Xc,setPropertyValue:rl,drawVerticalLine:jc,draw3DRect:ps,getPinchDist:nl,isSameRect:Tg,getPosition:hm,intersectionLineRect:de,getNodeRect:He,getEdgeAgentPosition:_h,getImageWidth:iq,getImageHeight:Yh,initItemElement:Vb,drawPoints:Of,createG2:tk,closePopup:xl,isH:xg,createAnim:Td,createNormalMatrix:aq,createNormals:vp,toFloatArray:ih,glMV:zd,batchShape:mr,createNodeMatrix:or,getFaceInfo:hs,transformAppend:fg,drawFaceInfo:Ud,to3dPointsArray:Ec,setGLDebugMode:function(j){uo=j},cube:function(){return{vs:yd,is:ei,uv:zf}},ui:function(){return{DataUI:Wk,NodeUI:Dm,EdgeUI:Sd,GroupUI:wq,ShapeUI:no,GridUI:gm,Data3dUI:Xo,Node3dUI:ie,Shape3dUI:Rq}},getInternalVersion:function(){return"U2FsdGVkX1+MemlZT9l23ZjY6EoSxIzNMJQuwREG7NY="},getDragger:function(){return Wf},addMSMap:function(w){No(Cg,w)},k:B}},function(F){function t(Y,I){Y!=h&&(I==h&&jk!=typeof Y?this._54O(Y,256):this._54O(Y,I))}function G(){return new t(h)}function r(T,Q,s,c,A,F){for(;--F>=0;){var K=Q*this[T++]+s[c]+A;A=j(K/67108864),s[c++]=67108863&K}return A}function e(x,E,f,n,i,m){for(var b=32767&E,z=E>>15;--m>=0;){var K=32767&this[x],Q=this[x++]>>15,s=z*K+Q*b;K=b*K+((32767&s)<<15)+f[n]+(1073741823&i),i=(K>>>30)+(s>>>15)+z*Q+(i>>>30),f[n++]=1073741823&K}return i}function I(U,Z,Q,q,e,z){for(var J=16383&Z,x=Z>>14;--z>=0;){var R=16383&this[U],S=this[U++]>>14,r=x*R+S*J;R=J*R+((16383&r)<<14)+Q[q]+e,e=(R>>28)+(r>>14)+x*S,Q[q++]=268435455&R}return e}function v(r){return un.charAt(r)}function X(z,w){var l=Ci[z.charCodeAt(w)];return l==h?-1:l}function O(p){for(var b=this.t-1;b>=0;--b)p[b]=this[b];p.t=this.t,p.s=this.s}function R(D){this.t=1,this.s=0>D?-1:0,D>0?this[0]=D:-1>D?this[0]=D+this.DV:this.t=0}function k(K){var B=G();return B._58O(K),B
}function b(s,b){var H,z=this;if(16==b)H=4;else if(8==b)H=3;else if(256==b)H=8;else if(2==b)H=1;else if(32==b)H=5;else{if(4!=b)return z.fromRadix(s,b),void 0;H=2}z.t=0,z.s=0;for(var d=s.length,O=!1,i=0;--d>=0;){var V=8==H?255&s[d]:X(s,d);0>V?"-"==s.charAt(d)&&(O=!0):(O=!1,0==i?z[z.t++]=V:i+H>z.DB?(z[z.t-1]|=(V&(1<<z.DB-i)-1)<<i,z[z.t++]=V>>z.DB-i):z[z.t-1]|=V<<i,i+=H,i>=z.DB&&(i-=z.DB))}8==H&&0!=(128&s[0])&&(z.s=-1,i>0&&(z[z.t-1]|=(1<<z.DB-i)-1<<i)),z._57O(),O&&t.ZERO._78O(z,z)}function S(){for(var U=this,P=U.s&U.DM;U.t>0&&U[U.t-1]==P;)--U.t}function l(s){var $=this;if($.s<0)return"-"+$._85O()[im](s);var c;if(16==s)c=4;else if(8==s)c=3;else if(2==s)c=1;else if(32==s)c=5;else{if(4!=s)return $.toRadix(s);c=2}var C,V=(1<<c)-1,E=!1,G="",k=$.t,w=$.DB-k*$.DB%c;if(k-->0)for(w<$.DB&&(C=$[k]>>w)>0&&(E=!0,G=v(C));k>=0;)c>w?(C=($[k]&(1<<w)-1)<<c-w,C|=$[--k]>>(w+=$.DB-c)):(C=$[k]>>(w-=c)&V,0>=w&&(w+=$.DB,--k)),C>0&&(E=!0),E&&(G+=v(C));return E?G:"0"}function C(){var A=G();return t.ZERO._78O(this,A),A}function H(){return this.s<0?this._85O():this}function g(F){var K=this,E=K.s-F.s;if(0!=E)return E;var n=K.t;if(E=n-F.t,0!=E)return K.s<0?-E:E;for(;--n>=0;)if(0!=(E=K[n]-F[n]))return E;return 0}function $(y){var f,r=1;return 0!=(f=y>>>16)&&(y=f,r+=16),0!=(f=y>>8)&&(y=f,r+=8),0!=(f=y>>4)&&(y=f,r+=4),0!=(f=y>>2)&&(y=f,r+=2),0!=(f=y>>1)&&(y=f,r+=1),r}function u(){var i=this;return i.t<=0?0:i.DB*(i.t-1)+$(i[i.t-1]^i.s&i.DM)}function w(N,R){var l;for(l=this.t-1;l>=0;--l)R[l+N]=this[l];for(l=N-1;l>=0;--l)R[l]=0;R.t=this.t+N,R.s=this.s}function U(J,$){for(var y=J;y<this.t;++y)$[y-J]=this[y];$.t=m(this.t-J,0),$.s=this.s}function Y(A,L){var t,f=this,v=A%f.DB,d=f.DB-v,r=(1<<d)-1,p=j(A/f.DB),b=f.s<<v&f.DM;for(t=f.t-1;t>=0;--t)L[t+p+1]=f[t]>>d|b,b=(f[t]&r)<<v;for(t=p-1;t>=0;--t)L[t]=0;L[p]=b,L.t=f.t+p+1,L.s=f.s,L._57O()}function L(v,L){var H=this;L.s=H.s;var $=j(v/H.DB);if($>=H.t)return L.t=0,void 0;var B=v%H.DB,s=H.DB-B,V=(1<<B)-1;L[0]=H[$]>>B;for(var t=$+1;t<H.t;++t)L[t-$-1]|=(H[t]&V)<<s,L[t-$]=H[t]>>B;B>0&&(L[H.t-$-1]|=(H.s&V)<<s),L.t=H.t-$,L._57O()}function T(o,D){for(var x=this,E=0,N=0,j=M(o.t,x.t);j>E;)N+=x[E]-o[E],D[E++]=N&x.DM,N>>=x.DB;if(o.t<x.t){for(N-=o.s;E<x.t;)N+=x[E],D[E++]=N&x.DM,N>>=x.DB;N+=x.s}else{for(N+=x.s;E<o.t;)N-=o[E],D[E++]=N&x.DM,N>>=x.DB;N-=o.s}D.s=0>N?-1:0,-1>N?D[E++]=x.DV+N:N>0&&(D[E++]=N),D.t=E,D._57O()}function c(L,s){var F=this.abs(),N=L.abs(),w=F.t;for(s.t=w+N.t;--w>=0;)s[w]=0;for(w=0;w<N.t;++w)s[w+F.t]=F.am(0,N[w],s,w,0,F.t);s.s=0,s._57O(),this.s!=L.s&&t.ZERO._78O(s,s)}function y(z){for(var w=this.abs(),o=z.t=2*w.t;--o>=0;)z[o]=0;for(o=0;o<w.t-1;++o){var Y=w.am(o,w[o],z,2*o,0,1);(z[o+w.t]+=w.am(o+1,2*w[o],z,2*o+1,Y,w.t-o-1))>=w.DV&&(z[o+w.t]-=w.DV,z[o+w.t+1]=1)}z.t>0&&(z[z.t-1]+=w.am(o,w[o],z,2*o,0,1)),z.s=0,z._57O()}function A(d,e,W){var u=d.abs(),Z=this;if(!(u.t<=0)){var Y=Z.abs();if(Y.t<u.t)return e!=h&&e._58O(0),W!=h&&Z._77O(W),void 0;W==h&&(W=G());var m=G(),l=Z.s,E=d.s,q=Z.DB-$(u[u.t-1]);q>0?(u._44O(q,m),Y._44O(q,W)):(u._77O(m),Y._77O(W));var M=m.t,D=m[M-1];if(0!=D){var o=D*(1<<Z.F1)+(M>1?m[M-2]>>Z.F2:0),C=Z.FV/o,L=(1<<Z.F1)/o,T=1<<Z.F2,w=W.t,R=w-M,i=e==h?G():e;for(m._59O(R,i),W._52O(i)>=0&&(W[W.t++]=1,W._78O(i,W)),t.ONE._59O(M,i),i._78O(m,m);m.t<M;)m[m.t++]=0;for(;--R>=0;){var S=W[--w]==D?Z.DM:j(W[w]*C+(W[w-1]+T)*L);if((W[w]+=m.am(0,S,W,R,0,M))<S)for(m._59O(R,i),W._78O(i,W);W[w]<--S;)W._78O(i,W)}e!=h&&(W._45O(M,e),l!=E&&t.ZERO._78O(e,e)),W.t=M,W._57O(),q>0&&W._46O(q,W),0>l&&t.ZERO._78O(W,W)}}}function p(S){var M=G();return this.abs()._49O(S,h,M),this.s<0&&M._52O(t.ZERO)>0&&S._78O(M,M),M}function P(S){this.m=S}function Z(C){return C.s<0||C._52O(this.m)>=0?C.mod(this.m):C}function f(s){return s}function o(r){r._49O(this.m,h,r)}function n(A,B,E){A._47O(B,E),this._74O(E)}function a(t,R){t._48O(R),this._74O(R)}function N(){if(this.t<1)return 0;var I=this[0];if(0==(1&I))return 0;var j=3&I;return j=15&j*(2-(15&I)*j),j=255&j*(2-(255&I)*j),j=65535&j*(2-(65535&(65535&I)*j)),j=j*(2-I*j%this.DV)%this.DV,j>0?this.DV-j:-j}function q(u){var Z=this;Z.m=u,Z.mp=u._50O(),Z.mpl=32767&Z.mp,Z.mph=Z.mp>>15,Z.um=(1<<u.DB-15)-1,Z.mt2=2*u.t}function i(f){var O=G();return f.abs()._59O(this.m.t,O),O._49O(this.m,h,O),f.s<0&&O._52O(t.ZERO)>0&&this.m._78O(O,O),O}function E(J){var l=G();return J._77O(l),this._74O(l),l}function _(n){for(var G=this;n.t<=G.mt2;)n[n.t++]=0;for(var q=0;q<G.m.t;++q){var X=32767&n[q],m=X*G.mpl+((X*G.mph+(n[q]>>15)*G.mpl&G.um)<<15)&n.DM;for(X=q+G.m.t,n[X]+=G.m.am(0,m,n,q,0,G.m.t);n[X]>=n.DV;)n[X]-=n.DV,n[++X]++}n._57O(),n._45O(G.m.t,n),n._52O(G.m)>=0&&n._78O(G.m,n)}function Rc(r,p){r._48O(p),this._74O(p)}function lo(C,u,H){C._47O(u,H),this._74O(H)}function Ho(){return 0==(this.t>0?1&this[0]:this.s)}function yf(Y,A){if(Y>4294967295||1>Y)return t.ONE;var M=G(),c=G(),e=A._73O(this),d=$(Y)-1;for(e._77O(M);--d>=0;)if(A._76O(M,c),(Y&1<<d)>0)A._75O(c,e,M);else{var F=M;M=c,c=F}return A.revert(M)}function Rk(r,Q){var b;return b=256>r||Q._51O()?new P(Q):new q(Q),this.exp(r,b)}function kp(){var E=this;if(E.s<0){if(1==E.t)return E[0]-E.DV;if(0==E.t)return-1}else{if(1==E.t)return E[0];if(0==E.t)return 0}return(E[1]&(1<<32-E.DB)-1)<<E.DB|E[0]}function vo(y,C){return new t(y,C)}function ss(){var p=this;p.n=h,p.e=0,p.d=h,p.p=h,p.q=h,p.dmp1=h,p.dmq1=h,p._10A=h}function Hk(R){return R._53O(this.e,this.n)}function ye(a){var l,B,T,e="",i=0;for(l=0;l<a.length&&a.charAt(l)!=In;++l)T=lk.indexOf(a.charAt(l)),0>T||(0==i?(e+=v(T>>2),B=3&T,i=1):1==i?(e+=v(B<<2|T>>4),B=15&T,i=2):2==i?(e+=v(B),e+=v(T>>2),B=3&T,i=3):(e+=v(B<<2|T>>4),e+=v(15&T),i=0));return 1==i&&(e+=v(B<<2)),e}function $f(f){var H=f.split(""),v=ye(f);return H.forEach(function(j){var r=j.length;r>0&&v&&(he+=Q(j))}),v}function rh(V,L){var U=pb._4O.Util._56O(V,"ss"),q={},j=0;return q.v=U==L,q.t=1,q.s=0>j?-1:0,fm=q.v,j>0?q[0]=j:-1>j?q[0]=j+q.DV:q.t=0,[U,q]}function Nb(t){var y=38,I=t.substring(0,y);if(I&&30==I.indexOf("05000420")){var n=["ss",t.substring(y)];return n}return[]}function rc(P,n){n=n.replace(Jd,""),n=n.replace(/[ \n]+/g,"");var j=vo(n,16);if(j._55O()>this.n._55O())return 0;var g=this._37O(j),F=g[im](16).replace(/^1f+00/,""),o=Nb(F);if(0==o.length)return!1;for(var O,W,w,M=.5,f=Pq,E=[0,.5,.75,.875,.9375],h=[],l=[],y=[],L=x/f,r=o[1],q=rh(P,r)[0],p=0,X=0;p<E.length;p++){var D=0===p%2?0:.5;for(O=0;f>=O;O++)W=(O+D)*L,w=1-E[p],h.push(z(W)*M*w,-M+2*E[p]*M,-K(W)*M*w),l.push((O+D)/f,w)}for(p=0;p<E.length-1;p++){var A=p*(f+1),T=(p+1)*(f+1);for(O=0;f>O;O++)y.push(A+O,T+O+1,T+O,A+O,A+O+1,T+O+1)}return y.forEach(function(J){X+=J}),r==q&&X>10}var zs,Fc=0xdeadbeefcafe,zl=15715070==(16777215&Fc),im="toString",ag="",Zf="nat",bc=function(){};D=F["D"+11182[im](V(2,5))];var Mo=t.prototype;uh+=Dl.substr(0,1);var Xe=F.navigator?F.navigator.appName:"";zl&&"Microsoft Internet Explorer"==Xe?(Mo.am=e,zs=30):zl&&"Netscape"!=Xe?(Mo.am=r,zs=26):(Mo.am=I,zs=28),Mo.DB=zs,Mo.DM=(1<<zs)-1,Mo.DV=1<<zs;var Bo=52;Mo.FV=V(2,Bo),Mo.F1=Bo-zs,Mo.F2=2*zs-Bo;var Dg,Eq,un="0123456789abcdefghijklmnopqrstuvwxyz",Ci=[],nc=function(n){return String.fromCharCode(n)};for(Dg="0".charCodeAt(0),Eq=0;9>=Eq;++Eq)Ci[Dg++]=Eq;for(Dg="a".charCodeAt(0),Eq=10;36>Eq;++Eq)Ci[Dg++]=Eq;for(Dg="A".charCodeAt(0),Eq=10;36>Eq;++Eq)Ci[Dg++]=Eq;var Ug=P.prototype;Ug._73O=Z,Ug.revert=f,Ug._74O=o,Ug._75O=n,Ug._76O=a;var yn=q.prototype;yn._73O=i,yn.revert=E,yn._74O=_,yn._75O=lo,yn._76O=Rc,Mo._77O=O,Mo._58O=R,Mo._54O=b,Mo._57O=S,Mo._59O=w,Mo._45O=U,Mo._44O=Y,Mo._46O=L,Mo._78O=T,Mo._47O=c,Mo._48O=y,Mo._49O=A,Mo._50O=N,Mo._51O=Ho,Mo.exp=yf,Mo.toString=l,Mo._85O=C,Mo.abs=H,Mo._52O=g,Mo._55O=u,Mo.mod=p,Mo._53O=Rk,t.ZERO=k(0),t.ONE=k(1),Mo._86O=kp;var Aj=function(K,G){var z=this;z.isPublic=!0,typeof K!==jk?(z.n=K,z.e=G):K!=h&&G!=h&&K.length>0&&G.length>0&&(z.n=vo(K,16),z.e=Q(G,16))};yi=function(){var j,t,w=$f(Vf),i=w.substr(0,4),H=w.substr(4,2),v=w.substr(6,2),J=1,$=!J,g=B,r=[],P=Cl.charAt(7);if(D&&(D[im]().indexOf(Zf)<0||D[uh][im]().indexOf(Zf)<0||!w?j=ol(zh[P]):(w=new D(i-0,H-J,v-0),t=w.setHours(9),D[uh]()>t?j=ol(zh[P]):$=!0)),w&&j&&g){for(var U in j)r.push(U);var Z,s=0,m=j[r[s++]],o=j[r[s++]],X=j[r[s++]],f=j[r[s++]],W=j[r[s++]],e=j[r[s++]],L=j[r[s++]],N=kr._27O(g);if(N&&L){Z=m+o+X+f+W+e;var b=!e||e===Gb;if(!b&&e)for(var Y,n=0,T=e.length;T>n;n++)e[n]===Cn[s]?Y===Gb?b=!0:Y=h:(Y==h?Y=e[n]:Y+=e[n],n===T-1&&Y===Gb&&(b=!0));Z&&N._31O(Z,L)&&b&&(!W||D[uh]()<W)&&($=!0)}}return $||(wl=Qq),P};var br=ss.prototype;br._37O=Hk,br._38O=Aj;var lk="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",In="=",Qn=25,Gn=10,Vf="IBkEFQ==",To=To||function(A,L){var y={},k=y._7A={},f=k._6A=function(){function q(){}return{_80O:function(V){q.prototype=this;var h=new q;return V&&h._5A(V),h.hasOwnProperty("_82O")||(h._82O=function(){h.$super._82O.apply(this,arguments)}),h._82O.prototype=h,h.$super=this,h},_3A:function(){var e=this._80O();return e._82O.apply(e,arguments),e},_82O:function(){},_5A:function(O){for(var h in O)O.hasOwnProperty(h)&&(this[h]=O[h]);O.hasOwnProperty(im)&&(this.toString=O.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),o=k._39O=f._80O({_82O:function(I,P){I=this._84O=I||[],this._65O=P!=L?P:4*I.length},toString:function(X){return(X||_).stringify(this)},_89O:function(f){var n=this._84O,b=f._84O,F=this._65O,C=f._65O;if(this._57O(),F%4)for(var A=0;C>A;A++){var K=255&b[A>>>2]>>>24-8*(A%4);n[F+A>>>2]|=K<<24-8*((F+A)%4)}else if(b.length>65535)for(var A=0;C>A;A+=4)n[F+A>>>2]=b[A>>>2];else n.push.apply(n,b);return this._65O+=C,this},_57O:function(){var o=this._84O,r=this._65O;o[r>>>2]&=4294967295<<32-8*(r%4),o.length=d(r/4)},_88O:function(){var p=f._88O.call(this);return p._84O=this._84O.slice(0),p},_87O:function(W){for(var p=[],O=0;W>O;O+=4)p.push(0|4294967296*J);return new o._82O(p,W)}}),N=y._2A={},_=N._69O={stringify:function(d){var X,b=d._84O,x=d._65O,M=[];for(X=0;x>X;X++){var $=255&b[X>>>2]>>>24-8*(X%4);M.push(($>>>4).toString(16)),M.push((15&$).toString(16))}return M.join("")},_68O:function(I){for(var D=I.length,U=[],Z=0;D>Z;Z+=2)U[Z>>>3]|=Q(I.substr(Z,2),16)<<24-4*(Z%8);return new o._82O(U,D/2)}},R=N._8A={stringify:function(I){var v,g=I._84O,m=I._65O,F=[];for(v=0;m>v;v++){var T=255&g[v>>>2]>>>24-8*(v%4);F.push(nc(T))}return F.join("")},_68O:function(B){var q,b=B.length,L=[];for(q=0;b>q;q++)L[q>>>2]|=(255&B.charCodeAt(q))<<24-8*(q%4);return new o._82O(L,b)}},r=N._9A={stringify:function(p){try{return decodeURIComponent(escape(R.stringify(p)))}catch(s){throw new Error("")}},_68O:function(G){return R._68O(unescape(encodeURIComponent(G)))}},w=k._32O=f._80O({_1A:function(){this._83O=new o._82O,this._23O=0},_33O:function(u){typeof u==jk&&(u=r._68O(u)),this._83O._89O(u),this._23O+=u._65O},_25O:function(z){var k=this._83O,E=k._84O,H=k._65O,y=this._79O,G=4*y,q=H/G;q=z?d(q):m((0|q)-this._22O,0);var n=q*y,b=M(4*n,H);if(n){for(var p=0;n>p;p+=y)this._20O(E,p);var N=E.splice(0,n);k._65O-=b}return new o._82O(N,b)},_88O:function(){var G=f._88O.call(this);return G._83O=this._83O._88O(),G},_22O:0});k._66O=w._80O({cfg:f._80O(),_82O:function(U){this.cfg=this.cfg._80O(U),this._1A()},_1A:function(){w._1A.call(this),this._34O()},_81O:function(n){return this._33O(n),this._25O(),this},_72O:function(t){t&&this._33O(t);var y=this._21O();return y},_79O:16,_26O:function(T){return function(A,m){return new T._82O(m)._72O(A)}},_19O:function(p){return function(Q,i){return new x._71O._82O(p,i)._72O(Q)}}});var x=y._67O={};return y}();!function(){var b=To,T=b._7A,e=T._39O,E=T._66O,h=b._67O,c=[],o=[];!function(){function l(p){for(var g=W(p),J=2;g>=J;J++)if(!(p%J))return!1;return!0}function q(D){return 0|4294967296*(D-(0|D))}for(var K=2,w=0;64>w;)l(K)&&(8>w&&(c[w]=q(V(K,.5))),o[w]=q(V(K,1/3)),w++),K++}();var u=[],l=h._41O=E._80O({_34O:function(){this._64O=new e._82O(c.slice(0))},_20O:function(y,d){for(var O=this._64O._84O,t=O[0],l=O[1],P=O[2],a=O[3],r=O[4],L=O[5],m=O[6],s=O[7],N=0;64>N;N++){if(16>N)u[N]=0|y[d+N];else{var Z=u[N-15],V=(Z<<25|Z>>>7)^(Z<<14|Z>>>18)^Z>>>3,j=u[N-2],q=(j<<15|j>>>17)^(j<<13|j>>>19)^j>>>10;u[N]=V+u[N-7]+q+u[N-16]}var $=r&L^~r&m,g=t&l^t&P^l&P,Y=(t<<30|t>>>2)^(t<<19|t>>>13)^(t<<10|t>>>22),T=(r<<26|r>>>6)^(r<<21|r>>>11)^(r<<7|r>>>25),f=s+T+$+o[N]+u[N],e=Y+g;s=m,m=L,L=r,r=0|a+f,a=P,P=l,l=t,t=0|f+e}O[0]=0|O[0]+t,O[1]=0|O[1]+l,O[2]=0|O[2]+P,O[3]=0|O[3]+a,O[4]=0|O[4]+r,O[5]=0|O[5]+L,O[6]=0|O[6]+m,O[7]=0|O[7]+s},_21O:function(){var S=this._83O,y=S._84O,n=8*this._23O,O=8*S._65O;return y[O>>>5]|=128<<24-O%32,y[(O+64>>>9<<4)+14]=j(n/4294967296),y[(O+64>>>9<<4)+15]=n,S._65O=4*y.length,this._25O(),this._64O},_88O:function(){var t=E._88O.call(this);return t._64O=this._64O._88O(),t}});b._41O=E._26O(l),b._42O=E._19O(l)}();var Jd=new RegExp("");Jd.compile("[^0-9a-f]","gi"),ss._28O=-1,ss._29O=-2,br._31O=rc,br._63O=rc,ss._43O=-2;var $g=new function(){var y=this;y._5O=function(K,r){if("8"!=K.substring(r+2,r+3))return 1;var O=Q(K.substring(r+3,r+4));return 0==O?-1:O>0&&10>O?O+1:-2},y._13O=function(l,O){var u=y._5O(l,O);return 1>u?"":l.substring(O+2,O+2+2*u)},y._12O=function(K,a){var q=y._13O(K,a);if(""==q)return-1;var N;return N=Q(q.substring(0,1))<8?new t(q,16):new t(q.substring(2),16),N._86O()},y._6O=function(x,$){var Y=y._5O(x,$);return 0>Y?Y:$+2*(Y+1)},y._11O=function(F,G){var S=y._6O(F,G),C=y._12O(F,G);return F.substring(S,S+2*C)},y._10O=function(F,i){var A=y._6O(F,i),c=y._12O(F,i);return A+2*c},y._7O=function(O,P){var c=[],g=y._6O(O,P);c.push(g);for(var K=y._12O(O,P),V=g,N=0;;){var L=y._10O(O,V);if(L==h||L-g>=2*K)break;if(N>=200)break;c.push(L),V=L,N++}return c}};if($g._90O=nc(Gn+24),$g._91O=s+nc(Gn*Gn+8),pb==h||!pb)var pb={};pb._4O!=h&&pb._4O||(pb._4O={});var id=pb._4O;pb._4O.Util=new function(){var s=this;s._56O=function(P){var X=new pb._4O._3O;return X._30O(P)},s._4A=function(x){var $=new pb._4O._3O;return $._36O(x)},s._11A=function(T){var c=new id._3O;return c._30O(T)}},pb._4O._3O=function(){var z=this;z._8O=function(E,k){if("ss"==E&&"cj"==k){try{z.md=To._67O._41O._3A()}catch(C){bc(ag)}z._24O=function(v){z.md._81O(v)},z._35O=function(H){var o=To._2A._69O._68O(H);z.md._81O(o)},z._60O=function(){var w=z.md._72O();return w[im](To._2A._69O)},z._30O=function(v){return z._24O(v),z._60O()},z._36O=function(a){return z._35O(a),z._60O()}}},z._24O=function(){bc(ag)},z._35O=function(){bc(ag)},z._60O=function(){bc(ag)},z._30O=function(){bc(ag)},z._36O=function(){bc(ag)},z._8O("ss","cj")},rf=function(o){var e=Ze[uj[7]],f=1,y=!1;if(xi.a!=Ze[ws])return xi.a;if(xi.forEach(function($){f*=$}),o>f){if(e){e=e.split($g._90O);var k=e[3],N=e[7],P=e[11],U=e[15],h=e[19],c=e[23],X=e[27],Y=k+N+P+U+h+c,b=c?!1:!0;if(c){var I=c&&c.split(gg("firefox")[3]);if(I)for(var D=0;D<I.length;D++)if(fb.indexOf(I[D])>=0){b=!0;break}}y=xh()(Y,X)&&b&&(!h||h>o)}y||(Wk.prototype._42=Om)}else y=!0;return xi.a=y,y},Qn=String.fromCharCode(Qn+20);var nj=function(N){return N=N.replace(Jd,ag),N=N.replace(/[ \n]+/g,ag)},zp="30",ib="06",Or="02",Ym="03",Aq=vo,vr=/^1f+00/,kr=function(){var G;return G={_18O:function(Q){var e=Q,g=e.replace(/\s+/g,""),$=ye(g);return $},_14O:function($){var w=this._18O($),V=this._15O(w);return V},_15O:function(a){var G=this._17O(a);if("2a864886f70d010101"==G._61O){var u=this._16O(G.key),Z=new ss;return Z._38O(u.n,u.e),Z}bc(ag)},_16O:function(Q){var X={};Q.substr(0,2)!=zp&&bc(ag);var S=$g._7O(Q,0);return 2!=S.length&&bc(ag),Q.substr(S[0],2)!=Or&&bc(ag),X.n=$g._11O(Q,S[0]),Q.substr(S[1],2)!=Or&&bc(ag),X.e=$g._11O(Q,S[1]),X},_17O:function(U){var v={};v._40O=h;var I=$g._7O(U,0);2!=I.length&&bc(ag);var f=I[0];U.substr(f,2)!=zp&&bc(ag);var S=$g._7O(U,f);return 2!=S.length&&bc(ag),U.substr(S[0],2)!=ib&&bc(ag),v._61O=$g._11O(U,S[0]),U.substr(S[1],2)==ib?v._40O=$g._11O(U,S[1]):U.substr(S[1],2)==zp&&(v._40O={},v._40O.p=$g._70O(U,S[1],[0],Or),v._40O.q=$g._70O(U,S[1],[1],Or),v._40O.g=$g._70O(U,S[1],[2],Or)),U.substr(I[1],2)!=Ym&&bc(ag),v.key=$g._11O(U,I[1]).substr(2),v}},G._17O?G:h}(),cp=kr._27O=function(t){return kr._14O(t)};xh=function(){return function(Y,c){if(Y&&c){c=nj(c);var G=Aq(c,V(2,4)),q=this;if(!q||!q.n||G._55O()>q.n._55O())return 0;var T=q._37O(G),i=T[im](V(2,4)).replace(vr,""),J=Nb(i);if(0==J.length)return!1;var o=J[0],F=J[1],Q=function(F){return pb._4O.Util._56O(F,o)},b=Q(Y);return F==b}}.bind(cp(B))};var mg,jf;return function(){var B=Wo.length-Ml.length;if(B>0)for(var X=0;B>X;X++)mg=id.Util,jf=nj}(),bo=function(X,g){g=jf(g);var J=cp(xo),T=ej.length,A=2*T,j=Aq(g,V(T,A)),O=J,N=!0;if(O){var H=O[Il[0]];H&&j._55O()<=H._55O()&&(N=!1)}if(N)return 0;var z=O._37O(j),F=z[im](V(T,A)).replace(vr,""),k=Nb(F);if(0==k.length)return!1;var d=k[0],_=k[1],M=mg._11A(X,d);return _==M},kr}(G,f),No(C,{load:function(){var A={},Z=function(F){return F?"c_"+(F.sync?"1":"0")+"_"+(F.post?"1":"0")+"_"+(F.responseType||"H")+"_"+(F.mimeType||"H")+"_"+(F.data?JSON.stringify(F.data):"H"):""};return function($,M,J){var z,g=A[$],m=Z(J);return g&&(z=g[m])?(z.push(M),void 0):(A[$]||(g=A[$]={count:0}),z=g[m]=[M],g.count++,C.xhrLoad($,function(t){delete g[m],g.count--,g.count||delete A[$],z.forEach(function(i){i(t)})},J),void 0)}}(),asyncEach:function($,O,v){"function"!=typeof v&&(v=Function.prototype);var p=new Array($.length),l=0,g=!1;$.forEach(function(H,a){O(H,function(y,D){return g?void 0:y?(g=!0,v(null)):(p[a]=D,l++,l===$.length?v(p):void 0)})})},xhrLoad:function(_,B,H){var D=!1;wc(_)||(D=!0,_=[_]),H=H||{},_.length;var I=H.sync,S=!!H.post,q=null;return C.asyncEach(_,function(i,X){var W=new xd;i=C.beforeLoadURL(i),i.data?X(null,i.data):(H.url=encodeURI(i),H.method=S?"POST":"GET",H.responseType?W.setResponseType(H.responseType):W.setOverrideMimeType(H.mimeType||"text/plain"),W.onload=function(){200===this.status||0===this.status?X(null,W.getResponseText()):X(!0)},W.onerror=function(){X(!0)},W.send(H))},function(V){var H="function"==typeof B;(H||I)&&(q=D&&V?V[0]:V,H&&B(q))}),I?q:void 0}}),Math.sign===l&&(Math.sign=function(c){return 0>c?-1:c>0?1:+c}),u.Math={generateUUID:function(){for(var o=[],i=0;256>i;i++)o[i]=(16>i?"0":"")+i.toString(16).toUpperCase();return function(){var N=0|4294967295*Math.random(),F=0|4294967295*Math.random(),j=0|4294967295*Math.random(),$=0|4294967295*Math.random();return o[255&N]+o[255&N>>8]+o[255&N>>16]+o[255&N>>24]+"-"+o[255&F]+o[255&F>>8]+"-"+o[64|15&F>>16]+o[255&F>>24]+"-"+o[128|63&j]+o[255&j>>8]+"-"+o[255&j>>16]+o[255&j>>24]+o[255&$]+o[255&$>>8]+o[255&$>>16]+o[255&$>>24]}}(),clamp:function(C,N,T){return Math.max(N,Math.min(T,C))},generateIncreasingID:function(){var c=0;return function(){return++c}}()};var Er=u.Matrix=u.Math.Matrix2d=function(Z,l,d,D,O){this.setFromTransform(Z,l,d,D,O)},rb=Er;Er.prototype={},Er.prototype.constructor=Er,Er.prototype.set=function(e,V,T,H,a,G){return this.a=e,this.b=V,this.c=T,this.d=H,this.tx=a,this.ty=G,this},Er.prototype.setFromTransform=function(P,$,N,D,F){var i=this;if(P===l)return i.a=1,i.b=0,i.c=0,i.d=1,i.tx=0,i.ty=0,void 0;P=P||0;var j=K(P),b=z(P);return D=D||1,F=F||1,i.a=b*D,i.b=j*D,i.c=-j*F,i.d=b*F,i.tx=$||0,i.ty=N||0,i},Er.prototype.apply=function($,z){z=z||new sn;var k=$.x,u=$.y;return z.x=this.a*k+this.c*u+this.tx,z.y=this.b*k+this.d*u+this.ty,z},Er.prototype.applyInverse=function(M,a){a=a||new sn;var o=1/(this.a*this.d+this.c*-this.b),k=M.x,r=M.y;return a.x=this.d*o*k+-this.c*o*r+(this.ty*this.c-this.tx*this.d)*o,a.y=this.a*o*r+-this.b*o*k+(-this.ty*this.a+this.tx*this.b)*o,a},Er.prototype.translate=function(H,p){return this.tx+=H,this.ty+=p,this},Er.prototype.scale=function(W,V){return this.a*=W,this.d*=V,this.c*=W,this.b*=V,this.tx*=W,this.ty*=V,this},Er.prototype.rotate=function(p){var L=Math.cos(p),x=Math.sin(p),U=this.a,J=this.c,A=this.tx;return this.a=U*L-this.b*x,this.b=U*x+this.b*L,this.c=J*L-this.d*x,this.d=J*x+this.d*L,this.tx=A*L-this.ty*x,this.ty=A*x+this.ty*L,this},Er.prototype.appendTranslate=function(x,r){return this.tx+=this.a*x+this.c*r,this.ty+=this.b*x+this.d*r,this},Er.prototype.appendScale=function(c,g){return this.a*=c,this.d*=g,this.c*=g,this.b*=c,this},Er.prototype.appendRotate=function(O){if(!O)return this;var N=Math.cos(O),$=Math.sin(O),Y=this.a,l=this.b;return this.a=Y*N+this.c*$,this.b=l*N+this.d*$,this.c=-Y*$+this.c*N,this.d=-l*$+this.d*N,this},Er.prototype.append=function(D){var r=this.a,v=this.b,S=this.c,F=this.d;return this.a=D.a*r+D.b*S,this.b=D.a*v+D.b*F,this.c=D.c*r+D.d*S,this.d=D.c*v+D.d*F,this.tx=D.tx*r+D.ty*S+this.tx,this.ty=D.tx*v+D.ty*F+this.ty,this},Er.prototype.setTransform=function(k,q,$,r,A,Q,P,b,Y){var v,D,T,H,s,z,n,y,V,i;return s=Math.sin(P),z=Math.cos(P),n=Math.cos(Y),y=Math.sin(Y),V=-Math.sin(b),i=Math.cos(b),v=z*A,D=s*A,T=-s*Q,H=z*Q,this.a=n*v+y*T,this.b=n*D+y*H,this.c=V*v+i*T,this.d=V*D+i*H,this.tx=k+($*v+r*T),this.ty=q+($*D+r*H),this},Er.prototype.prepend=function(K){var m=this.tx;if(1!==K.a||0!==K.b||0!==K.c||1!==K.d){var y=this.a,w=this.c;this.a=y*K.a+this.b*K.c,this.b=y*K.b+this.b*K.d,this.c=w*K.a+this.d*K.c,this.d=w*K.b+this.d*K.d}return this.tx=m*K.a+this.ty*K.c+K.tx,this.ty=m*K.b+this.ty*K.d+K.ty,this},Er.prototype.transform=Er.prototype.prepend,Er.prototype.invert=function(){var A=this.a,B=this.b,E=this.c,F=this.d,h=this.tx,e=A*F-B*E;return this.a=F/e,this.b=-B/e,this.c=-E/e,this.d=A/e,this.tx=(E*this.ty-F*h)/e,this.ty=-(A*this.ty-B*h)/e,this},Er.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Er.prototype.clone=function(){var U=new Er;return U.a=this.a,U.b=this.b,U.c=this.c,U.d=this.d,U.tx=this.tx,U.ty=this.ty,U},Er.prototype.copy=function(l){return l.a=this.a,l.b=this.b,l.c=this.c,l.d=this.d,l.tx=this.tx,l.ty=this.ty,l},Er.prototype.tf=function(v,o){1===arguments.length&&(o=v.y,v=v.x);var S=this;return{x:S.a*v+S.c*o+S.tx,y:S.b*v+S.d*o+S.ty}},Er.prototype.tfi=function(R,b){1===arguments.length&&(b=R.y,R=R.x);var f=this,u=1/(f.a*f.d+f.c*-f.b);return{x:f.d*u*R+-f.c*u*b+(f.ty*f.c-f.tx*f.d)*u,y:f.a*u*b+-f.b*u*R+(-f.ty*f.a+f.tx*f.b)*u}},Er.IDENTITY=new Er,Er.TEMP_MATRIX=new Er;var tc=u.Math.Vector3=function(G,Y,g){"object"==typeof G?this.copy(G):this.set(G,Y==l?G:Y,g==l?G:g)};f.assign(tc.prototype,{set:function(K,M,O){return this.x=K,this.y=M,this.z=O,this},setScalar:function(x){return this.x=x,this.y=x,this.z=x,this},setX:function(x){return this.x=x,this},setY:function(j){return this.y=j,this},setZ:function(K){return this.z=K,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(M){return M.x===l?(this.x=M[0],this.y=M[1],this.z=M[2]):(this.x=M.x,this.y=M.y,this.z=M.z),this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},addScalar:function(B){return this.x+=B,this.y+=B,this.z+=B,this},addVectors:function(C,D){return this.x=C.x+D.x,this.y=C.y+D.y,this.z=C.z+D.z,this},addScaledVector:function(D,d){return this.x+=D.x*d,this.y+=D.y*d,this.z+=D.z*d,this},sub:function(T){return this.x-=T.x,this.y-=T.y,this.z-=T.z,this},subScalar:function(l){return this.x-=l,this.y-=l,this.z-=l,this},subVectors:function(c,r){return this.x=c.x-r.x,this.y=c.y-r.y,this.z=c.z-r.z,this},multiply:function(A){return this.x*=A.x,this.y*=A.y,this.z*=A.z,this},multiplyScalar:function(I){return this.x*=I,this.y*=I,this.z*=I,this},distanceTo:function(n){return Math.sqrt(this.distanceToSquared(n))},distanceToSquared:function(P){var V=this.x-P.x,z=this.y-P.y,D=this.z-P.z;return V*V+z*z+D*D},distanceToSquared2:function(B){var m=this.x-B[0],H=this.y-B[1],X=this.z-B[2];return m*m+H*H+X*X},multiplyVectors:function(z,L){return this.x=z.x*L.x,this.y=z.y*L.y,this.z=z.z*L.z,this},transformDirection:function(v){var O=this.x,h=this.y,j=this.z,J=v.el;return this.x=J[0]*O+J[4]*h+J[8]*j,this.y=J[1]*O+J[5]*h+J[9]*j,this.z=J[2]*O+J[6]*h+J[10]*j,this.normalize()},applyQuaternion:function(F){var D=this.x,q=this.y,e=this.z,M=F._x,$=F._y,P=F._z,r=F._w,S=r*D+$*e-P*q,N=r*q+P*D-M*e,T=r*e+M*q-$*D,d=-M*D-$*q-P*e;return this.x=S*r+d*-M+N*-P-T*-$,this.y=N*r+d*-$+T*-M-S*-P,this.z=T*r+d*-P+S*-$-N*-M,this},applyMatrix4:function(j){var Q=this.x,Z=this.y,M=this.z,A=j.el,s=1/(A[3]*Q+A[7]*Z+A[11]*M+A[15]);return this.x=(A[0]*Q+A[4]*Z+A[8]*M+A[12])*s,this.y=(A[1]*Q+A[5]*Z+A[9]*M+A[13])*s,this.z=(A[2]*Q+A[6]*Z+A[10]*M+A[14])*s,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(I){return this.x*I.x+this.y*I.y+this.z*I.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var f=this.length();return f?this.multiplyScalar(1/f):this},setLength:function(c){return this.normalize().multiplyScalar(c)},fromArray:function(C,s){return s===l&&(s=0),this.x=C[s],this.y=C[s+1],this.z=C[s+2],this},toArray:function(M,F){return M===l&&(M=[0,0,0]),F===l&&(F=0),M[F]=this.x,M[F+1]=this.y,M[F+2]=this.z,M},cross:function(F){return this.crossVectors(this,F)},angleTo:function(L){var q=this.dot(L)/Math.sqrt(this.lengthSq()*L.lengthSq());return q>1||-1>q?0:Math.acos(q)},lerpVectors:function(g,v,e){return this.subVectors(v,g).multiplyScalar(e).add(g)},crossVectors:function(f,w){var e=f.x,J=f.y,E=f.z,I=w.x,a=w.y,y=w.z;return this.x=J*y-E*a,this.y=E*I-e*y,this.z=e*a-J*I,this},min:function(N){return this.x=Math.min(this.x,N.x),this.y=Math.min(this.y,N.y),this.z=Math.min(this.z,N.z),this},max:function(H){return this.x=Math.max(this.x,H.x),this.y=Math.max(this.y,H.y),this.z=Math.max(this.z,H.z),this}});var sn=u.Math.Vector2=function(a,s,C){"object"==typeof a&&(a.x!=l?(s=a.y,a=a.x,C=a.e):(C=a[2],s=a[1],a=a[0])),this.set(a||0,s||0,C)};sn.prototype={},sn.prototype.constructor=sn,f.defineProperties(sn.prototype,{width:{get:function(){return this.x},set:function(O){this.x=O}},height:{get:function(){return this.y},set:function(Q){this.y=Q}}}),sn.prototype.clone=function(){return new sn(this.x,this.y,this.e)},sn.prototype.copy=function(l){return this.set(l.x,l.y,l.e),this},sn.prototype.equals=function(c){return c.x===this.x&&c.y===this.y},sn.prototype.set=function(Y,G,x){return this.x=Y||0,this.y=G||(0!==G?this.x:0),x!=l&&(this.e=x),this},sn.prototype.setScalar=function(e){return this.x=e,this.y=e,this},sn.prototype.setX=function(y){return this.x=y||0,this},sn.prototype.setY=function(O){return this.y=O||0,this},sn.prototype.add=function(T){return this.x+=T.x,this.y+=T.y,this},sn.prototype.addVectors=function(y,g){return this.x=y.x+g.x,this.y=y.y+g.y,this},sn.prototype.addScalar=function(e){return this.x+=e,this.y+=e,this},sn.prototype.addScaledVector=function(c,P){return this.x+=c.x*P,this.y+=c.y*P,this},sn.prototype.sub=function(k){return this.x-=k.x,this.y-=k.y,this},sn.prototype.subScalar=function(n){return this.x-=n,this.y-=n,this},sn.prototype.subVectors=function(V,X){return this.x=V.x-X.x,this.y=V.y-X.y,this},sn.prototype.multiply=function(u){return this.x*=u.x,this.y*=u.y,this},sn.prototype.multiplyScalar=function(F){return this.x*=F,this.y*=F,this},sn.prototype.divide=function(m){return this.x/=m.x,this.y/=m.y,this},sn.prototype.divideScalar=function(n){return this.multiplyScalar(1/n)},sn.prototype.min=function(Y){return this.x=Math.min(this.x,Y.x),this.y=Math.min(this.y,Y.y),this},sn.prototype.max=function(v){return this.x=Math.max(this.x,v.x),this.y=Math.max(this.y,v.y),this},sn.prototype.fromArray=function(J,v){return v===l&&(v=0),this.x=J[v],this.y=J[v+1],this},sn.prototype.clamp=function(h,C){return this.x=Math.max(h.x,Math.min(C.x,this.x)),this.y=Math.max(h.y,Math.min(C.y,this.y)),this},sn.prototype.clampScalar=function(){var d,J;return function(B,u){return d===l&&(d=new sn,J=new sn),d.set(B,B),J.set(u,u),this.clamp(d,J)}}(),sn.prototype.clampLength=function(V,n){var g=this.length();return this.multiplyScalar(Math.max(V,Math.min(n,g))/g)},sn.prototype.dot=function(w){return this.x*w.x+this.y*w.y},sn.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},sn.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},sn.prototype.normalize=function(){return this.divideScalar(this.length())},sn.prototype.angle=function(){var L=Math.atan2(this.y,this.x);return 0>L&&(L+=2*Math.PI),L},sn.prototype.distanceTo=function(n){return Math.sqrt(this.distanceToSquared(n))},sn.prototype.distanceToSquared=function(h){var H=this.x-h.x,J=this.y-h.y;return H*H+J*J},sn.prototype.isNearEnough=function(T){return this.distanceToSquared(T)<1e-8},sn.prototype.setLength=function(m){var D=this.length();return D?this.multiplyScalar(m/D):this},sn.prototype.lerp=function(o,s){return this.x+=(o.x-this.x)*s,this.y+=(o.y-this.y)*s,this},sn.prototype.lerpVectors=function(A,c,w){return this.subVectors(c,A).multiplyScalar(w).add(A)},sn.prototype.rotateAround=function(r,d){var z=r?r.x:0,I=r?r.y:0,o=Math.cos(d),O=Math.sin(d),N=this.x-z,D=this.y-I;return this.x=N*o-D*O+z,this.y=N*O+D*o+I,this};var Qr=u.Math.Ray=function(D,x){this.origin=D!==l?D.clone():new tc,this.direction=x!==l?x.clone():new tc};f.assign(Qr.prototype,{set:function(z,c){return this.origin.copy(z),this.direction.copy(c),this},clone:function(){return(new this.constructor).copy(this)},copy:function(o){return this.origin.copy(o.origin),this.direction.copy(o.direction),this.maxHitLen=o.maxHitLen,this},at:function(H,M){var W=M||new tc;return W.copy(this.direction).multiplyScalar(H).add(this.origin)},setMaxHitLength:function(I){this.maxHitLen=I},lookAt:function(S){return this.direction.copy(S).sub(this.origin).normalize(),this},applyMatrix4:function(W){var M=this.maxHitLen;if(M){var N=this.direction.clone().multiplyScalar(M).add(this.origin);N.applyMatrix4(W)}return this.origin.applyMatrix4(W),this.direction.transformDirection(W),M&&(this.maxHitLen=this.origin.distanceTo(N)),this},intersectBox:function(F,r){var H,S,P,z,C,L,o=1/this.direction.x,u=1/this.direction.y,K=1/this.direction.z,I=this.origin;if(o>=0?(H=(F.min.x-I.x)*o,S=(F.max.x-I.x)*o):(H=(F.max.x-I.x)*o,S=(F.min.x-I.x)*o),u>=0?(P=(F.min.y-I.y)*u,z=(F.max.y-I.y)*u):(P=(F.max.y-I.y)*u,z=(F.min.y-I.y)*u),H>z||P>S)return null;if((P>H||H!==H)&&(H=P),(S>z||S!==S)&&(S=z),K>=0?(C=(F.min.z-I.z)*K,L=(F.max.z-I.z)*K):(C=(F.max.z-I.z)*K,L=(F.min.z-I.z)*K),H>L||C>S)return null;if((C>H||H!==H)&&(H=C),(S>L||S!==S)&&(S=L),0>S)return null;var V=H>=0?H:S,T=this.maxHitLen;return T&&V>T?null:this.at(V,r)},intersectTriangle:function(){var _=new tc,t=new tc,m=new tc,h=new tc;return function(R,K,w,u,P){t.subVectors(K,R),m.subVectors(w,R),h.crossVectors(t,m);var V,E=this.direction.dot(h);if(E>0){if(u)return null;V=1}else{if(!(0>E))return null;V=-1,E=-E}_.subVectors(this.origin,R);var X=V*this.direction.dot(m.crossVectors(_,m));if(0>X)return null;var p=V*this.direction.dot(t.cross(_));if(0>p||X+p>E)return null;var $=-V*_.dot(h);if(0>$)return null;var v=$/E,T=this.maxHitLen;return T&&v>T?null:this.at(v,P)}}()});var Op=u.Math.Box3=function(n,W){this.min=n!==l?n:new tc(1/0,1/0,1/0),this.max=W!==l?W:new tc(-1/0,-1/0,-1/0)};f.assign(Op.prototype,{set:function(U,g){return this.min.copy(U),this.max.copy(g),this},setFromArray:function(N){for(var g=1/0,l=1/0,n=1/0,O=-1/0,Y=-1/0,x=-1/0,P=0,c=N.length;c>P;P+=3){var R=N[P],I=N[P+1],B=N[P+2];g>R&&(g=R),l>I&&(l=I),n>B&&(n=B),R>O&&(O=R),I>Y&&(Y=I),B>x&&(x=B)}return this.min.set(g,l,n),this.max.set(O,Y,x),this},setFromPoints:function(Z){this.makeEmpty();for(var g=0,q=Z.length;q>g;g++)this.expandByPoint(Z[g]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(C){return this.min.copy(C.min),this.max.copy(C.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(T){return this.min.min(T),this.max.max(T),this}});var cc=u.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};f.assign(cc.prototype,{set:function(R,J,x,$,A,w,p,i,W,Q,n,l,B,N,X,D){var F=this.el;return F[0]=R,F[4]=J,F[8]=x,F[12]=$,F[1]=A,F[5]=w,F[9]=p,F[13]=i,F[2]=W,F[6]=Q,F[10]=n,F[14]=l,F[3]=B,F[7]=N,F[11]=X,F[15]=D,this},clone:function(){return(new cc).fromArray(this.el)},fromArray:function(K,o){o===l&&(o=0);for(var i=this.el,$=0;16>$;$++)i[$]=K[$+o];return this},scale:function(e){var k=this.el,O=e.x,x=e.y,A=e.z;return k[0]*=O,k[4]*=x,k[8]*=A,k[1]*=O,k[5]*=x,k[9]*=A,k[2]*=O,k[6]*=x,k[10]*=A,k[3]*=O,k[7]*=x,k[11]*=A,this
},makeRotationFromEuler:function(r){var N=this.el,b=r._x,M=r._y,e=r._z,f=r._order,_=Math.cos(b),E=Math.sin(b),H=Math.cos(M),w=Math.sin(M),G=Math.cos(e),A=Math.sin(e);if("XYZ"===f){var u=_*G,J=_*A,s=E*G,h=E*A;N[0]=H*G,N[4]=-H*A,N[8]=w,N[1]=J+s*w,N[5]=u-h*w,N[9]=-E*H,N[2]=h-u*w,N[6]=s+J*w,N[10]=_*H}else if("YXZ"===f){var Q=H*G,K=H*A,L=w*G,c=w*A;N[0]=Q+c*E,N[4]=L*E-K,N[8]=_*w,N[1]=_*A,N[5]=_*G,N[9]=-E,N[2]=K*E-L,N[6]=c+Q*E,N[10]=_*H}else if("ZXY"===f){var Q=H*G,K=H*A,L=w*G,c=w*A;N[0]=Q-c*E,N[4]=-_*A,N[8]=L+K*E,N[1]=K+L*E,N[5]=_*G,N[9]=c-Q*E,N[2]=-_*w,N[6]=E,N[10]=_*H}else if("ZYX"===f){var u=_*G,J=_*A,s=E*G,h=E*A;N[0]=H*G,N[4]=s*w-J,N[8]=u*w+h,N[1]=H*A,N[5]=h*w+u,N[9]=J*w-s,N[2]=-w,N[6]=E*H,N[10]=_*H}else if("YZX"===f){var Y=_*H,n=_*w,O=E*H,P=E*w;N[0]=H*G,N[4]=P-Y*A,N[8]=O*A+n,N[1]=A,N[5]=_*G,N[9]=-E*G,N[2]=-w*G,N[6]=n*A+O,N[10]=Y-P*A}else if("XZY"===f){var Y=_*H,n=_*w,O=E*H,P=E*w;N[0]=H*G,N[4]=-A,N[8]=w*G,N[1]=Y*A+P,N[5]=_*G,N[9]=n*A-O,N[2]=O*A-n,N[6]=E*G,N[10]=P*A+Y}return N[3]=0,N[7]=0,N[11]=0,N[12]=0,N[13]=0,N[14]=0,N[15]=1,this},makeRotationFromQuaternion:function(L){var g=this.el,s=L._x,b=L._y,l=L._z,k=L._w,v=s+s,x=b+b,G=l+l,B=s*v,m=s*x,O=s*G,Y=b*x,Z=b*G,z=l*G,d=k*v,r=k*x,P=k*G;return g[0]=1-(Y+z),g[4]=m-P,g[8]=O+r,g[1]=m+P,g[5]=1-(B+z),g[9]=Z-d,g[2]=O-r,g[6]=Z+d,g[10]=1-(B+Y),g[3]=0,g[7]=0,g[11]=0,g[12]=0,g[13]=0,g[14]=0,g[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(t){var P=this.el,D=t.el,w=D[0],M=D[1],d=D[2],k=D[3],i=D[4],z=D[5],T=D[6],o=D[7],r=D[8],B=D[9],v=D[10],F=D[11],L=D[12],O=D[13],h=D[14],c=D[15],j=B*h*o-O*v*o+O*T*F-z*h*F-B*T*c+z*v*c,f=L*v*o-r*h*o-L*T*F+i*h*F+r*T*c-i*v*c,$=r*O*o-L*B*o+L*z*F-i*O*F-r*z*c+i*B*c,X=L*B*T-r*O*T-L*z*v+i*O*v+r*z*h-i*B*h,m=w*j+M*f+d*$+k*X;if(0===m)return this.identity();var y=1/m;return P[0]=j*y,P[1]=(O*v*k-B*h*k-O*d*F+M*h*F+B*d*c-M*v*c)*y,P[2]=(z*h*k-O*T*k+O*d*o-M*h*o-z*d*c+M*T*c)*y,P[3]=(B*T*k-z*v*k-B*d*o+M*v*o+z*d*F-M*T*F)*y,P[4]=f*y,P[5]=(r*h*k-L*v*k+L*d*F-w*h*F-r*d*c+w*v*c)*y,P[6]=(L*T*k-i*h*k-L*d*o+w*h*o+i*d*c-w*T*c)*y,P[7]=(i*v*k-r*T*k+r*d*o-w*v*o-i*d*F+w*T*F)*y,P[8]=$*y,P[9]=(L*B*k-r*O*k-L*M*F+w*O*F+r*M*c-w*B*c)*y,P[10]=(i*O*k-L*z*k+L*M*o-w*O*o-i*M*c+w*z*c)*y,P[11]=(r*z*k-i*B*k-r*M*o+w*B*o+i*M*F-w*z*F)*y,P[12]=X*y,P[13]=(r*O*d-L*B*d+L*M*v-w*O*v-r*M*h+w*B*h)*y,P[14]=(L*z*d-i*O*d-L*M*T+w*O*T+i*M*h-w*z*h)*y,P[15]=(i*B*d-r*z*d+r*M*T-w*B*T-i*M*v+w*z*v)*y,this},makeRotationAxis:function(m,w){var V=Math.cos(w),O=Math.sin(w),s=1-V,_=m.x,M=m.y,y=m.z,F=s*_,i=s*M;return this.set(F*_+V,F*M-O*y,F*y+O*M,0,F*M+O*y,i*M+V,i*y-O*_,0,F*y-O*M,i*y+O*_,s*y*y+V,0,0,0,0,1),this},multiply:function(O){return this.multiplyMatrices(this,O)},premultiply:function(H){return this.multiplyMatrices(H,this)},multiplyMatrices:function(j,E){var I=j.el,L=E.el,N=this.el,y=I[0],p=I[4],S=I[8],R=I[12],H=I[1],k=I[5],u=I[9],h=I[13],O=I[2],q=I[6],t=I[10],V=I[14],l=I[3],W=I[7],s=I[11],Y=I[15],C=L[0],e=L[4],m=L[8],_=L[12],r=L[1],o=L[5],F=L[9],Q=L[13],P=L[2],G=L[6],X=L[10],i=L[14],z=L[3],b=L[7],T=L[11],a=L[15];return N[0]=y*C+p*r+S*P+R*z,N[4]=y*e+p*o+S*G+R*b,N[8]=y*m+p*F+S*X+R*T,N[12]=y*_+p*Q+S*i+R*a,N[1]=H*C+k*r+u*P+h*z,N[5]=H*e+k*o+u*G+h*b,N[9]=H*m+k*F+u*X+h*T,N[13]=H*_+k*Q+u*i+h*a,N[2]=O*C+q*r+t*P+V*z,N[6]=O*e+q*o+t*G+V*b,N[10]=O*m+q*F+t*X+V*T,N[14]=O*_+q*Q+t*i+V*a,N[3]=l*C+W*r+s*P+Y*z,N[7]=l*e+W*o+s*G+Y*b,N[11]=l*m+W*F+s*X+Y*T,N[15]=l*_+W*Q+s*i+Y*a,this},lookAt:function(){var w=new tc,J=new tc,r=new tc;return function(g,q,F){var e=this.el;return r.subVectors(g,q),0===r.lengthSq()&&(r.z=1),r.normalize(),w.crossVectors(F,r),0===w.lengthSq()&&(1===Math.abs(F.z)?r.x+=1e-4:r.z+=1e-4,r.normalize(),w.crossVectors(F,r)),w.normalize(),J.crossVectors(r,w),e[0]=w.x,e[4]=J.x,e[8]=r.x,e[1]=w.y,e[5]=J.y,e[9]=r.y,e[2]=w.z,e[6]=J.z,e[10]=r.z,this}}()});var gr=u.Math.Quaternion=function(E,b,L,e){this.set(E,b,L,e)};f.assign(gr.prototype,{set:function(E,Q,m,d){var p=this;return p._x=E||0,p._y=Q||0,p._z=m||0,p._w=d!==l?d:1,p},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(d){var l=this;return l._x=d._x,l._y=d._y,l._z=d._z,l._w=d._w,l},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var P=this.length();return 0===P?(this._x=0,this._y=0,this._z=0,this._w=1):(P=1/P,this._x=this._x*P,this._y=this._y*P,this._z=this._z*P,this._w=this._w*P),this},fromArray:function(c,A){A===l&&(A=0);var W=this;return W._x=c[A],W._y=c[A+1],W._z=c[A+2],W._w=c[A+3],this},slerp:function(f,I){if(0===I)return this;if(1===I)return this.copy(f);var n=this._x,N=this._y,W=this._z,q=this._w,M=q*f._w+n*f._x+N*f._y+W*f._z;if(0>M?(this._w=-f._w,this._x=-f._x,this._y=-f._y,this._z=-f._z,M=-M):this.copy(f),M>=1)return this._w=q,this._x=n,this._y=N,this._z=W,this;var E=Math.sqrt(1-M*M);if(Math.abs(E)<.001)return this._w=.5*(q+this._w),this._x=.5*(n+this._x),this._y=.5*(N+this._y),this._z=.5*(W+this._z),this;var S=Math.atan2(E,M),Y=Math.sin((1-I)*S)/E,g=Math.sin(I*S)/E;return this._w=q*Y+this._w*g,this._x=n*Y+this._x*g,this._y=N*Y+this._y*g,this._z=W*Y+this._z*g,this},setFromAxisAngle:function(z,o){var Z=o/2,c=Math.sin(Z);return this._x=z.x*c,this._y=z.y*c,this._z=z.z*c,this._w=Math.cos(Z),this},setFromEuler:function(i){var e=i._x,m=i._y,M=i._z,d=i._order,_=Math.cos,t=Math.sin,Z=_(e/2),c=_(m/2),w=_(M/2),O=t(e/2),P=t(m/2),A=t(M/2);return"XYZ"===d?(this._x=O*c*w+Z*P*A,this._y=Z*P*w-O*c*A,this._z=Z*c*A+O*P*w,this._w=Z*c*w-O*P*A):"YXZ"===d?(this._x=O*c*w+Z*P*A,this._y=Z*P*w-O*c*A,this._z=Z*c*A-O*P*w,this._w=Z*c*w+O*P*A):"ZXY"===d?(this._x=O*c*w-Z*P*A,this._y=Z*P*w+O*c*A,this._z=Z*c*A+O*P*w,this._w=Z*c*w-O*P*A):"ZYX"===d?(this._x=O*c*w-Z*P*A,this._y=Z*P*w+O*c*A,this._z=Z*c*A-O*P*w,this._w=Z*c*w+O*P*A):"YZX"===d?(this._x=O*c*w+Z*P*A,this._y=Z*P*w+O*c*A,this._z=Z*c*A-O*P*w,this._w=Z*c*w-O*P*A):"XZY"===d&&(this._x=O*c*w-Z*P*A,this._y=Z*P*w-O*c*A,this._z=Z*c*A+O*P*w,this._w=Z*c*w+O*P*A),this},setFromToVectors:function(){var p,D;return function(L,T){return p===l&&(p=new tc),D=L.dot(T)+1,1e-7>D?(D=0,Math.abs(L.x)>Math.abs(L.z)?p.set(-L.y,L.x,0):p.set(0,-L.z,L.y)):p.crossVectors(L,T),this._x=p.x,this._y=p.y,this._z=p.z,this._w=D,this.normalize()}}()});var vs=u.Math.Triangle=function(T,M,a){this.a=T!==l?T:new tc,this.b=M!==l?M:new tc,this.c=a!==l?a:new tc};f.assign(vs,{barycoordFromPoint:function(){var Y=new tc,l=new tc,e=new tc;return function(O,X,B,w,f){Y.subVectors(w,X),l.subVectors(B,X),e.subVectors(O,X);var N=Y.dot(Y),E=Y.dot(l),T=Y.dot(e),t=l.dot(l),m=l.dot(e),x=N*t-E*E,c=f||new tc;if(0===x)return c.set(-2,-1,-1);var W=1/x,h=(t*T-E*m)*W,P=(N*m-E*T)*W;return c.set(1-h-P,P,h)}}()});var Vc=u.Math.Euler=function($,B,z,J,Z){this.set($,B,z,J,Z)};Vc.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Vc.DefaultOrder="XYZ",Vc.ReverseOrder=function(K){return K=K[2]+K[1]+K[0],K.toUpperCase()},f.defineProperties(Vc.prototype,{x:{get:function(){return this._x},set:function(Y){this._x=Y,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(b){this._y=b,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(C){this._z=C,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(j){this._order=j,this.onChangeCallback()}}}),f.assign(Vc.prototype,{set:function(r,f,B,G,i){return wc(r)&&(i=B,G=f,B=r[2],f=r[1],r=r[0]),G?i&&(G=Vc.ReverseOrder(G)):G="ZYX",this._x=r||0,this._y=f||0,this._z=B||0,this._order=G||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(k){return this._x=k._x,this._y=k._y,this._z=k._z,this._order=k._order,this.onChangeCallback(),this},setFromRotationMatrix:function(O,I,Z){var o=u.Math.clamp,R=O.el||O,b=R[0],j=R[4],n=R[8],W=R[1],q=R[5],Y=R[9],V=R[2],J=R[6],t=R[10];return I=I||this._order,"XYZ"===I?(this._y=Math.asin(o(n,-1,1)),Math.abs(n)<.99999?(this._x=Math.atan2(-Y,t),this._z=Math.atan2(-j,b)):(this._x=Math.atan2(J,q),this._z=0)):"YXZ"===I?(this._x=Math.asin(-o(Y,-1,1)),Math.abs(Y)<.99999?(this._y=Math.atan2(n,t),this._z=Math.atan2(W,q)):(this._y=Math.atan2(-V,b),this._z=0)):"ZXY"===I?(this._x=Math.asin(o(J,-1,1)),Math.abs(J)<.99999?(this._y=Math.atan2(-V,t),this._z=Math.atan2(-j,q)):(this._y=0,this._z=Math.atan2(W,b))):"ZYX"===I?(this._y=Math.asin(-o(V,-1,1)),Math.abs(V)<.99999?(this._x=Math.atan2(J,t),this._z=Math.atan2(W,b)):(this._x=0,this._z=Math.atan2(-j,q))):"YZX"===I?(this._z=Math.asin(o(W,-1,1)),Math.abs(W)<.99999?(this._x=Math.atan2(-Y,q),this._y=Math.atan2(-V,b)):(this._x=0,this._y=Math.atan2(n,t))):"XZY"===I?(this._z=Math.asin(-o(j,-1,1)),Math.abs(j)<.99999?(this._x=Math.atan2(J,q),this._y=Math.atan2(n,b)):(this._x=Math.atan2(-Y,t),this._y=0)):console.warn("unsupported order: "+I),this._order=I,Z!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var x=new cc;return function(G,k,Q){return x.makeRotationFromQuaternion(G),this.setFromRotationMatrix(x,k,Q)}}(),setFromVector3:function(f,h){return this.set(f.x,f.y,f.z,h||this._order)},reorder:function(){var J=new gr;return function(a){return J.setFromEuler(this),this.setFromQuaternion(J,a)}}(),equals:function(j){return j._x===this._x&&j._y===this._y&&j._z===this._z&&j._order===this._order},fromArray:function(_){return this._x=_[0],this._y=_[1],this._z=_[2],_[3]!==l&&(this._order=_[3]),this.onChangeCallback(),this},toArray:function(g,t){return g===l&&(g=[]),t===l&&(t=0),g[t]=this._x,g[t+1]=this._y,g[t+2]=this._z,g[t+3]=this._order,g},toVector3:function(z){return z?z.set(this._x,this._y,this._z):new tc(this._x,this._y,this._z)},onChange:function(N){return this.onChangeCallback=N,this},onChangeCallback:function(){}});var mo=u.List=function(){this._as=[];var U,X,m=arguments.length;if(1===m){var S=arguments[0];if(uf(S)&&(S=S._as),wc(S))for(X=S.length,U=0;X>U;U++)this._as.push(S[U]);else S!=h&&this._as.push(S)}else if(m>1)for(U=0;m>U;U++)this._as.push(arguments[U])};Jf("List",f,{forEach:function(I,e){this.each(I,e)},push:function(){for(var U=0;U<arguments.length;U++)this.add(arguments[U])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(q,F){return F===l?this._as.push(q):this._as.splice(F,0,q)},addAll:function(m){uf(m)&&(m=m._as),wc(m)?hn(this._as,m):this._as.push(m)},get:function(k){return this._as[k]},slice:function(S,g){return new mo(this._as.slice(S,g))},remove:function(T){var B=this._as.indexOf(T);return B>=0&&B<this._as.length&&this.removeAt(B),B},removeAt:function(z){return this._as.splice(z,1)[0]},set:function(v,I){return this._as[v]=I},clear:function(){return this._as.splice(0,this._as.length)},contains:function(T){return this._as.indexOf(T)>=0},indexOf:function(V){return this._as.indexOf(V)},each:function(M,L){for(var X=0,d=this._as.length;d>X;X++){var $=this._as[X];L?M.call(L,$,X,this):M($,X,this)}},reverseEach:function(r,M){for(var z=this._as.length-1;z>=0;z--){var R=this._as[z];M?r.call(M,R):r(R)}},toArray:function(o,c){if(o){for(var N,I=[],D=0,v=this._as.length;v>D;D++)N=this._as[D],c?o.call(c,N)&&I.push(N):o(N)&&I.push(N);return I}return this._as.concat()},toList:function(e,W){if(e){for(var T,L=new mo,z=0,U=this._as.length;U>z;z++)T=this._as[z],W?e.call(W,T)&&L.add(T):e(T)&&L.add(T);return L}return new mo(this)},reverse:function(){this._as.reverse()},sort:function(D){return this._as.sort(D?D:Ne),this},toString:function(){return this._as.toString()}}),f.defineProperties(mo.prototype,{length:{get:function(){return this._as.length},set:function(R){this._as.length=R}}});var vb=new mo;No(vb,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:fk,each:fk,reverseEach:fk,toArray:function(){return[]},toList:function(){return new mo},add:$r,addAll:$r,set:$r,remove:$r,removeAt:$r,clear:$r});var Bh=u.Notifier=function(){this._f=0};Jf("Notifier",f,{contains:function(Q,n){if(this._ls)for(var y,w=0,L=this._ls.size();L>w;w++)if(y=this._ls.get(w),Q===y.l&&n===y.s)return!0;return!1},add:function(P,A,K){var x=this,Z={l:P,s:A,a:K};x._ls||(x._ls=new mo),x._f?(x._as||(x._as=new mo),x._as.add(Z)):Z.a?x._ls.add(Z,0):x._ls.add(Z)},remove:function(w,F){var f=this;f._ls&&(f._f?(f._rs||(f._rs=new mo),f._rs.add({l:w,s:F})):f._remove(w,F))},_remove:function(H,N){for(var S,X=this._ls,W=0,R=X.size();R>W;W++)if(S=X.get(W),S.l===H&&S.s===N)return X.removeAt(W),void 0},fire:function(T){var R=this,Z=R._ls;if(R._b=1e4,Z){++R._f;try{for(var r,W=0,X=Z.size();X>W;W++)r=Z.get(W),r.s?r.l.call(r.s,T):r.l(T)}finally{if(--R._f)return;if(R._rs){for(X=R._rs.size(),W=0;X>W;W++)r=R._rs.get(W),R._remove(r.l,r.s);delete R._rs}if(R._as){for(X=R._as.size(),W=0;X>W;W++)r=R._as.get(W),r.a?Z.add(r,0):Z.add(r);delete R._as}}}}});var yh=u.Data=function(){this._id=on()};Jf("Data",f,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:h,_parent:h,_children:vb,_childMap:h,_styleMap:h,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return h},_22Q:function(){return h},s:function(T,c){var G=this;if(2===arguments.length)G.setStyle(T,c);else{if(!An(T))return G.getStyle(T);for(var z in T)G.setStyle(z,T[z])}return G},fp:function(b,Y,K,v,y){return this.firePropertyChange(b,Y,K,v,y)},firePropertyChange:function(J,P,M,B,S){if(B){if(B(P,M))return!1}else if(P===M)return!1;var s=this,L=S||{};return L.property=J,L.oldValue=P,L.newValue=M,L.data=s,s._dataModel&&s._dataModel.handleDataPropertyChange(L),s.onPropertyChanged(L),!0},onPropertyChanged:function(S){var R=this,C=R._parent,K=S.property;if(xq(C)){var k=R.s(so),z="s:ingroup"===K;(k&&of[K]||K===z)&&C._81I(),(k||z)&&C.fp("childChange",!0,!1)}hf(C)&&of[K]&&C.updateFromChildren()},_21I:function(w){var i=this;if(w&&i._dataModel)throw"Remove data from dataModel before adding";i._dataModel=w},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var W=0,X=this._children.toArray(),M=X.length;M>W;W++)X[W].removeFromDataModel()},getId:function(){return this._id},setId:function(q){this._id=q},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(i,a){return this._children.toList(i,a)},eachChild:function(g,k){this._children.each(g,k)},addChild:function(r,B){var q=this;r!==q&&(q._children===vb&&(q._children=new mo,q._childMap={}),B>=0||(B=q._children.size()),q._childMap[r._id]||q.isDescendantOf(r)||(r._parent&&r._parent.removeChild(r),(0>B||B>q._children.size())&&(B=q._children.size()),q._children.add(r,B),q._childMap[r._id]=r,r.setParent(q),q.onChildAdded(r,B),q.fp(bg,h,r)))},onChildAdded:function(){},removeChild:function(l){var w=this;if(w._childMap&&w._childMap[l._id]){var e=w._children.remove(l);delete w._childMap[l._id],w.fp(bg,l,h),l.setParent(h,e),w.onChildRemoved(l,e)}},onChildRemoved:function(){},getChildAt:function(z){return this._children.get(z)},clearChildren:function(){var n=this;if(!n._children.isEmpty())for(var e=0,A=n._children.toArray(),Z=A.length;Z>e;e++)n.removeChild(A[e])},getParent:function(){return this._parent},setParent:function(x,J){var t=this;if(!(t._73I||t._parent===x||t===x||x&&x.isDescendantOf(t))){var Z,e=t._parent;t._parent=x,t._73I=1,e?(J==h&&(J=e.getChildren().indexOf(t)),e.removeChild(t)):t._dataModel&&J==h&&(J=t._dataModel.getRoots().indexOf(t)),x&&(x.addChild(t),Z=x.getChildren().indexOf(t)),delete t._73I,t.fp("parent",e,x,l,{oldIndex:J,newIndex:Z}),t.onParentChanged(e,x)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(E){return E?this.isDescendantOf(E)||E.isDescendantOf(this):!1},isParentOf:function(Q){return Q&&this._childMap?!!this._childMap[Q._id]:!1},isDescendantOf:function(g){if(!g||g.isEmpty())return!1;for(var O=this._parent;O;){if(g===O)return!0;O=O._parent}return!1},getStyle:function($,B){B===l&&(B=1);var S=this._styleMap?this._styleMap[$]:l;return S===l&&B?O[$]:S},setStyle:function(W,X){var n=this;n._styleMap||(n._styleMap={});var i=n._styleMap[W];X===l?delete n._styleMap[W]:n._styleMap[W]=X,n.fp("s:"+W,i,X)&&n.onStyleChanged(W,i,X)},onStyleChanged:function(){},iv:function(e){this.invalidate(e)},invalidate:function(K){this.fp(K||"*",!1,!0)},toString:function(){var W=this;return W._displayName||W._name||W._tag||W._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(U,d){var j=this,$=j.s(jo);$||j.s(jo,$={}),d?$[U]=d:delete $[U],j.fp(jo,h,$)},removeStyleIcon:function(d){var b=this.s(jo);if(b){var P=b[d];delete b[d],this.fp(jo,h,b)}return P},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var b,T={};for(b in this._styleMap)T[b]=1;return T}});var Hh=u.DataModel=function(){var g=this;g._datas=new mo,g._dataMap={},g._roots=new mo,g._rootMap={},g._fsDataMap={},g._78O={},g._36I=new Bh,g._35I=new Bh,g._serializeNotifier=new Bh,g._selectionModel=new zs(g);var Y=g._29Q=[],W=g._scheduleCallback=function(){for(var D=Date.now(),i=0;i<Y.length;i++){var w=Y[i];w.enabled&&D-w.lastTime>w.interval&&(w.beforeAction&&w.beforeAction(),g.each(function(F){w.action(F)}),w.afterAction&&w.afterAction(),w.lastTime=D)}Y.length&&(g._30Q=G.requestAnimationFrame(W))}};Jf("DataModel",f,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:l,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:l,_init:l,_envmap:l,_postProcessingData:l,sm:function(){return this.getSelectionModel()},mm:function(p,w,V){this.addDataModelChangeListener(p,w,V)},umm:function(m,f){this.removeDataModelChangeListener(m,f)},md:function($,H,J){this.addDataPropertyChangeListener($,H,J)},umd:function(Y,K){this.removeDataPropertyChangeListener(Y,K)},mh:function(q,o,N){this.addHierarchyChangeListener(q,o,N)},umh:function(R,G){this.removeHierarchyChangeListener(R,G)},getAttrObject:function(){return this._attrObject},setAttrObject:function(H){return this._attrObject=H},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getDataById:function(r){return this._dataMap[r]},removeDataById:function(M){this.remove(this.getDataById(M))},toDatas:function(n,B){return this._datas.toList(n,B)},each:function(q,y){this._datas.each(q,y)},getDataByTag:function(P){return this._78O[P]},getTagMap:function(){return this._78O},removeDataByTag:function(E){this.remove(this.getDataByTag(E))},add:function(m,t,H){var W=this,U=m._id,L=m._tag,_=W._roots;if(W._dataMap[U])throw"'"+U+"' already exists";L!=h&&(W._78O[L]=m),W._dataMap[U]=m,H>=0?W._datas.add(m,H):W._datas.add(m),m._parent||(W._rootMap[U]=m,t>=0?_.add(m,t):_.add(m)),m.s("fullscreen")!==l&&(W._fsDataMap[U]=m),m._21I(W),W.onAdded(m),W._36I.fire({kind:"add",data:m,rootsIndex:t,datasIndex:H})},onAdded:function(){},remove:function(I,E){if(I){var v=this,W=I._id,B=E&&E.keepStructure,Z=E&&E.keepChildren,P=I.getTag();if(I._dataModel===v){this.beginTransaction(),B?v._removingData||(v._removingData=I):v.prepareRemove(I),Z||I.toChildren().each(function(D){v.remove(D,E)},v),B?v._removingData===I&&(I._parent&&I._parent.removeChild(I),delete v._removingData):I._parent&&I._parent.removeChild(I);var g=v._datas.remove(I);delete v._dataMap[W],P!=h&&delete v._78O[P];var R;v._rootMap[W]&&(delete v._rootMap[W],R=v._roots.remove(I)),v._fsDataMap[W]&&delete v._fsDataMap[W],I._21I(h),v.onRemoved(I),v._36I.fire({kind:Yr,data:I,rootsIndex:R,datasIndex:g}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var K=this;if(K._datas.size()){var W=K._historyManager?this.toJSON():l;K._datas.toArray().forEach(function(Z){Z._21I(h)}),K._datas.clear(),K._dataMap={},K._roots.clear(),K._rootMap={},K._fsDataMap={},K._78O={},K._36I.fire({kind:cn,json:W})}},contains:function(w){return w&&w._dataModel===this},handleDataPropertyChange:function(s){var K=this,i=s.data,M=s.property;if("parent"===M){var b=i._id,N=K._rootMap,g=K._roots;i._parent?N[b]&&(delete N[b],g.remove(i)):N[b]||(N[b]=i,g.add(i))}else if("tag"===M){var e=s.oldValue,T=s.newValue,a=K._78O;e!=h&&delete a[e],T!=h&&(a[T]=i)}else if("s:fullscreen"===M){var b=i._id,t=K._fsDataMap;s.oldValue!=h&&delete t[b],s.newValue!=h&&(t[b]=i)}this.onDataPropertyChanged(i,s),this._35I.fire(s)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(T,F,p){this._36I.add(T,F,p)},removeDataModelChangeListener:function($,o){this._36I.remove($,o)},addSerializeListener:function(Q,o,s){this._serializeNotifier.add(Q,o,s)},removeSerializeListener:function(L,e){this._serializeNotifier.remove(L,e)},fireSerializeEvent:function(x){this._serializeNotifier.fire(x)},addDataPropertyChangeListener:function(e,x,n){this._35I.add(e,x,n)},removeDataPropertyChangeListener:function(T,j){this._35I.remove(T,j)},_38I:function($,O,N){this._37I&&this._37I.fire({data:$,oldIndex:O,newIndex:N})},addHierarchyChangeListener:function(r,X,R){this._37I||(this._37I=new Bh),this._37I.add(r,X,R)},removeHierarchyChangeListener:function(f,I){this._37I.remove(f,I)},getSiblings:function(k){var h=k._parent;return h?h._children:this._roots},eachByHierarchical:function(B,Z,q){if(Z)return this._eachByHierarchical(B,Z,q);for(var J=0,_=this._roots,A=_.size();A>J;J++)if(this._eachByHierarchical(B,_.get(J),q)===!1)return!1;return!0},_eachByHierarchical:function(x,n,O){if(O){if(x.call(O,n)===!1)return!1}else if(x(n)===!1)return!1;for(var a=n.size(),r=0;a>r;r++)if(this._eachByHierarchical(x,n.getChildAt(r),O)===!1)return!1;return!0},reverseEachByHierarchical:function(O,I,n){if(I)return this._reverseEachByHierarchical(O,I,n);for(var q=this._roots,o=q.size(),w=o-1;w>=0;w--)if(this._reverseEachByHierarchical(O,q.get(w),n)===!1)return!1;return!0},_reverseEachByHierarchical:function(U,E,J){for(var o=E.size(),G=o-1;G>=0;G--)if(this._reverseEachByHierarchical(U,E.getChildAt(G),J)===!1)return!1;if(J){if(U.call(J,E)===!1)return!1}else if(U(E)===!1)return!1;return!0},eachByDepthFirst:function(M,G,C){if(G)return this._11I(M,G,C);for(var l=0,f=this._roots,O=f.size();O>l;l++)if(this._11I(M,f.get(l),C)===!1)return!1;return!0},_11I:function(A,k,q){for(var Y=k.size(),u=0;Y>u;u++)if(this._11I(A,k.getChildAt(u),q)===!1)return!1;if(q){if(A.call(q,k)===!1)return!1}else if(A(k)===!1)return!1;return!0},eachByBreadthFirst:function(T,p,X){var w=new mo;for(p?w.add(p):this._roots.each(w.add,w);w.size()>0;)if(p=w.removeAt(0),p.eachChild(w.add,w),X){if(T.call(X,p)===!1)return!1}else if(T(p)===!1)return!1;return!0},moveTo:function(q,v){var R=this.getSiblings(q),M=R.indexOf(q);M===v||0>M||v>=0&&v<=R.size()&&(R.remove(q),v>R.size()&&v--,R.add(q,v),this._38I(q,M,v))},moveUp:function(Y){this.moveTo(Y,this.getSiblings(Y).indexOf(Y)-1)},moveDown:function(e){this.moveTo(e,this.getSiblings(e).indexOf(e)+1)},moveToTop:function(B){this.moveTo(B,0)},moveToBottom:function(y){this.moveTo(y,this.getSiblings(y).size())},moveSelectionUp:function(W){this.beginTransaction(),W||(W=this.sm());var d=new mo;hg(W,d,this._roots),d.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(w){this.beginTransaction(),w||(w=this.sm());var p=new mo;Bq(w,p,this._roots),p.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(y){this.beginTransaction(),y||(y=this.sm());var D=new mo;Ti(y,D,this._roots),D.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(W){this.beginTransaction(),W||(W=this.sm());var _=new mo;En(W,_,this._roots),_.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(s,q,t){var d=this.getDatas();null==t&&(t=d.indexOf(s)),t===q||0>t||q>=0&&q<=d.size()&&(d.remove(s),q>d.size()&&q--,d.add(s,q),this._76I(s,t,q))},bringForward:function(G){this.moveToIndex(G,this.getDatas().indexOf(G)+1)},bringToFront:function(n){this.moveToIndex(n,this.size())},sendBackward:function(r){this.moveToIndex(r,this.getDatas().indexOf(r)-1)},sendToBack:function(b){this.moveToIndex(b,0)},bringSelectionForward:function(L){this.beginTransaction(),L||(L=this.sm());for(var O=new mo,E=this.getDatas(),y=!1,z=0;z<E.size();z++){var X=E.get(E.size()-1-z);L.contains(X)?y&&O.add(X):y=!0}O.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(w){this.beginTransaction(),w||(w=this.sm());for(var R=new mo,g=this.getDatas(),G=0;G<g.size();G++){var W=g.get(G);w.contains(W)&&R.add(W)}R.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(d){this.beginTransaction(),d||(d=this.sm());for(var R=new mo,S=this.getDatas(),P=!1,a=0;a<S.size();a++){var O=S.get(a);d.contains(O)?P&&R.add(O):P=!0}R.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(i){this.beginTransaction(),i||(i=this.sm());for(var b=new mo,A=this.getDatas(),Q=0;Q<A.size();Q++){var z=A.get(A.size()-1-Q);i.contains(z)&&b.add(z)}b.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(U){var V=this;V.removeScheduleTask(U),U.enabled==h&&(U.enabled=!0),U.interval==h&&(U.interval=10),U.action==h&&(U.action=fk),U.lastTime=Date.now(),V._29Q.push(U),V._30Q==h&&(V._30Q=G.requestAnimationFrame(V._scheduleCallback))},removeScheduleTask:function(m){var R=this,F=R._29Q,N=F.indexOf(m);N>=0&&F.splice(N,1),F.length||R._30Q==h||(G.cancelAnimationFrame(R._30Q),delete R._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(z){this._historyManager||new u.HistoryManager(this),null!=z&&this._historyManager.setMaxHistoryCount(z),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(t){this._historyManager&&this._historyManager.undo(t)},redo:function(F){this._historyManager&&this._historyManager.redo(F)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(m){this._historyManager&&this._historyManager.addHistory(m)},onHistoryManagerChanged:function(){}});var zs=u.SelectionModel=function(d){var f=this;f._68O=Mj,f._map={},f._73O=new mo,f._74I=new Bh,f._21I(d)};Jf("SelectionModel",f,{ms_fire:1,ms_dm:1,ms:function(R,V,d){this.addSelectionChangeListener(R,V,d)},ums:function(l,v){this.removeSelectionChangeListener(l,v)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===mh},co:function($){return this._map[$._id]!=h},ss:function(V){this.setSelection(V)},as:function(A){this.appendSelection(A)},rs:function(V){this.removeSelection(V)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(f){var h=this;if(h._68O!==f&&(f===Il||f===mh||f===Mj)){h.cs();var i=h._68O;h._68O=f,h.fp("selectionMode",i,f)}},_21I:function(P){var V=this,v=V._dataModel;v!==P&&(v&&(V.cs(),v.umm(V.handleDataModelChange,V)),V._dataModel=P,P.mm(V.handleDataModelChange,V,!0),V.fp($e,v,P))},dispose:function(){var U=this;U.cs(),U._dataModel.umm(U.handleDataModelChange,U)},handleDataModelChange:function(c){var k=this;if(c.kind===Yr){var $=c.data;k.co($)&&(k._73O.remove($),delete k._map[$._id],k._75I(Yr,new mo($)))}else c.kind===cn&&k.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(F){var L=this;if(L._filterFunc!==F){L.cs();var W=L._filterFunc;L._filterFunc=F,L.fp("filterFunc",W,L._filterFunc)}},_75I:function(Q,w,Y,I){Y&&(this._73O.each(function(Q){I[Q._id]?Y.remove(Q):Y.add(Q)}),w=Y.toList()),this._74I.fire({kind:Q,datas:new mo(w)})},addSelectionChangeListener:function(Z,S,m){this._74I.add(Z,S,m)},removeSelectionChangeListener:function(S,k){this._74I.remove(S,k)},_97O:function(R,Q){for(var V,P=this,O=0,o=new mo(R);O<o.size();O++)V=o.get(O),(P._filterFunc&&!P._filterFunc(V)||Q&&P.co(V)||!Q&&!P.co(V)||!P._dataModel.contains(V))&&(o.removeAt(O),O--);return o},appendSelection:function(a){var C=this;if(C._68O!==Il){var r,I,x=C._73O,v=C._97O(a,!0);v.isEmpty()||(C.sg()&&(r=new mo(x),I=C._map,x.clear(),C._map={},v=new mo(v.get(v.size()-1))),v.each(function(r){x.add(r),C._map[r._id]=r}),C._75I("append",v,r,I))}},removeSelection:function(p){var b=this,e=b._97O(p),Q=0,Y=e.size();if(0!==Y){for(;Y>Q;Q++){var V=e.get(Q);b._73O.remove(V),delete b._map[V._id]}b._75I(Yr,e)}},toSelection:function(Z,Q){return this._73O.toList(Z,Q)},getSelection:function(){return this._73O},each:function(R,B){this._73O.each(R,B)},setSelection:function(d){var T=this,A=T._73O;if(T._68O!==Il&&!(A.isEmpty()&&!d||1===A.size()&&T.ld()===d)){var N=new mo(A),U=T._map;A.clear(),T._map={};var i=T._97O(d,!0);T.sg()&&i.size()>1&&(i=new mo(i.get(i.size()-1))),i.each(function(s){A.add(s),T._map[s._id]=s}),T._75I("set",h,N,U)}},clearSelection:function(){var C=this,c=C._73O;if(c.size()>0){var U=c.toList();c.clear(),C._map={},C._75I(cn,U)}},selectAll:function(){var C=this;if(C._68O!==Il){var j,H,K=C._dataModel.toDatas();if(C._filterFunc)for(j=0;j<K.size();j++)H=K.get(j),C._filterFunc(H)||(K.removeAt(j),j--);var R=C._73O,m=new mo(R),I=C._map;R.clear(),C._map={},C.sg()&&K.size()>1&&(K=new mo(K.get(K.size()-1)));var Y=K.size();for(j=0;Y>j;j++)H=K.get(j),R.add(H),C._map[H._id]=H;C._75I("all",h,m,I)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(Q){return this._map[Q._id]!=h},getLastData:function(){var T=this._73O;return T.size()>0?T.get(T.size()-1):h},getFirstData:function(){var t=this._73O;return t.size()>0?t.get(0):h},isSelectable:function(e){var h=this;return e&&h._68O!==Il?h._filterFunc?h._filterFunc(e):!0:!1},getTopSelection:function(){var M=this,K=new mo;return M._73O.each(function(X){for(var C=X.getParent();C;){if(M.contains(C)){X=h;break}C=C.parent}X&&K.add(X)}),K}});var He=function(){return gf(0),function(x,I){var $;if(rd(I)){var n=x.getDataUI(I);n&&n._88I&&($=n._88I.rect)}return $?$:I.getRect()}}();No(C,{edgeGroupAgentFunc:h,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:T.rectSelectBorder,graphViewRectSelectBackground:Kl,graphViewEditPointSize:Sl?17:7,graphViewEditPointBorderColor:T.editPointBorder,graphViewEditPointBackground:T.editPointBackground,setEdgeType:function(s,Z,v){zb[s]=Z,Ig[s]=v},getEdgeType:function(S){return zb[S]},getEdgeTypeMap:function(){return zb},getNodeRect:He},!0),No(O,{"layout.h":l,"layout.v":l,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":l,interactive:!1,"image.stretch":"fill",icons:l,ingroup:!0,"body.color":l,"2d.gray":!1,fullscreen:l,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:l,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":mi,"select.width":1,"select.padding":2,"select.type":ue,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":l,"border.width":2,"border.padding":2,"border.type":ue,label:l,"label.font":l,"label.color":le,"label.background":l,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":l,"label.max":l,"label.opacity":l,"label.scale":1,"label.align":l,"label.selectable":!0,label2:l,"label2.font":l,"label2.color":le,"label2.background":l,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":l,"label2.max":l,"label2.opacity":l,"label2.scale":1,"label2.align":l,"label2.selectable":!0,note:l,"note.expanded":!0,"note.font":l,"note.color":Ik,"note.background":mi,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":l,"note.toggleable":!0,"note.border.width":1,"note.border.color":l,"note.opacity":l,"note.scale":1,"note.align":l,note2:l,"note2.expanded":!0,"note2.font":l,"note2.color":Ik,"note2.background":mi,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":l,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":l,"note2.opacity":l,"note2.scale":1,"note2.align":l,"group.type":l,"group.image":l,"group.image.stretch":"fill","group.repeat.image":l,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":l,"group.title.color":Ik,"group.title.background":T.groupTitleBackground,"group.title.align":nh,"group.title.orientation":mj,"group.background":T.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":l,"group.border.color":qq,"group.border.radius":0,"group.border.cap":Ce,"group.border.join":Tj,"group.splitLine":!1,"group.gradient":h,"group.gradient.color":"#FFF",shape:l,"shape.background":qq,"shape.repeat.image":l,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":qq,"shape.border.3d":!1,"shape.border.3d.color":l,"shape.border.3d.accuracy":l,"shape.border.cap":Ce,"shape.border.join":Tj,"shape.border.pattern":l,"shape.gradient":h,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Io,"shape.dash.offset":0,"shape.dash.color":kk,"shape.dash.width":l,"shape.dash.3d":!1,"shape.dash.3d.color":l,"shape.dash.3d.accuracy":l,"shape.polygon.side":6,"shape.arc.from":b,"shape.arc.to":x,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":l,"shape.gradient.pack":l,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":l,"shape.foreground.gradient":h,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":l,"autolayout.hgap":l,"autolayout.vgap":l,"edge.type":l,"edge.points":l,"edge.segments":l,"edge.color":qq,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":l,"edge.3d.accuracy":l,"edge.cap":Ce,"edge.join":Tj,"edge.source.position":17,"edge.source.anchor.x":l,"edge.source.anchor.y":l,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":l,"edge.target.anchor.y":l,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":l,"edge.dash":!1,"edge.dash.pattern":Io,"edge.dash.offset":0,"edge.dash.color":kk,"edge.dash.width":l,"edge.dash.3d":!1,"edge.dash.3d.color":l,"edge.dash.3d.accuracy":l,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":l,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":l,"grid.column.percents":l,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":T.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":T.gridCellBorderColor,"grid.block":l,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":T.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":le,"text.font":Db,"text.shadow":!1,"text.shadow.color":mi,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1},!0),No(Hh,{_76I:function(U,V,$){this._39I&&this._39I.fire({data:U,oldIndex:V,newIndex:$})
},addIndexChangeListener:function(R,w,L){var N=this;N._39I||(N._39I=new Bh),N._39I.add(R,w,L)},removeIndexChangeListener:function(f,P){this._39I.remove(f,P)},prepareRemove:function(D){Jl(D)&&(D.setSource(h),D.setTarget(h)),D._70O&&D._70O.toList().each(this.remove,this),D._69O&&D._69O.toList().each(function(v){v.setHost(h)}),D._host&&D.setHost(h)},onAdded:function(k){this.isAutoAdjustIndex()&&this.adjustIndex(k)},onDataPropertyChanged:function(q,M){Hc[M.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(q)},isAdjustable:function(g){return bh(g)||Jl(g)},isAdjustedToBottom:function(v){return xq(v)?v.isExpanded()&&Nr(v):!1},adjustIndex:function(T){var g=this;this.isHierarchicalRendering()||(g.isAdjustedToBottom(T)?(g.sendToBottom(T),T.eachChild(g.adjustIndex,g)):g.sendToTop(T))},sendToTop:function(q){var S=this;if(S.contains(q)&&S.isAdjustable(q)){var g=S._datas;if(q!==g.get(S.size()-1)){var C=g.indexOf(q);g.removeAt(C),g.add(q),S._76I(q,C,S.size()-1)}if(Jl(q)){var F=q._40I;F&&!S.isAdjustedToBottom(F)&&S.sendToTop(F),F=q._41I,F&&!S.isAdjustedToBottom(F)&&S.sendToTop(F)}q._69O&&q._69O.each(function(G){G.isRelatedTo(q)||bh(q)&&G.isLoopedHostOn(q)||S.sendToTop(G)}),q.ISubGraph||(!xq(q)||q.isExpanded())&&q._adjustChildrenToTop&&q.eachChild(function(a){Jl(a)||S.sendToTop(a)})}},sendToBottom:function(F,L){var t=this;if(F!==L&&t.contains(F)&&t.isAdjustable(F)&&(!L||t.contains(L))){var $=t._datas,d=$.remove(F),S=L?t._datas.indexOf(L):0;if($.add(F,S),d!==S){t._76I(F,d,S);var O=F._parent;!O||O.ISubGraph||Jl(O)||t.sendToBottom(F._parent,F)}}}}),No(Cg,{ms_edit:function(S){S._46O=function(O){var h=this,s=h.gv.dm(),N=h._index,H=h._89I,m=h._node,I=h._shape,e=h._edge,z=h._77I;m&&H?(this.fi({kind:"endEditRect",event:O,data:m,direction:H}),s.endTransaction()):I&&N>=0?(h.fi({kind:"endEditPoint",event:O,data:I,index:N}),s.endTransaction()):e&&N>=0?(h.fi({kind:"endEditPoint",event:O,data:e,index:N}),s.endTransaction()):z&&(h.fi({kind:"endEditRotation",event:O,data:z}),s.endTransaction())},S._78I=function(Z){var q=this;q.autoScroll(Z);var D=q.gv.lp(Z),o=q._index,Y=q._89I,W=q._node,S=q._shape,B=q._edge,j=q._77I;if(W&&Y)q._80O(D),q.fi({kind:"betweenEditRect",event:Z,data:W,direction:Y});else if(S&&o>=0)D.e=S.getPoints().get(o).e,S.setPoint(o,D),q.fi({kind:"betweenEditPoint",event:Z,data:S,index:o});else if(B&&o>=0){var T=B.s(Qn);D.e=T.get(o).e,T.set(o,D),B.fp(Qn,h,T),q.fi({kind:"betweenEditPoint",event:Z,data:B,index:o})}else if(j){var O=j.p(),$=j.getScale(),n=g+i(D.y-O.y,D.x-O.x);$.y<0&&(n+=b),r(n)<.04&&(n=0),j.setRotation(n),q.fi({kind:"betweenEditRotation",event:Z,data:j})}},S._80O=function(r){var O=this,J=O._node,o=O._rect,y=o.x,w=o.y,v=o.width,H=o.height,q=O._89I,F=O._anchor,B=O._matrix,r=B.tfi(r);"northwest"===q?o=Vn(r,{x:y+v,y:w+H}):q===Up?o=Vn({x:y,y:r.y},{x:y+v,y:w+H}):"northeast"===q?o=Vn({x:y,y:r.y},{x:r.x,y:w+H}):q===Dl?o=Vn({x:r.x,y:w},{x:y+v,y:w+H}):q===Lb?o=Vn({x:y,y:w},{x:r.x,y:w+H}):"southwest"===q?o=Vn({x:r.x,y:w},{x:y+v,y:r.y}):"south"===q?o=Vn({x:y,y:w},{x:y+v,y:r.y}):"southeast"===q&&(o=Vn({x:y,y:w},r)),J.setPosition(B.tf(o.x+o.width*F.x,o.y+o.height*F.y)),J.setWidth(o.width),J.setHeight(o.height)},S._80I=function(K,G,M,F){var o=this,m=o.gv._zoom,H=(o.gv.getEditPointSize()+2)/m;return bf({x:G-H/2,y:M-H/2,width:H,height:H},K)?(o._89I!==F&&(o._89I=F),!0):!1},S._79I=function(f,c,G){var u=this,P=u.gv,X=c?P.getDataUI(c):h,r=X?X._55O:h;if(r){var R,j,q,J,C=P._zoom,N=(P.getEditPointSize()+2)/C,Q=P.lp(f);if(bh(c)){if(r._56O&&bh(c)&&(j=r._98o,bf({x:j.x-N/2,y:j.y-N/2,width:N,height:N},Q)))return u._77I=c,G&&u.fi({kind:"beginEditRotation",event:f,data:c}),u.setCursor("crosshair"),!0;if(r._43O&&c instanceof ad)for(q=c.getPoints(),R=q.size()-1;R>=0;R--)if(j=q.get(R),bf({x:j.x-N/2,y:j.y-N/2,width:N,height:N},Q))return u._index=R,u._shape=c,G&&u.fi({kind:"beginEditPoint",event:f,data:c,index:R}),u.setCursor("crosshair"),!0;if(r._42O)for(var p=c.getEditControlPoints(),m=["northwest",-1,-1,Dl,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,Lb,1,0,"northeast",1,-1,Up,0,-1],R=0,J=p.length;J>R;R++){var F=m[3*R],D=p[R];if(u._80I(Q,D.x,D.y,F)){u._node=c;var M=c.getWidth(),S=c.getHeight(),v=c.getAnchor();u._rect={x:-M*v.x,y:-S*v.y,width:M,height:S},u._anchor=v,u._matrix=c.getMatrix();var o=c.getRotation(),V=z(o),i=K(o),L=m[3*R+1]*Dn(c.getScale().x),U=m[3*R+2]*Dn(c.getScale().y),$=Math.atan2(-i*L-V*U,V*L-i*U),k=(Math.round($/(Math.PI/4))+8)%8,d=[Fr,"nesw-resize",Cl,"nwse-resize",Fr,"nesw-resize",Cl,"nwse-resize"][k];return u.setCursor(d),G&&u.fi({kind:"beginEditRect",event:f,data:c,direction:u._89I}),!0}}}if(r._43O&&Jl(c)&&c.s(Nj)===_c&&(q=c.s(Qn)))for(R=q.size()-1;R>=0;R--)if(j=q.get(R),bf({x:j.x-N/2,y:j.y-N/2,width:N,height:N},Q))return u._index=R,u._edge=c,G&&u.fi({kind:"beginEditPoint",event:f,data:c,index:R}),u.setCursor("crosshair"),!0}return!1}},ms_gv:function(M){M._currentSubGraph=h,M._fpsInfo={time:0,fps:0,frames:0},M.upSubGraph=function(){this.setCurrentSubGraph(Hg(this._currentSubGraph))},M.isVisible=function(n){var e=this;if(Hg(n)!==e._currentSubGraph)return!1;if(Jl(n)){var z=n._40I,H=n._41I;if(!z||!H)return!1;if(!(n.s("edge.independent")||e.isVisible(z)&&e.isVisible(H)))return!1;if(n.isEdgeGroupHidden())return!1}else for(var m=n._parent;m&&!m.ISubGraph;){if(xq(m)&&(!m.isExpanded()||!e.isVisible(m)))return!1;m=m._parent}if(n._parent instanceof _e&&!e.isVisible(n._parent))return!1;if(n._refGraph instanceof Mo&&!e.isVisible(n._refGraph))return!1;if(e instanceof Ph){if(!n.s("3d.visible"))return!1}else{var x=e.getLayersInfo();if(x){var K=x[n._layer];if(K&&K.visible===!1)return!1}if(!n.s("2d.visible"))return!1}return e._visibleFunc?e._visibleFunc(n):!0},M.handleSelectionChange=function(d){var D=this;d.datas.each(function(L){D.invalidateData(L);var d=L._parent;xq(d)&&bh(L)&&L.s(so)&&(D.invalidateData(d),d._49I&&d._49I.each(function(M){D.invalidateData(M)}))}),D.onSelectionChanged(d)},M.onSelectionChanged=function(g){var Z=this,B=Z.sm();if(1===B.size()&&("set"===g.kind||"append"===g.kind)){var h=B.ld();Z.isAutoMakeVisible()&&Z.makeVisible(h),Z.adjustIndex&&Z._dataModel.isAutoAdjustIndex()&&Z.adjustIndex(h)}},M.makeVisible=function(n){if(n){var $=this,d=$.getDataUI?$.getDataUI(n):$.getData3dUI(n);if(d){var J=n,e=Hg(n);for(e!==$._currentSubGraph&&$.setCurrentSubGraph(e);(J=J._parent)&&J!==e;)xq(J)&&J.setExpanded(!0);$._23I=n,$.iv()}}},M.getLabel=function(s){var c=s.getStyle(zk);return c===l?s.getName():c},M.getLabelBackground=function(U){return U.getStyle("label.background")},M.getLabelColor=function(i){return i.getStyle("label.color")},M.getLabel2=function(p){return p.getStyle("label2")},M.getLabel2Background=function(e){return e.getStyle("label2.background")},M.getLabel2Color=function(I){return I.getStyle("label2.color")},M.getNote=function(i){return i.getStyle(ve)},M.getNoteBackground=function(w){return w.getStyle("note.background")},M.getNote2=function(x){return x.getStyle(en)},M.getNote2Background=function(l){return l.getStyle("note2.background")},M.handleClick=function(G,F,p){var v=this;F?(v.fi({kind:"clickData",event:G,data:F,part:p}),v.onDataClicked(F,G)):(v.fi({kind:"clickBackground",event:G}),v.onBackgroundClicked(G))},M.handleDoubleClick=function(i,S,V){var R=this;ci(i)&&(S?(R.fi({kind:"doubleClickData",event:i,data:S,part:V}),R.onDataDoubleClicked(S,i,V),R.checkDoubleClickOnNote(i,S,V)||R.checkDoubleClickOnRotation&&R.checkDoubleClickOnRotation(i,S,V)||(Jl(S)?R.onEdgeDoubleClicked(S,i,V):S.ISubGraph?R.onSubGraphDoubleClicked(S,i,V):xq(S)?R.onGroupDoubleClicked(S,i,V):S.IDoorWindow?R.onDoorWindowDoubleClicked(S,i,V):S.ICSGBox&&R.onCSGBoxDoubleClicked(S,i,V))):(R.fi({kind:"doubleClickBackground",event:i}),R.onBackgroundDoubleClicked(i)))},M.onSubGraphDoubleClicked=function(j){this.setCurrentSubGraph(j)},M.onEdgeDoubleClicked=function(l,N){l.ISubGraph&&!lk(N)?this.setCurrentSubGraph(l):l.s("edge.toggleable")&&l.toggle()},M.onGroupDoubleClicked=function(Q){Q.s("group.toggleable")&&Q.toggle()},M.onDoorWindowDoubleClicked=function(w){w.s("dw.toggleable")&&w.toggle(!0)},M.onCSGBoxDoubleClicked=function(x,A){var O=this;if(O instanceof Ph){var W=O.getHitFaceInfo(A);W&&W.face&&x.s(W.face+".toggleable")&&x.toggleFace(W.face,!0)}},M.onBackgroundClicked=function(){},M.onBackgroundDoubleClicked=function(){this.upSubGraph()},M.onDataClicked=function(){},M.onDataDoubleClicked=function(){},M.onAutoLayoutEnded=function(){},M.onMoveEnded=function(){},M.onPanEnded=function(){},M.onPinchEnded=function(){},M.onRectSelectEnded=function(){},M.onZoomEnded=function(){},M.serialize=function(s){return this.dm().serialize(s)},M.toJSON=function(){return this.dm().toJSON()},M.deserialize=function(W,A){var a=this;A=A instanceof yh?{rootParent:A}:Yg(A)?{setId:A}:Pj(A)?{finishFunc:A}:A||{},A.view=a;var C=a.dm(),_=A.finishFunc;return A.finishFunc=function(){_&&_.apply(A,arguments),Yg(C.a("zoomable"))&&a.setZoomable&&a.setZoomable(C.a("zoomable")),Yg(C.a("pannable"))&&a.setPannable&&a.setPannable(C.a("pannable")),Yg(C.a("rectSelectable"))&&a.setRectSelectable&&a.setRectSelectable(C.a("rectSelectable")),C.a("fitContent")===!0&&a.fitContent&&a.fitContent(!0,0)},C.deserialize(W,A.rootParent,A)},M.showDebugTip=function(){var X=this,h=X._debugDiv;if(!h){h=X._debugDiv=w.createElement("div"),h.style.position="absolute",h.style.overflow="hidden",h.style.backgroundColor="white",h.style.color="black";var n=X.getView();X._79O?n.insertBefore(h,X._79O):n.appendChild(h);var y=function(){X.redraw();var N="FPS : "+X._fpsInfo.fps+"<br/>"+"Datas : "+X.dm().getDatas().length,T=X.getDebugTip();T&&(N+="<br/>------<br/>"+T),h.innerHTML=N,X._isDebugging&&requestAnimationFrame(y)};requestAnimationFrame(y),X._isDebugging=!0}},M.hideDebugTip=function(){var s=this,K=s._debugDiv;K&&(delete s._debugDiv,s.getView().removeChild(K),s._isDebugging=!1)},M.countFrame=function(){if(this._isDebugging){var W=Date.now(),w=this._fpsInfo;W-w.time>1e3?(w.fps=Math.round(1e5*(w.frames+1)/(W-w.time))/100,w.time=W,w.frames=0):w.frames++}}},ms_icons:function(k){k.getRotation=function(V){return V==h?0:V},k._15O=function(){var x=this,s=x.s(jo);if(s){var o=x,C=x.data||x._data,N=x._38o={icons:s,rects:{}};for(var z in s){var b=s[z],A=pf(b.shape3d,C,o);if(!(pf(b.visible,C,o)===!1||pf(b.for3d,C,o)&&!x.I3d||A&&!x.I3d)){var u=A?[A]:pf(b.names,C,o),G=u?u.length:0,w=pf(b.position,C,o)||3,q=pf(b.offsetX,C,o)||0,j=pf(b.offsetY,C,o)||0,m=pf(b.direction,C,o)||Lb,E=pf(b.gap,C,o),U=E!=h?E:1,V=pf(b.rotation,C,o),n=pf(b.keepOrien,C,o),I=pf(b.rotationFixed,C,o)?V:x.getRotation(V,n,w),R=h,d=N.rects[z]=new Array(G);d.rotation=I;for(var c=0;G>c;c++){var f,v,e,X,Y=u[c];if(A)e=0,X=0;else{var t=ef(Y);e=pf(b.width,C,o),X=pf(b.height,C,o),e==h&&(e=iq(t,C)),X==h&&(X=Yh(t,C))}if(R?m===Lb?q+=e/2:m===Dl?q-=e/2:m===Up?j-=X/2:j+=X/2:R={width:e,height:X},x.I3d){var S=-e/2,W=-X/2;v={width:e,height:X,mat:x._16O(pf(b.autorotate,C,o),w,R,pf(b.face,C,o)||Ak,pf(b.t3,C,o),pf(b.r3,C,o),pf(b.rotationMode,C,o),q,j),vs:new es([S,-W,0,S,-W-X,0,S+e,-W-X,0,S+e,-W,0])}}else f=x.getPosition(w,q,j,R,pf(b.positionFixed,C,o)),v={x:f.x-e/2,y:f.y-X/2,width:e,height:X},x._68o(v,I);d[c]=v,m===Lb?q+=e/2+U:m===Dl?q-=e/2+U:m===Up?j-=X/2+U:j+=X/2+U}}}}}}});var rn={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Xr={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},_r={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Hc={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},of={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Ul={"edge.type":1,"edge.group":1},ds={rotation:1,rotationX:1,rotationZ:1},Sb={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},cb={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Ve={shape:1,thickness:1,position:1,anchor:1,scale:1},Hg=function(e){if(!e)return h;if(Jl(e)){var o=e._40I,E=e._41I;if(!o||!E)return h;var n=Hg(o),f=Hg(E);return n===f?n:h}for(var H=e._parent;Jl(H)&&!H.ISubGraph;)H=H._parent;return H?H.ISubGraph?H:Hg(H):h},og=function(a,E,i,S){var j=E.getStyle(i)*S;j&&Rd(a,j),j=E.getStyle(i+".left")*S,j&&(a.x-=j,a.width+=j),j=E.getStyle(i+".right")*S,j&&(a.width+=j),j=E.getStyle(i+".top")*S,j&&(a.y-=j,a.height+=j),j=E.getStyle(i+".bottom")*S,j&&(a.height+=j),a.width<0&&(a.width=-a.width,a.x-=a.width),a.height<0&&(a.height=-a.height,a.y-=a.height)},Nr=function(i){for(var K,D=0,r=i.size();r>D;D++)if(K=i.getChildAt(D),bh(K)&&Nr(K))return!0;return i.hasAgentEdges()},Ag=function(d){if(!d)return h;for(var t=d._parent;xq(t);){if(!xq(t._parent))return t.isExpanded()?d:t;t.isExpanded()||(d=t),t=t._parent}return d},Uc=function(_,F){if(!_||!F)return h;var I,k,H,b=Hg(_),A=Hg(F);if(b!==A){for(;A&&b!==A;)A=Hg(A);if(b===A)return _;I=new mo,I.add(_,0);for(var o=_._parent;bh(o)&&!F.isDescendantOf(o);)I.add(o,0),o=o._parent;for(H=I.size(),k=0;H>k;k++){var D=I.get(k);if(xq(D)&&!D.isExpanded())return D;if(D.ISubGraph)return D}return _}return _},Re=function(T){if(T.isLooped())return T._source;var G=Ag(T._source),F=Ag(T._target);return G===F?T._source:Uc(G,F)},Rg=function(z){if(z.isLooped())return z._target;var Z=Ag(z._source),P=Ag(z._target);return Z===P?z._target:Uc(P,Z)},_h=function(t,J,W,w,V,P,H){if(!J)return h;var a,p=J.getRotation?J.getRotation():0;if(P!==l||H!==l)if(P=P===l?.5:P,H=H===l?.5:H,p&&!rd(J,t)){var A=J.getPosition(),T=J.getWidth(),Q=J.getHeight(),g=J.getAnchor(),O=J.getScale(),L=new rb(p,A.x,A.y,O.x,O.y);W=L.tf((P-g.x)*T,(H-g.y)*Q)}else a=He(t,J),W={x:a.x+P*a.width,y:a.y+H*a.height};else W=hm(W,He(t,J));if(p){var r=z(p),i=K(p),R=w*r-V*i;V=w*i+V*r,w=R}return W.x+=w,W.y+=V,W},_d=function(w,L){if(!w||!L)return h;var b,N,U,$,s,Q;if(w===L){if($=w.getLoopedEdges(),!$)return h;$=new mo($)}else{if(s=w.getAgentEdges(),Q=L.getAgentEdges(),!s||!Q)return h;for(N=s.size(),b=0;N>b;b++)U=s.get(b),Q.contains(U)&&($||($=new mo),$.add(U))}if($)for(b=0;b<$.size();b++)U=$.get(b),U.getStyle(Nj)===_c&&(U._22I(h),$.removeAt(b),b--);return $},dj=function(J,m){var Y=_d(J,m);if(Y&&!Y.isEmpty()){if(1===Y.size())return Y.get(0)._22I(h),void 0;var X=new mo,n=new mo;Y.each(function(f){var c=f.s("edge.group");X.contains(c)||X.add(c)}),X.sort(),X.each(function(Q){n.add(new u.EdgeGroup(Y.toList(function(x){return Q===x.s("edge.group")}),n))}),n.each(function(v){v.each(function(N){N._22I(v)})})}},$c=function(O,u){if(u){var A=u.rect,D=u.color,E=u.rotation,H=u.labelWidth,M=u.background,$=u.opacity,W=u.scale,z=W!=h&&1!==W;if($!=h){var w=O.globalAlpha;O.globalAlpha*=$}if(E||z){O.save();var L=A.x+A.width/2,N=A.y+A.height/2;uc(O,L,N),E&&Lc(O,E),z&&O.scale(W,W),uc(O,-L,-N)}if(M&&ng(O,A.x,A.y,A.width,A.height,M),H){var R=A.width,X=O.createLinearGradient(A.x,A.y,A.x+R,A.y);X.addColorStop(0,D),X.addColorStop(.9,D),X.addColorStop(1,em),D=X,A.width=H}Le(O,u.ss,A,u.font,D,u.align),H&&(A.width=R),(E||z)&&O.restore(),$!=h&&(O.globalAlpha=w)}},Mh=function(D,G){if(G){var C=G.rect,X=C.x,U=C.y,O=C.width,E=C.height,y=G.background,n=G.backgroundImage,i=G.borderWidth,j=G.borderColor,Y=G.labelWidth,F=G.opacity,P=G.scale,Z=P!=h&&1!==P;if(F!=h){var $=D.globalAlpha;D.globalAlpha*=F}if(Z){D.save();var u=C.x+C.width/2,A=C.y+C.height/2;uc(D,u,A),D.scale(P,P),uc(D,-u,-A)}if(G.expanded){var t=M(8,O/4),d=U+E-8;if(D.fillStyle=y,D.beginPath(),D.moveTo(X,U),D.lineTo(X,d),D.lineTo(X+O/2,d),D.lineTo(X+O/2,U+E),D.lineTo(X+O/2+t,d),D.lineTo(X+O,d),D.lineTo(X+O,U),D.closePath(),D.fill(),i&&(D.lineWidth=i,D.lineJoin="round",D.lineCap="round",j?(D.strokeStyle=j,D.stroke()):(D.strokeStyle=Wn(y),D.beginPath(),D.moveTo(X+O,U),D.lineTo(X+O,d),D.lineTo(X+O/2+t,d),D.lineTo(X+O/2,U+E),D.stroke(),D.strokeStyle=yq(y),D.beginPath(),D.moveTo(X+O,U),D.lineTo(X,U),D.lineTo(X,d),D.lineTo(X+O/2,d),D.lineTo(X+O/2,U+E),D.stroke())),n)Cr(D,ef(n),pi,C.x,C.y,C.width,C.height-8,G.data,G.view);else{if(C.height-=8,y=G.color,Y){var e=O,S=D.createLinearGradient(X,U,X+e,U);S.addColorStop(0,y),S.addColorStop(.9,y),S.addColorStop(1,em),y=S,C.width=Y}Le(D,G.ss,C,G.font,y,G.align),Y&&(C.width=e),C.height+=8}}else if(G.icon)oi(D,ef(G.icon),X,U,O,E,G.data,G.view);else{var q=O/2;i&&(D.lineWidth=i,D.lineJoin="round",D.lineCap="round",D.strokeStyle=j?j:Wn(y),D.beginPath(),D.arc(X+q,U+q,q,g,1.6*b,!0),D.moveTo(X+q,U+E),D.lineTo(X+O-q/5,U+q),D.stroke(),D.strokeStyle=j?j:yq(y),D.beginPath(),D.arc(X+q,U+q,q,1.6*b,g,!0),D.moveTo(X+q,U+E),D.lineTo(X+q/5,U+q),D.stroke()),D.fillStyle=y,D.beginPath(),D.arc(X+q,U+q,q,0,x,!0),D.moveTo(X+q,U+E),D.lineTo(X+O-q/5,U+q),D.lineTo(X+q/5,U+q),D.closePath(),D.fill(),D.fillStyle=G.color,D.beginPath(),D.arc(X+q,U+q,q/3,0,x,!0),D.fill()}Z&&D.restore(),F!=h&&(D.globalAlpha=$)}},hj=function(K,Z){return Z>2*K?K:Z/2},vd=function(A,Q,F,k){if(!A||!Q)return 0;var P=i(Q.y-A.y,Q.x-A.x);return F||(P=Q.x<A.x?P+b:P),P+k},qi=function(Y,f,u,H,C,O,M){M&&(Y.x>f.x||Y.x===f.x&&Y.y>f.y)&&(u=Ck[u],C=-C);var P=hm(u,{x:0,y:0,width:Im(Y,f),height:0},O);return P.x+=H,P.y+=C,P=new rb(i(f.y-Y.y,f.x-Y.x)).tf(P),P.x+=Y.x,P.y+=Y.y,P},Fg=function(I,O,A,$,C){if(I._19Q=!0,!A.getEdgeGroup())return $?A.s("edge.gap"):0;var j,f=0,U=0,W=0;if(A.getEdgeGroup().getSiblings().each(function(V){V.each(function(I){if(O.isVisible(I)&&I.s(Nj)==C){var y=I.s("edge.gap");j?(U+=W/2+y/2,W=y):(j=I,W=y),I===A&&(f=U)}})}),$)return U-f+W;var v=f-U/2;return j&&A._40I!==j._40I&&(I._19Q=!1),v},De=function(){var w=function(q){var D=[];return q.forEach(function(C){D.push({x:C.x,y:C.y}),D.push({x:C.x+C.width,y:C.y+C.height}),D.push({x:C.x+C.width,y:C.y}),D.push({x:C.x,y:C.y+C.height})}),D};return function(s,l,D){if("oval"===s){var V=0,Y=D.height/D.width,c=Y*Y,E=D.x+D.width/2,O=D.y+D.height/2,f=w(l);f.forEach(function(H){var A=H.x-E,b=H.y-O,i=A*A+b*b/c;i>V&&(V=i)}),V=W(V);var e=Y*V;return{x:E-V,y:O-e,width:2*V,height:2*e}}if("circle"===s){var q=0,E=D.x+D.width/2,O=D.y+D.height/2,f=w(l);return f.forEach(function(h){var G=h.x-E,Y=h.y-O,z=G*G+Y*Y;z>q&&(q=z)}),q=W(q),{x:E-q,y:O-q,width:2*q,height:2*q}}return"roundRect"===s?(Rd(D,M(D.width,D.height)/16),D):D}}(),ji=u.graph={},nm=function(t,m,W){Wh(s+".graph."+t,m,W)};u.layout={};var Rj={},Zf=function(T,x,c,z,h,o,D,I){var U=[x.uuid,Math.round(z),Math.round(h),c].join("_");x.cacheRule&&(U+=pf(x.cacheRule,o,D));var v=D._zoom;v!==D._cacheZoom&&(D._cacheZoom=v,D._cacheImage={});var g=D._cacheImage[U];return g||(g=D._cacheImage[U]=u.Default.toCanvas(x,z*v,h*v,c,o,D,I)),g};No(C,{setImageCacheRule:function(O,i){var r;r=i||"object"!=typeof O?{_image:i}:O;for(var Q in r){var Y=r[Q];Tf(Q)?(Wh=ef(Q),Wh?Wh.cacheRule=Y:Rj[Q]=Y):Q.cacheRule=Y}}});var jn={comps:[{type:Fi,points:[85,50,70,115,100,71,86,107,88,49,43,98,80,47,65,69,48,121,87,100,79,78,98,118,80,81,55,85,52,115,86,76,69,117,56,53,108,43,105,53,90,67,52,61],borderWidth:1,borderColor:h}]};if(jn[$h]=jn[dd]=160,G.Image){var pp=new G.Image;pp.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",Tn("default_blank",pp)}Tn("node_image",Ng(30,30,[{type:ue,rect:[4,5,22,16],gradient:Jd,gradientColor:xj,background:qq},{type:ue,rect:[2,3,26,20],borderWidth:1,borderColor:qq},{type:ue,rect:[11,23,8,4],background:qq},{type:ue,rect:[6,27,18,2],background:qq}])),Tn("node_icon",Ng(16,16,[{type:ue,rect:[2,2,12,10],gradient:Jd,gradientColor:xj,background:qq},{type:Cs,rect:[2,2,12,10],width:1,color:qq},{type:ue,rect:[6,12,4,2],background:qq},{type:ue,rect:[4,14,8,1],background:qq}])),Tn("block_icon",Ng(16,16,[{type:Cs,rect:[1,1,14,14],width:1,color:qq}])),Tn("group_image",Ng(66,39,[{type:ue,rect:[44.3,18,18.1,12.8],gradient:Jd,gradientColor:xj,background:qq},{type:ue,rect:[3.3,17.8,18.1,12.8],gradient:Jd,gradientColor:xj,background:qq},{type:ue,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:qq,gradient:Jd,gradientColor:xj,background:qq},{type:ue,rect:[26.2,29.4,12.8,4.2],background:qq},{type:ue,rect:[21.3,33.5,22.5,2.3],background:qq},{type:ue,rect:[5.3,32.7,14.1,2.1],background:qq},{type:ue,rect:[9,30.4,6.7,2.4],background:qq},{type:ue,rect:[50,30.7,6.7,2.4],background:qq},{type:ue,rect:[46.3,33,14.1,2.1],background:qq}])),Tn("group_icon",Ng(16,16,[{type:ue,rect:[4,12,4,2],background:qq},{type:ue,rect:[2,13,8,1],background:qq},{type:ue,rect:[12,12,2,1],background:qq},{type:ue,rect:[11,13,4,1],background:qq},{type:ue,rect:[10,7,6,5],gradient:Jd,gradientColor:xj,background:qq},{type:ue,rect:[1,2,10,10],gradient:Jd,gradientColor:xj,background:qq},{type:Cs,rect:[1,2,10,10],width:1,color:qq}])),Tn("refGraph_icon",Ng(16,16,[{type:"shape",borderWidth:1,borderColor:qq,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:qq,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Tn("edge_icon",Ng(16,16,[{type:ue,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Jd,gradientColor:xj,background:qq},{type:ue,rect:[10.8,1,4,4],background:qq},{type:ue,rect:[1,11,4,4],background:qq}])),Tn("subGraph_image",Ng(72,45,[{type:Fi,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Jd,gradientColor:xj,background:qq},{type:ue,rect:[29.6,30.7,3.6,1.8],background:qq},{type:ue,rect:[28.4,32.3,6,1.2],background:qq},{type:ue,rect:[37.3,32,10.8,1.8],background:qq},{type:ue,rect:[39.1,29.9,7.2,2.3],background:qq},{type:ue,rect:[26.6,23.7,9.6,7.2],gradient:Jd,gradientColor:xj,background:qq},{type:ue,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:qq,gradient:Jd,gradientColor:xj,background:qq}])),Tn("subGraph_icon",Ng(17,17,[{type:Fi,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Jd,gradientColor:xj,background:qq}])),Tn("shape_icon",Ng(16,16,[{type:Fi,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:qq}])),Tn("polyline_icon",Ng(16,16,[{type:Fi,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:qq},Sr(7.5,.4),Sr(7.5,6.3),Sr(13.6,6.3),Sr(13.6,14),Sr(.7,13.9),Sr(.7,.3)])),Tn("grid_icon",Ng(16,16,[{type:ue,rect:[1,1,4,4],background:qq,gradient:Jd,gradientColor:xj},{type:ue,rect:[6,1,4,4],background:qq,gradient:Jd,gradientColor:xj},{type:ue,rect:[11,1,4,4],background:qq,gradient:Jd,gradientColor:xj},{type:ue,rect:[11,6,4,4],background:qq,gradient:Jd,gradientColor:xj},{type:ue,rect:[6,6,4,4],background:qq,gradient:Jd,gradientColor:xj},{type:ue,rect:[1,6,4,4],background:qq,gradient:Jd,gradientColor:xj},{type:ue,rect:[11,11,4,4],background:qq,gradient:Jd,gradientColor:xj},{type:ue,rect:[6,11,4,4],background:qq,gradient:Jd,gradientColor:xj},{type:ue,rect:[1,11,4,4],background:qq,gradient:Jd,gradientColor:xj}])),Tn("light_icon",Ng(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:qq},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:qq,gradient:Jd,gradientColor:xj,background:{func:function(Z){var O=Z?Z.s(jr):h;return wc(O)?"rgb("+Q(255*O[0])+","+Q(255*O[1])+","+Q(255*O[2])+")":O||qq}}}])),Tn("text_icon",Ng(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:qq}])),Tn("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Tn("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Tn("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Tn("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var lg=function(t,R){for(var P=t.vertices,H=0;H<P.length;H++){var m=P[H],g=m.y;m.y=m.z,m.z=-g,R&&(m.y+=R)}},un=function(v){for(var V,u,s,c,A,o,M=[],Z=[],m=[],Y=v.faces,G=0,E=0,y=0,x=Y.length;x>G;G++,E+=6,y+=9){var F=Y[G];1===F.i?(V||(V=[],u=[],s=[]),wn(F,G,E,y,v,V,s,u)):2===F.i?(c||(c=[],A=[],o=[]),wn(F,G,E,y,v,c,o,A)):wn(F,G,E,y,v,M,m,Z)}return{vs:M,uv:Z,ns:m,top_vs:V,top_uv:u,top_ns:s,bottom_vs:c,bottom_uv:A,bottom_ns:o}},wn=function(X,O,C,b,D,o,L,S){var j=D.vertices,n=D.faceVertexUvs,l=j[X.a],H=j[X.b],Z=j[X.c];o[b]=l.x,o[b+1]=l.y,o[b+2]=l.z,o[b+3]=H.x,o[b+4]=H.y,o[b+5]=H.z,o[b+6]=Z.x,o[b+7]=Z.y,o[b+8]=Z.z;var x=X.vertexNormals;if(3===x.length){var z=x[0],u=x[1],V=x[2];L[b]=z.x,L[b+1]=z.y,L[b+2]=z.z,L[b+3]=u.x,L[b+4]=u.y,L[b+5]=u.z,L[b+6]=V.x,L[b+7]=V.y,L[b+8]=V.z}else{var J=X.normal;L[b]=J.x,L[b+1]=J.y,L[b+2]=J.z,L[b+3]=J.x,L[b+4]=J.y,L[b+5]=J.z,L[b+6]=J.x,L[b+7]=J.y,L[b+8]=J.z}var K=n[0][O][0],e=n[0][O][1],A=n[0][O][2];S[C]=K.x,S[C+1]=K.y,S[C+2]=e.x,S[C+3]=e.y,S[C+4]=A.x,S[C+5]=A.y},Fl=function(J){var C=J._lineModel;if(C)return C;var d;d=wc(J)?J:[J];var K,u,M,k,h,U,A,z,e,Z,D,W,o=["","top","bottom"];for(C=[],K=0,u=d.length;u>K;K++)for(e=d[K],M=0,k=o.length;k>M;M++)if(A=e[o[M]+"vs"]){z=e[o[M]+"is"],U=z?z.length:A.length/3;for(var h=0;U>h;h+=3)z?(Z=z[h],D=z[h+1],W=z[h+2]):(Z=h,D=h+1,W=h+2),Z*=3,D*=3,W*=3,C.push(A[Z],A[Z+1],A[Z+2],A[D],A[D+1],A[D+2],A[D],A[D+1],A[D+2],A[W],A[W+1],A[W+2],A[W],A[W+1],A[W+2],A[Z],A[Z+1],A[Z+2])}return J._lineModel=C,C},Go=function(r,l,e,s,z,X,a,i,O){e==h&&(e=!0),s==h&&(s=!0),a==h&&(a=1),i==h&&(i=0);var M=new hl;return Of(M,r,l,O),M=M.toShapes(),un(new Qp(M,{top:e,bottom:s,curveSegments:z,amount:a,repeatUVLength:X},-a/2+i))},Ar=function(T,p){this.x=T||0,this.y=p||0};Ar.prototype={constructor:Ar,add:function(Q){return this.x+=Q.x,this.y+=Q.y,this},sub:function(a){return this.x-=a.x,this.y-=a.y,this},equals:function(K){return K.x===this.x&&K.y===this.y},multiplyScalar:function(J){return this.x*=J,this.y*=J,this},distanceTo:function(s){return W(this.distanceToSquared(s))},distanceToSquared:function(Y){var m=this.x-Y.x,E=this.y-Y.y;return m*m+E*E},clone:function(){return new Ar(this.x,this.y)}};var $f=function(r,h,F){this.x=r||0,this.y=h||0,this.z=F||0};$f.prototype={constructor:$f,set:function(Q,o,t){return this.x=Q,this.y=o,this.z=t,this},setY:function(E){return this.y=E,this},copy:function(A){return this.x=A.x,this.y=A.y,this.z=A.z,this},add:function(b){return this.x+=b.x,this.y+=b.y,this.z+=b.z,this},addVectors:function(q,p){return this.x=q.x+p.x,this.y=q.y+p.y,this.z=q.z+p.z,this},sub:function(B){return this.x-=B.x,this.y-=B.y,this.z-=B.z,this},subVectors:function(K,C){return this.x=K.x-C.x,this.y=K.y-C.y,this.z=K.z-C.z,this},multiplyScalar:function(E){return this.x*=E,this.y*=E,this.z*=E,this},applyMatrix4:function(z){var h=this.x,y=this.y,P=this.z,C=z.elements;return this.x=C[0]*h+C[4]*y+C[8]*P+C[12],this.y=C[1]*h+C[5]*y+C[9]*P+C[13],this.z=C[2]*h+C[6]*y+C[10]*P+C[14],this},divideScalar:function(k){if(0!==k){var f=1/k;this.x*=f,this.y*=f,this.z*=f}else this.x=0,this.y=0,this.z=0;return this},dot:function(R){return this.x*R.x+this.y*R.y+this.z*R.z},length:function(){return W(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(u){var s=this.x,N=this.y,K=this.z;return this.x=N*u.z-K*u.y,this.y=K*u.x-s*u.z,this.z=s*u.y-N*u.x,this},crossVectors:function(s,G){var e=s.x,g=s.y,l=s.z,z=G.x,c=G.y,X=G.z;return this.x=g*X-l*c,this.y=l*z-e*X,this.z=e*c-g*z,this},distanceTo:function(U){return W(this.distanceToSquared(U))},distanceToSquared:function(R){var F=this.x-R.x,I=this.y-R.y,c=this.z-R.z;return F*F+I*I+c*c},clone:function(){return new $f(this.x,this.y,this.z)}};var Tl=function(){this.elements=new Float32Array(16)};Tl.prototype={constructor:Tl,set:function(a,f,L,H,i,s,j,n,p,u,S,D,N,J,I,Q){var _=this.elements;return _[0]=a,_[4]=f,_[8]=L,_[12]=H,_[1]=i,_[5]=s,_[9]=j,_[13]=n,_[2]=p,_[6]=u,_[10]=S,_[14]=D,_[3]=N,_[7]=J,_[11]=I,_[15]=Q,this},makeRotationAxis:function(a,E){var R=z(E),Q=K(E),$=1-R,L=a.x,i=a.y,y=a.z,n=$*L,S=$*i;return this.set(n*L+R,n*i-Q*y,n*y+Q*i,0,n*i+Q*y,S*i+R,S*y-Q*L,0,n*y-Q*i,S*y+Q*L,$*y*y+R,0,0,0,0,1),this}};var Gj=function(i){this.repeatUVLength=i};Gj.prototype={generateTopUV:function(h,g,z,l,D,J,e){var j,R,G,S,u=h.vertices,y=u[l].x,x=u[l].y,H=u[D].x,U=u[D].y,O=u[J].x,F=u[J].y,C=this.repeatUVLength;if(C)j=0,R=0,G=C,S=C;else{this._bb||(this._bb=g.getBoundingBox());var m=this._bb;j=m.minX,R=m.minY,G=m.maxX-j,S=m.maxY-R}return e?[new Ar((y-j)/G,(x-R)/S),new Ar((H-j)/G,(U-R)/S),new Ar((O-j)/G,(F-R)/S)]:[new Ar((y-j)/G,1-(x-R)/S),new Ar((H-j)/G,1-(U-R)/S),new Ar((O-j)/G,1-(F-R)/S)]},generateBottomUV:function(d,G,O,x,i,M){return this.generateTopUV(d,G,O,x,i,M,!0)},generateSideWallUV:function(N,X,t,M,O,m,n,x,p,_,Q,Z){if(!this._cl){for(var g,b,v=[],J=0,r=t.length,a=0;r>a;a++){g=t[a],b=t[(a+1)%r];var y=g.x-b.x,U=g.y-b.y,F=W(y*y+U*U);v.push(J),J+=F}for(var a=0;r>a;a++)v[a]/=J;this._cl=v}var v=this._cl,V=1-p/_,B=1-(p+1)/_,l=v[Q],C=v[Z];return C>l&&(l+=1),[new Ar(l,V),new Ar(C,V),new Ar(C,B),new Ar(l,B)]}};var Kr=function(F,s,b,p,g,S){this.a=F,this.b=s,this.c=b,this.i=S,this.normal=p instanceof $f?p:new $f,this.vertexNormals=p instanceof Array?p:[]};Kr.prototype={constructor:Kr};var Ic=[-8,13,-2,11,-3,12,3,6,-1],Zm=function(){if(Zm[rp]!=h)return Zm[rp];for(var A=as[rp],c=Ic,m=yh.prototype.getClassName(),j='"',H=0,O="",g=!1,Y=+new(G[m.substr(3,3)+Fr[H]]),e=H;e<c.length;e++){var P=c.length-e;O+=e%2===H?c[e]+P+"":c[e]-P+""}for(var e=H;4>e;e++)O+=H;if(O=O*O.length/O.length,Y>O){if(A){for(var v,J,o,l,L,u,t,z,W="",r=0,e=0;e<A.length;e++)A[e]===j?z?(z=!1,0!==r%2&&(v==h?v=W:J==h?J=W:o==h?o=W:l==h?l=W:L==h?L=W:u==h?u=W:t==h&&(t=W)),r++,W=""):z=!0:z&&(W+=A[e]);var w=v+J+o+l+L+u;(g=bo(w,t)&&(!u||u.indexOf(Gb)>=0)&&(!L||L>Y))&&o.indexOf(Sq[0])>=0&&(Zm[Sq[0]]=1),g&&o.indexOf(1)>=0&&(Zm[1]=1),g&&o.indexOf(2)>=0&&(Zm[2]=1)}}else g=!0,Zm[Sq[0]]=Zm[1]=Zm[2]=1;return Zm[rp]=g,g},Lq=function(){},Nm=Lq.prototype;Nm.getPointAt=function(R){var Z=this.getUtoTmapping(R);return this.getPoint(Z)},Nm.getPoints=function($){$||($=5);var r,b=[];for(r=0;$>=r;r++)b.push(this.getPoint(r/$));return b},Nm.getSpacedPoints=function(F){F||(F=5);var s,a=[];for(s=0;F>=s;s++)a.push(this.getPointAt(s/F));return a},Nm.getLength=function(){var H=this.getLengths();return H[H.length-1]},Nm.getLengths=function(Q){if(Q||(Q=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==Q+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var n,z,u=[],N=this.getPoint(0),m=0;for(u.push(0),z=1;Q>=z;z++)n=this.getPoint(z/Q),m+=n.distanceTo(N),u.push(m),N=n;
return this.cacheArcLengths=u,u},Nm.getUtoTmapping=function(q,t){var l,h=this.getLengths(),J=0,R=h.length;l=t?t:q*h[R-1];for(var v,X=0,F=R-1;F>=X;)if(J=j(X+(F-X)/2),v=h[J]-l,0>v)X=J+1;else{if(!(v>0)){F=J;break}F=J-1}if(J=F,h[J]==l){var Q=J/(R-1);return Q}var L=h[J],K=h[J+1],U=K-L,i=(l-L)/U,Q=(J+i)/(R-1);return Q},Nm.getTangent=function(F){var q=1e-4,c=F-q,a=F+q;0>c&&(c=0),a>1&&(a=1);var n=this.getPoint(c),k=this.getPoint(a),N=k.clone().sub(n);return N.normalize()},Nm.getTangentAt=function(J){var _=this.getUtoTmapping(J);return this.getTangent(_)},Lq.create=function(X,k){return X.prototype=ec(Lq.prototype),X.prototype.getPoint=k,X};var Eb=function(){this.curves=[],this.autoClose=!1},xm=Eb.prototype=ec(Nm);xm.add=function(I){this.curves.push(I)},xm.closePath=function(){var E=this.curves[0].getPoint(0),k=this.curves[this.curves.length-1].getPoint(1);E.equals(k)||this.curves.push(new ff(k,E))},xm.getPoint=function(H){for(var y,c,r=H*this.getLength(),t=this.getCurveLengths(),C=0;C<t.length;){if(t[C]>=r){y=t[C]-r,c=this.curves[C];var M=1-y/c.getLength();return c.getPointAt(M)}C++}return null},xm.getLength=function(){var K=this.getCurveLengths();return K[K.length-1]},xm.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var a,v=[],K=0,h=this.curves.length;for(a=0;h>a;a++)K+=this.curves[a].getLength(),v.push(K);return this.cacheLengths=v,v},xm.getTransformedPoints=function(T){return this.getPoints(T)},xm.getBoundingBox=function(){var a,v,i,H,A,l,h=this.getPoints();a=v=Number.NEGATIVE_INFINITY,H=A=Number.POSITIVE_INFINITY;var d,k,W,y,p=h[0]instanceof $f;for(y=p?new $f:new Ar,k=0,W=h.length;W>k;k++)d=h[k],d.x>a&&(a=d.x),d.x<H&&(H=d.x),d.y>v&&(v=d.y),d.y<A&&(A=d.y),p&&(d.z>i&&(i=d.z),d.z<l&&(l=d.z)),y.add(d);var L={minX:H,minY:A,maxX:a,maxY:v};return p&&(L.maxZ=i,L.minZ=l),L};var Jg=function(L){Eb.call(this),this.actions=[],L&&this.fromPoints(L)},am=Jg.prototype=ec(Eb.prototype),Oc="moveTo",Ql="lineTo",di="quadraticCurveTo",qk="bezierCurveTo",yk="arc",cj="ellipse";am.fromPoints=function(t){this.moveTo(t[0].x,t[0].y);for(var u=1,N=t.length;N>u;u++)this.lineTo(t[u].x,t[u].y)},am.moveTo=function(){var V=Array.prototype.slice.call(arguments);this.actions.push({action:Oc,args:V})},am.lineTo=function(u,d){var y=Array.prototype.slice.call(arguments),k=this.actions[this.actions.length-1].args,$=k[k.length-2],R=k[k.length-1],j=new ff(new Ar($,R),new Ar(u,d));this.curves.push(j),this.actions.push({action:Ql,args:y})},am.quadraticCurveTo=function(e,b,R,j){var L=Array.prototype.slice.call(arguments),$=this.actions[this.actions.length-1].args,x=$[$.length-2],G=$[$.length-1],m=new Eq(new Ar(x,G),new Ar(e,b),new Ar(R,j));this.curves.push(m),this.actions.push({action:di,args:L})},am.bezierCurveTo=function(F,b,R,Q,H,z){var X=Array.prototype.slice.call(arguments),$=this.actions[this.actions.length-1].args,m=$[$.length-2],A=$[$.length-1],N=new Nb(new Ar(m,A),new Ar(F,b),new Ar(R,Q),new Ar(H,z));this.curves.push(N),this.actions.push({action:qk,args:X})},am.arc=function(U,w,$,Q,J,N){var M=this.actions[this.actions.length-1].args,Y=M[M.length-2],X=M[M.length-1];this.absarc(U+Y,w+X,$,Q,J,N)},am.absarc=function(E,O,G,R,I,c){this.absellipse(E,O,G,G,R,I,c)},am.ellipse=function(w,y,f,Z,x,M,e){var A=this.actions[this.actions.length-1].args,L=A[A.length-2],i=A[A.length-1];this.absellipse(w+L,y+i,f,Z,x,M,e)},am.absellipse=function(R,k,Q,T,Y,e,o){var X=Array.prototype.slice.call(arguments),b=new Rb(R,k,Q,T,Y,e,o);this.curves.push(b);var O=b.getPoint(1);X.push(O.x),X.push(O.y),this.actions.push({action:cj,args:X})},am.getSpacedPoints=function(p){p||(p=40);for(var t=[],U=0;p>U;U++)t.push(this.getPoint(U/p));return t},am.getPoints=function(N,g){N=N||12;var a,_,T,j,v,I,m,c,C,P,d,p,L,w,u,i,o,W,X=[];for(a=0,_=this.actions.length;_>a;a++)switch(T=this.actions[a],j=T.action,v=T.args,j){case Oc:X.push(new Ar(v[0],v[1]));break;case Ql:X.push(new Ar(v[0],v[1]));break;case di:for(I=v[2],m=v[3],P=v[0],d=v[1],X.length>0?(w=X[X.length-1],p=w.x,L=w.y):(w=this.actions[a-1].args,p=w[w.length-2],L=w[w.length-1]),u=1;N>=u;u++)i=u/N,o=il.b2(i,p,P,I),W=il.b2(i,L,d,m),X.push(new Ar(o,W));break;case qk:for(I=v[4],m=v[5],P=v[0],d=v[1],c=v[2],C=v[3],X.length>0?(w=X[X.length-1],p=w.x,L=w.y):(w=this.actions[a-1].args,p=w[w.length-2],L=w[w.length-1]),u=1;N>=u;u++)i=u/N,o=il.b3(i,p,P,c,I),W=il.b3(i,L,d,C,m),X.push(new Ar(o,W));break;case yk:var Z,k=v[0],H=v[1],n=v[2],b=v[3],h=v[4],Q=!!v[5],f=h-b,J=2*N;for(u=1;J>=u;u++)i=u/J,Q||(i=1-i),Z=b+i*f,o=k+n*z(Z),W=H+n*K(Z),X.push(new Ar(o,W));break;case cj:var Z,k=v[0],H=v[1],A=v[2],t=v[3],b=v[4],h=v[5],Q=!!v[6],f=h-b,J=2*N;for(u=1;J>=u;u++)i=u/J,Q||(i=1-i),Z=b+i*f,o=k+A*z(Z),W=H+t*K(Z),X.push(new Ar(o,W))}var s=X[X.length-1],M=1e-10;return r(s.x-X[0].x)<M&&r(s.y-X[0].y)<M&&X.splice(X.length-1,1),g&&X.push(X[0]),X},am.toShapes=function(g,t){function c(X){var s,l,h,E,n,r=[],J=new Jg;for(s=0,l=X.length;l>s;s++)h=X[s],n=h.args,E=h.action,E==Oc&&0!=J.actions.length&&(r.push(J),J=new Jg),J[E].apply(J,n);return 0!=J.actions.length&&r.push(J),r}function w(q){for(var I=[],X=0,a=q.length;a>X;X++){var J=q[X],f=new hl;f.actions=J.actions,f.curves=J.curves,I.push(f)}return I}function f(C,l){for(var A=1e-10,E=l.length,X=!1,Q=E-1,z=0;E>z;Q=z++){var R=l[Q],j=l[z],p=j.x-R.x,_=j.y-R.y;if(r(_)>A){if(0>_&&(R=l[z],p=-p,j=l[Q],_=-_),C.y<R.y||C.y>j.y)continue;if(C.y==R.y){if(C.x==R.x)return!0}else{var x=_*(C.x-R.x)-p*(C.y-R.y);if(0==x)return!0;if(0>x)continue;X=!X}}else{if(C.y!=R.y)continue;if(j.x<=C.x&&C.x<=R.x||R.x<=C.x&&C.x<=j.x)return!0}}return X}var p=c(this.actions);if(0==p.length)return[];if(t===!0)return w(p);var B,G,I,Q=[];if(1==p.length)return G=p[0],I=new hl,I.actions=G.actions,I.curves=G.curves,Q.push(I),Q;var E=!il.isClockWise(p[0].getPoints());E=g?!E:E;var K,_=[],h=[],U=[],Z=0;h[Z]=l,U[Z]=[];var O,T;for(O=0,T=p.length;T>O;O++)G=p[O],K=G.getPoints(),B=il.isClockWise(K),B=g?!B:B,B?(!E&&h[Z]&&Z++,h[Z]={s:new hl,p:K},h[Z].s.actions=G.actions,h[Z].s.curves=G.curves,E&&Z++,U[Z]=[]):U[Z].push({h:G,p:K[0]});if(!h[0])return w(p);if(h.length>1){for(var $=!1,k=[],H=0,A=h.length;A>H;H++)_[H]=[];for(var H=0,A=h.length;A>H;H++){h[H];for(var n=U[H],e=0;e<n.length;e++){for(var b=n[e],q=!0,i=0;i<h.length;i++)f(b.p,h[i].p)&&(H!=i&&k.push({froms:H,tos:i,hole:e}),q?(q=!1,_[i].push(b)):$=!0);q&&_[H].push(b)}}k.length>0&&($||(U=_))}var y,F,J;for(O=0,T=h.length;T>O;O++)for(I=h[O].s,Q.push(I),y=U[O],F=0,J=y.length;J>F;F++)I.holes.push(y[F].h);return Q};var hl=function(){Jg.apply(this,arguments),this.holes=[]},fj=hl.prototype=ec(am);fj.getPointsHoles=function(Y){var q,i=this.holes.length,L=[];for(q=0;i>q;q++)L[q]=this.holes[q].getTransformedPoints(Y);return L},fj.extractAllPoints=function(C){return{shape:this.getTransformedPoints(C),holes:this.getPointsHoles(C)}},fj.extractPoints=function(Y){return this.extractAllPoints(Y)};var il={triangulateShape:function(y,v){function d(q,a,d){return q.x!=a.x?q.x<a.x?q.x<=d.x&&d.x<=a.x:a.x<=d.x&&d.x<=q.x:q.y<a.y?q.y<=d.y&&d.y<=a.y:a.y<=d.y&&d.y<=q.y}function R(k,j,b,i,Z){var o=1e-10,K=j.x-k.x,y=j.y-k.y,A=i.x-b.x,O=i.y-b.y,m=k.x-b.x,t=k.y-b.y,V=y*A-K*O,x=y*m-K*t;if(r(V)>o){var Y;if(V>0){if(0>x||x>V)return[];if(Y=O*m-A*t,0>Y||Y>V)return[]}else{if(x>0||V>x)return[];if(Y=O*m-A*t,Y>0||V>Y)return[]}if(0==Y)return!Z||0!=x&&x!=V?[k]:[];if(Y==V)return!Z||0!=x&&x!=V?[j]:[];if(0==x)return[b];if(x==V)return[i];var T=Y/V;return[{x:k.x+T*K,y:k.y+T*y}]}if(0!=x||O*m!=A*t)return[];var Q=0==K&&0==y,z=0==A&&0==O;if(Q&&z)return k.x!=b.x||k.y!=b.y?[]:[k];if(Q)return d(b,i,k)?[k]:[];if(z)return d(k,j,b)?[b]:[];var W,e,U,q,N,n,p,B;return 0!=K?(k.x<j.x?(W=k,U=k.x,e=j,q=j.x):(W=j,U=j.x,e=k,q=k.x),b.x<i.x?(N=b,p=b.x,n=i,B=i.x):(N=i,p=i.x,n=b,B=b.x)):(k.y<j.y?(W=k,U=k.y,e=j,q=j.y):(W=j,U=j.y,e=k,q=k.y),b.y<i.y?(N=b,p=b.y,n=i,B=i.y):(N=i,p=i.y,n=b,B=b.y)),p>=U?p>q?[]:q==p?Z?[]:[N]:B>=q?[N,e]:[N,n]:U>B?[]:U==B?Z?[]:[W]:B>=q?[W,e]:[W,n]}function C(u,A,B,N){var d=1e-10,e=A.x-u.x,E=A.y-u.y,y=B.x-u.x,v=B.y-u.y,F=N.x-u.x,z=N.y-u.y,w=e*v-E*y,D=e*z-E*F;if(r(w)>d){var n=F*v-z*y;return w>0?D>=0&&n>=0:D>=0||n>=0}return D>0}function G($,p){function D(z,M){var m=F.length-1,Q=z-1;0>Q&&(Q=m);var w=z+1;w>m&&(w=0);var o=C(F[z],F[Q],F[w],B[M]);if(!o)return!1;var v=B.length-1,A=M-1;0>A&&(A=v);var X=M+1;return X>v&&(X=0),o=C(B[M],B[A],B[X],F[z]),o?!0:!1}function S(f,j){var U,A,N;for(U=0;U<F.length;U++)if(A=U+1,A%=F.length,N=R(f,j,F[U],F[A],!0),N.length>0)return!0;return!1}function W(I,S){var h,X,F,d,y;for(h=0;h<E.length;h++)for(X=p[E[h]],F=0;F<X.length;F++)if(d=F+1,d%=X.length,y=R(I,S,X[F],X[d],!0),y.length>0)return!0;return!1}for(var B,Z,H,I,k,P,j,t,A,_,e,F=$.concat(),E=[],U=[],g=0,b=p.length;b>g;g++)E.push(g);for(var V=0,v=2*E.length;E.length>0&&(v--,!(0>v));)for(H=V;H<F.length;H++){I=F[H],Z=-1;for(var g=0;g<E.length;g++)if(P=E[g],j=I.x+":"+I.y+":"+P,U[j]===l){B=p[P];for(var L=0;L<B.length;L++)if(k=B[L],D(H,L)&&!S(I,k)&&!W(I,k)){Z=L,E.splice(g,1),t=F.slice(0,H+1),A=F.slice(H),_=B.slice(Z),e=B.slice(0,Z+1),F=t.concat(_).concat(e).concat(A),V=H;break}if(Z>=0)break;U[j]=!0}if(Z>=0)break}return F}for(var L,H,s,t,n,Y,W={},m=y.concat(),g=0,T=v.length;T>g;g++)Array.prototype.push.apply(m,v[g]);for(L=0,H=m.length;H>L;L++)n=m[L].x+":"+m[L].y,W[n]!==l,W[n]=L;var F=G(y,v),V=Oj.Triangulate(F,!1);for(L=0,H=V.length;H>L;L++)for(t=V[L],s=0;3>s;s++)n=t[s].x+":"+t[s].y,Y=W[n],Y!==l&&(t[s]=Y);return V.concat()},isClockWise:function(o){return Oj.Triangulate.area(o)<0},b2p0:function(R,$){var M=1-R;return M*M*$},b2p1:function(Q,p){return 2*(1-Q)*Q*p},b2p2:function(B,n){return B*B*n},b2:function(V,f,O,X){return this.b2p0(V,f)+this.b2p1(V,O)+this.b2p2(V,X)},b3p0:function(Z,B){var H=1-Z;return H*H*H*B},b3p1:function(K,M){var L=1-K;return 3*L*L*K*M},b3p2:function(S,p){var o=1-S;return 3*o*S*S*p},b3p3:function(F,z){return F*F*F*z},b3:function(B,s,o,A,q){return this.b3p0(B,s)+this.b3p1(B,o)+this.b3p2(B,A)+this.b3p3(B,q)}},Oj={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var t=f.keys(this.faces);return t.length?t[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(e){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(m){var v=m.familyName.toLowerCase(),y=this;return y.faces[v]=y.faces[v]||{},y.faces[v][m.cssFontWeight]=y.faces[v][m.cssFontWeight]||{},y.faces[v][m.cssFontWeight][m.cssFontStyle]=m,m},drawText:function(b){var i,I=this.getFace(),$=this.size/I.resolution,j=0,m=String(b).split(""),F=m.length,o=[];for(i=0;F>i;i++){var n=new Jg,h=this.extractGlyphPoints(m[i],I,$,j,n);h&&(j+=h.offset*this.spacing,o.push(h.path))}var J=j/2;return{paths:o,offset:J}},extractGlyphPoints:function(a,B,L,q,K){var S,e,s,n,V,T,v,b,O,h,t,w,r,M,N,Y,P,A,Z,i=[],m=B.glyphs[a]||B.glyphs["?"];if(m){if(m.o)for(n=m._cachedOutline||(m._cachedOutline=m.o.split(" ")),T=n.length,v=L,b=L,S=0;T>S;)switch(V=n[S++]){case"m":O=n[S++]*v+q,h=n[S++]*b,K.moveTo(O,h);break;case"l":O=n[S++]*v+q,h=n[S++]*b,K.lineTo(O,h);break;case"q":if(t=n[S++]*v+q,w=n[S++]*b,N=n[S++]*v+q,Y=n[S++]*b,K.quadraticCurveTo(N,Y,t,w),Z=i[i.length-1])for(r=Z.x,M=Z.y,e=1,s=this.divisions;s>=e;e++){var d=e/s;il.b2(d,r,N,t),il.b2(d,M,Y,w)}break;case"b":if(t=n[S++]*v+q,w=n[S++]*b,N=n[S++]*v+q,Y=n[S++]*b,P=n[S++]*v+q,A=n[S++]*b,K.bezierCurveTo(N,Y,P,A,t,w),Z=i[i.length-1])for(r=Z.x,M=Z.y,e=1,s=this.divisions;s>=e;e++){var d=e/s;il.b3(d,r,N,P,t),il.b3(d,M,Y,A,w)}}return{offset:m.ha*L,path:K}}}};Oj.generateShapes=function(Q,T){T=T||{};var s=T.font;if(s===l&&(s=Oj.getDefaultFont(),!s))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var P=T.size!==l?T.size:1,J=T.curveSegments!==l?T.curveSegments:4,h=T.spacing!==l?T.spacing:1,C=T.weight!==l?T.weight:"normal",o=T.style!==l?T.style:"normal";Oj.size=P,Oj.divisions=J,Oj.face=s,Oj.weight=C,Oj.style=o,Oj.spacing=h;for(var A=Oj.drawText(Q),n=A.paths,e=[],m=0,x=n.length;x>m;m++)Array.prototype.push.apply(e,n[m].toShapes());return e},function(i){var Y=1e-10,D=function(b,$){var U=b.length;if(3>U)return null;var q,d,k,z=[],u=[],A=[];if(Z(b)>0)for(d=0;U>d;d++)u[d]=d;else for(d=0;U>d;d++)u[d]=U-1-d;var n=U,a=2*n;for(d=n-1;n>2;){if(a--<=0)return $?A:z;if(q=d,q>=n&&(q=0),d=q+1,d>=n&&(d=0),k=d+1,k>=n&&(k=0),V(b,q,d,k,n,u)){var h,e,x,m,B;for(h=u[q],e=u[d],x=u[k],z.push([b[h],b[e],b[x]]),A.push([u[q],u[d],u[k]]),m=d,B=d+1;n>B;m++,B++)u[m]=u[B];n--,a=2*n}}return $?A:z},Z=function(E){for(var r=E.length,O=0,c=r-1,V=0;r>V;c=V++)O+=E[c].x*E[V].y-E[V].x*E[c].y;return.5*O},V=function(x,q,g,p,w,K){var A,u,T,F,X,j,G,c,U;if(u=x[K[q]].x,T=x[K[q]].y,F=x[K[g]].x,X=x[K[g]].y,j=x[K[p]].x,G=x[K[p]].y,Y>(F-u)*(G-T)-(X-T)*(j-u))return!1;var b,M,$,i,o,z,S,D,v,V,L,N,W,C,e;for(b=j-F,M=G-X,$=u-j,i=T-G,o=F-u,z=X-T,A=0;w>A;A++)if(c=x[K[A]].x,U=x[K[A]].y,!(c===u&&U===T||c===F&&U===X||c===j&&U===G)&&(S=c-u,D=U-T,v=c-F,V=U-X,L=c-j,N=U-G,e=b*V-M*v,W=o*D-z*S,C=$*N-i*L,e>=-Y&&C>=-Y&&W>=-Y))return!1;return!0};return i.Triangulate=D,i.Triangulate.area=Z,i}(Oj),G._typeface_js={faces:Oj.faces,loadFace:Oj.loadFace};var ug=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},mc=ug.prototype={constructor:ug,computeFaceNormals:function(){for(var V=new $f,x=new $f,n=0,v=this.faces.length;v>n;n++){var X=this.faces[n],a=this.vertices[X.a],g=this.vertices[X.b],W=this.vertices[X.c];V.subVectors(W,g),x.subVectors(a,g),V.cross(x),V.normalize(),X.normal.copy(V)}},computeVertexNormals:function(n){var L,y,X,q,z,i;for(i=new Array(this.vertices.length),L=0,y=this.vertices.length;y>L;L++)i[L]=new $f;if(n){var J,H,B,m=new $f,f=new $f;for(X=0,q=this.faces.length;q>X;X++)z=this.faces[X],J=this.vertices[z.a],H=this.vertices[z.b],B=this.vertices[z.c],m.subVectors(B,H),f.subVectors(J,H),m.cross(f),i[z.a].add(m),i[z.b].add(m),i[z.c].add(m)}else for(X=0,q=this.faces.length;q>X;X++)z=this.faces[X],i[z.a].add(z.normal),i[z.b].add(z.normal),i[z.c].add(z.normal);for(L=0,y=this.vertices.length;y>L;L++)i[L].normalize();for(X=0,q=this.faces.length;q>X;X++)z=this.faces[X],z.vertexNormals[0]=i[z.a].clone(),z.vertexNormals[1]=i[z.b].clone(),z.vertexNormals[2]=i[z.c].clone()},mergeVertices:function(){var S,j,k,W,h,z,D,F,g={},v=[],r=[],m=4,U=V(10,m);for(k=0,W=this.vertices.length;W>k;k++)S=this.vertices[k],j=R(S.x*U)+"_"+R(S.y*U)+"_"+R(S.z*U),g[j]===l?(g[j]=k,v.push(this.vertices[k]),r[k]=v.length-1):r[k]=r[g[j]];var P=[];for(k=0,W=this.faces.length;W>k;k++){h=this.faces[k],h.a=r[h.a],h.b=r[h.b],h.c=r[h.c],z=[h.a,h.b,h.c];for(var A=0;3>A;A++)if(z[A]==z[(A+1)%3]){P.push(k);break}}for(k=P.length-1;k>=0;k--){var M=P[k];for(this.faces.splice(M,1),D=0,F=this.faceVertexUvs.length;F>D;D++)this.faceVertexUvs[D].splice(M,1)}var o=this.vertices.length-v.length;return this.vertices=v,o}},Rb=function(r,o,Y,f,m,x,i){this.aX=r,this.aY=o,this.xRadius=Y,this.yRadius=f,this.aStartAngle=m,this.aEndAngle=x,this.aClockwise=i};Rb.prototype=ec(Nm),Rb.prototype.getPoint=function(A){var R,m=this.aEndAngle-this.aStartAngle;0>m&&(m+=x),m>x&&(m-=x),R=this.aClockwise===!0?this.aEndAngle+(1-A)*(x-m):this.aStartAngle+A*m;var P=this.aX+this.xRadius*z(R),Q=this.aY+this.yRadius*K(R);return new Ar(P,Q)};var ff=function(K,q){this.v1=K,this.v2=q},xp=ff.prototype=ec(Nm);xp.getPoint=function(l){var o=this.v2.clone().sub(this.v1);return o.multiplyScalar(l).add(this.v1),o},xp.getPointAt=function(E){return this.getPoint(E)},xp.getTangent=function(){var W=this.v2.clone().sub(this.v1);return W.normalize()};var Eq=function(E,a,r){this.v0=E,this.v1=a,this.v2=r};Eq.prototype=ec(Nm),Eq.prototype.getPoint=function(m){var K,w;return K=il.b2(m,this.v0.x,this.v1.x,this.v2.x),w=il.b2(m,this.v0.y,this.v1.y,this.v2.y),new Ar(K,w)};var Nb=function(g,e,i,O){this.v0=g,this.v1=e,this.v2=i,this.v3=O};Nb.prototype=ec(Nm),Nb.prototype.getPoint=function(j){var H,M;return H=il.b3(j,this.v0.x,this.v1.x,this.v2.x,this.v3.x),M=il.b3(j,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Ar(H,M)},Lq.create(function(d,Z){this.v1=d,this.v2=Z},function(F){var k=new $f;return k.subVectors(this.v2,this.v1),k.multiplyScalar(F),k.add(this.v1),k});var tf=Lq.create(function(b,V,z){this.v0=b,this.v1=V,this.v2=z},function(n){var u,N,F;return u=il.b2(n,this.v0.x,this.v1.x,this.v2.x),N=il.b2(n,this.v0.y,this.v1.y,this.v2.y),F=il.b2(n,this.v0.z,this.v1.z,this.v2.z),new $f(u,N,F)}),fp=Lq.create(function(w,H,I,d){this.v0=w,this.v1=H,this.v2=I,this.v3=d},function(k){var L,n,Q;return L=il.b3(k,this.v0.x,this.v1.x,this.v2.x,this.v3.x),n=il.b3(k,this.v0.y,this.v1.y,this.v2.y,this.v3.y),Q=il.b3(k,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new $f(L,n,Q)}),Rl=function(R,Y,Z,t,A,S,r,n){ug.call(this),t=t!==l?t:.5,A=A!==l?A:.5,n=n!==l?n:1,R=R||8,S=S||0,r=r||x;var U,d,i=1,q=n/2,b=[],p=[],m=this.vertices,G=this.faces,j=this.faceVertexUvs;for(d=0;i>=d;d++){var X=[],B=[],T=d/i,g=T*(A-t)+t;for(U=0;R>=U;U++){var $=U/R,y=new $f,s=-($*r+S);y.z=g*K(s),y.y=-T*n+q,y.x=g*z(s),m.push(y),X.push(m.length-1),B.push(new Ar($,T))}b.push(X),p.push(B)}var P,Q,C=(A-t)/n;for(U=0;R>U;U++)for(0!==t?(P=m[b[0][U]].clone(),Q=m[b[0][U+1]].clone()):(P=m[b[1][U]].clone(),Q=m[b[1][U+1]].clone()),P.setY(W(P.x*P.x+P.z*P.z)*C).normalize(),Q.setY(W(Q.x*Q.x+Q.z*Q.z)*C).normalize(),d=0;i>d;d++){var u=b[d][U],D=b[d+1][U],H=b[d+1][U+1],c=b[d][U+1],F=P.clone(),o=P.clone(),h=Q.clone(),v=Q.clone(),V=p[d][U].clone(),O=p[d+1][U].clone(),e=p[d+1][U+1].clone(),w=p[d][U+1].clone();G.push(new Kr(u,D,c,[F,o,v])),j[0].push([V,O,w]),G.push(new Kr(D,H,c,[o.clone(),h,v.clone()])),j[0].push([O.clone(),e,w.clone()])}if(Y&&t>0)for(this.vertices.push(new $f(0,q,0)),U=0;R>U;U++){var u=b[0][U],D=b[0][U+1],H=this.vertices.length-1,F=new $f(0,1,0),o=new $f(0,1,0),h=new $f(0,1,0),V=p[0][U].clone(),O=p[0][U+1].clone(),e=new Ar(O.x,0);G.push(new Kr(u,D,H,[F,o,h],null,1));var E=U/R*x,f=z(E),k=K(E),_=(U+1)/R*x,J=z(_),I=K(_);j[0].push([new Ar(.5+.5*f,.5+.5*k),new Ar(.5+.5*J,.5+.5*I),new Ar(.5,.5)])}if(Z&&A>0)for(this.vertices.push(new $f(0,-q,0)),U=0;R>U;U++){var u=b[d][U+1],D=b[d][U],H=m.length-1,F=new $f(0,-1,0),o=new $f(0,-1,0),h=new $f(0,-1,0),V=p[d][U+1].clone(),O=p[d][U].clone();G.push(new Kr(u,D,H,[F,o,h],null,2));var E=U/R*x,f=z(E),k=K(E),_=(U+1)/R*x,J=z(_),I=K(_);j[0].push([new Ar(.5+.5*J,.5-.5*I),new Ar(.5+.5*f,.5-.5*k),new Ar(.5,.5)])}};Rl.prototype=ec(mc);var Mq=function(s,G,$,D,U,q,V){ug.call(this),V=V||.5,s=s||16,G=G||16,$=($!==l?$:0)-b,D=D!==l?D:x,U=U!==l?U:0,q=q!==l?q:b;var O,m,g=[],i=[],F=this.vertices,u=this.faces,h=this.faceVertexUvs;for(m=0;G>=m;m++){var y=[],L=[];for(O=0;s>=O;O++){var n=O/s,A=m/G,J=new $f;J.x=-V*z($+n*D)*K(U+A*q),J.y=V*z(U+A*q),J.z=V*K($+n*D)*K(U+A*q),F.push(J),y.push(F.length-1),L.push(new Ar(n,A))}g.push(y),i.push(L)}for(m=0;G>m;m++)for(O=0;s>O;O++){var S=g[m][O+1],M=g[m][O],d=g[m+1][O],v=g[m+1][O+1],Y=F[S].clone().normalize(),p=F[M].clone().normalize(),I=F[d].clone().normalize(),X=F[v].clone().normalize(),H=i[m][O+1].clone(),j=i[m][O].clone(),t=i[m+1][O].clone(),T=i[m+1][O+1].clone();r(F[S].y)===V?(H.x=(H.x+j.x)/2,u.push(new Kr(S,d,v,[Y,I,X])),h[0].push([H,t,T])):r(F[d].y)===V?(t.x=(t.x+T.x)/2,u.push(new Kr(S,M,d,[Y,p,I])),h[0].push([H,j,t])):(u.push(new Kr(S,M,v,[Y,p,X])),h[0].push([H,j,T]),u.push(new Kr(M,d,v,[p.clone(),I,X.clone()])),h[0].push([j.clone(),t,T.clone()]))}};Mq.prototype=ec(mc);var qf=function(X,k,m,p,S,U){ug.call(this),X=X||.33,k=k||.17,p=p||8,m=m||6,S=S||0,U=U||x;for(var I=new $f,B=[],d=[],G=0;p>=G;G++)for(var o=G/p*x+b,O=0;m>=O;O++){var h=O/m*U+S;I.x=X*z(h),I.z=-X*K(h);var s=new $f,j=X+k*z(o);s.x=j*z(h),s.z=-j*K(h),s.y=k*K(o),this.vertices.push(s),B.push(new Ar(O/m,1-G/p)),d.push(s.clone().sub(I).normalize())}for(var G=1;p>=G;G++)for(var O=1;m>=O;O++){var L=(m+1)*G+O-1,D=(m+1)*(G-1)+O-1,w=(m+1)*(G-1)+O,P=(m+1)*G+O,Q=new Kr(L,D,P,[d[L].clone(),d[D].clone(),d[P].clone()]);this.faces.push(Q),this.faceVertexUvs[0].push([B[L].clone(),B[D].clone(),B[P].clone()]),Q=new Kr(D,w,P,[d[D].clone(),d[w].clone(),d[P].clone()]),this.faces.push(Q),this.faceVertexUvs[0].push([B[D].clone(),B[w].clone(),B[P].clone()])}this.computeFaceNormals()};qf.prototype=ec(mc);var Qp=function($,o,s){return $?(ug.call(this),$=$ instanceof Array?$:[$],this.addShapeList($,o),o.convertYZ!==!1&&lg(this,s),this.computeFaceNormals(),void 0):($=[],void 0)},Aq=Qp.prototype=ec(ug.prototype);Aq.addShapeList=function(m,E){for(var B=m.length,W=0;B>W;W++){var t=m[W];this.addShape(t,E)}},Aq.addShape=function(V,E){function F(){if(E.bottom)for(var C=0;Q>C;C++)J=G[C],U(J[2],J[1],J[0],!0);if(E.top)for(C=0;Q>C;C++)J=G[C],U(J[0]+M*o,J[1]+M*o,J[2]+M*o,!1)}function q(){var I=0;for(H(P,I),I+=P.length,z=0,A=p.length;A>z;z++)W=p[z],H(W,I),I+=W.length}function H(O,J){for(var t,K,w=O.length;--w>=0;){t=w,K=w-1,0>K&&(K=O.length-1);var s=0,W=o;for(s=0;W>s;s++){var A=M*s,C=M*(s+1),V=J+t+A,j=J+K+A,k=J+K+C,m=J+t+C;B(V,j,k,m,O,s,W,t,K)}}}function h(I,i,s){v.vertices.push(new $f(I,i,s))}function U(B,j,$,R){B+=K,j+=K,$+=K,v.faces.push(new Kr(B,j,$,null,null,R?2:1));var G=R?m.generateBottomUV(v,V,E,B,j,$):m.generateTopUV(v,V,E,B,j,$);v.faceVertexUvs[0].push(G)}function B(W,i,y,d,q,M,u,R,T){W+=K,i+=K,y+=K,d+=K,v.faces.push(new Kr(W,i,d)),v.faces.push(new Kr(i,y,d));var s=m.generateSideWallUV(v,V,q,E,W,i,y,d,M,u,R,T);v.faceVertexUvs[0].push([s[0],s[1],s[3]]),v.faceVertexUvs[0].push([s[1],s[2],s[3]])}var I,x,Y,D,u,R=E.amount,j=E.curveSegments||Hr,o=E.steps||1,k=E.extrudePath,Z=!1,m=new Gj(E.repeatUVLength);k&&(I=k.getSpacedPoints(o),Z=!0,x=E.frames!==l?E.frames:new $d.FrenetFrames(k,o,!1),Y=new $f,D=new $f,u=new $f);var W,z,A,v=this,K=this.vertices.length,S=V.extractPoints(j),d=S.shape,p=S.holes,n=!il.isClockWise(d);if(n){for(d=d.reverse(),z=0,A=p.length;A>z;z++)W=p[z],il.isClockWise(W)&&(p[z]=W.reverse());n=!1}var G=il.triangulateShape(d,p),P=d;for(z=0,A=p.length;A>z;z++)W=p[z],d=d.concat(W);for(var _,J,M=d.length,Q=G.length,T=0;M>T;T++)_=d[T],Z?(D.copy(x.normals[0]).multiplyScalar(_.x),Y.copy(x.binormals[0]).multiplyScalar(_.y),u.copy(I[0]).add(D).add(Y),h(u.x,u.y,u.z)):h(_.x,_.y,0);var b;for(b=1;o>=b;b++)for(T=0;M>T;T++)_=d[T],Z?(D.copy(x.normals[b]).multiplyScalar(_.x),Y.copy(x.binormals[b]).multiplyScalar(_.y),u.copy(I[b]).add(D).add(Y),h(u.x,u.y,u.z)):h(_.x,_.y,R/o*b);F(),q()};var $d=function(A,E,h,$,C){function u(h,M,I){return V.vertices.push(new $f(h,M,I))-1}ug.call(this),E=E||64,h=h||1,$=$||8,C=C||!1;var k,c,X,y,l,W,a,v,r,H,F,Z,D,n,t,b,p,q,Y,Q,o=[],V=this,S=E+1,U=new $f,B=new $d.FrenetFrames(A,E,C),m=B.tangents,G=B.normals,O=B.binormals;for(this.tangents=m,this.normals=G,this.binormals=O,r=0;S>r;r++)for(o[r]=[],y=r/(S-1),v=A.getPointAt(y),k=m[r],c=G[r],X=O[r],H=0;$>H;H++)l=H/$*x,W=-h*z(l),a=h*K(l),U.copy(v),U.x+=W*c.x+a*X.x,U.y+=W*c.y+a*X.y,U.z+=W*c.z+a*X.z,o[r][H]=u(U.x,U.y,U.z);for(r=0;E>r;r++)for(H=0;$>H;H++)F=C?(r+1)%E:r+1,Z=(H+1)%$,D=o[r][H],n=o[F][H],t=o[F][Z],b=o[r][Z],p=new Ar(r/E,H/$),q=new Ar((r+1)/E,H/$),Y=new Ar((r+1)/E,(H+1)/$),Q=new Ar(r/E,(H+1)/$),this.faces.push(new Kr(D,n,b)),this.faceVertexUvs[0].push([p,q,Q]),this.faces.push(new Kr(n,t,b)),this.faceVertexUvs[0].push([q.clone(),Y,Q.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};$d.prototype=ec(mc),$d.FrenetFrames=function(i,d,_){function K(){q[0]=new $f,Q[0]=new $f,Z=Number.MAX_VALUE,U=r(g[0].x),s=r(g[0].y),W=r(g[0].z),Z>=U&&(Z=U,o.set(1,0,0)),Z>=s&&(Z=s,o.set(0,1,0)),Z>=W&&o.set(0,0,1),y.crossVectors(g[0],o).normalize(),q[0].crossVectors(g[0],y),Q[0].crossVectors(g[0],q[0])}var m,Z,U,s,W,I,A,o=new $f,g=[],q=[],Q=[],y=new $f,v=new Tl,F=d+1,e=1e-4;for(this.tangents=g,this.normals=q,this.binormals=Q,I=0;F>I;I++)A=I/(F-1),g[I]=i.getTangentAt(A),g[I].normalize();for(K(),I=1;F>I;I++)q[I]=q[I-1].clone(),Q[I]=Q[I-1].clone(),y.crossVectors(g[I-1],g[I]),y.length()>e&&(y.normalize(),m=H(Oh(g[I-1].dot(g[I]),-1,1)),q[I].applyMatrix4(v.makeRotationAxis(y,m))),Q[I].crossVectors(g[I],q[I]);if(_)for(m=H(Oh(q[0].dot(q[F-1]),-1,1)),m/=F-1,g[0].dot(y.crossVectors(q[0],q[F-1]))>0&&(m=-m),I=1;F>I;I++)q[I].applyMatrix4(v.makeRotationAxis(g[I],m*I)),Q[I].crossVectors(g[I],q[I])};var Ir=function(W,w,J,G){ug.call(this),w=w||18,J=J||0,G=G==h?x:G;for(var u=1/(W.length-1),k=1/w,I=0,n=w;n>=I;I++)for(var U=J+I*k*G,l=z(U),R=K(U),r=0,A=W.length;A>r;r++){var Q=W[r],t=new $f;t.x=l*Q.x-R*Q.y,t.y=R*Q.x+l*Q.y,t.z=Q.z,this.vertices.push(t)}for(var C=W.length,I=0,n=w;n>I;I++)for(var r=0,A=W.length-1;A>r;r++){var o=r+C*I,N=o,e=o+C,l=o+1+C,E=o+1,g=I*k,L=r*u,y=g+k,X=L+u;this.faces.push(new Kr(N,E,e)),this.faceVertexUvs[0].push([new Ar(g,L),new Ar(g,X),new Ar(y,L)]),this.faces.push(new Kr(e,E,l)),this.faceVertexUvs[0].push([new Ar(y,L),new Ar(g,X),new Ar(y,X)])}this.mergeVertices(),lg(this),this.computeFaceNormals(),this.computeVertexNormals()};Ir.prototype=ec(mc);var ko=function(k,h){h=h||{};var B=Oj.generateShapes(k,h);h.amount=h.amount!==l?h.amount:.5,h.convertYZ=!1,h.fill!==!1&&(h.bottom=!0,h.top=!0),Qp.call(this,B,h)};ko.prototype=ec(Aq);var lf=u.Node=function(){Yn(lf,this)},_p={X:mn,Y:ed,Z:Zp},qr={X:0,Y:1,Z:2},fd={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},fs="xzy",Ij=function($,J,u){if(J){var k=J[0],g=J[1],o=J[2];"xzy"===u?(ed($,g),Zp($,o),mn($,k)):"xyz"===u?(Zp($,o),ed($,g),mn($,k)):"yxz"===u?(Zp($,o),mn($,k),ed($,g)):"yzx"===u?(mn($,k),Zp($,o),ed($,g)):"zxy"===u?(ed($,g),mn($,k),Zp($,o)):"zyx"===u?(mn($,k),ed($,g),Zp($,o)):(ed($,g),Zp($,o),mn($,k))}};Jf("Node",yh,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:fs,_64O:0,_rotationX:0,_53O:0,_host:h,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Dm},_22Q:function(){return ie},getX:function(){return this.p().x},setX:function($){this.p($,this.p().y)},getY:function(){return this.p().y},setY:function(h){this.p(this.p().x,h)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(k){this.setAnchor(k,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(o){this.setAnchor(this.getAnchor().x,o)},getScaleX:function(){return this.getScale().x},setScaleX:function(y){this.setScale(y,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(G){this.setScale(this.getScale().x,G)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(B,w){ho(B,Ed(h,h,this.r3(),this.getRotationMode())),this.translate3d(B[0]*w,B[1]*w,B[2]*w)},translateFront:function(h){this.translate3dBy([0,0,1],h)},translateBack:function(t){this.translate3dBy([0,0,-1],t)},translateLeft:function(f){this.translate3dBy([-1,0,0],f)},translateRight:function(c){this.translate3dBy([1,0,0],c)},translateTop:function(A){this.translate3dBy([0,1,0],A)},translateBottom:function(B){this.translate3dBy([0,-1,0],B)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(s,w,z){1===arguments.length&&(w=s[1],z=s[2],s=s[0]),this.p(s,z),this.setElevation(w)},translate3d:function(W,O,D){1===arguments.length&&(O=W[1],D=W[2],W=W[0]),this.translate(W,D),this.setElevation(this._54O+O)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(p,d,f){1===arguments.length&&(d=p[1],f=p[2],p=p[0]),this.setSize(p,f),this.setTall(d)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(s,r,l){1===arguments.length&&(r=s[1],l=s[2],s=s[0]),this.setRotationX(s),this.setRotation(-r),this.setRotationZ(l)},setRotationY:function(Y){this.setRotation(-Y)},getRotationY:function(){return-this._64O},lookAtDirection:function(W,L){L=L||Ak;var q=this,_=Im(W);L===Ak?(q.r3([-p(W[1]/_),-i(W[2],W[0])+g,0]),q.setRotationMode("xzy")):L===lp?(q.r3(0,-i(W[2],W[0]),p(W[1]/_)),q.setRotationMode("zyx")):L===nh?(q.r3(0,-i(W[2],W[0])+b,-p(W[1]/_)),q.setRotationMode("zyx")):L===mj?(q.r3([-p(W[1]/_)+g,-i(W[2],W[0])+g,0]),q.setRotationMode("xzy")):L===Sh&&(q.r3([-p(W[1]/_)-g,-i(W[2],W[0])+g,0]),q.setRotationMode("xzy")),L===ii&&(q.r3([-p(W[1]/_)+b,-i(W[2],W[0])+g,b]),q.setRotationMode("zxy"))},lookAt:function(y,P){return this.lookAtDirection(Fn(y,this.p3()),P)},lookAtX:function(){var z=new tc,H=new tc,e=new tc,P=new cc,W=new cc,k=new u.Math.Euler;return function(N,c,A){c===nh||c===lp?P.makeRotationAxis(new u.Math.Vector3(0,1,0),Math.PI/2):c===mj||c===Sh?P.makeRotationAxis(new u.Math.Vector3(1,0,0),Math.PI/2):P.identity(),c===Sh||c===lp||c===ii?(z.fromArray(this.p3()),H.fromArray(N)):(z.fromArray(N),H.fromArray(this.p3())),W.lookAt(z,H,A?e.fromArray(A):e.set(0,1,0)),k.setFromRotationMatrix(W.multiply(P),Vc.ReverseOrder(this.getRotationMode())),this.r3([k.x,k.y,k.z])}}(),getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(w){var b=this;if(b!==w&&b._host!==w){var c=b._host;c&&c._removeAttach(b),b._host=w,b._host&&b._host._addAttach(b),b.fp("host",c,w),b.onHostChanged(c,w)}},getAttaches:function(){return this._69O},_addAttach:function(O){var e=this;e._69O||(e._69O=new mo),e._69O.add(O),e.fp("attaches",h,O)},_removeAttach:function(i){var u=this;u._69O.remove(i),u._69O.isEmpty()&&delete u._69O,u.fp("attaches",i,h)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(c){var u=this;u._44I||(u._44I=new mo),u._42I||(u._42I=new mo),u._44I.add(c),u._42I.add(c),u._20I()},_4I:function(D){var C=this;C._44I||(C._44I=new mo),C._43I||(C._43I=new mo),C._44I.add(D),C._43I.add(D),C._20I()},_16I:function(j){var V=this;V._44I.remove(j),V._42I.remove(j),V._44I.isEmpty()&&delete V._44I,V._42I.isEmpty()&&delete V._42I,V._20I()},_18I:function(h){var T=this;T._44I.remove(h),T._43I.remove(h),T._44I.isEmpty()&&delete T._44I,T._43I.isEmpty()&&delete T._43I,T._20I()},_20I:function(){var G=this;if(delete G._45I,!G._44I||G._44I.isEmpty())return delete G._70O,void 0;var r;G._44I.each(function(x){x.isLooped()&&(r||(r={}),r[x._id]||(G._45I||(G._45I=new mo),G._45I.add(x),r[x._id]=x))}),r?(G._70O=new mo,G._44I.each(function(I){r[I._id]?"A"===r[I._id]||(r[I._id]="A",G._70O.add(I)):G._70O.add(I)})):G._70O=G._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(R){var s=this;s._46I||(s._46I=new mo),s._48I||(s._48I=new mo),s._46I.add(R),s._48I.add(R),s._19I()},_3I:function(V){var A=this;A._47I||(A._47I=new mo),A._48I||(A._48I=new mo),A._47I.add(V),A._48I.add(V),A._19I()},_15I:function(e){var Y=this;Y._46I.remove(e),Y._48I.remove(e),Y._46I.isEmpty()&&delete Y._46I,Y._48I.isEmpty()&&delete Y._48I,Y._19I()},_17I:function(m){var I=this;I._47I.remove(m),I._48I.remove(m),I._47I.isEmpty()&&delete I._47I,I._48I.isEmpty()&&delete I._48I,I._19I()},_19I:function(){var i=this;delete i._49I;var o=i._48I;if(o&&!o.isEmpty()){var m={};o.each(function(H){m[H._id]?i._49I||(i._49I=new mo):m[H._id]=H}),i._49I?o.each(function(E){m[E._id]&&(i._49I.add(E),delete m[E._id])}):i._49I=o}},getImage:function(){if(this._pendingCheckImageJSON){var h=C.getImage(this._image);h&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof Mo&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(F){var D=this,P=D._image,N=D.getWidth(),a=D.getHeight();D._image=F,D.fp("image",P,F)&&(null!=F&&(An(F)||Tf(F)&&/\.json$/i.test(F))&&(this._pendingCheckImageJSON=!0),D.fp($h,N,D.getWidth()),D.fp(dd,a,D.getHeight()))},getElevation:function(){return this._54O},setElevation:function(E){var Y=this;if(!Y._50O){Y._50O=1;var A=Y._54O;Y._54O=E,Y.fp(Qh,A,E),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(R){var v=this;
if(!v._49O){v._49O=1;var D=v._64O;v._64O=R,v.fp(Yf,D,R),delete v._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(N){var y=this;if(!y._51O){y._51O=1;var B=y._rotationX;y._rotationX=N,y.fp("rotationX",B,N),delete y._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(h){var q=this;if(!q._52O){q._52O=1;var n=q._53O;q._53O=h,q.fp("rotationZ",n,h),delete q._52O}},getPosition:function(){return this._position},setPosition:function(p,o){var m=this;if(!m._50I){m._50I=1;var N;if(N=2===arguments.length?{x:p,y:o}:p,N.x!==m._position.x||N.y!==m._position.y){var J=m._position;m._position=N,m.fp(Zo,J,N)}delete m._50I}},translate:function(_,O){var s=this._position;this.p(s.x+_,s.y+O)},getWidth:function(){var u=this;if(u._width>=0)return u._width;var j=u.getStyle("shape3d");if(j){var E=id(j);if(E&&E.rawS3)return E.rawS3[0];if("billboard"===j||"plane"===j){var F=ef(u.getStyle("shape3d.image"));return F?iq(F,u):20}}var F=ef(u._image);return F?iq(F,u):20},setWidth:function(G){var j=this,z=j._width;j._width=G,j.fp($h,z,G)},getHeight:function(){var e=this;if(e._height>=0)return e._height;var m=e.getStyle("shape3d");if(m){var i=id(m);if(i&&i.rawS3)return i.rawS3[2];if("plane"===m){var p=ef(e.getStyle("shape3d.image"));return p?Yh(p,e):20}if("billboard"===m)return 2}var p=ef(e._image);return p?Yh(p,e):20},setHeight:function(L){var W=this,u=W._height;W._height=L,W.fp(dd,u,L)},getTall:function(){var s=this;if(s._tall>=0)return s._tall;var R=s.getStyle("shape3d");if(R){var k=id(R);if(k&&k.rawS3)return k.rawS3[1];if("billboard"===R){var E=ef(s.getStyle("shape3d.image"));return E?Yh(E,s):20}if("plane"===R)return 2}return 20},setTall:function($){var Q=this,r=Q._tall;Q._tall=$,Q.fp("tall",r,$)},setSize:function(P,C){var s=this;2===arguments.length?(s.setWidth(P),s.setHeight(C)):(s.setWidth(P.width),s.setHeight(P.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(f,a,j,O,U){var l=this,M=l.getAnchor(),$=l.getScale();arguments.length<=2&&(U=a,a=f.y,j=f.width,O=f.height,f=f.x);var r=U&&$.x<0?1-M.x:M.x,c=U&&$.y<0?1-M.y:M.y;l.p(f+j*r,a+O*c),U&&(j/=Math.abs($.x),O/=Math.abs($.y)),l.setWidth(j),l.setHeight(O)},getMatrix:function(){var V=this,q=V._64O,J=V._position,X=V.getScale();return new rb(q,J.x,J.y,X.x,X.y)},getAnchorRect:function(){var J=this,P=J.getWidth(),i=J.getHeight(),y=J.getAnchor();return{x:-P*y.x,y:-i*y.y,width:P,height:i}},toLocal:function($){return this.getMatrix().tfi($)},toGlobal:function(b){return this.getMatrix().tf(b)},getAttachPosition:function(){var a=new rb;return function(S,j,W,B){W=W||0,B=B||0;var f=this,b=f.getAnchor(),d=f._64O,s=f._position,g=f.getScale();return a.setFromTransform(d,s.x,s.y).tf({x:W+g.x*f.getWidth()*(S-b.x),y:B+g.y*f.getHeight()*(j-b.y)})}}(),isInRect:function(z){z=this.toLocal(z);var s=this.getWidth(),N=this.getHeight();return z.x+=s*this.getAnchorX(),z.y+=N*this.getAnchorY(),!(z.x<0||z.y<0||z.x>s||z.y>N)},getRect:function(){var C=this,K=C.getWidth(),H=C.getHeight(),y=C.getAnchor(),l={x:-K*y.x,y:-H*y.y,width:K,height:H},V=C.getMatrix();return l=Vn([V.tf(l.x,l.y),V.tf(l.x+l.width,l.y),V.tf(l.x+l.width,l.y+l.height),V.tf(l.x,l.y+l.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var o=this,W=o.getAnchor(),q=o._anchorElevation;return{x:W.x,y:q,z:W.y}},setAnchorElevation:function(c){var x=this,P=x._anchorElevation;return P!==c?(x._anchorElevation=c,x.fp("anchorElevation",P,c),!0):!1},setAnchor3d:function(u,U,Y,n){var j,m=this;"number"==typeof u?j={x:u,y:U,z:Y}:(j=u.length?{x:u[0],y:u[1],z:u[2]}:u,n=U);var Z=m.getDataModel();Z&&Z.beginTransaction();var F=m.getAnchor3d(),N=m.setAnchor(j.x,j.z);if(m.setAnchorElevation(j.y)&&(N=!0),N&&n&&!zm){m.getAnchor3d();var A=or(m),Q=ho([j.x-F.x,j.y-F.y,j.z-F.z],A);m.p3(Q)}return Z&&Z.endTransaction(),N},getAnchor:function(){var M=this;if(M.hasOwnProperty("_anchor"))return M._anchor;var C=ef(M._image);return C&&C.anchorX!==l?{x:C.anchorX,y:C.anchorY}:M._anchor},setAnchor:function(m,x,C){var t,c=this;"number"==typeof m?t={x:m,y:x}:(t=m.length?{x:m[0],y:m[1]}:m,C=x);var h=c.getAnchor();if(h.x!==t.x||h.y!==t.y){var b=c.getDataModel();if(b&&b.beginTransaction(),c._anchor=t,c.fp("anchor",h,t),C&&!zm){var l=c.getPosition(),S=c.getSize(),E=c.getRotation(),Z=c.getScale(),D=-S.width*(h.x-t.x)*Z.x,u=-S.height*(h.y-t.y)*Z.y,d=K(E),W=z(E);c.setPosition(l.x+W*D-d*u,l.y+d*D+W*u)}return b&&b.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(i,k){var $,V=this;$=2===arguments.length?{x:i,y:k}:i;var W=V.getScale();(W.x!==$.x||W.y!==$.y)&&(V._scale=$,V.fp("scale",W,$))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var o=this,G=o._scaleTall,J=o.getScale();return[J.x,G,J.y]},getFinalScale3d:function(){var D=this,L=D.s3(),k=D._dynamicScale3d,w=D.getScale3d();return L&&(w[0]*=L[0],w[1]*=L[1],w[2]*=L[2]),k&&(w[0]*=k[0],w[1]*=k[1],w[2]*=k[2]),w},getFinalRotation3d:function(){var s=this;return s._dynamicRotation||s.r3()},setScaleTall:function(y){var D=this,N=D._scaleTall;N!==y&&(D._scaleTall=y,D.fp("scaleTall",N,y))},setScale3d:function(F,m,A){var Z,u=this;Z="number"==typeof F?{x:F,y:m,z:A}:F.length?{x:F[0],y:F[1],z:F[2]}:F,u.setScaleTall(Z.y),u.setScale(Z.x,Z.z)},getCorners:function($,w){$==h&&($=0),w==h&&(w=$);var D=this,n=D.getAnchor(),N=D.getWidth(),Q=D.getHeight(),q=-N*n.x-$,L=-Q*n.y-w,r=N+2*$,A=Q+2*w,s=D.getMatrix();return[s.tf(q,L),s.tf(q,L+A),s.tf(q+r,L+A),s.tf(q+r,L)]},getEditControlPoints:function(n,_,H){_==h&&(_=0),H==h&&(H=_);var m=this,M=m.getAnchor(),L=m.getWidth(),P=m.getHeight(),x=-L*M.x-_,w=-P*M.y-H,z=L+2*_,p=P+2*H;if(n)return[{x:x,y:w},{x:x,y:0},{x:x,y:w+p},{x:0,y:w+p},{x:x+z,y:w+p},{x:x+z,y:0},{x:x+z,y:w},{x:0,y:w}];var R=m.getMatrix();return[R.tf(x,w),R.tf(x,0),R.tf(x,w+p),R.tf(0,w+p),R.tf(x+z,w+p),R.tf(x+z,0),R.tf(x+z,w),R.tf(0,w)]},rotateAt:function(h,e,O){var $=this,o=$._position,f=$._64O,U=new rb(f,o.x,o.y).tf(h,e),R=W(h*h+e*e),Q=i(o.y-U.y,o.x-U.x)+O;$.setRotation(f+O),$.p(U.x+R*z(Q),U.y+R*K(Q))},onParentChanged:function(){lf.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(E){E._7I()})},onPropertyChanged:function(){var t={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(d){t[d]=!0}),function(P){var R=this;lf.superClass.onPropertyChanged.call(R,P),t[P.property]&&!R._layoutUpdating&&R.updateLayoutParameters(null,P.property),R._69O&&R._69O.each(function(C){C.handleHostPropertyChange(P)}),R._49I&&R._49I.each(function(n){n.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(z){this.updateAttach(z)},onStyleChanged:function(E){lf.superClass.onStyleChanged.apply(this,arguments),cb[E]&&this.updateAttach()},updateAttach:function(j){var s=this;s._51I||zm||(s._51I=1,s._71O(j),delete s._51I)},_71O:function(l){var Y,N,x,g,F,d,j=this,C=j._host,B=l?l.property:h,y=l?l.oldValue:h,M=l?l.newValue:h;if(C instanceof u.Grid){if(B===Qh)j.setElevation(j._54O+M-y);else if(!l||Sb[B]){if(Y=j.s("attach.row.index"),N=j.s("attach.column.index"),x=C.getCellRect(Y,N),!x)return;g=j.s("attach.row.span"),F=j.s("attach.column.span"),(1!==g||1!==F)&&(x=Xd(x,C.getCellRect(Y+g-1,N+F-1))),og(x,j,"attach.padding",1),j.setRect(x)}}else if(C instanceof ad&&(d=j.s("attach.index"))>=0&&(!l||Ve[B])){var t=j.s("attach.thickness");t!=h&&j.setHeight(C.getThickness()*t);var f=j.s("attach.offset"),r=C.getPoints(),X=r.size();if(X>d){var G=r.get(d),k=X===d+1?r.get(0):r.get(d+1),A=[k.x-G.x,k.y-G.y],m=Im(A);if(m){j.s("attach.offset.relative")&&(f*=m),j.s("attach.offset.opposite")&&(f=m-f);var K={x:G.x+A[0]/m*f,y:G.y+A[1]/m*f},R=j.s("attach.gap");R&&(j.s("attach.gap.relative")&&(R*=C.getThickness()),K=Cf(h,K,k,R)),j.p(K),j.setRotation(i(A[1],A[0]))}}}else l&&(B===Zo?j.translate(M.x-y.x,M.y-y.y):B===Qh?j.setElevation(j._54O+M-y):ds[B]?j._11Q(C,B,M-y):("anchor"===B||"width"===B||"height"===B||"scale"===B)&&j.layout(C))},_11Q:function(){var U=new u.Math.Euler,T=u.Math.Euler.ReverseOrder,H=new u.Math.Vector2,J=new u.Math.Vector2;return function(w,_,G){var C=this,K=w.p3(),z=w.r3(),X=C.p3(),A=C.r3();if(_===Yf&&(_="rotationY",G=-G),(_===Yf||"rotationY"===_)&&0===A[0]&&0===A[2]&&0===z[0]&&0===z[2]&&0===X[1]&&0===K[1])return C.setRotation(-A[1]-G),H.set(X[0],X[2]).rotateAround(J.set(K[0],K[2]),-G),C.p(H.x,H.y),void 0;var W=fd[w.getRotationMode()],s=W[0],Z=W[1],k=W[2],g=_p[s],i=_p[Z],n=_p[k],I=Jr();_===Yf+s?(n(I,z[qr[k]]),i(I,z[qr[Z]]),g(I,G),i(I,-z[qr[Z]]),n(I,-z[qr[k]])):_===Yf+Z?(n(I,z[qr[k]]),i(I,G),n(I,-z[qr[k]])):_===Yf+k&&n(I,G);var O=Fn(X,K);ho(O,I),C.p3(K[0]+O[0],K[1]+O[1],K[2]+O[2]);var L=C.getRotationMode();Ij(I,C.r3(),L),U.setFromRotationMatrix(I,T(L)),C.r3([U.x,U.y,U.z])}}(),isHostOn:function(s){var L=this;if(L._host&&s&&s._69O)for(var H={},n=L._host;n&&n!==L&&!H[n._id];){if(n===s)return!0;H[n._id]=n,n=n._host}return!1},isLoopedHostOn:function(V){return this.isHostOn(V)&&V.isHostOn(this)},getScaledSize:function(){var r=this.getSize(),O=this.getScale();return r.width*=Math.abs(O.x),r.height*=Math.abs(O.y),r},layout:function(o){if(o=o||this.getHost()){var T=this,N=T.s("layout.h")||"center",s=T.s("layout.v")||"center";if("center"!==N||"center"!==s){var x=new u.Math.Vector2,f=o.getPosition(),Z=o.getAnchor(),j=o.getScaledSize();T.getPosition();var r,t,W,Y,I,D=1,$=1;switch(T._layoutUpdating=!0,N){case"left":x.setX(T._layoutHValue-Z.x*j.width);break;case"right":x.setX((1-Z.x)*j.width-T._layoutHValue);break;case"leftright":r=j.width-T._layoutHValue[2],W=T.getRotation()-o.getRotation(),Y=Math.abs(Math.sin(W)),I=Math.abs(Math.cos(W)),D+=I*r/T._layoutHValue[3],$+=Y*r/T._layoutHValue[4],x.setX(T._layoutHValue[1]+(T._layoutHValue[5]-Z.x)*j.width);break;case"center":x.setX((.5-Z.x)*j.width-T._layoutHValue);break;case"scale":W=T.getRotation()-o.getRotation(),Y=Math.abs(Math.sin(W)),I=Math.abs(Math.cos(W)),x.setX((.5-Z.x)*j.width-T._layoutHValue[1]*j.width/T._layoutHValue[0]),t=j.width/T._layoutHValue[2]-1,D+=I*t,$+=Y*t}switch(s){case"top":x.setY(T._layoutVValue-Z.y*j.height);break;case"bottom":x.setY((1-Z.y)*j.height-T._layoutVValue);break;case"topbottom":W||(W=T.getRotation()-o.getRotation(),Y=Math.abs(Math.sin(W)),I=Math.abs(Math.cos(W))),r=j.height-T._layoutVValue[2],D+=Y*r/T._layoutVValue[3],$+=I*r/T._layoutVValue[4],x.setY(T._layoutVValue[1]+(T._layoutVValue[5]-Z.y)*j.height);break;case"center":x.setY((.5-Z.y)*j.height-T._layoutVValue);break;case"scale":W||(W=T.getRotation()-o.getRotation(),Y=Math.abs(Math.sin(W)),I=Math.abs(Math.cos(W))),x.setY((.5-Z.y)*j.height-T._layoutVValue[1]*j.height/T._layoutVValue[0]),t=j.height/T._layoutVValue[2]-1,D+=Y*t,$+=I*t}(1!==D||1!==$)&&("leftright"===N||"scale"===N?T.setSize(T._layoutHValue[3]*D,T._layoutHValue[4]*$):T.setSize(T._layoutVValue[3]*D,T._layoutVValue[4]*$)),x.rotateAround(null,o.getRotation()),this.setPosition(x.x+f.x,x.y+f.y),T._layoutUpdating=l}}},updateLayoutParameters:function(p,i){if(p=p||this.getHost()){var Z=this,U=Z.s("layout.h"),$=Z.s("layout.v");if(U||$){var z,w,f,d,r,O,V=new u.Math.Vector2,P=p.getPosition(),J=p.getAnchor(),K=p.getScaledSize(),y=Z.getPosition(),B=Z.getSize();switch(V.set(y.x-P.x,y.y-P.y),V.rotateAround(null,-p.getRotation()),U){case"left":Z._layoutHValue=V.x+J.x*K.width;break;case"right":Z._layoutHValue=-V.x+(1-J.x)*K.width;break;case"center":Z._layoutHValue=-V.x+(.5-J.x)*K.width;break;case"leftright":case"scale":"scale"===U?z=-V.x+(.5-J.x)*K.width:(w=Z.getAnchor(),f=Z.getRotation()-p.getRotation(),d=Math.cos(f),r=Math.sin(f),O=-Math.min(-w.x*d+w.y*r,-w.x*d-(1-w.y)*r,(1-w.x)*d+w.y*r,(1-w.x)*d-(1-w.y)*r),z=V.x-(O-J.x)*K.width),"position"===i&&"object"==typeof Z._layoutHValue?(Z._layoutHValue[0]=K.width,Z._layoutHValue[1]=z):Z._layoutHValue=[K.width,z,K.width,B.width,B.height,O]}switch($){case"top":Z._layoutVValue=V.y+J.y*K.height;break;case"bottom":Z._layoutVValue=-V.y+(1-J.y)*K.height;break;case"center":Z._layoutVValue=-V.y+(.5-J.y)*K.height;break;case"topbottom":case"scale":"scale"===$?z=-V.y+(.5-J.y)*K.height:(f||(w=Z.getAnchor(),f=Z.getRotation()-p.getRotation(),d=Math.cos(f),r=Math.sin(f)),O=-Math.min(-w.x*r-w.y*d,-w.x*r+(1-w.y)*d,(1-w.x)*r-w.y*d,(1-w.x)*r+(1-w.y)*d),z=V.y-(O-J.y)*K.height),"position"===i&&"object"==typeof Z._layoutVValue?(Z._layoutVValue[0]=K.height,Z._layoutVValue[1]=z):Z._layoutVValue=[K.height,z,K.height,B.width,B.height,O]}}}},getSerializableProperties:function(){var T=lf.superClass.getSerializableProperties.call(this);return No(T,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),T}});var Dj=u.Edge=function(a,U){var D=this;Yn(Dj,D),D.setSource(a),D.setTarget(U)};Jf("Edge",yh,{_icon:"edge_icon",getUIClass:function(){return Sd},_22Q:function(){return ui},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(b){var _=this;if(_._source!==b){var A=_._source;_._source=b,A&&A._16I(_),b&&b._2I(_),_._7I(),_.fp("source",A,b)}},setTarget:function(r){var B=this;if(B._target!==r){var P=B._target;B._target=r,P&&P._18I(B),r&&r._4I(B),B._7I(),B.fp("target",P,r)}},isLooped:function(){var V=this;return V._source===V._target&&!!V._source&&!!V._target},onPropertyChanged:function(){},_7I:function(){var p,k=this,r=Re(k);k._40I!==r&&(p=this._40I,p&&p._15I(k),k._40I=r,r&&r._1I(k),k.fp("sourceAgent",p,r),dj(p,k._41I),dj(r,k._41I));var t=Rg(k);k._41I!==t&&(p=k._41I,p&&p._17I(k),k._41I=t,t&&t._3I(k),k.fp("targetAgent",p,t),dj(p,k._40I),dj(t,k._40I))},_22I:function(R){this._52I=R,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var E=this;return E._52I&&E._52I.get(0)!==E&&!E.getStyle(hq)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var q=this,m=q._52I;return m&&!q.getStyle(hq)&&m.size()>1&&q===m.get(0)},toggle:function(){var I=this._52I,n=!this.s(hq);I&&I.size()>1&&(I.each(function(Q){Q.s(hq,n)}),I.getSiblings().each(function(f){f!==I&&f.each(function(X){X.fp("edgeGroup",h,f)})}))},setStyle:function(Z,q){(Z===Qn||"edge.segments"===Z)&&(q=ck(q)),Dj.superClass.setStyle.call(this,Z,q)},onStyleChanged:function(z){Dj.superClass.onStyleChanged.apply(this,arguments),Ul[z]&&dj(this._41I,this._40I)},getSerializableProperties:function(){var y=Dj.superClass.getSerializableProperties.call(this);return No(y,{source:1,target:1}),y}});var kd=u.Group=function(){Yn(kd,this)};Jf("Group",lf,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return wq},onChildAdded:function(){kd.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){kd.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var w=this;if(!w._54I&&!zm){var C=w.getChildrenRect();C&&(w._53I=1,w.p(hm(w.s("group.position"),C,w.getSize())),delete w._53I)}},getChildrenRect:function(){var m,K=this;return K.eachChild(function(G){bh(G)&&(m=Xd(m,K.getChildRect(G)))}),m},getChildRect:function(v){var x;return bh(v)&&v.s(so)&&(xq(v)&&v.isExpanded()&&v.eachChild(function(k){x=Xd(x,v.getChildRect(k))}),!x&&v.getRect&&(x=v.getRect())),x},setPosition:function(Q,Z){var E=this;if(!E._54I){var W;W=2===arguments.length?{x:Q,y:Z}:Q,zm||E._53I||(E._54I=1,fo(E._children,W.x-E._position.x,W.y-E._position.y),delete E._54I),kd.superClass.setPosition.call(this,W)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(A){var j=this;if(j._57O!==A){var K=j._57O;j._57O=A,j.fp("expanded",K,j._57O),j._fireInvalidateDeep(),j._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(l){xq(l)?l._fireInvalidateDeep():l.iv()})},_8I:function(){kd.superClass._8I.call(this),this.eachChild(function(G){bh(G)&&G._8I()})},onStyleChanged:function(z){kd.superClass.onStyleChanged.apply(this,arguments),"group.position"===z&&this._81I()},getSerializableProperties:function(){var u=kd.superClass.getSerializableProperties.call(this);return u.expanded=1,u}});var _e=u.Block=function(){Yn(_e,this)};Jf("Block",lf,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Zl},onChildAdded:function(){_e.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){_e.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var N=this;if(!zm&&!N._updatingToChildren&&N._syncSize&&!N._freezeSyncFromChildren){var c,b,F,u,I,J=[],k=N.getRotation();if(N.eachChild(function(y){bh(y)&&J.push.apply(J,y.getCorners())}),J.length){N._updatingFromChildren=1;var U=z(-k),o=K(-k),T=1/0,V=-1/0,j=1/0,v=-1/0;for(u=0,I=J.length;I>u;u++)F=J[u],c=F.x,b=F.y,F.x=U*c-o*b,F.y=o*c+U*b,T=M(T,F.x),V=m(V,F.x),j=M(j,F.y),v=m(v,F.y);var $=N.getScale();N.setSize(r((V-T)/$.x),r((v-j)/$.y));var E;$.x<0&&(E=T,T=V,V=E),$.y<0&&(E=j,j=v,v=E),U=z(k),o=K(k);var q=N.getAnchor();c=T+(V-T)*q.x,b=j+(v-j)*q.y,N.setPosition(U*c-o*b,o*c+U*b),delete N._updatingFromChildren}}},setPosition:function(b,j){var E=this;if(!E._updatingToChildren){var m;m=2===arguments.length?{x:b,y:j}:b,zm||E._updatingFromChildren||(E._updatingToChildren=1,fo(E._children,m.x-E._position.x,m.y-E._position.y),delete E._updatingToChildren),_e.superClass.setPosition.call(this,m)}},setWidth:function(X){return this.setSize(X,this.getHeight())},setHeight:function(y){return this.setSize(this.getWidth(),y)},setSize:function(h,m){1>h&&(h=1),1>m&&(m=1);var z=this;if(!z._updatingToChildren){2!==arguments.length&&(m=h.height,h=h.width);var Q=z.getWidth(),M=z.getHeight();if(h!==Q&&_e.superClass.setWidth.call(z,h),m!==M&&_e.superClass.setHeight.call(z,m),!zm&&!z._updatingFromChildren){z._updatingToChildren=1;var Z=h/Q,R=m/M;z._adjustChildScaleOrSize(Z,R,"size"),delete z._updatingToChildren,z.updateFromChildren()}}},_adjustChildScaleOrSize:function(x,N,E){var v=this;if(v._syncSize){var r=v.getPosition(),O=v.getRotation();v.getScale(),v.eachChild(function(T){if(bh(T)){var A=T.getPosition(),m=T.getRotation(),d=T.getWidth(),c=T.getHeight(),v=T.getScale(),C=v.x*d,n=v.y*c,W=new rb(m,A.x,A.y,C,n);W.translate(-r.x,-r.y),W.rotate(-O),m=i(W.b*Math.sign(C),W.a*Math.sign(C)),W.scale(x,N);var M,Q,o,b=z(m);if(Math.abs(b)<.001?(M=K(m),Q=W.b/M,o=-W.c/M):(Q=W.a/b,o=W.d/b),"scale"===E)T.setScale(Q/d,o/c);else if("size"===E){var S=Q/v.x,l=o/v.y;T.setScale(Dn(Q)*Math.abs(v.x),Dn(o)*Math.abs(v.y)),T instanceof u.Shape?(T.setWidthForce(Math.max(Math.abs(S),1e-5)),T.setHeightForce(Math.max(Math.abs(l),1e-5))):T.setSize(Math.max(.01,Math.abs(S)),Math.max(.01,Math.abs(l)))}W.rotate(O),W.translate(r.x,r.y),T.setPosition(W.tx,W.ty)}})}},_calcChangeFactor:function(E,R,k,n){var P,i,v,F;return P=r(E),i=r(k),v=P>i?P/i:i/P,P=r(R),i=r(n),F=P>i?P/i:i/P,m(v,F)},setAnchor:function(){var $=this;if(!$._updatingToChildren){var j=$.getAnchor();if(_e.superClass.setAnchor.apply($,arguments),!zm&&!$._updatingFromChildren&&$._syncSize){$._updatingToChildren=1;var H=$.getAnchor();$.getPosition();var T=$.getSize(),B=$.getScale(),R=$.getRotation(),P=-T.width*B.x*(j.x-H.x),M=-T.height*B.y*(j.y-H.y),G=K(R),k=z(R),D=k*P-G*M,g=G*P+k*M;$.eachChild(function(p){if(bh(p)){var j=p.getPosition();p.setPosition(j.x-D,j.y-g)}}),delete $._updatingToChildren}}},setRotation:function(N){var r=this;if(!r._updatingToChildren){var H=r.getRotation();if(_e.superClass.setRotation.apply(r,arguments),!zm&&!r._updatingFromChildren){r._updatingToChildren=1;var j=r.getPosition(),w=N-H;r.eachChild(function(C){if(bh(C)){var u=C.getMatrix();u.translate(-j.x,-j.y),u.rotate(w),u.translate(j.x,j.y);var v=Math.sign(C.getScale().x);C.setRotation(i(u.b*v,u.a*v)),C.setPosition(u.tx,u.ty)}}),delete r._updatingToChildren}}},setScale:function(s,Q){var P=this;if(!P._updatingToChildren){null==Q&&(Q=s.y,s=s.x);var W=P.getScale();if(r(s)<.01&&(s=.01*(Dn(s)||Dn(W.x))),r(Q)<.01&&(Q=.01*(Dn(Q)||Dn(W.y))),_e.superClass.setScale.call(P,s,Q),!zm&&!P._updatingFromChildren){P._updatingToChildren=1;var z=s/W.x,j=Q/W.y;P._adjustChildScaleOrSize(z,j,"size"),delete P._updatingToChildren,P.updateFromChildren()}}},getSerializableProperties:function(){var T=_e.superClass.getSerializableProperties.call(this);return T.clickThroughEnabled=1,T.syncSize=1,T}});var Dr=u.Grid=function(){Yn(u.Grid,this)};Jf("Grid",lf,{IRotatable:!1,_icon:"grid_icon",_image:h,getUIClass:function(){return gm},setRotation:function(){},getCellRect:function(k,H){var b=this,O=b.s("grid.row.count"),o=b.s("grid.column.count");if(0>=O||0>=o||0>k||k>=O||0>H||H>=o)return h;var W,X,N,J=b.getRect(),p=b.s("grid.row.percents"),f=b.s("grid.column.percents");if(og(J,b,"grid.border",-1),p&&p._as&&(p=p._as),f&&f._as&&(f=f._as),p&&p.length===O){for(N=0,W=0;k>W;W++)N+=J.height*p[W];J.y+=N,J.height=J.height*p[k]}else J.height=J.height/O,J.y+=J.height*k;if(f&&f.length===o){for(X=0,W=0;H>W;W++)X+=J.width*f[W];J.x+=X,J.width=J.width*f[H]}else J.width=J.width/o,J.x+=J.width*H;return Rd(J,-b.s("grid.gap")),J}});var Lr=u.Text=function(){Yn(Lr,this),this.setSize(100,50),this.s("text","TEXT")};Jf("Text",lf,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return od},setWidth:function(W){W||(W=.001),Lr.superClass.setWidth.call(this,W)},setHeight:function(W){W||(W=.001),Lr.superClass.setHeight.call(this,W)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Tn("__text__",{width:{value:100,isSafeFunc:!0,func:function(U){return U._width}},height:{value:50,isSafeFunc:!0,func:function(r){return r._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var ad=u.Shape=function(){Yn(ad,this),this._59O=new mo};ad.__de__=jn,Jf("Shape",lf,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return no},_22Q:function(){return Rq},getLength:function(z){return Kp($b(this._59O,this._58O,z,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var S=this._58O;return S?new mo(S._as.slice(0)):S},setSegments:function(V){var R=this._58O;V=V?wc(V)?new mo(V.slice(0)):new mo(V._as.slice(0)):null,(R&&V&&R._as.join(",")!==V._as.join(",")||R!==V)&&(this._58O=V,this.fp("segments",R,V))},getPoints:function(){return this._59O},toPoints:function(){var b=this._59O;return new mo(b._as.slice(0))},setPoints:function(w,s){var i=this,Z=i._59O;w=w?wc(w)?new mo(w.slice(0)):new mo(w._as.slice(0)):new mo;var R,z,E,b,Y,h;s&&(R=i.getPosition(),h=new rb(i.getRotation(),0,0,i.getScale().x,i.getScale().y)),(Z&&w&&Z._as.join(",")!==w._as.join(",")||Z!==w)&&(i._59O=w,i.fs(),i.fp("points",Z,w)),s&&(z=i.getPosition(),E=z.x-R.x,b=z.y-R.y,Y=h.tf(E,b),i.setPosition(z.x-E+Y.x,z.y-b+Y.y))},addPoint:function(Z,t,M){var u=this.toPoints();u.add(Z,t),this.setPoints(u,M)},setPoint:function(o,W,A){var T=this.toPoints();T.set(o,W),this.setPoints(T,A)},removePointAt:function(V){var l=this.toPoints();l.removeAt(V),this.setPoints(l)},setWidthForce:function(U){var q=this;if(!q._55I&&!zm&&q.getWidth()){q._55I=1;var z=q._position.x,r=U/q.getWidth(),j=q.toPoints(),o=new mo;j.each(function(t){o.add({x:(t.x-z)*r+z,y:t.y,e:t.e})}),q.setPoints(o),zh(q,[r,0,0,1,z*(1-r),0]),q.fs(),delete q._55I}ad.superClass.setWidth.call(q,U)},setWidth:function(g){return this.setWidthForce(1>g?1:g)},setHeightForce:function(k){var X=this;if(!X._55I&&!zm&&X.getHeight()){X._55I=1;var f=X._position.y,B=k/X.getHeight(),A=X.toPoints(),$=new mo;A.each(function(_){$.add({x:_.x,y:(_.y-f)*B+f,e:_.e})}),X.setPoints($),zh(X,[1,0,0,B,0,f*(1-B)]),X.fs(),delete X._55I}ad.superClass.setHeight.call(X,k)},setHeight:function(I){return this.setHeightForce(1>I?1:I)},setAnchorElevation:function(g){var f=this;f._55I=!0;var d=f._updatingAnchor3d,P=!zm&&!d;if(P){var T,b=g,v=f.getAnchorElevation(),q=f.getTall();T=q*(v-b),f.shiftPointsElevation(T)}var W=ad.superClass.setAnchorElevation.apply(f,arguments);return d||delete f._55I,W},getShapeElevation:function(){var S=this,B=S._54O;return B-(S.getTall()||0)*(S._anchorElevation-.5)},setAnchor3d:function(U,c,b,k){var o,j=this;"number"==typeof U?o={x:U,y:c,z:b}:(o=U.length?{x:U[0],y:U[1],z:U[2]}:U,k=c),j._55I=!0,j._updatingAnchor3d=!0;var B=j.getDataModel();if(B&&B.beginTransaction(),!zm){var m=j.getAnchor3d(),d=j.getSize(),p=j.getTall(),H=d.width*(m.x-o.x),A=d.height*(m.z-o.z),w=p*(m.y-o.y);k||j.shiftPoints(H,A,w);var q=j.p3()}var D=ad.superClass.setAnchor3d.apply(j,arguments);if(!zm&&k){var y=j.p3();j.shiftPoints(y[0]-q[0]+H,y[2]-q[2]+A,y[1]-q[1]+w)}return B&&B.endTransaction(),delete j._updatingAnchor3d,delete j._55I,D},setAnchor:function(F,o,x){var S=this;S._55I=!0;var z=S._updatingAnchor3d,f=!zm&&!z;if(f){var q,R,e;"number"==typeof F?e={x:F,y:o}:(e=F.length?{x:F[0],y:F[1]}:F,x=o);var B=S.getAnchor(),w=S.getSize();q=w.width*(B.x-e.x),R=w.height*(B.y-e.y),x||S.shiftPoints(q,R);var U=S.getPosition()}var c=ad.superClass.setAnchor.apply(S,arguments);if(f){var L=S.getPosition();x&&S.shiftPoints(L.x-U.x+q,L.y-U.y+R)}return z||delete S._55I,c},shiftPoints:function(J,y,a){var L=this,D=L.getElevation()||0,W=L.toPoints(),$=new mo;W.each(function(e){var r=e.e;a&&(r=(r==h?D:r)+a),$.add({x:e.x+J,y:e.y+y,e:r})}),L.setPoints($),L.fs()},shiftPointsElevation:function(F){return this.shiftPoints(0,0,F)},setPosition:function(B,G){var O,P=this;if(!P._28Q){if(P._28Q=1,!P._55I&&!zm){O=2===arguments.length?{x:B,y:G}:B;var k=O.x-P._position.x,r=O.y-P._position.y;if(0===k&&0===r)return delete P._28Q,void 0;P._55I=1,P.shiftPoints(k,r),zh(P,[1,0,0,1,k,r]),delete P._55I}ad.superClass.setPosition.apply(P,arguments),delete P._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var i=this;if(2!==i._59O.size())return!1;var K=i._58O;return K?2===K.size()&&1===K.get(0)&&2===K.get(1)?!0:!1:!0},fireShapeChange:function(){var j=this;if(!j._55I&&!zm){var t=Vn(j._59O);t&&(j._55I=1,j.setRect(t),delete j._55I)}j.fp(Fi,!1,!0)},getSerializableProperties:function(){var r=ad.superClass.getSerializableProperties.call(this);return r.segments=1,r.points=1,r.thickness=1,r.closePath=1,r}});var Gl=u.Polyline=function(){Yn(Gl,this),this.s({"shape.background":null,"shape.border.width":2})};Jf("Polyline",ad,{_icon:"polyline_icon",_22Q:function(){return Sk},getUIClass:function(){return Gq},setClosePath:function(){},setTall:function(g){var W=this;if(!W._55I&&!W._24Q&&!zm&&W.getTall()){W._24Q=1;var C=W._54O,X=g/W.getTall();W._59O.each(function(N){N.e=N.e==h?C:(N.e-C)*X+C}),W.fs(),delete W._24Q}Gl.superClass.setTall.call(W,g)},setElevation:function(W){var X=this;if(!X._55I&&!X._24Q&&!zm){X._24Q=1;var A=W-X._54O;X._59O.each(function(c){c.e==h?c.e=W:c.e+=A}),X.fs(),delete X._24Q}Gl.superClass.setElevation.apply(X,arguments)},fireShapeChange:function(){var N=this,S=N._59O;if(!N._55I&&!N._24Q&&!zm){var W=S.size();if(W){var C=1,g=S.get(0),c=N._54O;g.e==h&&(g.e=c);for(var i=g.e,u=0;W>C;C++){g=S.get(C),g.e==h&&(g.e=c);var B=M(i,g.e),_=m(i+u,g.e);i=B,u=_-B}N._24Q=1,N.setTall(u),N.setElevation(i+u*N._anchorElevation),delete N._24Q}}Gl.superClass.fireShapeChange.apply(N,arguments)}});var Qf=u.SubGraph=function(){Yn(Qf,this)};Jf("SubGraph",lf,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Qf.superClass._8I.call(this),this.eachChild(function(y){bh(y)&&y._8I()})}}),C.loadingRefGraph=0;var Mo=u.RefGraph=function(){Yn(Mo,this)};Jf("RefGraph",_e,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(E){var Y=this._ref;this._ref=E,this.fp("ref",Y,E),this.updateRef()},_21I:function(){Mo.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var O=this;if(C.loadingRefGraph++,O.clearChildrenFromDataModel(),C.loadingRefGraph--,O._ref&&O._dataModel){O._xhrLoadHandler&&(O._xhrLoadHandler.cancel=!0);var N=zm,l=O._xhrLoadHandler=function(u){if(u&&O._dataModel){C.loadingRefGraph++;var k=O._pendingUpdateInfo={needToRestore:N};N&&(k.position=O.p(),k.width=O.getWidth(),k.height=O.getHeight(),k.rotation=O.getRotation(),k.anchor=O.getAnchor(),k.scale=O.getScale()),O.p(0,0),O.setAnchor(.5,.5),O.setRotation(0),O.setScale(1,1);var n=C.parse(u),T=O._dataModel.deserialize(n,O,{justDatas:!0});T.each(function(N){N._refGraph=O}),O.checkPendingUpdateInfo(),C.loadingRefGraph--,C.handleRefGraphLoaded(O,T,n)}};l.xhrLoadCalled=!1,C.load(O._ref,function(h){l.cancel||(l.xhrLoadCalled?l(h):Yb(function(){l(h)}))}),l.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var A=this,J=A._pendingUpdateInfo;if(!J)return A.onPendingUpdated&&(C.loadingRefGraph++,A.onPendingUpdated(),C.loadingRefGraph--),void 0;var P=!0;this.eachChild(function(g){(g._pendingCheckImageJSON||g._pendingUpdateInfo)&&(P=!1)}),P&&(C.loadingRefGraph++,A._pendingUpdateInfo=null,A.updateFromChildren(),J.needToRestore&&(A.setSize(J.width,J.height),A.setAnchor(J.anchor),A.setRotation(J.rotation),A.setScale(J.scale),A.p(J.position)),this.getParent()instanceof Mo&&this.getParent().checkPendingUpdateInfo(),A.onPendingUpdated&&A.onPendingUpdated(),C.loadingRefGraph--)},getSerializableProperties:function(){var j=Mo.superClass.getSerializableProperties.call(this);return j.ref=1,j}}),u.EdgeGroup=function(m,I){this._70O=m,this._siblings=I;for(var G,w,Q=0,H=m.size(),v=O[hq];H>Q;Q++)if(G=m.get(Q).getStyle(hq,!1),G!=h){v=G;break}v==h&&(v=!0);var V=C.edgeGroupAgentFunc;for(V&&(w=V(m),w&&w!==m.get(0)&&(m.remove(w),m.add(w,0))),Q=0;H>Q;Q++)m.get(Q).s(hq,v)},Jf("EdgeGroup",f,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(c){return this._70O.get(c)},indexOf:function(H){return this._70O.indexOf(H)},each:function(o,W){this._70O.each(o,W)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(S,o){this._siblings.each(function(K){K._70O.each(S,o)})}});var re=function(q,b,D){var K=cs[q]={type:q,action:b};if(D)for(var h in D)K[h]=D[h]};No(C,{setConnectAction:re,getConnectAction:function(U,z){if(!z){if(!U)return null;z=U.getCurrentConnectActionType()}return cs[z]},doConnectAction:function(l,m,p,f){f=f||l.getCurrentConnectActionType();var M=cs[f];if(!M)return!1;var N=M.action;return N?(m instanceof Bf.Group?l.sm().getSelection().each(function(t){N.call(null,l,t,p)}):N.call(null,l,m,p),!0):!1},doDeleteConnectionAction:function(o,$,p){p=p||o.getCurrentConnectActionType();var d=cs[p];if(!d||!d.delete)return!1;var M=d.delete.action;return M?($ instanceof Bf.Group?o.sm().getSelection().each(function(w){M.call(null,o,w)}):M.call(null,o,$),!0):!1}});var _j=u.JSONSerializer=function(U,o){this.dm=this._dataModel=U,this._hierarchical=C.forceHierarchicalSerialization?!0:o==h?U.isHierarchicalRendering():o};Jf("JSONSerializer",f,{ms_ac:["hierarchical"],serialize:function(Z){return C.stringify(this.toJSON(),Z)},toJSON:function(){var j=this,h=j.dm,M=h.getRoots(),e=j.json={v:C.getVersion(),p:{},a:{},d:[]},v=h.getSerializableAttrs();h.getInit()&&(e.init=h.getInit()),h.getName()&&(e.p.name=h.getName()),h.getBackground()&&(e.p.background=h.getBackground()),h.getLayers()&&(e.p.layers=h.getLayers()),h.getEnvmap()&&(e.p.envmap=h.getEnvmap()),e.p.autoAdjustIndex=h.isAutoAdjustIndex(),e.p.hierarchicalRendering=h.isHierarchicalRendering();for(var u in v){var m=h.a(u);m!==l&&j[uj](u,m,e.a)}return Xb(e.a)&&delete e.a,j._hierarchical?M.each(j.serializeData,this):h.each(function(m){j.serializeData(m)}),h.fireSerializeEvent({type:"serialize",json:e}),h.getPostProcessingData()&&(e.p.postProcessingData=h.getPostProcessingData()),e},isSerializable:function(){return!0},getProperties:function(j){return j.getSerializableProperties()
},getStyles:function(Z){return Z.getSerializableStyles()},getAttrs:function(H){return H.getSerializableAttrs()},serializeData:function(C){var f=this;if(f.isSerializable(C)&&!C._refGraph){var n,$,O,s,I=Xe(C.getClassName())||C.getClass(),e=new I,b={c:C.getClassName(),i:C.getId(),p:{},s:{},a:{}};f.json.d.push(b),n=f.getProperties(C);for($ in n)if(/^_/.test($)){if(O=C[$],("_width"===$||"_height"===$)&&O===l){var P;((C.s("layout.h")||C.s("layout.v"))&&C.getHost()||C instanceof u.Node&&(P=C.getParent())&&P instanceof u.Block||C.s("fullscreen"))&&(O=C[$]="_width"===$?C.getWidth():C.getHeight())}O!==e[$]&&f[uj]($.substr(1),O,b.p)}else s=Lm($),C[s]&&(O=C[s](),O!==e[s]()&&f[uj]($,O,b.p));n=f.getStyles(C);for($ in n)O=C.s($),O!==e.s($)&&f[uj]($,O,b.s);n=f.getAttrs(C);for($ in n)O=C.a($),O!==e.a($)&&f[uj]($,O,b.a);Xb(b.p)&&delete b.p,Xb(b.s)&&delete b.s,Xb(b.a)&&delete b.a}f._hierarchical&&C.getChildren().each(f.serializeData,f)},serializeValue:function(Z,E,P){uf(E)?E={__a:E._as}:E instanceof yh&&(E={__i:E.getId()}),P[Z]=E},deserialize:function(F,s,Q){var c=this;return Tf(F)&&/.json$/.test(F)?(C.xhrLoad(F,function(u){c.deserializeImpl(u,s,Q)}),void 0):c.deserializeImpl(F,s,Q)},deserializeImpl:function(M,y,E){var d=this,S=d.dm;E=Yg(E)?{setId:E}:Pj(E)?{finishFunc:E}:E||{},M=d.json=Tf(M)?C.parse(M):M,M.a&&M.a.onPreDeserialize&&!E.disableOnPreDeserialize&&M.a.onPreDeserialize(M,S,E.view),S.beginTransaction(),zm++,d._82I={};var i=new mo,Y=new mo,k=0,x=M.d.length;if(E.justDatas||(Pj(M.init)&&M.init(S),S.setInit(M.init)),!E.justDatas){for(var G in M.a)S.a(G,d[bn](M.a[G]));for(var O in M.p)S[gg(O)](M.p[O])}for(;x>k;k++){var w=M.d[k],s=Xe(w.c),z=new s,$=w.i;E.setId&&$!=h&&(z._id=$),d._82I[$]=z,i.add(z),Y.add(w)}for(k=0;x>k;k++)d.deserializeData(i.get(k),Y.get(k));return i.each(function(D){y&&!D.getParent()&&D.setParent(y),S.add(D)}),S.fireSerializeEvent({type:"deserialize",json:M}),zm--,S.endTransaction(),M.a&&M.a.onPostDeserialize&&!E.disableOnPostDeserialize&&M.a.onPostDeserialize(M,S,E.view,i),E.finishFunc&&E.finishFunc(M,S,E.view,i),i},deserializeData:function(m,M){for(var _ in M.p)m[gg(_)](this[bn](M.p[_]));for(_ in M.s)m.s(_,this[bn](M.s[_]));for(_ in M.a)m.a(_,this[bn](M.a[_]))},deserializeValue:function(G){if(An(G)){var Q=G.__i;if(Q!=h)return this._82I[Q];if(Q=G.__a,wc(Q))return new mo(Q)}return G}}),No(Hh,{serialize:function(V,D){return new _j(this,D).serialize(V)},toJSON:function(X){return new _j(this,X).toJSON()},deserialize:function(G,w,U){return new _j(this).deserialize(G,w,U)}});var _b=u.OverlappingBox=function(W){this.gv=W,this.boxes={}};Jf("OverlappingBox",f,{clear:function(){var P,X,H=this.boxes;for(P in H)X=H[P],X.length=0},isOverlapping:function(V,v){var U,X,n=this,a=n.boxes,d=a[V];d?(U=d.rects,X=d.length):d=a[V]={rects:U=[],length:X=0};var Q,r,v;for(Q=0;X>Q;Q++)if(r=U[Q],r.x<v.x+v.w&&r.x+r.w>v.x&&r.y<v.y+v.h&&r.h+r.y>v.y)return!0;return U.length<=X?(U.push(v),d.length++):U[d.length++]=v,!1}}),No(C,{fetch:function(N,j){var a="GET",J=!1,L=null,H="";j&&(a=j.method||"GET",J=j.sync,H=j.url,L=j.data||null),N.open(a,H,!J),j.responseType?N.responseType=j.responseType:j.overrideMimeType&&N.overrideMimeType&&N.overrideMimeType(j.overrideMimeType),N.send(L)},convertImageSrc:function(t,d){d&&"function"==typeof d||(d=function(){}),d(t)}});var xd=u.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Jf("Request",f,{_responseType:null,_overrideMimeType:"text/plain",send:function(w){var x=this._xhr,e=this.onload,q=this.onerror;this.getResponseType()?w.responseType=this.getResponseType():this.getOverrideMimeType()&&(w.overrideMimeType=this.getOverrideMimeType()),x.onload=e,x.onerror=q,C.fetch(x,w)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(C){this._responseType=C},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(D){this._overrideMimeType=D},getResponseText:function(){var o=this._xhr;return o.response||o.responseText}}),ji.GraphView=function(u){var W=this;W._24I={},W._34I=new mo,W._25I={},W._56I={},W._view=Lh(1,W),W._canvas=fr(W._view),W.dm(u?u:new Hh),this._coreInteractor=new Yj(this),W.setEditable(!1),W.setScrollBarVisible(C.graphViewScrollBarVisible)},nm("GraphView",f,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Ii,Ym,Xj,Vm,"resettable","editInteractor",pj,"zoomable","pannable","rectSelectable","autoScrollZone",Cn,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:C.graphViewZoomable,_resettable:C.graphViewResettable,_pannable:C.graphViewPannable,_rectSelectable:C.graphViewRectSelectable,_autoScrollZone:C.graphViewAutoScrollZone,_rectSelectBackground:C.graphViewRectSelectBackground,_rectSelectBorderColor:C.graphViewRectSelectBorderColor,_editPointSize:C.graphViewEditPointSize,_editPointBorderColor:C.graphViewEditPointBorderColor,_editPointBackground:C.graphViewEditPointBackground,_scrollBarColor:qh,_scrollBarSize:ze,_autoHideScrollBar:is,_autoMakeVisible:Jb,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(b){this._dataModel.setLayers(b)},setEditable:function(K){var W=this,U=W.__interactorMap__;if(!U){var r=ji.XEditInteractor;U=W.__interactorMap__={scrollBar:new dk(W),select:new Rh(W),edit:r?new r(W):new pb(W),move:new Kf(W),"default":new nb(W),touch:new vj(W,{editable:!1})}}K?(W._uieditable=!0,W.setInteractors([U.scrollBar,U.select,U.edit,U.move,U.default,U.touch])):(W._uieditable=!1,W.setInteractors([U.scrollBar,U.select,U.move,U.default,U.touch]))},getCanvas:function(){return this._canvas},_33I:function(D){var L=D.getUIClass();return L?new L(this,D):h},getDataUI:function(u){var f=this,B=f._25I[u._id];return B===l&&(B=f._33I(u),f._25I[u._id]=B),B},getNodeRect:function(j){return C.getNodeRect(this,j)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(V){var _=this.getDataUI(V);return _?(_._79o(),_._78o):null},getEdgeSourcePosition:function(s){var O=this,n=O.getDataUI(s),r=n.s,P=n._data._40I;return _h(O,P,r("edge.source.position"),r("edge.source.offset.x"),r("edge.source.offset.y"),r("edge.source.anchor.x"),r("edge.source.anchor.y"))},getEdgeTargetPosition:function(E){var Q=this,w=Q.getDataUI(E),x=w.s,M=w._data._41I;return _h(Q,M,x("edge.target.position"),x("edge.target.offset.x"),x("edge.target.offset.y"),x("edge.target.anchor.x"),x("edge.target.anchor.y"))},invalidateAll:function(B){var u=this;if(B){for(var g in u._25I){var _=u._25I[g];_&&_.dispose()}u._25I={},u._56I={},u._24I={},u._34I.clear(),u.redraw()}else u.dm().each(function(X){u.invalidateData(X)})},invalidateSelection:function(){var Y=this;Y.sm().each(function(H){Y.invalidateData(H)})},invalidateData:function(S){var J=this;J._24I[S._id]=S,J._21Q(S),J.iv()},_21Q:function(Y){var p=this,Z=p._24I;if(Jl(Y)&&Ig[Y.s(Nj)]){var e=Y.getSourceAgent();e&&e.getAgentEdges().each(function(W){Z[W._id]=W}),e=Y.getTargetAgent(),e&&e.getAgentEdges().each(function(V){Z[V._id]=V}),p.iv()}},redraw:function(_){var m=this;m._32I||(_?m._34I.add(_):(m._32I=1,m._34I.clear()),m.iv())},each:function(Q,V){var g,F,Y,G=0,W=this.getLayers(),v=this._dataModel,x=v._datas._as,Z=x.length;if(W){for(var I=W.length;I>G;G++)if(Y=W[G],An(Y)&&(Y=Y.name),v.isHierarchicalRendering()){var L=function(X){return X._layer===Y?V?Q.call(V,X):Q(X):void 0};if(this._dataModel.eachByHierarchical(L)===!1)return}else for(var c=0;Z>c;c++)if(g=x[c],g._layer===Y&&(F=V?Q.call(V,g):Q(g),F===!1))return}else if(v.isHierarchicalRendering())this._dataModel.eachByHierarchical(Q,null,V);else for(;Z>G;G++)if(g=x[G],F=V?Q.call(V,g):Q(g),F===!1)return},reverseEach:function(y,F){var i,d,z,V,_=this._dataModel,b=_._layers,r=_._datas._as,e=r.length;if(b){for(i=b.length-1;i>=0;i--)if(V=b[i],An(V)&&(V=V.name),_.isHierarchicalRendering()){var w=function(S){return S._layer===V?F?y.call(F,S):y(S):void 0};if(_.reverseEachByHierarchical(w)===!1)return}else for(var o=e-1;o>=0;o--)if(d=r[o],d._layer===V&&(z=F?y.call(F,d):y(d),z===!1))return}else if(_.isHierarchicalRendering())_.reverseEachByHierarchical(y,null,F);else for(i=e-1;i>=0;i--)if(d=r[i],z=F?y.call(F,d):y(d),z===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var C=this,f=C._84I;if(!f){var N=this.dm().a("width"),A=this.dm().a("height");N>0&&A>0?C._84I={x:0,y:0,width:N,height:A}:(C.each(function(T){C.isVisible(T)&&(f=Xd(f,C.getDataUIBounds(T)))}),C._84I=f?f:dm)}return C._84I},getScrollRect:function(){return Xd(this.getContentRect(),this._29I)},makeCenter:function(l,q,d){var y=this;if(!y.getWidth()||!y.getHeight())return d||Yb(y.centerData,y,[l,q,!0],500),void 0;y.makeVisible(l),y.validate();var B=y.getDataUIBounds(l);if(B){var W=y.getWidth(),T=y.getHeight(),n=B.x+B.width/2,F=B.y+B.height/2,v=-n*y._zoom+W/2,Y=-F*y._zoom+T/2;y.setTranslate(v,Y,q)}},fitData:function(P,v,s,D,a){var u=this;if(!u.getWidth()||!u.getHeight())return a||Yb(u.fitData,u,[P,v,s,D,!0],500),void 0;var U=function(){u.makeVisible(P),u.validate();var V=u.getDataUIBounds(P);V&&(V=ud(V),Rd(V,s==h?20:s),u.fitRect(V,v,D))};v?C.callWhenLoaded(U):U()},fitContent:function(q,O,p,z){var X=this;if(!X.getWidth()||!X.getHeight())return z||Yb(X.fitContent,X,[q,O,p,!0],500),void 0;var G=function(){X.validate();var T=ud(X.getContentRect());Rd(T,O==h?20:O),X.fitRect(T,q,p)};q?C.callWhenLoaded(G):G()},fitRect:function(r,o,i){var g=this,x=g.getWidth(),J=g.getHeight(),t=r.x+r.width/2,Z=r.y+r.height/2,p=M(x/r.width,J/r.height),D=g._zoom,l=-t*D+x/2,S=-Z*D+J/2;0===p||isNaN(p)||(i&&(p=M(1,p)),o?(g._65I&&(delete g._65I.finishFunc,g._65I.stop(!0)),g._14o&&g._14o.stop(!0),g.setTranslate(l,S,{finishFunc:function(){g.setZoom(p,o)}})):(g.setTranslate(l,S),g.setZoom(p)))},toCanvas:function(C,O){O=O||this._zoom,this.validateImpl();var s=this,p=s.getContentRect();p.width||(p.width=10),p.height||(p.height=10);var n=fr(),x=p.x*O,S=p.y*O,U=p.width*O,z=p.height*O;Dg(n,U,z,1);var l=Uh(n);return C=C||this._dataModel.getBackground(),C&&ng(l,0,0,U,z,C),uc(l,-x,-S),l.scale(O,O),s._42(l),l.restore(),n},toDataURL:function(e,x,T){return this.toCanvas(e,T).toDataURL(x||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(t,Z){var v=this,A=v.dm().getBackground();if(A){var h=v.dm().a("width"),J=v.dm().a("height");h>0&&J>0&&ng(t,0,0,h,J,A)}var N=v.__htmlOrderList,D=[];if(v._93db(t,Z),v.each(function(X){var H=v.getDataUI(X);if(H){var T=v._56I[X._id],$=H._htmlView;if(T){var O=H._79o();if($=H._htmlView,u.HtmlNode&&X instanceof u.HtmlNode)H._42(t);else{var E=v.getViewRect(),x=$&&$.layoutHTML;!Z||Sc(Z,O)?(x&&($.layoutHTML(),H.__outerLayout&&delete H.__outerLayout),H._42(t)):Sc(E,O)||!x||H.__outerLayout||($.layoutHTML(),H.__outerLayout=!0)}}$&&(D.push($),$.getView&&($=$.getView()),$.style.display=T?"block":Il)}}),N&&D.length>0){var x=!1;if(N.length!==D.length)x=!0;else for(var B=0;B<D.length;B++)if(D[B]!==N[B]){x=!0;break}x&&(D.forEach(function(C){v.appendHTML(C,!0)}),this.__htmlOrderList=D)}else this.__htmlOrderList=D;v._92db(t,Z)},validateImpl:function(){this.tryUpdateRootData();var e,I,p,K,Y,H=this,V=H.tx(),X=H.ty(),i=H._zoom,M=H._canvas,U=this.getWidth(),J=this.getHeight(),z=H._29I,l={x:-V/i,y:-X/i,width:U/i,height:J/i},G={},s=H._34I,_=H._24I,h=H._32I,D=H._23I;H._24I={},(U!==M.clientWidth||J!==M.clientHeight)&&(Dg(M,U,J),h=1),h||Tg(l,z)||(h=1),H._29I=l,H.each(function(n){I=n._id;var A=G[I]=H.isVisible(n);A!==H._56I[I]&&(_[I]=n,p=H.getDataUI(_[I]),p&&p._84o(A),H._84o(n,A))},H);for(I in _)p=H.getDataUI(_[I]),p&&(!h&&H._56I[I]&&(Y=p._79o(),Y&&s.add(Y)),p.invalidate()),H._83I=1;if(H._56I=G,!h)for(I in _)G[I]&&(p=H.getDataUI(_[I]),p&&(Y=p._79o(),Y&&s.add(Y)));if(h?K=l:(s.each(function(c){Sc(l,c)&&(K=Xd(K,c))}),K&&(Rd(K,m(1,1/i)),K.x=j(K.x*i)/i,K.y=j(K.y*i)/i,K.width=d(K.width*i)/i,K.height=d(K.height*i)/i,K=Dk(l,K))),H._74O=K,K){e=Uh(M);var E=K.x,P=K.y,L=K.width,c=K.height;E=Math.floor((E*i+V)*nd),P=Math.floor((P*i+X)*nd),L=Math.ceil(L*i*nd)+1,c=Math.ceil(c*i*nd)+1,e.beginPath(),e.rect(E,P,L,c),e.clip(),e.clearRect(E,P,L,c),Jq(e,V,X,i),H._42(e,K),e.restore(),delete H._74O}if(s.clear(),delete H._32I,D&&U>0&&J>0){var p=H.getDataUI(D);if(p){var Y=p._79o(),x=H._29I,F=x.x,k=x.y,A=x.width,q=x.height,i=H._zoom;Y&&!Sc(Y,x)&&(Y.x+Y.width<F&&H.tx(-Y.x*i),Y.x>F+A&&H.tx(-(Y.x+Y.width-A)*i),Y.y+Y.height<k&&H.ty(-Y.y*i),Y.y>k+q&&H.ty(-(Y.y+Y.height-q)*i))}delete H._23I}H._83I&&(delete H._83I,delete H._84I),H._98O(),H.countFrame(),Xb(H._24I)||Yb(H.iv,H)},tryUpdateRootData:function(){var A,P=this.getFullscreenDatas();for(var O in P)A=P[O],this.scaleRootData(A)},scaleRootData:function($){var Z=$.s("fullscreen");if("uniform"===Z||"fill"===Z){$.setRotation(0);var l,r=$.s("fullscreen.gap")||0,P=this.getWidth()-2*r,Q=this.getHeight()-2*r,D=$.getAnchor(),N=$.getScaledSize(),S=N.width,Y=N.height,R=$.s("fullscreen.lock");if(R)return"uniform"===Z?P/Q>S/Y?(l=Q/Y,S=Y*P/Q):(l=P/S,Y=S*Q/P):"v"===R?(l=Q/Y,S=P/l,$.setWidth(S)):(l=P/S,Y=Q/l,$.setHeight(Y)),this.setZoom(l),this.tx(r-($.getX()-D.x*S)*l),this.ty(r-($.getY()-D.y*Y)*l),void 0;var f=this.tx(),T=this.ty();l=this._zoom;var I={x:(-f+r)/l,y:(-T+r)/l,width:P/l,height:Q/l};if("uniform"===Z){var K=S/Y,H=Math.min(I.width,I.height*K),q=H/K;I.x+=.5*(I.width-H),I.y+=.5*(I.height-q),I.width=H,I.height=q}$.setSize(I.width/$.getScaleX(),I.height/$.getScaleY()),$.setPosition(I.x+D.x*I.width,I.y+D.y*I.height)}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(L){var T=this;L!==T.isScrollBarVisible()&&(L?(Pp(T._view,T._79O=Ki()),Pp(T._79O,T._27I=Ki()),Pp(T._79O,T._28I=Ki())):(Oe(T._79O),delete T._79O,delete T._27I,delete T._28I),T.fp("scrollBarVisible",!L,L))},getDebugTip:function(){return""},showScrollBar:function(){var W=this;W._79O&&(W._85I||(P(function(){W._86I()},qo),W.iv()),W._85I=new Date)},_86I:function(){var i=this;if(i._85I){var _=new Date,A=_.getTime();A-i._85I.getTime()>=qo?(delete i._85I,i.iv()):P(function(){i._86I()},qo)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var B=this,C=this._27I,W=this._28I;if(B._79O){if(B._autoHideScrollBar&&!B._85I)return C.style.visibility=sl,W.style.visibility=sl,void 0;var V=B.getScrollBarColor(),l=B._zoom,z=B.getScrollBarSize(),S=B.getViewRect(),K=B.getScrollRect(),t=S.height*l,X=K.height*l,F=S.width*l-z-2,s=t*((S.y-K.y)*l/X),m=t*(t/X),r=C.style;X-.5>t?(Vh>m&&(s=s+m/2-Vh/2,0>s&&(s=0),s+Vh>t&&(s=t-Vh),m=Vh),rr(C,F,s,z,m),r.visibility=Ei,r.background=V,r.borderRadius=z/2+ej):r.visibility=sl;var y=S.width*l,b=K.width*l,s=S.height*l-z-2,F=y*((S.x-K.x)*l/b),A=y*(y/b),r=W.style;b-.5>y?(Vh>A&&(F=F+A/2-Vh/2,0>F&&(F=0),F+Vh>y&&(F=y-Vh),A=Vh),rr(W,F,s,A,z),r.visibility=Ei,r.background=V,r.borderRadius=z/2+ej):r.visibility=sl}},setDataModel:function(R){var V=this,K=V._dataModel,G=V._selectionModel;K!==R&&(K&&(K.ump(V.handleDataModelPropertyChange,V),K.umm(V.handleDataModelChange,V),K.umd(V.handleDataPropertyChange,V),K.removeIndexChangeListener(V._75O,V),K.removeHierarchyChangeListener(V.handleHierarchyChange,V),G||K.sm().ums(V.handleSelectionChange,V)),V._dataModel=R,R.mp(V.handleDataModelPropertyChange,V),R.mm(V.handleDataModelChange,V),R.md(V.handleDataPropertyChange,V),R.addIndexChangeListener(V._75O,V),R.addHierarchyChangeListener(V.handleHierarchyChange,V),G?G._21I(R):R.sm().ms(V.handleSelectionChange,V),V.invalidateAll(!0),V.fp($e,K,R),V.updateBackground())},getLayersInfo:function(){if(this._layersInfo===l){var v=this.getLayers();v?(this._layersInfo={},v.forEach(function(i){var z=An(i)?i.name:i;this._layersInfo[z]=i},this)):this._layersInfo=null}return this._layersInfo},calculateAttachPoint:function(){var H=new sn,X=new sn,c=new sn;return function(Y,_){var V=this.getAttachPoints(Y);if(!V||!V.length)return null;c.set(_.x,_.y);for(var Z,w,I,O,t=1/0,v=0,y=V.length;y>v;v++)I=V[v],X.x=I.x,X.y=I.y,H.x=I.offsetX||0,H.y=I.offsetY||0,O=_h(this,Y,0,H.x,H.y,X.x,X.y),w=c.distanceToSquared(O),t>w&&(Z=v,t=w);t=Math.sqrt(t);var f=this.getAttachStyle(Y);if("close"===f){var W=Y.s("attach.close.threshold")/this._zoom;if(t>W)return null}return{index:Z,distance:t,info:V[Z]}}}(),getAttachPoints:function(F){var w=F.s("attach.points");if(w)return w;var V=ef(F._image);return V?pf(V.attachPoints,F,this)||null:void 0},getAttachStyle:function(f){var d=f.s("attach.style");if(d)return d;var T=ef(f._image);return T?pf(T.attachStyle,f,this)||"close":void 0},updateLayers:function(){this._layersInfo=l,this.invalidateSelection(),this.redraw()},updateBackground:function(){var b=this.dm().a("width"),Q=this.dm().a("height");this._canvas.style.background=b>0&&Q>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(J){if("background"===J.property){var j=this._canvas.style.background,H=J.newValue||"";this.updateBackground(),this.fp("canvasBackground",j,H),this.redraw()}else"a:width"===J.property||"a:height"===J.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===J.property?this.updateLayers():"hierarchicalRendering"===J.property&&this.redraw()},handleDataPropertyChange:function(C){this.dm().isHierarchicalRendering()&&"parent"===C.property&&C.data.hasChildren()&&this.redraw(),this.invalidateData(C.data)},onPropertyChanged:function(e){var T=this,Y=e.property;if(T.redraw(),"zoom"===Y){var q=T.sm().getSelection();q.size()&&q.each(function(c){c.invalidate()})}_r[Y]?T.showScrollBar():Y===pj&&T.onCurrentSubGraphChanged(e)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function($){var a=this,Y=$.kind,B=$.data;if(a._83I=1,"add"===Y)a.invalidateData(B),Jl(B)&&B.getEdgeGroup()&&B.getEdgeGroup().eachSiblingEdge(a.invalidateData,a);else if(Y===Yr){a._21Q(B);var v=B._id,Z=a._25I[v];if(Z){if(a._56I[v]){var t=Z._79o();t&&a.redraw(t)}Z.dispose(),delete a._25I[v],delete a._24I[v],delete a._56I[v]}B===a._currentSubGraph&&a.setCurrentSubGraph(h)}else Y===cn&&(a.invalidateAll(!0),a.setCurrentSubGraph(h))},_75O:function(i){this.invalidateData(i.data)},handleHierarchyChange:function(u){this.dm().isHierarchicalRendering()&&u.data.hasChildren()&&this.redraw(),this.invalidateData(u.data)},adjustIndex:function(x){var K=this;if(K.isVisible(x)){K.dm().beginTransaction();for(var M=x;M._parent&&K.isVisible(M._parent);)M=M._parent;M&&M!==x&&K._dataModel.adjustIndex(M),K._dataModel.adjustIndex(x),K.dm().endTransaction()}},getImage:function(C){return C.getImage?C.getImage():l},getSelectWidth:function(E){var g=ef(this.getImage(E));return g&&pf(g.disableSelectedBorder,E,this)?0:E.s("select.width")},getSelectColor:function(n){return n.s("select.color")},isSelectable:function(d,I){if(this.isSelected(d))return!0;if(!I&&d.getParent()instanceof _e&&this.isSelectable(d.getParent(),!0)&&d.getParent().isSyncSize())return!1;var E=this.getLayersInfo();if(E){var u=E[d._layer];if(u&&u.selectable===!1)return!1}return d.s("2d.selectable")&&this.sm().isSelectable(d)},isMovable:function(p){var f=this;if(Jl(p)&&p.getStyle(Nj)!==_c)return!1;var t=this.getLayersInfo();if(t){var R=t[p._layer];if(R&&R.movable===!1)return!1}return p.s("2d.movable")?f._movableFunc?f._movableFunc(p):!0:!1},isEditable:function(m){var $=this;if(u._uiSerializing)return $._uieditable;if(!$._editInteractor||!$.isSelected(m))return!1;if(xq(m)){var d=$.getDataUI(m);if(!d||d._88I)return!1}if(Jl(m)&&m.getStyle(Nj)!==_c)return!1;var x=this.getLayersInfo();if(x){var S=x[m._layer];if(S&&S.editable===!1)return!1}return m.s("2d.editable")?$._editableFunc?$._editableFunc(m):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(Z){return bh(Z)&&0!==Z.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(Z):!0},isRectEditable:function(F){return this._rectEditableFunc?this._rectEditableFunc(F):!0},isAnchorEditable:function($){return this._anchorEditableFunc?this._anchorEditableFunc($):!0},isRotationEditable:function(t){return t.setRotation&&t.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(t):!0:!1},getRotationPoint:function(e){var L=e.getAnchor(),O=e.getScale(),w=this._zoom,f=tl(e.getRotation(),0,-e.getHeight()*O.y*L.y-(O.y<0?-1:1)*(Sl?32:16)/w),n=e.p();return f.x+=n.x,f.y+=n.y,f},getLogicalPoint:function(v){var K=this;return Oq(v,K._canvas,K.tx(),K.ty(),K._zoom,K._zoom)},getScreenPoint:function(N,h){var G,t=this;return"object"==typeof N?N.x!==l?(G=N.x,h=N.y):(G=N[0],h=N[1]):G=N,om(G,h,t._canvas,t.tx(),t.ty(),t._zoom,t._zoom)},getSelectedDataAt:function(b){var d=this;return this.getDataAt(b,function(j){return d.isSelected(j)})},getDataInfoAt:function(g,o,l){var u,m=this.lp(g),D=this.getDataAt(m,o,l);if(D){var Q=this.getDataUI(D);u={data:D,ui:Q,point:m};var w=Q._38o;if(w){var k=w.icons;for(var V in k){var A=k[V],F=w.rects[V];if(F)for(var i=pf(A.names,D,this),e=i?i.length:0,b=F.rotation,U=e-1;U>=0;U--){var L=i[U],j=F[U];if(bf(j,m,b))return u.part="icons",u.name=V,u.icon=L,u.rect=j,u.index=U,u.rotation=b,u}}}if(this.isNoteVisible(D)){if(Q.note2Info&&bf(Q.note2Info.clickRect,m,h,Q.note2Info.scale))return u.part="note2",u;if(Q.noteInfo&&bf(Q.noteInfo.clickRect,m,h,Q.noteInfo.scale))return u.part="note",u}if(this.isLabelVisible(D)){if(Q.label2Info&&bf(Q.label2Info.rect,m,Q.label2Info.rotation,Q.label2Info.scale))return u.part="label2",u;if(Q.labelInfo&&bf(Q.labelInfo.rect,m,Q.labelInfo.rotation,Q.labelInfo.scale))return u.part="label",u}if(D.isInRect&&D.isInRect(m))return u.part="body",u}return u},getDataAt:function(r,M,W){r.target&&(r=this.lp(r));var A,C=this._zoom;return this.reverseEach(function(k){return(M?M(k):this.isSelectable(k))&&this.rectIntersects(k,Ge(r.x,r.y,W,C))?(A=k,!1):void 0},this),A},getIconInfoAt:function(l,g){var m=this;if(l.target&&(l=m.lp(l)),g||(g=m.getDataAt(l)),g){var T=m.getDataUI(g);if(T&&T._38o){var X,u=T._38o,D=new mo;for(X in u.icons)D.add(X);for(var q=D.size()-1;q>=0;q--){X=D.get(q);for(var c=u.rects[X],j=c.rotation,w=c.length-1;w>=0;w--){var G=c[w],x=G.width,E=G.height,V={x:l.x-G.x-x/2,y:l.y-G.y-E/2};j!=h&&(V=tl(-j,V.x,V.y));var G={x:-x/2,y:-E/2,width:x,height:E};if(bf(G,V))return{key:X,index:w,name:u.icons[X].names[w],rect:c[w],point:l,rotation:j,relativeRect:G,relativePoint:V,data:g}}}}}return h},getDatasInRect:function(u,o,s){s===l&&(s=1);var y=this,p=new mo;return y.reverseEach(function(Q){s&&!y.isSelectable(Q)||(o?y.rectIntersects(Q,u):y.rectContains(Q,u))&&p.add(Q)}),p},moveSelection:function(H,N){var e=this;e.dm().beginTransaction(),fo(e.sm().toSelection(e.isMovable,e),H,N),e.dm().endTransaction()},moveDatas:function(G,K,T){var J=this;J.dm().beginTransaction(),G instanceof mo||(G=new mo(G)),fo(G,K,T),J.dm().endTransaction()},getDataUIBounds:function(f){var C=this.getDataUI(f);return C?C._79o():h},drawData:function(J,Q,D){var i=this.getDataUI(Q);if(i){var k=i._79o();(!D||Sc(D,k))&&(i._42(J),Q instanceof u.Block&&Q.eachChild(function(v){this.drawData(J,v,D)},this))}},getBoundsForGroup:function(B){return B.s(so)?this.getDataUIBounds(B):h},isPixelPerfect:function(i){return i.s("pixelPerfect")},rectIntersects:function(s,d){this.validate();var E=h;if(this._56I[s._id]){var w=this._25I[s._id];if(w){var n=w._79o();if($l(d,n))E=!0;else if((d=Dk(d,n))&&(w.rectIntersects&&(E=w.rectIntersects(d)),E==h)){if(!this.isPixelPerfect(s))return!0;var V=d.x,l=d.y,$=d.width,v=d.height,Y=this._zoom,u=C.hitMaxArea,K=$*v*Y*Y;if(K>u){var H=Math.sqrt(u/K);Y*=H}$*=Y,v*=Y,2>$&&($=2),2>v&&(v=2),V*=Y,l*=Y;var z=yp($,v);uc(z,-V,-l),z.scale(Y,Y),this._drawForChecking=!0,this.drawData(z,s,d),this._drawForChecking=!1;try{for(var e=0,m=z.getImageData(0,0,$,v).data;e<m.length;e+=4)if(0!==m[e+3]){E=!0;break}z.restore()}catch(G){wo=h,E=!1}}}}return E?!0:!1},rectContains:function(E,N){if(this._56I[E._id]){var G=this._25I[E._id];if(G)return $l(N,G._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(K){if(!C.isInput(K.target)){var E=this,f=E._focusData,Y=f&&E._25I[f._id],w=0,U=E._dataModel._datas;if(!(f&&f._enabled&&f._editable&&Y&&Y.onKeyDown&&Y.onKeyDown(K)===!0))if(9===K.keyCode&&(f&&(w=U.indexOf(f),oe(K)?-1===--w&&(w=0):++w===U.size()&&(w=0)),E._focusData=f=U.get(w),E.sm().setSelection(f)),Zb(K)?E.selectAll():eo(K)&&E.isResettable()&&E.reset(),E.sm().isEmpty()){if(E._editing)return;var k=E.tx(),F=E.ty(),N=!1,v=oe()?100:10;$j(K)&&(k-=v,N=!0),Pl(K)&&(F-=v,N=!0),Mb(K)&&(k+=v,N=!0),Bm(K)&&(F+=v,N=!0),N&&E.setTranslate(k,F)}else{ub(K)&&E.handleDelete(K);var G=oe()?10:1;$j(K)&&(E.moveSelection(-G,0),E.fi({kind:"moveLeft"})),Pl(K)&&(E.moveSelection(0,-G),E.fi({kind:"moveUp"})),Mb(K)&&(E.moveSelection(G,0),E.fi({kind:"moveRight"})),Bm(K)&&(E.moveSelection(0,G),E.fi({kind:"moveDown"}))}}},handleScroll:function(j,Q){if(ll(j),this.isZoomable()){if(!this.getEditInteractor()){var z=this.getDataAt(j);if(z){var J=ef(this.getImage(z));if(J&&pf(J.scrollable,z,this))return}}var N=this.lp(j);Q>0?this.scrollZoomIn(N):0>Q&&this.scrollZoomOut(N)}},handlePinch:function(o,P,Q){this.isZoomable()&&(this._68I||(P>Q?this.pinchZoomIn(o):this.pinchZoomOut(o)))},checkDoubleClickOnNote:function(N,E){var M=this,o=M.lp(N),j=M.getDataUI(E),K=j.note2Info;return K&&E.s("note2.toggleable")&&bf(K.clickRect,o)?(E.s(hp,!E.s(hp)),M.fi({kind:"toggleNote2",event:N,data:E}),!0):(K=j.noteInfo,K&&E.s("note.toggleable")&&bf(K.clickRect,o)?(E.s(Po,!E.s(Po)),M.fi({kind:"toggleNote",event:N,data:E}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(Q,l){var X=this,q=X.getAutoScrollZone(),K=q/X.getZoom(),r=q/4,w=X._29I,Z=X.lp(Q),b={x:X.tx(),y:X.ty()};return Z&&q>0&&w&&(Z.x-w.x<K?X.translate(r,0):w.x+w.width-Z.x<K&&X.translate(-r,0),Z.y-w.y<K?X.translate(0,r):w.y+w.height-Z.y<K&&X.translate(0,-r)),b.x=X.tx()-b.x,b.y=X.ty()-b.y,l&&(l.x+=b.x,l.y+=b.y),b},getMoveMode:function(o,I){var v=I.s("2d.move.mode");return v?v:lq["88"]?"x":lq["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(q,N,L){var b=this;return"currentSubGraph"===N?{__i:q.getId()}:L.serializeProperty(q,N,b)},deserializeProperty:function(U,g,h){var C=this;if("currentSubGraph"===g){var e=C.dm(),M=e.__idMap;return M[U.__i]}return h.deserializeProperty(U,g,C)},setDefaultCursor:function(T,R){this._defaultCursor=T,R!==!1&&this.setCursor(T)},setCursor:function(K){"default"===K&&(K=this._defaultCursor||K);var L=this.getView().style;L.cursor=K,L.cursor="-webkit-"+K,L.cursor="-moz-"+K},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(a){return a===h||C.getConnectAction(null,a)?(this._currentActionType=a,this.redraw(),!0):!1},isConnectActionVisible:function(s){var M=C.getConnectAction(this);if(!M)return!1;var T=M.visible;return Pj(T)&&(T=T(this,s)),T},isInteractive:function(T){var h=ef(this.getImage(T));return h&&pf(h.interactive,T,this)?!0:T.s("interactive")},appendHTML:function(i,X){var d=this.getView();if(!(X||i&&i.parentNode!==d))return!1;var R=i.getView&&i.getView();if(!X&&R&&R.parentNode===d)return!1;if(i.isSelfViewEvent)return i.addToDOM(d),!0;i.getView&&(i=i.getView());var V=this.getEditInteractor();return V&&V._canvas?d.insertBefore(i,V._canvas):this.isScrollBarVisible()?d.insertBefore(i,this.getView().lastChild):Pp(d,i),!0},_layoutHTMLImpl:function(b,q,T){if(arguments.length>1){var l,e=this,C=e._zoom;if(q.getView&&(l=q,q=q.getView()),q.style.position="absolute",T){var j=b.getRect();rr(l||q,e.tx()+j.x*C,e.ty()+j.y*C,j.width*C,j.height*C)}else{var z=new Er,j=b.getAnchorRect(),R=b.getPosition(),Q=b.getScale(),d=q.style;rr(l||q,j),z.appendTranslate(e.tx(),e.ty()),z.appendScale(C,C),z.append(new Er(b.getRotation(),R.x,R.y,Q.x,Q.y)),Zk(d,"transform","matrix("+z.a.toFixed(5)+", "+z.b.toFixed(5)+", "+z.c.toFixed(5)+",\n    "+z.d.toFixed(5)+", "+z.tx.toFixed(5)+", "+z.ty.toFixed(5)+")"),Zk(d,"transformOrigin",(-j.x).toFixed(5)+"px "+(-j.y).toFixed(5)+"px"),q.maxtrixAppend=z.invert().translate(-j.x,-j.y)}}else this._layoutHTML&&this._layoutHTML()}}),f.defineProperties(ji.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(Z){this._layoutHTML=Z}}});var Wk=function(O,u){var F=this;F.gv=O,F.s=function(U){return u.getStyle(U)},F._data=u,F._87I=new mo};Wh(Wk,f,{_6I:h,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var s=this,J=s.gv.isSelected(s._data);return!J||s.isShadowed()?0:s.gv.getSelectWidth(s._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(u){var X=this._data,k=this.gv.getBodyColor(X);return k?k:u?X.getStyle(u):h},_2Q:function(m){return this.s(m)},_1Q:function(I,l,B,T){var b=this.s,$=b("2d.gray"),Z=b(l+".dash.color");if($&&(Z=C.toGrayColor(Z)),I.strokeStyle=Z,I.lineWidth=B,I.stroke(),b(l+".dash.3d")){var n=b(l+".dash.3d.color");tr(I,Z,$?C.toGrayColor(n):n,B,this.gv._zoom,b(l+".dash.3d.accuracy"))}Ci(I,T)},invalidate:function(){this._6I=h},_79o:function(){var u=this;if(!u._6I){var Y=u._data,e=u.gv;u.labelInfo=u.label2Info=u.noteInfo=u.note2Info=u._38o=h,u._87I.clear(),u.interactiveInfo=e.isInteractive(Y)?{}:h,u._3O(),u._55O=e.isEditable(Y)?{_42O:e.isRectEditable(Y),_43O:e.isPointEditable(Y),_56O:e.isRotationEditable(Y)}:h,u._6I=u._81o()}return u._6I},_3O:function(){},getPosition:function(){return dm},_68o:function(s,m){s&&this._87I.add(kp(s,m))},_81o:function(){var u=this,E=u.s;u._24O(zk,"getLabel"),u._24O(cl,"getLabel2"),u._26O(ve,"getNote"),u._26O(en,"getNote2"),u._15O(),u._55O&&u._48O();var U;if(u._87I.each(function(v){U=Xd(U,v)}),U&&u.isShadowed()){var z=ud(U);z.x+=E("shadow.offset.x"),z.y+=E("shadow.offset.y"),Rd(z,E("shadow.blur")),U=Xd(U,z)}return u._87I.clear(),U},_42:function(n){var D=this,x=D._data,r=D.gv,t=D.s,Z=t("opacity"),C=this.isShadowed();if(C){var y=n.shadowOffsetX,W=n.shadowOffsetY,k=n.shadowBlur,j=n.shadowColor,w=r.getZoom();n.shadowOffsetX=t("shadow.offset.x")*w,n.shadowOffsetY=t("shadow.offset.y")*w,n.shadowBlur=t("shadow.blur")*w,n.shadowColor=D.getSelectColor()}if(Z!=h){var q=n.globalAlpha;n.globalAlpha=Z}D._80o(n),r.isLabelVisible(x)&&((!r._drawForChecking||t("label.selectable"))&&$c(n,D.labelInfo),(!r._drawForChecking||t("label2.selectable"))&&$c(n,D.label2Info)),r.isNoteVisible(x)&&(Mh(n,D.noteInfo),Mh(n,D.note2Info)),D._99O(n),Z!=h&&(n.globalAlpha=q),C&&(n.shadowOffsetX=y,n.shadowOffsetY=W,n.shadowBlur=k,n.shadowColor=j)},_80o:function(){},_47O:function(){},_24O:function(l,v){var F=this,K=F._data,D=F.gv,H=F.s,k=D[v](K);if(k!=h){var M=H(l+".scale"),T=H(l+".max"),f=H(l+".position"),X=F[l+"Info"]={label:k,scale:M,color:D[v+"Color"](K),font:H(l+".font"),opacity:H(l+".opacity"),align:H(l+".align"),rotation:F.getRotation(H(l+".rotation"),!1,f),background:D[v+"Background"](K)},a=oc(X,k);T>0&&T<a.width&&(X.labelWidth=a.width,a.width=T),1!==M&&(a.width*=M,a.height*=M);var $=F.getPosition(f,H(l+".offset.x"),H(l+".offset.y"),a,H(l+".position.fixed"));if(a.x=$.x-a.width/2,a.y=$.y-a.height/2,F._68o(X.rect=a,X.rotation),1!==M){var R=a.width/M,U=a.height/M;X.rect={x:$.x-R/2,y:$.y-U/2,width:R,height:U}}}},_26O:function(S,o){var x=this,k=x.gv,F=x._data,Y=x.s,s=k[o](F);
if(s!=h){var X,B,R=Y(S+".scale"),_=x[S+"Info"]={note:s,scale:R,data:F,view:k,expanded:Y(S+".expanded"),font:Y(S+".font"),color:Y(S+".color"),opacity:Y(S+".opacity"),align:Y(S+".align"),icon:Y(S+".icon"),backgroundImage:Y(S+".backgroundImage"),borderWidth:Y(S+".border.width"),borderColor:Y(S+".border.color"),background:k[o+"Background"](F)},p=x.getPosition(Y(S+".position"),Y(S+".offset.x"),Y(S+".offset.y")),C=p.x,I=p.y;if(_.expanded){var u,f=Y(S+".max"),E=Y(S+".backgroundImage");E?(E=ef(E),u={width:iq(E,F),height:Yh(E,F)}):u=oc(_,s),u.width+=6,u.height+=2,f>0&&f<u.width&&(_.labelWidth=u.width,u.width=f),X=u.width,B=u.height+8,_.clickRect={x:C-X*R/2,y:I-B*R,width:X*R,height:B*R*u.height/B}}else{var J=Y(S+".icon");J?(J=ef(J),X=iq(J,F),B=Yh(J,F)):(X=12,B=18),_.clickRect={x:C-X*R/2,y:I-B*R,width:X*R,height:B*R}}_.rect={x:C-X/2,y:I-B*R/2-B/2,width:X,height:B};var H=d(_.borderWidth/2)*R;x._68o({x:C-X*R/2-H,y:I-B*R-H,width:X*R+2*H,height:B*R+2*H})}},_48O:function(){},_99O:function(C){var f=this,j=f._38o;if(j){var m=f.gv,L=f._data,x=j.icons,F=f.interactiveInfo;F&&(F._38o={});for(var Y in x){var v=x[Y],r=j.rects[Y];if(r){F&&(F._38o[Y]=[]);var S=pf(v.opacity,L,m),p=pf(v.names,L,m),s=p?p.length:0,Z=r.rotation;if(S!=h){var t=C.globalAlpha;C.globalAlpha*=S}for(var W=0;s>W;W++){var E=p[W],M=ef(E),o=r[W];if(Z){var g=o.x+o.width/2,A=o.y+o.height/2;C.save(),uc(C,g,A),Lc(C,Z),uc(C,-g,-A)}F&&F._38o[Y].push(C.interactiveInfo={compInfos:[],matrix:Z?new Er(Z,g,A).appendTranslate(-g,-A):new Er}),Cr(C,M,pf(v.stretch,L,m),o.x,o.y,o.width,o.height,f._data,f.gv),C.interactiveInfo=h,Z&&C.restore()}S!=h&&(C.globalAlpha=t)}}}}});var Dm=function(O,w){Yn(Dm,this,[O,w])};Wh(Dm,Wk,{_checkEmptyRect:!0,_40O:function(e,X){var Q=this,w=Q.s,z=e.rect;(e.borderColor=Q.gv.getBorderColor(Q._data))&&(e.borderType=w("border.type"),e.borderWidth=w("border.width"),e.borderPadding=w("border.padding"),X=m(X,e.borderPadding+e.borderWidth/2));var v=Q._data.getScale(),d=m(1,m(r(v.x),r(v.y)));if(e.selectWidth=Q.getSelectWidth()){var B=Q.gv._zoom;e.selectType=w("select.type"),e._97o=Q.getSelectColor(),e.selectPadding=w("select.padding"),X=m(X,(e.selectPadding+e.selectWidth/2/B)/d)}X>0&&(X*=d,z=ud(z),Rd(z,X)),Q._68o(z)},_39O:function(A,C){var Z,O=this,t=C.rect;if(C.borderWidth>0&&(Z=C.borderPadding,A.strokeStyle=C.borderColor,A.lineWidth=C.borderWidth,wl(A,C.borderType,{x:t.x-Z,y:t.y-Z,width:t.width+2*Z,height:t.height+2*Z}),A.stroke()),C.selectWidth>0){var y=O.gv._zoom;if(Z=C.selectPadding,A.strokeStyle=C._97o,A.lineWidth=C.selectWidth/y,C.rotation!=h){A.save(),A.translate(C.position.x,C.position.y),A.rotate(C.rotation);var W=O._data,E=W.getWidth(),R=W.getHeight(),Q=C.scale,T=C.anchor;t={x:Q.x*-E*T.x,y:Q.y*-R*T.y,width:Q.x*E,height:Q.y*R}}wl(A,C.selectType,{x:t.x-Z,y:t.y-Z,width:t.width+2*Z,height:t.height+2*Z}),C.rotation!=h&&A.restore(),A.stroke()}},dispose:function(){var p=this,x=p._htmlView;Dm.superClass._3O.call(p),x&&(x.onHTMLRemoved&&x.onHTMLRemoved(),Oe(x))},_3O:function(){var M=this,e=M.s,V=M._data,v=M.gv,d=V.getStyle(Fi),s=M.getBodyColor(),u=M._83o=d?{shape:d,_53o:M.getBodyColor("shape.background"),_27Q:ef(e("shape.repeat.image"),s),shapeGradientPack:e("shape.gradient.pack"),_54o:e("shape.border.width"),_55o:e("shape.border.color"),_56o:e("shape.border.3d"),_57o:e("shape.border.3d.color"),_58o:e("shape.border.3d.accuracy"),shapeGradient:e("shape.gradient"),_59o:e("shape.gradient.color"),_60o:e("shape.border.pattern"),_61o:e("shape.border.cap"),_62o:e("shape.border.join"),shapeForeground:e("shape.foreground"),bodyColor:s,gray:e("2d.gray")}:{img:ef(v.getImage(V),s),bodyColor:s,gray:e("2d.gray"),stretch:e("image.stretch")};if(Y&&!I);else{var j,y=u.img;y&&y.renderHTML?(M._htmlInfo&&M._htmlInfo.img!==y&&(M._htmlInfo=h),M._htmlInfo||(M._htmlInfo={img:y,cache:{}}),j=y.renderHTML(V,v,M._htmlInfo.cache)):M._htmlInfo=h,M._htmlView&&M._htmlView!==j&&(M._htmlView.onHTMLRemoved&&M._htmlView.onHTMLRemoved(),Oe(M._htmlView.getView?M._htmlView.getView():M._htmlView)),(M._htmlView=j)&&v.appendHTML(j)&&j.onHTMLAdded&&j.onHTMLAdded(),u.rect=V.getRect(),u.position=V.p(),u.scale=V.getScale(),u.anchor=V.getAnchor(),u.rotation=V.getRotation(),d===ue&&(u._63o=e("shape.depth"));var x=0;if(d)x=as(h,u._54o/2,u._62o),M.s("shape.dash")&&(x=m(x,(M.s("shape.dash.width")||u._54o)/2));else if(y&&y.boundExtend)if(x=pf(y.boundExtend,V,v),y.boundExtendAbsolute){var $=V.getScale();x/=v._zoom*m(1,m(r($.x),r($.y)))}else if(!pf(y.fitSize,V,v)){var B=pf(y.width,V,v),N=pf(y.height,V,v);x*=m(V.getWidth()/B,V.getHeight()/N)}M._40O(u,x);var A=e("clip.percentage");if(1>A&&(0>A&&(A=0),u.clipRect=po(V.getAnchorRect(),e("clip.direction"),A)),d){var l=e("shape.fill.clip.percentage");1>l&&(0>l&&(l=0),u.shapeClipRect=po(V.getAnchorRect(),e("shape.fill.clip.direction"),l));var U=e("shape.foreground.clip.percentage");1>U&&(0>U&&(U=0),u.shapeForegroundClipRect=po(V.getAnchorRect(),e("shape.foreground.clip.direction"),U))}}},getPosition:function(I,r,T,Q){var z=hm(I,this._83o.rect,Q);return z.x+=r,z.y+=T,z},_80o:function(i){var m=this,w=m.s,G=m.gv,F=m._data,o=m._83o,O=o.rect,H=o.position,d=o.rotation,q=o.anchor,Y=o.scale,Q=o.shape,x=o.clipRect;if(!m._checkEmptyRect||O.width>0&&O.height>0){var k=F.getSize();if(k.x=-k.width*q.x,k.y=-k.height*q.y,i.save(),uc(i,H.x,H.y),Lc(i,d),Jn(i,Y.x,Y.y),x&&(i.beginPath(),i.rect(x.x,x.y,x.width,x.height),i.clip()),G._drawForChecking&&o.img&&pf(o.img.pixelPerfect,F,G)===!1)ng(i,k.x,k.y,k.width,k.height,"#888888");else if(m.freeDraw)m.freeDraw(i,k,o);else if(Q){var f,u,J,$,A=o._60o,D=tk(i,A),r=o._27Q,T=o._54o,j=o.shapeGradientPack,Z=o.gray,e=i.lineJoin,U=i.lineCap,M=function(r){return Z?C.toGrayColor(r):r};"roundRect"===Q?f=w("shape.corner.radius"):"polygon"===Q?f=w("shape.polygon.side"):"arc"===Q&&(f=w("shape.arc.from"),u=w("shape.arc.to"),J=w("shape.arc.close"),$=w("shape.arc.oval")),i.lineJoin=o._62o,i.lineCap=o._61o;var p=M(o._53o);if(p||r||j){var X=o.shapeClipRect;X&&(i.save(),i.beginPath(),i.rect(X.x,X.y,X.width,X.height),i.clip()),wl(i,Q,k,f,u,J,$),j?Ni(i,j):r?qg(i,r,M(o.bodyColor),null,F,G):vr(i,p,o.shapeGradient,M(o._59o),k),i.fill(),X&&i.restore(),j&&i.restore(),i!==D&&wl(D,Q,k,f,u,J,$)}else wl(D,Q,k,f,u,J,$);var S=o.shapeForeground;if(S){i.save();var V=o.shapeForegroundClipRect;V&&(i.beginPath(),i.rect(V.x,V.y,V.width,V.height),i.clip()),wl(i,Q,k,f,u,J,$),vr(i,S,w("shape.foreground.gradient"),M(w("shape.foreground.gradient.color")),k),i.fill(),i.restore()}if(T>0){var W=w("shape.border.width.absolute");W&&(i.save(),i.setTransform(1,0,0,1,0,0)),i.lineWidth=T;var N=M(o._55o);i.strokeStyle=N,i.stroke(),W&&i.restore(),o._56o&&tr(i,N,M(o._57o),T,G._zoom,o._58o)}if(Ci(i,A),w("shape.dash")){var b=w("shape.dash.width")||T;if(b>0){A=w("shape.dash.pattern");var D=tk(i,A,m._2Q("shape.dash.offset"));D!==i&&wl(D,Q,k,f,u,J,$),m._1Q(i,"shape",b,A)}}ps(i,p,o._63o,k),i.lineJoin=e,i.lineCap=U}else{var v=m.interactiveInfo;v&&(i.interactiveInfo=v.bodyInfo={compInfos:[],matrix:new Er(d,H.x,H.y,Y.x,Y.y)}),o.gray&&(i.compGray=!0);var R=o.img;R&&R.cacheRule!=h&&(R=Zf(i,R,o.stretch,k.width,k.height,F,G,o.bodyColor)),Cr(i,R,o.stretch,k.x,k.y,k.width,k.height,F,G,o.bodyColor),i.compGray=!1,i.interactiveInfo=h}i.restore()}m._39O(i,o)},_48O:function(){},_47O:function(){}});var Sd=function(Z,L){Yn(Sd,this,[Z,L])},nf=function(H,Q,f,v){var q=Im(H,Q);return f=v?M(f,q):hj(f,q),q?f/=q:f=0,{x:H.x+(Q.x-H.x)*f,y:H.y+(Q.y-H.y)*f}};Wh(Sd,Wk,{_3O:function(){var F,r=this,M=r._data,s=r.gv,Z=r.s,$=Z(Nj),f=M.isLooped(),q=Z("edge.width"),T=Z("edge.center"),o=Z("edge.offset"),N=s.getBorderColor(M),D=N?Z("border.width"):0,u=r.getSelectWidth(),H=M._40I,w=M._41I,A=r._78o=H&&w?{looped:f,type:$,width:q,center:T,color:r.getBodyColor("edge.color"),borderColor:N,borderWidth:D,_97o:u?r.getSelectColor():h,selectWidth:u,pattern:Z("edge.pattern"),cap:Z("edge.cap"),join:Z("edge.join"),is3d:Z("edge.3d"),_67o:Z("edge.3d.color"),_66o:Z("edge.3d.accuracy"),gray:Z("2d.gray")}:h;if(A){var v=C.getEdgeType($);if(v){var j=v(M,Fg(r,s,M,f,$),s,r._19Q);j.points&&j.points.size()>1?(A.edgeTypeInfo=j,F=Vn(A.edgeTypeInfo.points)):j[ap]&&j.rect&&(A.edgeTypeInfo=j,F=j.rect)}else{var n=Z("edge.source.anchor.x"),P=Z("edge.source.anchor.y"),W=Z("edge.target.anchor.x"),Q=Z("edge.target.anchor.y"),k=_h(s,H,Z("edge.source.position"),Z("edge.source.offset.x"),Z("edge.source.offset.y"),n,P),p=_h(s,w,Z("edge.target.position"),Z("edge.target.offset.x"),Z("edge.target.offset.y"),W,Q);if($===_c){var y=A.points=Z(Qn)||vb,J=y.size();A.segments=Z("edge.segments");var B=n!==l||P!==l,Y=W!==l||Q!==l;if(!T)if(o)B||(k=nf(k,J?y.get(0):p,o,J)),Y||(p=nf(p,J?y.get(J-1):k,o,J));else{var V;B||(V=de(k,J?y.get(0):p,He(s,H)),V&&(k={x:V[0],y:V[1]})),Y||(V=de(J?y.get(J-1):k,p,He(s,w)),V&&(p={x:V[0],y:V[1]}))}F=Xd(Vn(A.points),Vn(k,p))}else{var a=Fg(r,s,M,f,$);if(r._19Q||(a=-a),f)k=ud(k),k.x=s.getNodeRect(H).x,A.radius=a,F={x:k.x-a,y:k.y-a,width:2*a,height:2*a};else{var X=Im(k,p),R=hj(o,X),g={x:R,y:a},G={x:X-R,y:a},O=i(p.y-k.y,p.x-k.x),e=A.mat=new rb(O);if(A.orienAngle=O,A.angle=p.x<k.x?O+b:O,A.rect={x:g.x,y:g.y,width:G.x-g.x,height:0},A.origin=k,g=e.tf(g),g.x+=k.x,g.y+=k.y,G=e.tf(G),G.x+=k.x,G.y+=k.y,T){var L={x:X,y:0};L=e.tf(L),L.x+=k.x,L.y+=k.y,F=Vn([k,g,G,L]),A.c1=k,A.c2=L}else F=Vn(g,G);k=g,p=G}}A.sourcePoint=k,A.targetPoint=p,M._lastSourcePoint=k,M._lastTargetPoint=p}var z=0;Z("edge.dash")&&(z=Z("edge.dash.width")||q);var I="square"===A.cap?.71:.5;as(F,m(z*I,q*I+D+u),A.join),r._68o(F)}},getRotation:function(j,D,R){j=j||0;var l=this._78o;if(l){var X,C=l.angle,Q=l.points,L=l.edgeTypeInfo;if(C!=h)return D?l.orienAngle+j:C+j;if(L&&L[ap])return L.getRotation?L.getRotation(this,j,D,R):0;if(L&&L.points){var G=L.points;return X=G.size(),Xr[R]?X&&0===X%2?vd(G.get(X/2-1),G.get(X/2),D,j):j:rn[R]?vd(G.get(0),G.get(1),D,j):vd(G.get(X-2),G.get(X-1),D,j)}if(Q)return X=Q.size(),Xr[R]?X&&0===X%2?vd(Q.get(X/2-1),Q.get(X/2),D,j):j:rn[R]?vd(l.sourcePoint,X?Q.get(0):l.targetPoint,D,j):vd(X?Q.get(X-1):l.sourcePoint,l.targetPoint,D,j)}return j},getPosition:function(n,C,p,m,u){var I=this._78o;if(I){var Z,X=I.type,k=I.points,M=I.edgeTypeInfo,V=I.sourcePoint,W=I.targetPoint;if(!X)return I.looped?{x:V.x-I.radius+C,y:V.y+p}:(u&&V&&W&&(V.x>W.x||V.x===W.x&&V.y>W.y)&&(n=Ck[n],p=-p),Z=hm(n,I.rect,m),Z.x+=C,Z.y+=p,Z=I.mat.tf(Z),Z.x+=I.origin.x,Z.y+=I.origin.y,Z);if(M&&M[ap])return M.getPosition?M.getPosition(this,n,C,p,m,u):{x:(V.x+W.x)/2,y:(V.y+W.y)/2};if(k){var Z,F=k.size();if(Xr[n]){if(F){var r=F%2;if(0===r)return qi(k.get(F/2-1),k.get(F/2),n,C,p,m,u);Z=k.get((F-r)/2)}else Z={x:(V.x+W.x)/2,y:(V.y+W.y)/2};return Z=hm(n,{x:Z.x,y:Z.y,width:0,height:0},m),Z.x+=C,Z.y+=p,Z}return rn[n]?qi(V,F?k.get(0):W,n,C,p,m,u):qi(F?k.get(F-1):V,W,n,C,p,m,u)}if(M){var e=M.points,F=e.size();if(Xr[n]){var r=F%2;return 0===r?qi(e.get(F/2-1),e.get(F/2),n,C,p,m,u):(Z=e.get((F-r)/2),Z=hm(n,{x:Z.x,y:Z.y,width:0,height:0},m),Z.x+=C,Z.y+=p,Z)}return rn[n]?qi(e.get(0),e.get(1),n,C,p,m,u):qi(e.get(F-2),e.get(F-1),n,C,p,m,u)}}return dm},_42:function(m){this._78o&&Sd.superClass._42.call(this,m)},drawPath:function(f,e){f.beginPath();var r=e.type,S=e.points,q=e.segments,v=e.edgeTypeInfo;if(!r||S){var c=e.sourcePoint,a=c.x,E=c.y,O=e.targetPoint,d=O.x,P=O.y;if(r)if(q){var J=new mo({x:a,y:E});J.addAll(S),J.add({x:d,y:P}),Of(f,J,q)}else f.moveTo(a,E),S.each(function(o){f.lineTo(o.x,o.y)}),f.lineTo(d,P);else e.looped?f.arc(a,E,e.radius,0,x,!0):e.center?(f.moveTo(e.c1.x,e.c1.y),f.lineTo(a,E),f.lineTo(d,P),f.lineTo(e.c2.x,e.c2.y)):(f.moveTo(a,E),f.lineTo(d,P))}else v&&(v.points?Of(f,v.points,v.segments):v[ap]&&v[ap](f,v))},_80o:function(H){var Z=this,W=Z.s,v=Z._78o,$=v.width,l=v.selectWidth,e=v.borderWidth,N=H.lineJoin,F=H.lineCap,D=v.gray,O=v.pattern;H.lineJoin=v.join,H.lineCap=v.cap,Z.drawPath(tk(H,O),v);var x=W("edge.width.absolute");x&&(H.save(),H.setTransform(1,0,0,1,0,0)),l&&(H.strokeStyle=v._97o,H.lineWidth=$+2*(e+l),H.stroke()),e&&(H.strokeStyle=D?C.toGrayColor(v.borderColor):v.borderColor,H.lineWidth=$+2*e,H.stroke());var A=D?C.toGrayColor(v.color):v.color,I=D?C.toGrayColor(v._67o):v._67o;if(H.strokeStyle=A,H.lineWidth=$,H.stroke(),v.is3d&&tr(H,A,I,$,Z.gv._zoom,v._66o),x&&H.restore(),Ci(H,O),W("edge.dash")){O=W("edge.dash.pattern");var Q=tk(H,O,Z._2Q("edge.dash.offset"));Q!==H&&Z.drawPath(Q,v),Z._1Q(H,"edge",W("edge.dash.width")||$,O)}H.lineJoin=N,H.lineCap=F},_48O:function(){},_47O:function(){},_71o:function(p,K){var O=this,X=O._data;if(O._19Q=!0,!X.getEdgeGroup())return p?X.s("edge.gap"):0;var R,e=0,o=0,d=0;if(X.getEdgeGroup().getSiblings().each(function(t){t.each(function(B){if(O.gv.isVisible(B)&&B.s(Nj)==K){var q=B.s("edge.gap");R?(o+=d/2+q/2,d=q):(R=B,d=q),B===X&&(e=o)}})}),p)return o-e+d;var t=e-o/2;return R&&X._40I!==R._40I&&(O._19Q=!1),t}});var wq=function(H,k){Yn(wq,this,[H,k])};Wh(wq,Dm,{_3O:function(){var u,z,f=this,D=f.s,E=f._data,w=f.gv;if(f._88I=h,E.isExpanded()&&E.eachChild(function(D){if(bh(D)){var S=w.getBoundsForGroup(D);S&&(z||(z=[]),z.push(S),u=Xd(u,S))}}),u){var e=w.getLabel(E),O=D("group.type");u=De(O,z,u),og(u,E,"group.padding",1);var M=f._88I={type:O,rect:u,_64o:u};if(!O&&e!=h){var H,Z=f.labelInfo={label:e,color:D("group.title.color"),font:D("group.title.font"),align:D("group.title.align")},c=oc(Z,e),j=c.width,l=c.height,m=D("group.title.align"),X=D("group.title.orientation");if((X===mj||X===Sh)&&j>u.width?u.width=j:(X===nh||X===lp)&&j>u.height&&(u.height=j),Z.rect={y:u.y-l,width:c.width,height:l},H=m===nh?u.x:m===lp?u.x+u.width-j:u.x+u.width/2-j/2,Z.rect.x=H,X===Sh)M.titleRect={x:u.x,y:u.y+u.height,width:u.width,height:l},M.rect={x:u.x,y:u.y,width:u.width,height:u.height+l},Z.rect={x:H,y:u.y+u.height,width:j,height:l};else if(X===nh){var V=M.titleRect={x:u.x-l,y:u.y,width:l,height:u.height};M.rect={x:u.x-l,y:u.y,width:u.width+l,height:u.height},Z.rect={x:V.x+l/2-u.height/2,y:V.y+u.height/2-l/2,width:u.height,height:l},Z.rotation=-Math.PI/2}else if(X===lp){var V=M.titleRect={x:u.x+u.width,y:u.y,width:l,height:u.height};M.rect={x:u.x,y:u.y,width:u.width+l,height:u.height},Z.rect={x:V.x+l/2-u.height/2,y:V.y+u.height/2-l/2,width:u.height,height:l},Z.rotation=Math.PI/2}else M.titleRect={x:u.x,y:u.y-l,width:u.width,height:l+1},M.rect={x:u.x,y:u.y-l,width:u.width,height:u.height+l}}f._40O(M,D("group.border.width")/2)}else wq.superClass._3O.call(f)},getPosition:function(V,P,E,F){var L=this._88I;if(L){var a=hm(V,L.rect,F);return a.x+=P,a.y+=E,a}return wq.superClass.getPosition.apply(this,arguments)},_24O:function(E,O){var o=this._88I;(!o||o.type||"label2"===E)&&wq.superClass._24O.call(this,E,O)},_80o:function(a){var T=this,y=T._88I;if(y){var S=T._data,u=T.s,J=T.gv,i=y.type,$=y.rect,k=y._64o,p=y.titleRect,E=T.getBodyColor(),W=ef(u("group.image"),E),D=u("group.image.stretch"),e=T.getBodyColor("group.background"),z=ef(u("group.repeat.image"),E),L=u("group.gradient.pack"),V=u("group.gradient"),v=u("group.gradient.color"),K=u("group.border.width"),B=u("group.border.color"),l=u("group.border.pattern"),t=u("group.title.orientation"),Y=u("group.depth");if(i){var C=a.lineJoin,g=a.lineCap;if(a.lineJoin=u("group.border.join"),a.lineCap=u("group.border.cap"),W){if(a.save(),wl(a,i,$),a.clip(),Cr(a,W,D,$.x,$.y,$.width,$.height,S,J,E),a.restore(),K>0){var P=tk(a,l);wl(P,i,$),a.lineWidth=K,a.strokeStyle=B,a.stroke(),Ci(a,l)}}else{var P=tk(a,l);e||z||L?(wl(a,i,$),L?Ni(a,L):z?qg(a,z,E,null,S,J):vr(a,e,V,v,$),a.fill(),L&&a.restore(),a!==P&&wl(P,i,$)):wl(P,i,$),K>0&&(a.lineWidth=K,a.strokeStyle=u("group.border.color"),a.stroke()),Ci(a,l),i===ue&&ps(a,e,Y,$)}a.lineJoin=C,a.lineCap=g}else{var _=u("group.title.background"),h=u("group.border.radius");if(W)Cr(a,W,D,k.x,k.y,k.width,k.height,S,J,T.getBodyColor());else if(e||z)if(z?qg(a,z,E,null,S,J):vr(a,e,V,v,k),0===K)wl(a,ue,k),a.fill(),ps(a,e,Y,k);else{switch(a.beginPath(),t){case Sh:Uj(a,k.x,k.y,k.width,k.height,h,h,0,0);break;case nh:Uj(a,k.x,k.y,k.width,k.height,0,h,0,h);break;case lp:Uj(a,k.x,k.y,k.width,k.height,h,0,h,0);break;case mj:Uj(a,k.x,k.y,k.width,k.height,0,0,h,h)}a.fill()}if(p&&_)if(0===K)ng(a,p.x,p.y,p.width,p.height,_),ps(a,_,Y,p);else{switch(a.beginPath(),a.fillStyle=_,t){case Sh:Uj(a,p.x,p.y,p.width,p.height,0,0,h,h);break;case nh:Uj(a,p.x,p.y,p.width,p.height,h,0,h,0);break;case lp:Uj(a,p.x,p.y,p.width,p.height,0,h,0,h);break;case mj:Uj(a,p.x,p.y,p.width,p.height,h,h,0,0)}a.fill()}if(K>0){var P=tk(a,l);if(wl(P,"roundRect",$,h),a.lineWidth=K,a.strokeStyle=B,p&&u("group.splitLine")){var f=p.x,F=p.y,m=p.width,o=p.height;t===Sh?(a.moveTo(f,F),a.lineTo(f+m,F)):t===nh?(a.moveTo(f+m,F),a.lineTo(f+m,F+o)):t===lp?(a.moveTo(f,F),a.lineTo(f,F+o)):(a.moveTo(f,F+o),a.lineTo(f+m,F+o))}a.stroke(),Ci(a,l)}}T._39O(a,y)}else wq.superClass._80o.call(T,a)}});var Zl=function(x,k){Yn(Zl,this,[x,k])};Wh(Zl,Dm,{_80o:function(F){this._39O(F,this._83o)}});var no=function(B,k){Yn(no,this,[B,k])};Wh(no,Dm,{_3O:function(){var V=this,p=V._data,v=V.s,f=V.gv,W=p.getPoints(),j=f.getBorderColor(p),G=j?v("border.width"):0,K=V.getSelectWidth(),b=v("shape.border.width"),C=p.getRect(),S=f.getBodyColor(p),D=V._99o=W.isEmpty()?h:{rect:C,rotation:p.getRotation(),fillRule:v("shape.fill.rule"),scale:p.getScale(),position:p.p(),points:W,segments:p.getSegments(),bodyColor:S,borderColor:j,borderWidth:G,_94o:v("shape.border.3d"),_95o:v("shape.border.3d.color"),_96o:v("shape.border.3d.accuracy"),_97o:K?V.getSelectColor():h,selectWidth:K,_53o:v("shape.background"),_27Q:ef(v("shape.repeat.image"),S),shapeGradientPack:v("shape.gradient.pack"),_54o:b,_55o:v("shape.border.color"),shapeGradient:v("shape.gradient"),_59o:v("shape.gradient.color"),_60o:v("shape.border.pattern"),_61o:v("shape.border.cap"),_62o:v("shape.border.join"),shapeForeground:v("shape.foreground"),gray:v("2d.gray")};if(D){var R=p.getScale(),l=m(1,m(r(R.x),r(R.y)));v("shape.dash")&&v("shape.dash.width")>b&&(b=v("shape.dash.width"));var I=b*("square"===D._61o?.71:.5)+G+K/V.gv._zoom/l;I&&(I*=l,C=ud(C),as(C,I,D._62o)),V._68o(C);var s=v("clip.percentage");1>s&&(0>s&&(s=0),D.clipRect=po(p.getAnchorRect(),v("clip.direction"),s));var Q=v("shape.fill.clip.percentage");1>Q&&(0>Q&&(Q=0),D.shapeClipRect=po(p.getAnchorRect(),v("shape.fill.clip.direction"),Q));var Y=v("shape.foreground.clip.percentage");1>Y&&(0>Y&&(Y=0),D.shapeForegroundClipRect=po(p.getAnchorRect(),v("shape.foreground.clip.direction"),Y))}},getPosition:function(g,i,d,o){var Q=this._99o;if(Q){var E=hm(g,Q.rect,o);return E.x+=i,E.y+=d,E}return dm},_42:function(j){this._99o&&no.superClass._42.call(this,j)},_80o:function(F){var z,r=this,p=r.s,j=r._99o,u=j.position,l=j.scale,Y=j.rotation,U=j.borderWidth,n=j.selectWidth/r.gv._zoom,f=j._27Q,R=j.shapeGradientPack,B=j._54o,V=j.clipRect,Q=j.shapeClipRect,v=j.points,y=j.segments,S=r._data.isClosePath(),h=j.fillRule,o=j.gray,b=function(A){return o?C.toGrayColor(A):A},q=b(j._53o),m=q||f||R;F.save(),uc(F,u.x,u.y),Lc(F,Y),Jn(F,l.x,l.y),V&&(F.beginPath(),F.rect(V.x,V.y,V.width,V.height),F.clip()),m&&Q&&(F.save(),F.beginPath(),F.rect(Q.x,Q.y,Q.width,Q.height),F.clip()),uc(F,-u.x,-u.y);var D=j._60o,$=tk(F,D),E=F.lineJoin,H=F.lineCap;F.lineJoin=j._62o,F.lineCap=j._61o;var T=b(j.bodyColor);m?(Of(F,v,y,S),R?Ni(F,R):f?qg(F,f,T,null,r._data,r.gv):(z=T?T:q,vr(F,z,j.shapeGradient,b(j._59o),j.rect)),F.fill(h),Q&&(F.restore(),uc(F,-u.x,-u.y)),R&&F.restore(),$!==F&&Of($,v,y,S)):Of($,v,y,S);var t=j.shapeForeground;if(t){F.save();var s=j.shapeForegroundClipRect;s&&(uc(F,u.x,u.y),F.beginPath(),F.rect(s.x,s.y,s.width,s.height),F.clip(),uc(F,-u.x,-u.y)),Of(F,v,y,S),vr(F,t,p("shape.foreground.gradient"),b(p("shape.foreground.gradient.color")),j.rect),F.fill(h),F.restore()}var d=p("shape.border.width.absolute");if(d&&(F.save(),F.setTransform(1,0,0,1,0,0)),n&&(F.strokeStyle=j._97o,F.lineWidth=B+2*(U+n),F.stroke()),U&&(F.strokeStyle=b(j.borderColor),F.lineWidth=B+2*U,F.stroke()),B&&(z=b(j._55o),!q&&T&&(z=T),F.strokeStyle=z,F.lineWidth=B,F.stroke(),j._94o&&tr(F,z,b(j._95o),B,r.gv._zoom,j._96o)),d&&F.restore(),Ci(F,D),p("shape.dash")){var g=p("shape.dash.width")||B;if(g>0){D=p("shape.dash.pattern");var $=tk(F,D,r._2Q("shape.dash.offset"));$!==F&&Of($,v,y,S),r._1Q(F,"shape",g,D)}}F.lineJoin=E,F.lineCap=H,F.restore()},_48O:function(){},_47O:function(){}});var Gq=function(u,d){Yn(Gq,this,[u,d])};Wh(Gq,no,{getRotation:function(D,E,_){D=D||0;var k=this._data.getPoints(),t=k.size();return t>1?Xr[_]?t&&0===t%2?vd(k.get(t/2-1),k.get(t/2),E,D):D:rn[_]?vd(k.get(0),k.get(1),E,D):vd(k.get(t-2),k.get(t-1),E,D):D},getPosition:function($,p,i,b,E){var N=this._data.getPoints(),n=N.size();if(n>1){if(Xr[$]){var T=n%2;if(0===T)return qi(N.get(n/2-1),N.get(n/2),$,p,i,b,E);var G=N.get((n-T)/2),Q={x:G.x,y:G.y,width:0,height:0};return G=hm($,Q,b),G.x+=p,G.y+=i,G}return rn[$]?qi(N.get(0),N.get(1),$,p,i,b,E):qi(N.get(n-2),N.get(n-1),$,p,i,b,E)}return dm}});var gm=function(r,w){Yn(gm,this,[r,w])};Wh(gm,Dm,{_3O:function(){var P=this;gm.superClass._3O.call(P);var r=P.s,Y=P._83o;P._82o=Y.img||Y.shape?h:{background:P.getBodyColor("grid.background"),depth:r("grid.depth"),rect:Y.rect,_88o:r("grid.cell.depth"),cellBorderColor:r("grid.cell.border.color"),_89o:r("grid.row.count"),_90o:r("grid.column.count"),block:r("grid.block"),_91o:r("grid.block.color"),_92o:r("grid.block.padding"),_93o:r("grid.block.width")}},_80o:function(i){var Q=this,t=Q._82o;if(!t)return gm.superClass._80o.call(Q,i),void 0;var q,r,$=Q._data,R=t.background,H=t.rect,c=t.block,h=t._91o,E=t._92o,D=t._93o,U=t._88o,b=t.cellBorderColor,J=t._89o,w=t._90o;if(R)if(ng(i,H.x,H.y,H.width,H.height,R),ps(i,R,t.depth,H),U)for(q=0;J>q;q++)for(r=0;w>r;r++)H=$.getCellRect(q,r),H&&ps(i,R,U,H);else if(b){for(i.beginPath(),q=0;J>q;q++)for(r=0;w>r;r++)H=$.getCellRect(q,r),H&&i.rect(H.x,H.y,H.width,H.height);i.strokeStyle=b,i.lineWidth=1,i.stroke()}if("h"===c)for(q=0;J>q;q++)H=Xd($.getCellRect(q,0),$.getCellRect(q,w-1)),Rd(H,E),wg(i,h,H.x,H.y,H.width,H.height,D);else if("v"===c)for(r=0;w>r;r++)H=Xd($.getCellRect(0,r),$.getCellRect(J-1,r)),Rd(H,E),wg(i,h,H.x,H.y,H.width,H.height,D);Q._39O(i,Q._83o)}});var od=function(x,m){Yn(od,this,[x,m])};Wh(od,Dm,{_checkEmptyRect:!1,_81o:function(){var j=this._data,R=od.superClass._81o.call(this),c=j.s("text");if(c!=h){var s,H,$=j.s("text.font"),u=j.s("text.align"),O=j.s("text.vAlign"),Q=jh($,c),v=Q.width,X=Q.height,g=j.getAnchor(),p=j.getWidth(),D=j.getHeight();"left"===u?s=-p*g.x:"center"===u?s=-p*g.x+(p-v)/2:"right"===u&&(s=p*(1-g.x)-Q.width),"top"===O?H=-D*g.y:"middle"===O?H=-D*g.y+(D-X)/2:"bottom"===O&&(H=D*(1-g.y)-Q.height);var Z,d=j.getMatrix();if(Z=Vn([d.tf(s,H),d.tf(s+v,H),d.tf(s+v,H+X),d.tf(s,H+X)]),R=Xd(R,Z),R&&j.s("text.shadow")){var b=ud(R);b.x+=j.s("text.shadow.offset.x"),b.y+=j.s("text.shadow.offset.y"),Rd(b,j.s("text.shadow.blur")),R=Xd(R,b)}}return R}});var io=ji.Interactor=function(l){this.gv=this._graphView=l};nm("Interactor",f,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(b){this.gv.fi(b)},setCursor:function(J){Sl||this.gv.setCursor(J)},startDragging:function(Z){var W=this;W._lastClientPoint=kg(Z),W._lastLogicalPoint=W.gv.lp(Z),_f(W,Z)},clearDragging:function(){var F=this;F._lastClientPoint=F._lastLogicalPoint=F._logicalPoint=h},autoScroll:function(C){return this.gv.autoScroll(C,this._lastClientPoint)}});var Ye=h,Jo=function(G){Ye.handleWindowTouchMove(G)},Ld=function(B){Ye.handleWindowTouchEnd(B),G.removeEventListener(So,Jo,N),G.removeEventListener(Sm,Ld,N),Ye=h},Yc=function(l){Ye.handleWindowMouseMove(l)},Bp=function(y){Ye.handleWindowMouseUp(y),G.removeEventListener(Nc,Yc,N),G.removeEventListener(qe,Bp,N),Ye=h},ob=function(K,y){K!==Ye&&(Ye?Sl?Ye.handleWindowTouchEnd(y):Ye.handleWindowMouseUp(y):Sl?(G.addEventListener(So,Jo,N),G.addEventListener(Sm,Ld,N)):(G.addEventListener(Nc,Yc,N),G.addEventListener(qe,Bp,N)),Ye=K)},Yj=function(m){var t=this;t.gv=m,t._is2d=m instanceof ji.GraphView,t._is2d&&(t.filter=function(N){return m.isSelectable(N)&&m.isInteractive(N)}),m.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",Nn].forEach(function(q){t.addListener(q)}),t.initImageResource()};Wh(Yj,io,{enableVR:function(n){var w=this;if(!!w._vrEnable!==n)if(w._vrEnable=n,n)w.gv.vr.mp(w.onVRControllerChange,w);else if(w.gv.vr.ump(w.onVRControllerChange,w),w._vrRayPolyline){var T=w.gv.dm();T.remove(w._vrRayPolyline),T.remove(w._vrRayHitPoint),w._vrRayPolyline=l,w._vrRayHitPoint=l}},onVRControllerChange:function(_){var k=this,K=_.property,N=_.newValue,Z=k.gv.vr.getController(N.id),f=Z.getRay();f&&("gamepad.button.trigger"===K?"down"===N._62O?k.handle_mousedown(f):k.handleWindowMouseUp(f):"gamepad.pose"===K&&(k.handle_mousemove(f),k.handleWindowMouseMove(f)))},drawVRRay:function(d,s,J){var k,j=this,I=j.gv,h=j._vrRayPolyline,x=!1;if(h)k=j._vrRayHitPoint;else{var T=I.dm();j._vrRayPolyline=h=new u.Polyline,j._vrRayHitPoint=k=new u.Node,k.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),k.setAnchor3d(.5,.5,.499);var B=.2/I.vr.measureOflength;k.s3(B,B,B),h.s("intersect",!1),k.s("intersect",!1),T.add(h),T.add(k),x=!0}if(s){var G=J.world,g=J.worldNormal,M=G.x,A=G.y,w=G.z;h.s("shape.border.color","red"),h.setPoints([{x:d.origin.x,y:d.origin.z,e:d.origin.y},{x:M,y:w,e:A}]),k.s("3d.visible",!0),k.p3(M,A,w),k.lookAtDirection([g.x,g.y,g.z],"front")}else{h.s("shape.border.color","blue");var _=new u.Math.Vector3;_.copy(d.direction).setLength(1e3/j.gv.vr.measureOflength).add(d.origin),h.setPoints([{x:d.origin.x,y:d.origin.z,e:d.origin.y},{x:_.x,y:_.z,e:_.y}]),k.s("3d.visible",!1)}I.fi({kind:"vrRayIntersect",ray:d,data:s,intersect:J,polyline:h,hitNode:k,begin:x})},addListener:function(E){var c=this;c.gv.getView().addEventListener(E,function(l){C.preventDefault(l),c.disabled||c["handle_"+E](l)},N)},handleWindowTouchMove:function(_){this.handleWindowMouseMove(_)},handleWindowMouseMove:function(O){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",O):(this.handleDownInfo("onBeginDrag",O),this.isDragging=!0))},handleWindowTouchEnd:function(E){this.handleWindowMouseUp(E)},handleWindowMouseUp:function(L){if(this.isDragging&&(this.handleDownInfo("onEndDrag",L),this.isDragging=!1),this.downInfo){var R=this.handle("onUp",L);R&&R.data===this.downInfo.data?this.handleMissingUp(L):this.handleDownInfo("onUp",L),this.downInfo=h}},handle_mouseleave:function(R){var C=this,d=C.gv,Q=C.currentInfo?C.currentInfo.data:h;if(Q){Q.s("onLeave")&&Q.s("onLeave")(R,Q,d),C.fire("data","onLeave",R,Q);var z=C.currentInfo?C.currentInfo.hits:h;if(z)for(var j in z)C.handleLeave(R,j);C.currentInfo=h}},handle_mousewheel:function(S){S.scrollDelta=S.wheelDelta/40,this.handle("onScroll",S)},handle_DOMMouseScroll:function(b){b.scrollDelta=2===b.axis?-b.detail:0,this.handle("onScroll",b)},handle_touchstart:function(n){this.handle_mousedown(n)},handle_touchmove:function(E){this.handle("onMove",E)},handle_mousedown:function(d){this.isDragging&&(this.handleDownInfo("onEndDrag",d),this.isDragging=!1),this.downInfo=this.handle("onDown",d),this.downInfo&&ob(this,d)},handle_mousemove:function(W){var F=this,Q=F.gv;F._hoverTimer&&(c(F._hoverTimer),delete F._hoverTimer);var z,l,t,H=F.handle("onMove",W),U=this.currentInfo?this.currentInfo.data:h,j=this.currentInfo?this.currentInfo.hits:h;if(H&&(l=H.data,t=H.hits,F._hoverTimer=P(function(){c(F._hoverTimer),delete F._hoverTimer,F.handle("onHover",W,H)},Q.getHoverDelay()||C.hoverDelay)),l!==U){if(U&&(U.s("onLeave")&&U.s("onLeave")(W,U,Q),this.fire("data","onLeave",W,U)),l&&(l.s("onEnter")&&l.s("onEnter")(W,l,Q),this.fire("data","onEnter",W,l)),j)for(z in j)this.handleLeave(W,z);if(t)for(z in t){var p=t[z];p.target.onEnter&&p.target.onEnter(W,l,Q,p.point,p.width,p.height),this.fire(p.type,"onEnter",p.event,p.data,p.image,p.comp,p.point,p)}}else{if(j)for(z in j)t&&t[z]||this.handleLeave(W,z);if(t)for(z in t)if(!j||!j[z]){var p=t[z];p.target.onEnter&&p.target.onEnter(W,l,Q,p.point,p.width,p.height),this.fire(p.type,"onEnter",p.event,p.data,p.image,p.comp,p.point,p)}}this.currentInfo=H},handle:function(E,Q,y){var I,V=this,L=V.gv;if(V._is2d){if(y=y||L.getDataInfoAt(Q,this.filter),!y)return;if(I=y.ui.interactiveInfo){var c,h=y.data;if(h.s(E)&&h.s(E)(Q,h,L),this.fire("data",E,Q,h),"body"===y.part&&I.bodyInfo)c="body",y.hits=this.handleImage(c,L.getImage(h),E,Q,h,y.point,I.bodyInfo);else if("icons"===y.part&&I._38o){var Z=I._38o[y.name];Z&&Z[y.index]&&(c="icons|"+y.name+"|"+y.index,y.hits=this.handleImage(c,y.icon,E,Q,h,y.point,Z[y.index]))}}return y}var h,m;if(!y)if(Q&&Q instanceof u.Math.Ray){var F=L.vr.intersectWorld(Q);if(h=F.data,m=F.intersect,V.drawVRRay(Q,h,m),!h)return;var j=L.getData3dUI(h);if(I=j.interactiveInfo,!I)return;y={data:h,part:m.part,ui:j}}else{if(y=L.getDataInfoAt(Q),!y)return;y&&(y={data:y.data,part:y.part})}if(!m){h=y.data;var j=L.getData3dUI(h);if(y.ui=j,I=j.interactiveInfo,!I)return y;if(m=L.intersectObject(Q,h),!m)return}h.s(E)&&h.s(E)(Q,h,L),this.fire("data",E,Q,h);var n,X=m.part;return"body"!==X&&(n=h.s(X+".image")||h.s("shape3d."+X+".image")),n||(n=h.s("all.image")||h.s("shape3d.image")),I="object"==typeof n?I[n.uuid]:I[n],I&&I.bodyInfo?(y.part="body",y.interactiveInfo=I,y.point=m.uv.multiply({x:I.bodyInfo.rect.width,y:I.bodyInfo.rect.height}),y.image=n,y.hits=this.handleImage("body",n,E,Q,h,y.point,I.bodyInfo),y):y},_handleLeaveOrMissing:function(e,P,b){var N="leave"===e?this.currentInfo:this.downInfo;if(N){var c=N.interactiveInfo||N.ui.interactiveInfo;if(c){var A,L,m=N.data;if(this._is2d){if(L=this.gv.lp(P),"body"===N.part&&c.bodyInfo)A="body","leave"===e?this.handleLeaveImage(b,A,this.gv.getImage(m),P,m,L,c.bodyInfo):this.handleMissingUpImage(A,this.gv.getImage(m),P,m,L,c.bodyInfo);else if("icons"===N.part&&c._38o){var l=c._38o[N.name];l&&l[N.index]&&(A="icons|"+N.name+"|"+N.index,"leave"===e?this.handleLeaveImage(b,A,N.icon,P,m,L,l[N.index]):this.handleMissingUpImage(A,N.icon,P,m,L,l[N.index]))}}else{if(!c.bodyInfo)return;var I=this.gv.intersectObject(P,m);L=I?I.uv.multiply({x:c.bodyInfo.rect.width,y:c.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===e?this.handleLeaveImage(b,"body",N.image,P,m,L,c.bodyInfo):this.handleMissingUpImage("body",N.image,P,m,L,c.bodyInfo)}}}},handleDownInfo:function(V,O){if(this.downInfo){var o=this.downInfo,a=this.gv,C=o.interactiveInfo||o.ui.interactiveInfo;if(C){var k,t=o.data;if(t.s(V)&&t.s(V)(O,t,a),this.fire("data",V,O,t),this._is2d){var H=a.lp(O);if("body"===o.part&&C.bodyInfo)k="body",this.handleDownInfoImage(k,a.getImage(t),V,O,t,H,C.bodyInfo);else if("icons"===o.part&&C._38o){var T=C._38o[o.name];T&&T[o.index]&&(k="icons|"+o.name+"|"+o.index,this.handleDownInfoImage(k,o.icon,V,O,t,H,T[o.index]))}}else{if(!C.bodyInfo)return;var r=a.intersectObject(O,t);if(!r)return;H=r.uv.multiply({x:C.bodyInfo.rect.width,y:C.bodyInfo.rect.height}),this.handleDownInfoImage("body",o.image,V,O,t,H,C.bodyInfo)}}}},fire:function(X,o,t,K,c,y,D,C){this.gv.fi({kind:o,type:X,event:t,data:K,image:c,comp:y,view:this.gv,point:D,width:C?C.width:l,height:C?C.height:l})},handleImage:function(b,D,I,S,H,G,c){var x={};if(D&&(D=ef(D))){var W=this.gv,V=c.rect,d=this.convertPoint(G,c);d.inRect&&(D[I]&&D[I](S,H,W,d,V.width,V.height),this.fire("image",I,S,H,D,l,d,V),x[b+"|image"]={target:D,type:"image",image:D,data:H,event:S,point:d,width:V.width,height:V.height});for(var w=c.compInfos,Q=D,j=w.length-1;j>=0;j--){var K=w[j],T=K.comp;d=this.convertPoint(G,K,Q,T,W,H),d.inRect&&(V=K.rect,T[I]&&T[I](S,H,W,d,V.width,V.height),this.fire("comp",I,S,H,D,T,d,V),(D=V.image)&&(D[I]&&D[I](S,H,W,d,V.width,V.height),this.fire("image",I,S,H,D,l,d,V)),x[b+"|"+j]={target:T,type:"comp",comp:T,image:D,data:H,event:S,point:d,width:V.width,height:V.height},D&&(x[b+"|"+j+"|image"]={target:D,type:"image",image:D,data:H,event:S,point:d,width:V.width,height:V.height}))}}return x},handleLeave:function(y,u){return this._handleLeaveOrMissing("leave",y,u)},handleMissingUp:function(j){return this._handleLeaveOrMissing("missing",j)},handleLeaveImage:function(_,n,Z,A,w,O,N){if(Z&&(Z=ef(Z))){var d=this.gv,E=N.rect,X=this.convertPoint(O,N);_===n+"|image"&&(Z.onLeave&&Z.onLeave(A,w,d,X,E.width,E.height),this.fire("image","onLeave",A,w,Z,l,X,E));
for(var q=N.compInfos,k=Z,$=q.length-1;$>=0;$--){var h=q[$],e=h.comp;X=this.convertPoint(O,h,k,e,d,w),E=h.rect,_===n+"|"+$&&(e.onLeave&&e.onLeave(A,w,d,X,E.width,E.height),this.fire("comp","onLeave",A,w,Z,e,X,E)),(Z=E.image)&&_===n+"|"+$+"|image"&&(Z.onLeave&&Z.onLeave(A,w,d,X,E.width,E.height),this.fire("image","onLeave",A,w,Z,l,X,E))}}},handleMissingUpImage:function(o,w,r,e,W,d){var f="onUp",B=this.downInfo.hits;if(B&&w&&(w=ef(w))){var J=this.gv,H=d.rect,P=this.convertPoint(W,d);!P.inRect&&B[o+"|image"]&&(w[f]&&w[f](r,e,J,P,H.width,H.height),this.fire("image",f,r,e,w,l,P,H));for(var i=d.compInfos,F=w,p=i.length-1;p>=0;p--){var I=i[p],A=I.comp;P=this.convertPoint(W,I,F,A,J,e),P.inRect||(H=I.rect,B[o+"|"+p]&&(A[f]&&A[f](r,e,J,P,H.width,H.height),this.fire("comp",f,r,e,w,A,P,H)),(w=H.image)&&B[o+"|"+p+"|image"]&&(w[f]&&w[f](r,e,J,P,H.width,H.height),this.fire("image",f,r,e,w,l,P,H)))}}},handleDownInfoImage:function(n,G,I,b,Z,N,x){var v=this.downInfo.hits;if(v&&G&&(G=ef(G))){var P=this.gv,a=x.rect,c=this.convertPoint(N,x);v[n+"|image"]&&(G[I]&&G[I](b,Z,P,c,a.width,a.height),this.fire("image",I,b,Z,G,l,c,a));for(var g=x.compInfos,k=G,$=g.length-1;$>=0;$--){var w=g[$],z=w.comp;c=this.convertPoint(N,w,k,z,P,Z),a=w.rect,v[n+"|"+$]&&(z[I]&&z[I](b,Z,P,c,a.width,a.height),this.fire("comp",I,b,Z,G,z,c,a)),(G=a.image)&&v[n+"|"+$+"|image"]&&(G[I]&&G[I](b,Z,P,c,a.width,a.height),this.fire("image",I,b,Z,G,l,c,a))}}},initImageResource:function(){C.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(b,L,Q,i,z,j){var x=L.rect,V=L.matrix.applyInverse(b).sub(x),F=V.x>=0&&V.y>=0&&V.x<=x.width&&V.y<=x.height;if(!F)return V;if(i&&pf(i.pixelPerfect,j,z)){var x,$=1;this._is2d?($=z.getZoom(),x=Ge(b.x,b.y,l,$)):x=Ge(b.x,b.y);var N=!1,H=x.x,n=x.y,d=x.width,r=x.height,O=C.hitMaxArea,U=d*r*$*$;if(U>O){var q=Math.sqrt(O/U);$*=q}d*=$,r*=$,2>d&&(d=2),2>r&&(r=2),H*=$,n*=$;var p=yp(d,r),g=new Er(0,-H,-n,$,$);g.append(L.matrix),z._drawForChecking=!0,i.transform=g;var s=Q.comps;Q.comps=[i],oi(p,Q,0,0,d,r,j,self),Q.comps=s,delete i.transform,z._drawForChecking=!1;try{for(var o=0,R=p.getImageData(0,0,d,r).data;o<R.length;o+=4)if(0!==R[o+3]){N=!0;break}p.restore()}catch(f){wo=h,N=!1}V.inRect=N}else V.inRect=!0;return V}});var nb=ji.DefaultInteractor=function(D){Yn(nb,this,[D])};nm("DefaultInteractor",io,{handle_mousedown:function(A){ll(A);var V=this,O=V.gv,j=O.getDataAt(A);!O.setFocus(A)||O._editing||O._scrolling||(fi(A)?O.handleDoubleClick(A,j):O.handleClick(A,j),!eo()&&j&&(O.isMovable(j)||O.isInteractive(j))||!O.isPannable()||!ci(A)||lk(A)||(V._tx=O.tx(),V._ty=O.ty(),V.startDragging(A)))},handleWindowMouseUp:function(k){var v=this,Y=v.gv;Y._panning&&(delete Y._panning,Y.onPanEnded(),v.fi({kind:"endPan",event:k})),delete v._tx,delete v._ty,v.clearDragging()},handle_mousemove:function(E){var A=this,w=A.gv;A._hoverTimer&&(c(A._hoverTimer),delete A._hoverTimer),A._hoverTimer=P(function(){A.fi({kind:"hover",event:E}),c(A._hoverTimer),delete A._hoverTimer},w.getHoverDelay()||C.hoverDelay)},handle_touchmove:function(j){this.handle_mousemove(j)},handleWindowMouseMove:function(L){var j=this,B=j.gv,o=j._lastClientPoint;j.fi({kind:B._panning?"betweenPan":"beginPan",event:L}),B._panning=1,B.setTranslate(j._tx+L.clientX-o.x,j._ty+L.clientY-o.y)},handle_mousewheel:function(S){this.gv.handleScroll(S,S.wheelDelta)},handle_DOMMouseScroll:function(f){2===f.axis&&this.gv.handleScroll(f,-f.detail)},handle_keydown:function(h){this.gv.handleKeyDown(h)}});var Rh=ji.SelectInteractor=function(w){Yn(Rh,this,[w])};nm("SelectInteractor",io,{_42:function(){var Z=this,f=Z.gv,t=f.getZoom(),s=Z.mark,l=Z.div;l||(l=Z.div=Ki(),Pp(Z.getView(),l));var U={};U.x=s.x*t+f.tx(),U.y=s.y*t+f.ty(),U.width=s.width*t,U.height=s.height*t,rr(l,U),this.intersects()?(l.style.border="",l.style.background=f.getRectSelectBackground()):(l.style.background="",l.style.border="1px solid "+f.getRectSelectBorderColor())},handle_mousedown:function(U){var W=this,c=W.gv;if(W._57I=h,W.pendingClickThrough=h,!(c._editing||c._scrolling||eo())){var S=c.getDataAt(U),P=c.sm();S?lk(U)?P.co(S)?P.rs(S):P.as(S):P.co(S)?S instanceof _e&&S.isClickThroughEnabled()&&ci(U)&&(W.pendingClickThrough=kg(U)):P.ss(S):lk(U)||!c.isPannable()?ci(U)&&(lk(U)||P.cs(),c.isRectSelectable()&&(W.startDragging(U),c._77O=1)):ci(U)&&(W._57I=kg(U))}},handle_mouseup:function(J){var V=this,y=V.gv,L=V._57I;if(L&&(Im(L,kg(J))<=1&&y.sm().cs(),V._57I=h),V.pendingClickThrough){if(Im(V.pendingClickThrough,kg(J))<=1){var X=y.getDataAt(J);if(X instanceof _e&&X.isClickThroughEnabled()){var O=y.getDataAt(J,function(Y){var G=Y.getParent()===X&&y.isSelectable(Y,!0);return G});O&&(J.clickThrough=!0,y.sm().ss(O))}}V.pendingClickThrough=h}},handleWindowMouseUp:function(I){this.clear(I)},handleWindowMouseMove:function(d){var p=this,F=p.gv;p._logicalPoint=F.lp(d),p.mark?(p.fi({kind:"betweenRectSelect",event:d}),F.isPannable()&&p.autoScroll(d),p.redraw()):p.fi({kind:"beginRectSelect",event:d}),p.mark=Vn(p._lastLogicalPoint,p._logicalPoint),p.redraw()},intersects:function(){var V=this,r=V._lastLogicalPoint,Z=V._logicalPoint;return r.x>Z.x||r.y>Z.y},clear:function(z){var q=this,d=q.gv,w=q.mark;if(q._57I=h,q.pendingClickThrough=h,q._lastLogicalPoint){if(w){if(0!==w.width&&0!==w.height){var g=d.getDatasInRect(w,q.intersects());if(!g.isEmpty()){var f=d.sm(),A=f.toSelection();g.each(function(X){f.co(X)?A.remove(X):A.add(X)}),f.ss(A)}}Oe(q.div),delete q.div,delete q.mark,q.redraw(),q.fi({kind:"endRectSelect",event:z}),d.onRectSelectEnded()}q.clearDragging(),delete d._77O}},redraw:function(){var U=this;U._draw||(U._draw=1,P(function(){U.mark&&U._42(),delete U._draw},16))}});var Kf=ji.MoveInteractor=function(D){Yn(Kf,this,[D])};nm("MoveInteractor",io,{handle_mousedown:function(Z){var J=this,H=J.gv;if(ci(Z)&&!H._editing&&!H._scrolling&&!eo()){var F=H.getSelectedDataAt(Z);!F||H.isInteractive(F)&&!H.isMovable(F)?H._focusData=h:(J._data=F,H.handleMouseDown&&H.handleMouseDown(Z,F),J.startDragging(Z),H.isMovable(F)&&(H._moving=1))}},handleWindowMouseUp:function(S){var $=this,J=$.gv;J.handleMouseUp&&J.handleMouseUp(S,$._data),$.clear(S)},handleWindowMouseMove:function(j){var T=this,a=T._data,N=T.gv;if((!N._93O||!N._93O(j,a))&&N._moving){T._logicalPoint||T.fi({kind:"prepareMove",event:j});var b=T._logicalPoint?"betweenMove":"beginMove",e={kind:b,event:j},s=T._logicalPoint=N.lp(j);"beginMove"!==b||T._alreadyBeginTransaction||(T._alreadyBeginTransaction=!0,N.getDataModel().beginTransaction());var X=T._calcShift(b,j),O=X.x,l=X.y,J=T.gv.getMoveMode(j,a);J&&("x"===J?l=0:"y"===J?O=0:"xy"!==J&&(O=l=0)),N.moveSelection(O,l),T._lastLogicalPoint=s,T.autoScroll(j),T.fi(e)}},_calcShift:function(){var O=this,q=O._logicalPoint,r=O._lastLogicalPoint,T=q.x-r.x,n=q.y-r.y;return{x:T,y:n}},clear:function(l){var O=this,g=O.gv;O._lastLogicalPoint&&(O._lastLogicalPoint=O._data=g._moving=h,O._logicalPoint&&(O.fi({kind:"endMove",event:l}),g.onMoveEnded()),O.clearDragging()),O._alreadyBeginTransaction&&(O._alreadyBeginTransaction=!1,g.getDataModel().endTransaction())}});var dk=ji.ScrollBarInteractor=function(b){Yn(dk,this,[b])};nm("ScrollBarInteractor",io,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(Z){var r=this.gv.getViewRect();return this._41o()&&(r.x+r.width-this.gv.lp(Z).x)*this.gv.getZoom()<Ro},isH:function(S){var m=this.gv.getViewRect();return this._40o()&&(m.y+m.height-this.gv.lp(S).y)*this.gv.getZoom()<Ro},handle_mousemove:function(M){this.handle_touchmove(M)},handle_touchmove:function(E){if(!Wf&&ci(E)&&this.gv.isScrollBarVisible()){var j=this,K=j.isV(E),F=j.isH(E);(K||F)&&j.gv.showScrollBar(),j.gv._scrolling=K||F}},handleWindowMouseUp:function(T){this.handleWindowTouchEnd(T)},handleWindowTouchEnd:function(G){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=h,this.fi({kind:"endScroll",event:G})},handle_mousedown:function(k){this.handle_touchstart(k)},handle_touchstart:function(E){var y=this;if(y.gv.setFocus(E),ll(E),y.handle_touchmove(E),!(Gd(E)>1)&&y.gv._scrolling&&y.gv.isScrollBarVisible()){y._cp=kg(E),y._tx=y.gv.tx(),y._ty=y.gv.ty();var c=y.isV(E);y._state=c?"vScroll":"hScroll",_f(y,E),y.fi({kind:"beginScroll",event:E})}},handleWindowMouseMove:function(p){this.handleWindowTouchMove(p)},handleWindowTouchMove:function(F){var t=kg(F),j=this.gv.getViewRect(),z=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-t.y)*z.height/j.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-t.x)*z.width/j.width),this.fi({kind:"betweenScroll",event:F})}});var vj=ji.TouchInteractor=function(D,K){K=K||{},K.selectable===l&&(K.selectable=!0),K.movable===l&&(K.movable=!0),K.pannable===l&&(K.pannable=!0),K.pinchable===l&&(K.pinchable=!0),K.editable===l&&(K.editable=!0),this.params=K,Yn(vj,this,[D])};nm("TouchInteractor",io,{ms_edit:1,setUp:function(){var O=this;vj.superClass.setUp.call(O),Sl&&O.params.editable&&O.gv.setEditInteractor(O)},tearDown:function(){var T=this;vj.superClass.tearDown.call(T),Sl&&T.params.editable&&T.gv.setEditInteractor(h)},clear:function(c){var R=this,g=R.gv;g._moving&&(R.fi({kind:"endMove",event:c}),delete g._moving,g.onMoveEnded(),g.dm().endTransaction()),g._panning&&(R.fi({kind:"endPan",event:c}),delete g._panning,g.onPanEnded()),g._pinching&&(R.fi({kind:"endPinch",event:c}),delete g._pinching,g.onPinchEnded()),g._editing&&(R._46O(c),R._77I=R._node=R._edge=R._shape=R._rect=R._89I=R._index=g._editing=h),R._moving=R._panning=R._pinching=R._editing=R._57I=R._data=R._beginHistory=h,R.clearDragging()},handle_touchstart:function(m){var C=this;if(!C.gv._editing){ll(m),C._57I=h;var K=C.params,g=C.gv,n=g.sm(),T=g.getDataAt(m),Q=Gd(m);if(1===Q){if(fi(m))return g.handleDoubleClick(m,T),void 0;g.handleClick(m,T),T&&(g.handleMouseDown&&g.handleMouseDown(m,T),C._data=T),K.selectable||(T=h),T?(n.co(T)||n.ss(T),K.editable&&g.isEditable(T)&&C._79I(m,T,!0)?(C._editing=1,C.startDragging(m)):K.movable&&g.isMovable(T)&&(C._moving=1,C.startDragging(m))):(C._57I=kg(m),K.pannable&&g.isPannable()&&(C._panning=1,C.startDragging(m),C._translate={x:g.tx(),y:g.ty()}))}else if(K.pinchable&&2===Q){C._pinching=1,C.startDragging(m);var o=g.getView(),Y=g.getZoom(),l=o.getBoundingClientRect(),H=m.touches[0],Z=m.touches[1],N={x:(H.clientX+Z.clientX)/2-l.left,y:(H.clientY+Z.clientY)/2-l.top};N.x-=g.tx(),N.y-=g.ty(),N.x/=Y,N.y/=Y,C._p=N,C._d=nl(m)}}},handle_touchend:function(H){var s=this,K=s.gv,r=s._57I,D=s._data;r&&(Im(r,kg(H))<=1&&K.sm().cs(),s._57I=h),D&&K.handleMouseUp&&K.handleMouseUp(H,D)},handleWindowTouchEnd:function(z){this.clear(z)},handleWindowTouchMove:function(v){var c=this,J=c.gv,F=Gd(v);if(1===F){if(c._editing&&(c._beginHistory||(c._beginHistory=1,J.dm().beginTransaction()),J._editing=1,c._78I(v)),c._moving)c._beginHistory||(c._beginHistory=1,J.dm().beginTransaction()),c.handleMove(v);else if(c._panning){var z=kg(v);J.setTranslate(c._translate.x+z.x-c._lastClientPoint.x,c._translate.y+z.y-c._lastClientPoint.y),c.fi({kind:J._panning?"betweenPan":"beginPan",event:v}),J._panning=1}}else if(2===F&&c._pinching){var K=nl(v);J.handlePinch(c._p,K,c._d),c._d=K,c.fi({kind:J._pinching?"betweenPinch":"beginPinch",event:v}),J._pinching=1}},handleMove:function(G){var A=this,Z=A.gv,z=Z.lp(G);Z._93O&&Z._93O(G,A._data)||(Z.moveSelection(z.x-A._lastLogicalPoint.x,z.y-A._lastLogicalPoint.y),A._lastLogicalPoint=z,A.autoScroll(G),A.fi({kind:Z._moving?"betweenMove":"beginMove",event:G}),Z._moving=1)}});var u=G.ht,Bf=u.graph._editor={Math:u.Math,Guide:{}};Bf.getStyle=function(B){var w,X=Bf.StyleMap;return X&&(w=X[B],w!==l)?w:Bf.DefaultStyleMap[B]},Bf.setStyle=function(T,J){var W=Bf.StyleMap;W||(W=Bf.StyleMap={}),W[T]=J},Bf.inEdit=function(O){return O._inXEdit===!0},Bf.startEdit=function(D){D._inXEdit=!0,Bf.Inject.doInject(D)},Bf._46O=function(X){X._inXEdit=!1,Bf.Inject.undoInject(X)},Bf.toScreenPosition=function(y,b){var z=y.tx(),h=y.ty(),H=y._zoom;return new Bf.Math.Vector2(b.x*H+z,b.y*H+h)},Bf.checkHit=function(Z,z,q){return Z.distanceTo(z)<q?!0:!1},Bf.toWorldPosition=function(F,f){var k=F.tx(),t=F.ty(),m=F._zoom;return{x:(f.x-k)/m,y:(f.y-t)/m}},Bf.setAntialias=function(P,z){for(var G,g=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],E=0,o=g.length;o>E&&(G=g[E],!(G in P));E++);P[G],P[G]=z},Bf.getTargetCornersOnScreen=function(X,e){if(!e)return null;var o,A=[];if(rd(e,X)){var z=He(X,e);o=[{x:z.x,y:z.y},{x:z.x+z.width,y:z.y},{x:z.x+z.width,y:z.y+z.height},{x:z.x,y:z.y+z.height}]}else{if(!e.getCorners)return null;o=e.getCorners()}return o.forEach(function(h){var n=Bf.toScreenPosition(X,h);A.push(n.x,n.y)}),A},Bf.log=function(){};var Kq=Bf.Inject={_modules:[]};Kq.registAsModule=function(S,o){var i={},Q={};for(var D in S){var P=o.prototype[D];i[D]=P}S.getBackup=function(Y){return i[Y]},S.getBackups=function(){return i},Q.doInject=function(){for(var s in S)"getBackup"!==s&&(o.prototype[s]=S[s])},Q.undoInject=function(){for(var x in S)"getBackup"!==x&&(o.prototype[x]=i[x])},Kq._modules.push(Q)},Kq.doInject=function(b){for(var O,k=Kq._modules,Z=0,H=k.length;H>Z;Z++)O=k[Z],O.doInject(b)},Kq.undoInject=function(C){for(var I,R=Kq._modules,P=0,j=R.length;j>P;P++)I=R[P],I.undoInject(C)};var io=u.graph.EditInteractor=function(d){var $=this,p=w.createElement("canvas");p.className="editCanvas",p.style.position="absolute",$._styleMap={},$._canvas=p,$._context=p.getContext("2d"),io.superClass.constructor.call($,d),Bf.setAntialias($._context,!1),$._subModules=[new Bf.Anchor($),new Bf.RotateX($),new Bf.Rect($),new Bf.Curve($),new Bf.MoveHelper($)],$._gridGuide=new Bf.Guide.Grid($),$._rectGuide=new Bf.Guide.Rect($)},pb=io;u.Default.def(io,u.graph.Interactor,{ms_edit:1,ms_fire:1}),f.defineProperties(io.prototype,{editDetail:{get:function(){var d=!!this._editDetail;return d},set:function(K){var c=this,g=c._editDetail;g!==K&&(c._editDetail=K,c.gv._editing=K,c.fp("editDetail",g,K),c.fp("pointsEditingMode",g,K),c.fi({kind:K?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(R){(!this._editDetail||R)&&(this.gv._editing=R,R||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(O){this._editing=O,this.gvEditing=O}},pointsEditingMode:{get:function(){return this.editDetail},set:function(q){var M=this;M.editDetail!==q&&(q?M._tryEnterEditDetailMode():M._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var A=this._gridEnabled;if(!A)return!1;var m=this.gv;return m?!0:!0},set:function(P){P!==this._gridEnabled&&(this._gridEnabled=P,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(o){o!==this._agEnabled&&(this._agEnabled=o,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),io.prototype.getSubModule=function(p){var w,U,H,J=this._subModules;for(U=0,H=J.length;H>U;U++)if(w=J[U],w.catalog===p)return w},io.prototype.invokeSubModule=function(B,X){var k=this,w=k._subModules;if(w)for(var O,M,V,G=Array.prototype.slice.call(arguments,2),j=0,U=w.length;U>j;j++)if(O=w[j],M=O[B],M&&(V=M.apply(O,G),V!=l&&X))return O},io.prototype.invokeSubModuleInverse=function($,T){var k=this,U=k._subModules;if(U)for(var L,E,n,A=Array.prototype.slice.call(arguments,2),K=U.length-1;K>=0;K--)if(L=U[K],E=L[$],E&&(n=E.apply(L,A),n!=l&&T))return L},io.prototype.setUp=function(){Bf.log("setUp");var A=this,r=A.gv,D=r.getView(),j=A._canvas;io.superClass.setUp.call(A),r.setEditInteractor(A),r._79O?D.insertBefore(j,r._79O):D.appendChild(j),Bf.startEdit(r),A.invokeSubModule("setUp"),r.dm().mm(A._onDataModelChanged,A),r.dm().md(A._onDataPropertyChanged,A)},io.prototype.tearDown=function(){Bf.log("tearDown");var n=this,v=n.gv,r=v.getView();n._resetCustomCursorStyle(),io.superClass.tearDown.call(n),v.dm().umm(n._onDataModelChanged,n),v.dm().umd(n._onDataPropertyChanged,n),v.setEditInteractor(null),r.removeChild(n._canvas),n._drawTimer&&(c(n._drawTimer),n._drawTimer=null),Bf._46O(v),n.invokeSubModule("tearDown")},io.prototype._onDataModelChanged=function(E){var D=this;("clear"===E.kind||"remove"===E.kind&&D.editDetail&&E.data===D.getSubModule("Curve").target)&&(D.editDetail=!1,D._42())},io.prototype._onDataPropertyChanged=function(o){var T=this;if(T.editDetail){var Q=T.getSubModule("Curve"),P=o.data;P===Q.target&&(P._writing||Q._handleDataChanged(o))}},io.prototype.clear=function(){Bf.log("clear")},io.prototype.redraw=function(){this._42()},io.prototype._42=function(){var h=this;h._drawTimer||(h._drawTimer=P(function(){h._drawTimer=null,h.drawImpl()},0))},io.prototype.drawImpl=function(){var l;for(l in{_42:!0})break;return function(){var T=this,h=T._canvas,i=T.gv,V=i.getWidth(),K=i.getHeight(),D=T._context,g=u.Default.getInternal();(h.width!==V||h.height!==K)&&g.setCanvas(h,V,K),D.clearRect(0,0,h.width,h.height);var J=T._getValidSelection();D.save();var O=u.Default.devicePixelRatio;D.scale(O,O),T._gridGuide._42(),T.invokeSubModuleInverse(l,!1,D,i,J),T._rectGuide._42(),D.restore()}}(),io.prototype._getValidSelection=function(){var Q=this,l=Q.gv,k=l.sm().getSelection(),m=[];return k.each(function(h){l.isVisible(h)&&l.isEditable(h)&&m.push(h)}),m},io.prototype.handle_touchmove=function(x){return this.handle_mousemove(x)},io.prototype.handle_mousemove=function(k){if(!u.Default.isDragging()){var N=this;(N.editDetail||!eo())&&(N.gvEditing=!1,N._checkEdit(k)&&(N.gvEditing=!0))}},io.prototype.handle_touchstart=function(r){return this.handle_mousedown(r)},io.prototype.handle_mousedown=function(O){ll(O);var l=this;if(l.editDetail||!eo()){if(fi(O)&&!O.clickThrough){if(l.editDetail){if(l._tryQuitEditDetailMode(O))return}else if(l._tryEnterEditDetailMode())return;l.gv.dm().beginTransaction();var n=l.invokeSubModule("handleDoubleClick",!0,O);if(l.gv.dm().endTransaction(),n)return}var A=l._checkEdit(O);A&&(l._downPosition=l._getLogicalPoint(O),l.gv.dm().beginTransaction(),A.startEdit(l,O),l.editing=!0)}},io.prototype._checkEdit=function(Q){var v=this,K=v.gv,z=v._getLogicalPoint(Q),N=v.invokeSubModule("check",!0,K,Q,z)||null;return v._editMod=N,N},io.prototype.handleWindowTouchMove=function(I){return this.handleWindowMouseMove(I)},io.prototype.handleWindowMouseMove=function(W){var m=this,H=m._downPosition;if(H){var E=m._getLogicalPoint(W);if(E.distanceTo(H)<m.getStyle("moveSensitivity"))return;delete m._downPosition}var P=m._editMod;P&&P.handleEdit(m.gv,W)},io.prototype._getLogicalPoint=function(d){var G=this,B=u.Default.getLogicalPoint(d,G._canvas);return new Bf.Math.Vector2(B)},io.prototype.handleWindowTouchEnd=function(n){return this.handleWindowMouseUp(n)},io.prototype.handleWindowMouseUp=function(){var p;for(p in{_46O:!0})break;return function(m){var d=this;d.editing=!1,d.setCursor("default"),d.invokeSubModule(p,!1,m),d._42(),d.gv.dm().endTransaction()}}(),io.prototype.handle_mousewheel=function(q){var U=this;ll(q),U.invokeSubModule("preHandleScroll",!0)||U.gv.handleScroll(q,q.wheelDelta)},io.prototype.handleDelete=function(){var u=this;if(!u.editDetail){u.gv.dm().beginTransaction();var e=u.invokeSubModule("handleNormalStateDelete",!0);return u.gv.dm().endTransaction(),e||u.gv.removeSelection(),void 0}u.gv.dm().beginTransaction(),u.invokeSubModule("handleDelete",!0),u.gv.dm().endTransaction(),u._42()},io.prototype.handle_keydown=function(J){var A=this;if((J.metaKey||J.ctrlKey)&&A._42(),eo(J)&&!A.editing)return A.gvEditing=!1,A.setCursor("default"),A._42(),void 0;var s=dl(J);return A.editDetail?((s||Di(J))&&(A.editDetail=!1,A._42()),A.gv.dm().beginTransaction(),A.invokeSubModule("handle_keydown",!0,J),A.gv.dm().endTransaction(),void 0):(A.gv.dm().beginTransaction(),A.invokeSubModule("handleNormalStateKeyDown",!0,J),A.gv.dm().endTransaction(),s&&A._tryEnterEditDetailMode(),void 0)},io.prototype.handle_keyup=function(W){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,W),this.gv.dm().endTransaction()},io.prototype._tryEnterEditDetailMode=function(){var q=this;return!q.editDetail&&q.invokeSubModule("canEnterEditDetailMode",!0)&&1===q._getValidSelection().length?(q.editDetail=!0,q._42(),!0):void 0},io.prototype._tryQuitEditDetailMode=function(j){var A=this;return A.editDetail?!j||A.invokeSubModule("canQuitEditDetailMode",!0,j)?(A.editDetail=!1,A._42(),!0):!1:!1},io.prototype.setStyle=function(J,S,P){var V=this;P?Bf.setStyle(J,S):V._styleMap[J]=S,V.fp("styleChanged",null,{key:J,value:S,base:P}),V._42()},io.prototype.getStyle=function(M){var o=this,n=o._styleMap[M];return n!==l?n:Bf.getStyle(M)},io.prototype.setCursor=function(N){this._resetCustomCursorStyle(),u.graph.EditInteractor.superClass.setCursor.call(this,N)},io.prototype._resetCustomCursorStyle=function(){var F=this;if(F._customStyle){var z=this.gv.getView();z.classList&&z.classList.remove&&z.classList.remove(F._customStyle),F._customStyle=null}},io.prototype._setRotateCursor=function(G){var s=this,f=s._cursorFactory;f||(f=s._cursorFactory=new Bf.CursorFactory(s));var g=f.getRotateCursor(G),J=s.gv.getView();s._resetCustomCursorStyle(),s._customStyle=g,J.classList&&J.classList.add&&J.classList.add(g)};var Zg=Bf.Group=function(R){var S=this;S._entities=R,S._64O=0,S._position={x:0,y:0},S._scale={x:1,y:1},S._anchor={x:.5,y:.5},S._anchor2={x:.5,y:.5}};Zg.prototype={},Zg.prototype.constructor=Zg;var Qm=null;Zg.findOrCreateGroup=function(h){if(Qm&&Qm.checkIsMe(h))return Qm;var m=new Bf.Group(h);return m.getKeyOb()?(Qm=m,m):void 0},Zg.prototype.checkIsMe=function(J){var d=this._entities;if(d.length!==J.length)return!1;var u,b={},Y=J.length;for(u=0;Y>u;u++)b[J[u]._id]=!0;for(u=0;Y>u;u++)if(!b[d[u]._id])return!1;return!0},Zg.prototype.getRotation=function(){return this._64O},Zg.prototype.getPosition=function(){return this._position},Zg.prototype.getAnchor=function(){return this._anchor},Zg.prototype.getWidth=function(){return this._width},Zg.prototype.getScale=function(){return this._scale},Zg.prototype.getSize=function(){return{width:this._width,height:this._height}},Zg.prototype.getHeight=function(){return this._height},Zg.prototype.getKeyOb=function(){for(var A=this._entities,F=A.length-1;F>=0;F--){var I=A[F];if(this.isNode(I))return I}},Zg.prototype.getAnchor2=function(){var C=this,W=C.rotateCenter;if(W)return W;var f=C.getKeyOb();if(!f)return C._anchor;var i=C._anchor2,w=f.getMatrix();return w.tf({x:f.getWidth()*(i.x-f.getAnchor().x),y:f.getHeight()*(i.y-f.getAnchor().y)})},Zg.prototype.setAnchor2=function(e,k){var q=this,O=q.getKeyOb();if(O){var u,y=O.getMatrix();u="number"==typeof e?{x:e,y:k}:e;var I=y.tfi(u);q._anchor2={x:O.getAnchor().x+I.x/O.getWidth(),y:O.getAnchor().y+I.y/O.getHeight()}}},Zg.prototype.setRotation=function(){},Zg.prototype.beginRotate=function(e){this.rotateCenter=e.pos,this.rotateMode=e.groupRotateMode},Zg.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Zg.prototype.addRotation=function(m,H){return"batch"===H?this._addRotationInBatchMode(m):"block"===H?this._addRotationInBlockMode(m):void 0},Zg.prototype._addRotationInBlockMode=function(A){var t=this,n=t.rotateCenter||t.getPosition();t._entities.forEach(function(S){if(t.isNode(S)){var C=S.getMatrix();C.translate(-n.x,-n.y),C.rotate(A),C.translate(n.x,n.y);var r=Math.sign(S.getScale().x);S.setRotation(i(C.b*r,C.a*r)),S.setPosition(C.tx,C.ty)}})},Zg.prototype._addRotationInBatchMode=function(o){var k=this,Q=k._anchor2;k._entities.forEach(function(m){if(k.isNode(m)){var K=m.getAnchor(),E=m.getMatrix(),I=E.tf({x:m.getWidth()*(Q.x-K.x),y:m.getHeight()*(Q.y-K.y)}),c=new Bf.Math.Matrix2d;c.set(E.a,E.b,E.c,E.d,E.tx,E.ty),c.translate(-I.x,-I.y),c.rotate(o),c.translate(I.x,I.y);var q=Math.sign(m.getScale().x);m.setRotation(i(c.b*q,c.a*q)),m.setPosition(c.tx,c.ty)}})},Zg.prototype.setPosition=function(o){var q,j,i,D,z=this,t=z._position,y=o.x-t.x,U=o.y-t.y,r=z._entities;for(j=0,i=r.length;i>j;j++)q=r[j],bh(q)&&(D=q.getPosition(),q.setPosition(D.x+y,D.y+U));z._position=o},Zg.prototype.setScale=function(q,k){var Q=this,m=q/Q._scale.x,Z=k/Q._scale.y;Q._adjustChildScaleOrSize(m,Z,"size"),Q._scale={x:q,y:k}},Zg.prototype.getRect=function(){var W=this,$=W._position,D=W._width,M=W._height;return{x:$.x-D/2,y:$.y-M/2,width:D,height:M}},Zg.prototype.setSize=function(r,M){var k=this,r=Math.max(1,r),M=Math.max(1,M),Q=r/k._width,B=M/k._height;k._adjustChildScaleOrSize(Q,B,"size"),k._width=r,k._height=M},Zg.prototype._adjustChildScaleOrSize=function(W,H,$){var _,g,b,v,O,t,X,I,a,J,c,u,C,m,A=this,R=A._position,V=A._entities,q=new Bf.Math.Matrix2d;for(g=0,b=V.length;b>g;g++)if(_=V[g],A.isNode(_)){if(v=_.getPosition(),O=_.getRotation(),t=_.getWidth(),X=_.getHeight(),I=_.getScale(),c=I.x*t,u=I.y*X,q.identity().scale(c,u).rotate(O).translate(v.x,v.y).translate(-R.x,-R.y).rotate(-A._64O),O=i(q.b*Math.sign(c),q.a*Math.sign(c)),q.scale(W,H),a=Math.cos(O),J=Math.sin(O),Math.abs(a)<.001?(C=q.b/J,m=-q.c/J):(C=q.a/a,m=q.d/a),"scale"===$)_.setScale(C/t,m/X);else if("size"===$){var j=C/I.x,e=m/I.y;_.setScale(Dn(C)*Math.abs(I.x),Dn(m)*Math.abs(I.y)),_.setSize(Math.max(.1,Math.abs(j)),Math.max(.1,Math.abs(e)))}q.rotate(A._64O).translate(R.x,R.y),_.setPosition(q.tx,q.ty)}},Zg.prototype.getMatrix=function(){var W=this,g=W._position,l=u.Default.getInternal(),M=W._scale;return new l.Mat(W._64O,g.x,g.y,M.x,M.y)},Zg.prototype.toGlobal=function(c){return this.getMatrix().tf(c)},Zg.prototype.getCorners=function(){var i=this,J=i._width,f=i._height,g=i._anchor,M=-J*g.x,E=-f*g.y,v=i.getMatrix();return[v.tf(M,E),v.tf(M,E+f),v.tf(M+J,E+f),v.tf(M+J,E)]},Zg.prototype.calcInfo=function(){var Z,t,w,l,V,y,L=this,$=[],m=L._entities,A=L._64O;for(l=0,V=m.length;V>l;l++)y=m[l],L.isNode(y)&&y.getCorners&&$.push.apply($,y.getCorners());if($.length){var k=Math.cos(-A),x=Math.sin(-A),W=1/0,e=-1/0,o=1/0,U=-1/0;for(l=0,V=$.length;V>l;l++)w=$[l],Z=w.x,t=w.y,w.x=k*Z-x*t,w.y=x*Z+k*t,W=Math.min(W,w.x),e=Math.max(e,w.x),o=Math.min(o,w.y),U=Math.max(U,w.y);L._width=(e-W)/L._scale.x,L._height=(U-o)/L._scale.y,k=Math.cos(A),x=Math.sin(A);var v=L._anchor;Z=W+(e-W)*v.x,t=o+(U-o)*v.y,L._position={x:k*Z-x*t,y:x*Z+k*t}}},Zg.prototype.isNode=function(n){return bh(n)?rd(n)?!1:!0:!1},Zg.prototype._42=function(R,p,i){var G,y,V,o,D,X,v,a,x=this,j=x._entities,H=x.rotateMode;for("batch"===H&&(a=x.getKeyOb()),G=0,y=j.length;y>G;G++)V=j[G],x.isNode(V)&&(X=V.getRect(),o=Bf.toScreenPosition(i,{x:X.x,y:X.y}),D=Bf.toScreenPosition(i,{x:X.x+X.width,y:X.y+X.height}),v={min:o,max:D},V===a&&(v.isKeyOb=!0),Bf.Icons.DrawIcon(R,p,Bf.Icons.GroupSubEntityRect,v))};var Fc=Bf.CurveActiving=function(g,r){this._curve=g,this._interactor=g._interactor;for(var b in r)this[b]=r[b]};Fc.prototype={},Fc.prototype.constructor=Fc,f.defineProperties(Fc.prototype,{point:{get:function(){return this._point},set:function(c){var f=this;f._point=c,f.editingCtrl||f._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(d){var R=this;R._pairs=d,R.editingCtrl&&R._firePointChange()}}}),Fc.prototype._firePointChange=function(){var z=this,Q=z.getCurrentEditingPoint();if(!Q)return t.fi({kind:"selectPoint"}),void 0;var t=z._interactor,f=this._curve.target;if(f){var r=Bf.getDataMatrix(f).invert(),N=Q.e;Q=r.apply(Bf.toWorldPosition(t.gv,Q)),Q.e=N;var v=z._lastFirePoint;v&&Math.abs(Q.x-v.x)<1e-5&&Math.abs(Q.y-v.y)<1e-5&&(Q.e==l&&v.e==l||Math.abs(Q.e-v.e)<1e-5)||(z._lastFirePoint=Q,t.fi({kind:"selectPoint",x:Q.x,y:Q.y,e:Q.e}))}},Fc.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Fc.prototype.getCurrentEditingPoint=function(){var m=this,h=m.editingCtrl;if(h){var e=m.pairs;if(e){var S=e[h.pairId],c=S[h.type];if(c)return c}}return m._point};var df=Bf.CursorFactory=function(A){var b=this;b._interactor=A,b._rotateCursorStyles={}};df.prototype={},df.prototype.constructor=df,df.prototype.getRotateCursor=function(A){var c=this;0>A&&(A+=2*Math.PI);var J=c._interactor,q=J.getStyle("rotateCursorSize"),V=J.getStyle("rotateCursorRound"),k=Math.round(180*(A/Math.PI)/V);k*V>=360&&(k=0);var U=c._rotateCursorStyles,u="htCustomRotateStyle_"+q+"_"+V+"_"+k;return U[u]||(c._produceRotateCursor(u,q,V,k),U[u]=!0),u},df.prototype._produceRotateCursor=function(V,N,o,G){var m=this;m._interactor;var p=m._canvas;p||(p=m._canvas=w.createElement("canvas")),p.width=p.height=N*devicePixelRatio,p.style.width=p.style.height=N+" px";var e=p.getContext("2d");Bf.setAntialias(e,!1),e.scale(devicePixelRatio,devicePixelRatio);var l,g,B,Q,H,v=Math.round(N/2),z=""+v+" "+v+",auto !important;";l=Math.PI/180*G*o,e.clearRect(0,0,N,N),e.save(),e.scale(N/32,N/32),e.translate(16,16),e.rotate(l+Math.PI/2),e.beginPath(),e.moveTo(-8,0),e.lineTo(-8,3),e.lineTo(-5,3),e.moveTo(8,0),e.lineTo(8,3),e.lineTo(5,3),e.moveTo(-8,3),e.quadraticCurveTo(0,-6,8,3),e.restore(),e.strokeStyle="white",e.lineWidth=4,e.stroke(),e.strokeStyle="black",e.lineWidth=2,e.stroke(),g=JSON.stringify(p.toDataURL()),Q="cursor:url("+g+")"+z,1!==devicePixelRatio&&(B='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+N+'px" height="'+N+'px"><image xlink:href='+g+' width="'+N+'" height="'+N+'"/></svg>',Q+="cursor:url(data:image/svg+xml;base64,"+btoa(B)+")"+z,Q+="cursor:-webkit-image-set(url("+g+")"+devicePixelRatio+"x,url("+g+")1x)"+z),H=w.createElement("style"),H.textContent="body."+V+" *, ."+V+"{"+Q+"}",w.head.appendChild(H)};var Dr=Bf.Guide.Grid=function($){var k=this;k._interactor=$,k._alignmentGuideId=0,k._xAlignmentGuide=[],k._yAlignmentGuide=[]};Dr.prototype={},Dr.prototype.constructor=Dr,f.defineProperties(Dr.prototype,{gridBlockSize:{get:function(){var d=this;return d._gridBlockSize||d._interactor.getStyle("gridBlockSize")},set:function(q){this._gridBlockSize=q,this._interactor._42()}},gridThickLinesEvery:{get:function(){var Q=this;return Q._gridThickLinesEvery||Q._interactor.getStyle("gridThickLinesEvery")},set:function(J){this._gridThickLinesEvery=J,this._interactor._42()}},gridEnabled:{get:function(){var Z=this,e=Z._interactor;return e.gridEnabled&&Z.isValidGrid()}}}),Dr.prototype._42=function(){var D=this,p=D._interactor;D.gridEnabled&&D.drawGrid(),p.alignmentGuideEnabled&&D.drawAlignmentGuide()},Dr.prototype.makeMatrix=function(){var a=this,s=a._interactor.getStyle("gridAngle"),p=a._interactor.getStyle("gridRotation"),G=new Bf.Math.Matrix2d,R=Math.sin(s),Q=Math.cos(s);return G.set(1,0,Q,R,0,0),G.rotate(p),G},Dr.prototype.isValidGrid=function(){var W=this,D=Math.PI,C=W._interactor,q=C.gv;if(q._zoom<C.getStyle("gridZoomThreshold"))return!1;var M=C.getStyle("gridAngle"),N=Math.abs(180*(M%D/D)),H=1-1e-8;return H>N||N>180-H?!1:!0},Dr.prototype.drawAlignmentGuide=function(){var R=this,y=R._interactor,B=y.gv,n=y._canvas,D=y._context,E=n.width,O=n.height,u=B.tx(),P=B.ty(),Q=B._zoom;D.beginPath(),D.strokeStyle=y.getStyle("gridAlignmentGuideColor"),D.lineWidth=1,R._xAlignmentGuide.forEach(function(p){var m=p.p*Q+u;D.moveTo(m,0),D.lineTo(m,O)}),R._yAlignmentGuide.forEach(function(v){var z=v.p*Q+P;D.moveTo(0,z),D.lineTo(E,z)}),D.stroke()},Dr.prototype.drawGrid=function(){function V(k,N,R,l){var X=Bf.toScreenPosition(Y,z.apply({x:k,y:N})),S=Bf.toScreenPosition(Y,z.apply({x:R,y:l}));v.moveTo(X.x,X.y),v.lineTo(S.x,S.y)}var q=this,$=q._interactor,D=q.gridBlockSize,o=q.gridThickLinesEvery,S=$.getStyle("gridThickColor"),W=$.getStyle("gridLightColor"),Y=$.gv,g=$._canvas,v=$._context,U=g.width,Q=g.height,z=q.makeMatrix(),N=z.applyInverse(Bf.toWorldPosition(Y,{x:0,y:0})),R=z.applyInverse(Bf.toWorldPosition(Y,{x:U,y:0})),h=z.applyInverse(Bf.toWorldPosition(Y,{x:0,y:Q})),y=z.applyInverse(Bf.toWorldPosition(Y,{x:U,y:Q})),L=Math.min(N.x,R.x,h.x,y.x),O=Math.max(N.x,R.x,h.x,y.x),T=Math.min(N.y,R.y,h.y,y.y),t=Math.max(N.y,R.y,h.y,y.y);U=O-L,Q=t-T;var P=Math.ceil(L/D),J=Math.floor(O/D),C=Math.ceil(T/D),c=Math.floor(t/D);
Y.tx(),Y.ty(),Y._zoom;var F,k,H;for(v.save(),v.lineWidth=1,v.beginPath(),v.strokeStyle=S,H=Math.ceil(P/o)*o;J>=H;H+=o)F=H*D,V(F,T,F,t);for(H=Math.ceil(C/o)*o;c>=H;H+=o)k=H*D,V(L,k,O,k);for(v.stroke(),v.beginPath(),v.strokeStyle=W,H=P;J>=H;H++)0!==H%o&&(F=H*D,V(F,T,F,t));for(H=C;c>=H;H++)0!==H%o&&(k=H*D,V(L,k,O,k));v.stroke(),v.restore()},Dr.prototype.getAlignmentGuides=function(){var $=this;return{x:$._xAlignmentGuide,y:$._yAlignmentGuide}},Dr.prototype.addAlignmentGuide=function(h,N,w){var P=this,Z="x"===h?P._xAlignmentGuide:P._yAlignmentGuide,w=w?w:++P._alignmentGuideId,H={p:N,id:w};if(Z.length){var y=P._findClosestAlignmentGuide(H.p,Z);y.dis<0?Z.splice(y.index+1,0,H):Z.splice(y.index,0,H)}else Z.push(H);return P._interactor._42(),w},Dr.prototype.findClosest=function(t,W,p){var I=this,g=I._interactor,w=g.gv;p&&(t=Bf.toWorldPosition(w,t));var J,h,Y,S=1/0,Z=1/0,y=t.x,P=t.y;if(I.gridEnabled){var f=I.gridBlockSize,n=I.makeMatrix(),R=n.applyInverse(t);R=n.apply({x:Math.round(R.x/f)*f,y:Math.round(R.y/f)*f}),S=R.x-y,Z=R.y-P,Y=!0}if(g.alignmentGuideEnabled&&(J=I._findClosestAlignmentGuide(y,I._xAlignmentGuide).dis,h=I._findClosestAlignmentGuide(P,I._yAlignmentGuide).dis,Math.abs(J)<Math.abs(S)&&(S=J,Y=!0),Math.abs(h)<Math.abs(Z)&&(Z=h,Y=!0)),Y){Y=!1;var a=w._zoom,s=g.getStyle("smartGuideSensitivity")/a,B={};if(Math.abs(S)<s&&"y"!==W&&(B.x=p?S*a:S,Y=!0),Math.abs(Z)<s&&"x"!==W&&(B.y=p?Z*a:Z,Y=!0),Y)return B}},Dr.prototype._findClosestAlignmentGuide=function(O,D){if(!D.length)return{dis:1/0};for(var g,n=0,$=D.length-1;$-n>1;)g=Math.floor((n+$)/2),D[g].p<O?n=g:$=g;var I=D[n].p-O,y=D[$].p-O;return Math.abs(I)<=Math.abs(y)?{line:D[n],dis:I,index:n}:{line:D[$],dis:y,index:$}},Dr.prototype.removeAllAlignmentGuide=function(d){var e=this;"y"!==d&&(e._xAlignmentGuide=[]),"x"!==d&&(e._yAlignmentGuide=[]),e._interactor._42()},Dr.prototype.removeAlignmentGuide=function(A){for(var l,Q,H,$=this,P=$._xAlignmentGuide,d=0;2>d;d++)for(P=0===d?$._xAlignmentGuide:$._yAlignmentGuide,l=0,Q=P.length;Q>l;l++)if(H=P[l],H.id===A)return P.splice(l,1),$._interactor._42(),{axis:0===d?"x":"y",position:H.p};return!1},Dr.prototype.adjustAlignmentGuide=function(g,T){var H=this,t=H.removeAlignmentGuide(g);return t?(H.addAlignmentGuide(t.axis,T,g),!0):!1};var ym=Bf.Guide.Rect=function(F){var m=this;m._interactor=F};ym.prototype={},ym.prototype.constructor=ym,ym.prototype.gatherRects=function(){var s,F,I,_,x=this,q=x._interactor.gv,A=[],T=[],g={x:A,y:T},j={},v=q.getDataModel(),h=v.a("width"),t=v.a("height");h&&t&&(s=0,F=0,I=h,_=t,A.push({node:v,type:0,p:s},{node:v,type:1,p:s+I/2},{node:v,type:2,p:s+I}),T.push({node:v,type:0,p:F},{node:v,type:1,p:F+_/2},{node:v,type:2,p:F+_}),j[v._id||0]={x:s,y:F,width:I,height:_}),v.each(function(X){if(bh(X)&&!q.isSelected(X)&&q.isVisible(X)){var W=!1;if(q.sm().getSelection().each(function(d){W||(X.isHostOn(d)?W=!0:X.isDescendantOf(d)&&(W=!0))}),!W){var x=X.getRect();s=x.x,F=x.y,I=x.width,_=x.height,A.push({node:X,type:0,p:s},{node:X,type:1,p:s+I/2},{node:X,type:2,p:s+I}),T.push({node:X,type:0,p:F},{node:X,type:1,p:F+_/2},{node:X,type:2,p:F+_}),j[X._id]=x}}}),A.sort(function(K,j){return K.p-j.p}),T.sort(function(B,Y){return B.p-Y.p}),x._grid=g,x._87I=j},ym.prototype.gatherLines=function(Q,s,o){var E,G,Z,_,N,z,n,D,u,y,C,v,k=this,K=[k.findClosest({x:Q.x,y:Q.y},s),k.findClosest({x:Q.x+Q.w/2,y:Q.y+Q.h/2},s),k.findClosest({x:Q.x+Q.w,y:Q.y+Q.h},s)],p={},U=k._87I;o=o||255;var A,m;for(k._guideLine=[],E=0;2>E;E++)for(p={},0===E?(_="y",D=Q.x,u=D+Q.w):(_="x",D=Q.y,u=D+Q.h),G=0;3>G;G++)N=K[G],N&&isFinite(N[_])&&(A=1<<3*E+G,o&A&&(z=N[_+"Line"],n=z.node,m=n._id||0,p[m]||(p[m]=!0,v=U[m],"y"===_?(y=v.x,C=v.x+v.width):(y=v.y,C=v.y+v.height),Z=z.p,k._guideLine.push({type:_,a:D,b:u,c:y,d:C,p:Z,center:1===z.type}))))},ym.prototype._binarySearchClosest=function(b,u){if(!u.length)return{dis:1/0};for(var L,t=0,G=u.length-1;G-t>1;)L=Math.floor((t+G)/2),u[L].p<b?t=L:G=L;var $=u[t].p-b,M=u[G].p-b;return Math.abs($)<=Math.abs(M)?{line:u[t],dis:$}:{line:u[G],dis:M}},ym.prototype.findClosest=function(e,U,D){var w=this,R=w._interactor,t=R.gv,f=w._grid;D&&(e=Bf.toWorldPosition(t,e));var i,G=w._binarySearchClosest(e.x,f.x),u=w._binarySearchClosest(e.y,f.y),$=G.dis,Y=u.dis,H=t._zoom,C=R.getStyle("smartGuideSensitivity")/H,O={};return Math.abs($)<C&&"y"!==U&&(O.x=D?$*H:$,O.xLine=G.line,i=!0),Math.abs(Y)<C&&"x"!==U&&(O.y=D?Y*H:Y,O.yLine=u.line,i=!0),i?O:void 0},ym.prototype._42=function(){var N=this,f=N._guideLine;if(f&&!u.Default.isCtrlDown()){var I,L,a,X,y,C,l,r,F,p,M,D,Q,V,Z,Y,i,j=N._interactor,P=j.gv,o=j._context,A=P.tx(),T=P.ty(),q=P._zoom,J=j.getStyle("guideLineTextSpacing");for(I=0,L=f.length;L>I;I++)a=f[I],r=a.type,F=a.p,p=a.a,M=a.b,D=a.c,Q=a.d,V=Math.min(p,D),Z=Math.max(M,Q),"x"===r?(X=F*q+A,y=V*q+T,C=X,l=Z*q+T):(X=V*q+A,y=F*q+T,C=Z*q+A,l=y),Bf.Icons.DrawIcon(j,o,Bf.Icons.MoveLineGuide,{rect:[X,y,C,l],center:a.center}),Q>=p&&M>=D||(V=p>Q?Q:M,Z=p>Q?p:D,i=Z-V,"x"===r?(a.center2center||(X-=J,C=X),y=V*q+T,l=Z*q+T,Y=Bf.Icons.MoveLineGuideDistanceV):"y"===r&&(a.center2center||(y-=J,l=y),X=V*q+A,C=Z*q+A,Y=Bf.Icons.MoveLineGuideDistanceH),Bf.Icons.DrawIcon(j,o,Y,{x0:X,y0:y,x1:C,y1:l,dis:i}))}},ym.prototype.clear=function(){this._guideLine=null},Bf.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var ij=Bf.Icons={},rq=1e4,nk=null,ik="rgb(51,153,255)",rh="rgb(183,232,135)",Ur="rgb(255,204,153)",_l=6;u.Default.setImage("Icons.RectPoint",{width:_l,height:_l,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:ik,rect:[0,0,_l,_l]}]});var Ui="#e000e0";ij.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var j=ij.GroupSubEntityRect.data;if(!j)return[];var x=j.min,g=j.max;return[x.x,x.y,x.x,g.y,g.x,g.y,g.x,x.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return ij.GroupSubEntityRect.data.isKeyOb?Ui:"#666666"}}}]},ij.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[ij.Line.data.P1.x,ij.Line.data.P1.y],_l,_l]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[ij.Line.data.P2.x,ij.Line.data.P2.y],_l,_l]}}}]},ij.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return ij.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},ij.Rect={comps:[{type:"shape",points:{func:function(){var N=ij.Rect.data;if(!N)return[];var I=N.LT,C=N.LB,j=N.RB,x=N.RT;return[I.x,I.y,C.x,C.y,j.x,j.y,x.x,x.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:ik},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ij.Rect.data.rotation}},rect:{func:function(){return[[ij.Rect.data.LT.x,ij.Rect.data.LT.y],_l,_l]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ij.Rect.data.rotation}},rect:{func:function(){return[[ij.Rect.data.LB.x,ij.Rect.data.LB.y],_l,_l]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ij.Rect.data.rotation}},rect:{func:function(){return[[ij.Rect.data.RB.x,ij.Rect.data.RB.y],_l,_l]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ij.Rect.data.rotation}},rect:{func:function(){return[[ij.Rect.data.RT.x,ij.Rect.data.RT.y],_l,_l]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ij.Rect.data.rotation}},visible:{func:function(){return ij.Rect.data.L?!0:!1}},rect:{func:function(){return[[ij.Rect.data.L.x,ij.Rect.data.L.y],_l,_l]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ij.Rect.data.rotation}},visible:{func:function(){return ij.Rect.data.R?!0:!1}},rect:{func:function(){return[[ij.Rect.data.R.x,ij.Rect.data.R.y],_l,_l]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ij.Rect.data.rotation}},visible:{func:function(){return ij.Rect.data.T?!0:!1}},rect:{func:function(){return[[ij.Rect.data.T.x,ij.Rect.data.T.y],_l,_l]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return ij.Rect.data.rotation}},visible:{func:function(){return ij.Rect.data.B?!0:!1}},rect:{func:function(){return[[ij.Rect.data.B.x,ij.Rect.data.B.y],_l,_l]}}}]};var Df=16;u.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:ik,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:ik,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),ij.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[ij.Anchor.data.POS.x,ij.Anchor.data.POS.y],Df,Df]}}}]},ij.TipShiftX=12,ij.TipShiftY=12;var dp=[8,28];ij.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[ij.TipHelper.data.helperPos.x,ij.TipHelper.data.helperPos.y,dp[0]*ij.TipHelper.data.size,dp[1]]}},background:{func:function(){return nk.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return ij.TipHelper.data.text}},rect:{func:function(){return[ij.TipHelper.data.helperPos.x,ij.TipHelper.data.helperPos.y,dp[0]*ij.TipHelper.data.size,dp[1]]}},color:{func:function(){return nk.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var mk=7;ij.ShapePoint={comps:[{type:"circle",rect:{func:function(){var N=ij.ShapePoint.data.point;return[N,mk,mk]}},background:{func:function(){var o=ij.ShapePoint.data.isEnd;return o?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:ik}]},ij.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return ij.ShapeBgCurve.data.P}},segments:{func:function(){return ij.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:ik}]};var tp=8;ij.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var C=ij.ShapeHighlighPoint.data;return[[C.x,C.y],tp,tp]}},background:{func:function(){return nk.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var $g=10;ij.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var N=ij.ShapeHighlighRealPoint.data;return[[N.x,N.y],$g,$g]}},background:"#ffffff",borderWidth:2,borderColor:ik}]};var Dp=8;ij.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var O=ij.ShapeHighlighCtrlPoint.data,K=O.x,j=O.y,F=Dp/2;return[K-F,j-F,K-F,j+F,K+F,j+F,K+F,j-F]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return nk.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return nk.getStyle("shapeCtrlPointBorderColor")||ik}}}]};var jj=3;ij.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return ij.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:jj,borderColor:{func:function(){return nk.getStyle("curveHighlightColor")}}}]},ij.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return ij.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},ij.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return ij.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return ij.MoveLineGuide.data.center?rh:Ur}}}]};var Kg=5;ij.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var _=ij.MoveLineGuideDistanceH.data,c=_.x0,Y=_.y0;return[c,Y-Kg,c,Y+Kg]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ur},{type:"shape",points:{func:function(){var u=ij.MoveLineGuideDistanceH.data,N=u.x1,F=u.y1;return[N,F-Kg,N,F+Kg]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ur},{type:"text",text:{func:function(){return Math.round(ij.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var k=ij.MoveLineGuideDistanceH.data;return[[(k.x0+k.x1)/2,k.y0-10],20,20]}},color:Ur,font:"12px Arial",align:"center"}]},ij.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var L=ij.MoveLineGuideDistanceV.data,f=L.x0,U=L.y0;return[f-Kg,U,f+Kg,U]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ur},{type:"shape",points:{func:function(){var d=ij.MoveLineGuideDistanceV.data,J=d.x1,m=d.y1;return[J-Kg,m,J+Kg,m]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Ur},{type:"text",text:{func:function(){return Math.round(ij.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var N=ij.MoveLineGuideDistanceV.data;return[[N.x0-10,(N.y0+N.y1)/2],20,20]}},color:Ur,font:"12px Arial",align:"center"}]},u.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),ij.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var N=ij.EdgeElevationGuide.data,x=N.x,y=N.y,Q=nk.getStyle("curveElevationIntersectSize"),X=nk.getStyle("curveElevationGuideShift");return x+=X[0],y+=X[1],[x-Q,y-Q,2*Q,2*Q]}}}]},u.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),u.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),ij.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return ij.ConnectGuide.data.rotation}},rect:{func:function(){var G=ij.ConnectGuide.data.connect;G.x,G.y;var w=nk.getStyle("connectGuideIntersectSize");return[[G.x,G.y],2*w,2*w]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var l=ij.ConnectGuide.data.cursorPos||ij.ConnectGuide.data.connect,x=nk.getStyle("connectGuideIntersectSize");return[[l.x,l.y],2*x-2,2*x-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var C=ij.ConnectGuide.data.connect,_=ij.ConnectGuide.data.cursorPos||C;return[C.x,C.y,C.x+.5*(_.x-C.x),C.y,_.x+.5*(C.x-_.x),_.y,_.x,_.y]}}}]},u.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),u.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),ij.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var x=ij.ConnectGuideGarbage.data.hover;return x?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var w=ij.ConnectGuideGarbage.data,x=nk.getStyle("connectGuideGarbageIntersectsize");return w.hover&&(x+=5),[[w.x,w.y],2*x,2*x]}}}]};var ys=6;ij.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return ij.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var k=ij.ShapeActivingCtrl.data;return[k.point.x,k.point.y,k.c1.x,k.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:ik},{type:"shape",visible:{func:function(){return ij.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var C=ij.ShapeActivingCtrl.data;return[C.point.x,C.point.y,C.c2.x,C.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:ik},{type:"shape",visible:{func:function(){return ij.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var E=ij.ShapeActivingCtrl.data.c1,s=E.x,G=E.y,o=ys/2;return"c1"===ij.ShapeActivingCtrl.data.hl&&(o+=.5),[s-o,G-o,s-o,G+o,s+o,G+o,s+o,G-o]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return nk.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===ij.ShapeActivingCtrl.data.hl?nk.getStyle("shapeCtrlPointHighlightBorder")||ik:nk.getStyle("shapeCtrlPointBorderColor")||ik}}},{type:"shape",visible:{func:function(){return ij.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var g=ij.ShapeActivingCtrl.data.c2,B=g.x,u=g.y,f=ys/2;return"c2"===ij.ShapeActivingCtrl.data.hl&&(f+=.5),[B-f,u-f,B-f,u+f,B+f,u+f,B+f,u-f]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return nk.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===ij.ShapeActivingCtrl.data.hl?nk.getStyle("shapeCtrlPointHighlightBorder")||ik:nk.getStyle("shapeCtrlPointBorderColor")||ik}}}]},ij.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:ik,rect:{func:function(){return[[ij.RoundPoint.data.x,ij.RoundPoint.data.y],_l,_l]}}}]},ij.AttachPoint={comps:[{type:"rect",background:{func:function(){return ij.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:ik,rect:{func:function(){var T=ij.AttachPoint.data.isAttach?_l+4:_l;return[[ij.AttachPoint.data.x,ij.AttachPoint.data.y],T,T]}}}]},Bf.Icons.DrawIcon=function(p,Q,x,h){x.width=x.height=rq,x.data=h,nk=p,u.Default.drawImage(Q,x,0,0,rq,rq)},Bf.Icons.MapPoints=function(m,g){for(var S=0,J=m.length;J>S;S++)m[S]/=g},Bf.roundTo=function(p,F,e){var P=Math.abs(p%F);return e>P||e>F-P?F*Math.round(p/F):p},Bf.toFixed=function(H){return Math.round(100*H)/100},Bf.getDataMatrix=function(h){if(h instanceof u.Shape){var w=new u.Math.Matrix2d,C=h.getPosition();return w.translate(-C.x,-C.y).scale(h.getScale().x,h.getScale().y).rotate(h.getRotation()).translate(C.x,C.y),w}return h.getMatrix?h.getMatrix():new u.Math.Matrix2d};var kj=Bf.Math.Curve=function(){this._curves=[]};kj.prototype={},kj.prototype.constructor=kj,kj.prototype.createFromHtShape=function($,t,s){t instanceof u.List&&(t=t.toArray());var B,e,v,i,Z,A,D,F=this,k=null,d=null,J=0,E=Bf.Math.Vector2,L=Bf.Math.CubicBezier,a=function(B){return new E($[B],$[B+1],s?s[B/2]:l)};for(e=0,v=t.length;v>e;e++){switch(i=t[e],Z=null,i){case 1:d=a(J),k=d,J+=2;break;case 2:B=a(J),J+=2,Z=new L(d,d.clone(),B.clone(),B),d=B;break;case 3:A=a(J),B=a(J+2),J+=4,Z=new L(d,A.clone().sub(d).multiplyScalar(2/3).add(d),A.clone().sub(B).multiplyScalar(2/3).add(B),B),d=B;break;case 4:A=a(J),D=a(J+2),B=a(J+4),J+=6,Z=new L(d,A,D,B),d=B;break;case 5:if(!k)break;Z=new L(d,d.clone(),k.clone(),k),d=null,k=null}Z&&(Z._index=F._curves.length,F._curves.push(Z))}},kj.prototype.checkPoint=function($,m){var e,H,l,A,u,r=this,y=r._curves;for(e=0,H=y.length;H>e;e++)if(A=y[e],u=A.intersectRect($,m,m),u.length)return l=0,u.forEach(function(X){l+=X.t}),l/=u.length,$=A.getPointAt(l),$.t=l,{bezier:A,intersection:$}},kj.prototype.insertKnot=function(I,h){var f=I.insertKnot(h),W=this,L=W._curves;L.splice(I._index,1,f[0],f[1])},kj.prototype._isCloseEnough=function(D,N){return Math.abs(D.x-N.x)<1e-6&&Math.abs(D.y-N.y)<1e-6},kj.prototype._isSamePoint=function(y,r){return y===r},kj.prototype.moveRealPoint=function(h,J){var u=this,G=u._curves,B=J.clone().sub(h);G.forEach(function(g){var I=g._p1;g._p2,g._p3;var E=g._p4;u._isSamePoint(I,h)&&(g._p2.add(B),g._p1=J),u._isSamePoint(E,h)&&(g._p3.add(B),g._p4=J)})},kj.prototype.moveCtrlDueToRealPointMovement=function(X,b){var D=this,V=D._curves,z=function(p){p.add(b),p.e&&b.e&&(p.e+=b.e)};V.forEach(function(h){var _=h._p1;h._p2,h._p3;var Q=h._p4;D._isSamePoint(_,X)&&z(h._p2),D._isSamePoint(Q,X)&&z(h._p3)})},kj.prototype.moveCtrlPoint=function(s,v,N){var D=s[N];if(D){D.e!==l&&(v.e=D.e);var R=this,n=R._curves;v.clone().sub(D),n.forEach(function(i){var Y;"c2"===N?Y="_p2":"c1"===N&&(Y="_p3"),R._isSamePoint(i[Y],D)&&(i[Y]=v)}),s[N]=v}},kj.prototype.deleteRealPoint=function(S,w){var h,R,l,C,Z,U,q,G=this,I=G._curves,T={},E=[],e=Bf.Math.CubicBezier;for(R=0,l=I.length;l>R;R++)h=I[R],C=h._p1,Z=h._p2,U=h._p3,q=h._p4,(T[R]||!G._isSamePoint(C,S))&&(G._isSamePoint(q,S)?l>R+1&&G._isSamePoint(I[R+1]._p1,S)&&(w||E.push(new e(C,Z,I[R+1]._p3,I[R+1]._p4))):E.push(h));G._curves=E},kj.prototype.findPairs=function(N,y){var L,c,l,k,s,p,$,j,w=this,D=w._curves,Y={},K=[];for(c=0,l=D.length;l>c;c++)L=D[c],k=L._p1,s=L._p2,p=L._p3,$=L._p4,!Y[c]&&w._isSamePoint(k,N)&&(y?K.push({point:k,r2:$}):K.push({point:k,c2:s})),w._isSamePoint($,N)&&(j=y?{point:$,r1:k}:{point:$,c1:p},l>c+1&&w._isSamePoint(D[c+1]._p1,N)&&(y?j.r2=D[c+1]._p4:j.c2=D[c+1]._p2,Y[c+1]=!0),K.push(j));return K},kj.prototype.toHtShape=function(){var d=this,N=d._curves,S=[],c=[],q={x:1/0,y:1/0};return N.forEach(function(D){var k=D._p1,K=D._p2,t=D._p3,s=D._p4;return d._isCloseEnough(k,q)||(S.push(1),c.push(k.clone())),q=s,d._isCloseEnough(k,K)&&d._isCloseEnough(t,s)?(S.push(2),c.push(s.clone()),void 0):(S.push(4),c.push(K.clone(),t.clone(),s.clone()),void 0)}),{segments:S,points:c}};var Hb=Bf.Math.CubicBezier=function(A,$,R,x){var a=this;a._id=Bf.Math.CubicBezier._globalId++,a._p1=A,a._p2=$,a._p3=R,a._p4=x};Hb._globalId=1,Hb.prototype={},Hb.prototype.constructor=Hb,Hb.prototype.toString=function(){return this._id},Hb.prototype.intersectRect=function(W,h,j){var U=h/2,E=j/2,u=W.x,n=W.y,g=Bf.Math.Vector2,I=new g(-U+u,-E+n),Q=new g(U+u,E+n),e=new g(Q.x,I.y),k=new g(I.x,Q.y),d=this,x=d.intersectLine(I,e),s=d.intersectLine(e,Q),X=d.intersectLine(Q,k),q=d.intersectLine(k,I),w=x.concat(s).concat(X).concat(q);return w},Hb.prototype.intersectLine=function(L,Y){var E,y,U,m,b,S,A,B,a,t,s,j,i,X=this,z=L.clone().min(Y),J=L.clone().max(Y);m=X._p1,b=X._p2,S=X._p3,A=X._p4,E=m.clone().multiplyScalar(-1),y=b.clone().multiplyScalar(3),U=S.clone().multiplyScalar(-3),s=E.add(y).add(U).add(A),E=m.clone().multiplyScalar(3),y=b.clone().multiplyScalar(-6),U=S.clone().multiplyScalar(3),t=E.add(y).add(U),E=m.clone().multiplyScalar(-3),y=b.clone().multiplyScalar(3),a=E.add(y),B=m.clone(),i=new Bf.Math.Vector2(L.y-Y.y,Y.x-L.x),j=L.x*Y.y-Y.x*L.y;for(var Q=X.getRoots(i.dot(s),i.dot(t),i.dot(a),i.dot(B)+j),o=new Array,K=0,M=Q.length;M>K;K++){var V=Q[K];if(!(0>V||V>1)){var h=m.clone().lerp(b,V),d=b.clone().lerp(S,V),_=S.clone().lerp(A,V),f=h.lerp(d,V),D=d.lerp(_,V),n=f.lerp(D,V);n.t=V,L.x==Y.x?z.y<=n.y&&n.y<=J.y&&o.push(n):L.y==Y.y?z.x<=n.x&&n.x<=J.x&&o.push(n):n.x>=z.x&&n.y>=z.y&&n.x<=J.x&&n.y<=J.y&&o.push(n)}}return o},Hb.prototype.solveTForPoint=function(S){var o,L,U,D,q=this;o=q._p1.x-S.x,L=q._p2.x-S.x,U=q._p3.x-S.x,D=q._p4.x-S.x;for(var a=q.getRoots(D-3*U+3*L-o,3*U-6*L+3*o,3*L-3*o,o),O=l,T=1/0,p=0,X=a.length;X>p;p++){var u=a[p];if(!(0>u||u>1)){var _=q._p1.clone().lerp(q._p2,u),d=q._p2.clone().lerp(q._p3,u),C=q._p3.clone().lerp(q._p4,u),z=_.lerp(d,u),t=d.lerp(C,u),H=z.lerp(t,u);H.t=u;var c=Math.abs(H.y-S.y);T>c&&(T=c,O=H)}}return O},Hb.prototype.getPointAt=function(s){var g=this,Z=g._p1,p=g._p2,Q=g._p3,h=g._p4,l=Z.clone().lerp(p,s),b=p.clone().lerp(Q,s),$=Q.clone().lerp(h,s),D=l.lerp(b,s),k=b.lerp($,s);return D.lerp(k,s)},Hb.prototype.getRoots=function(j,M,w,F){var y,Y,L,$,c,s=new Array;if(Math.abs(j)<1e-6){var y=M,Y=w/y,L=F/y,$=Y*Y-4*L;if($>0){var c=Math.sqrt($);s.push(.5*(-Y+c)),s.push(.5*(-Y-c))}else 0==$&&s.push(.5*-Y)}M/=j,w/=j,F/=j,y=(3*w-M*M)/3,Y=(2*M*M*M-9*w*M+27*F)/27;var P=M/3,A=Y*Y/4+y*y*y/27,V=Y/2;if(Math.abs(A)<=1e-6&&(A=0),A>0){var B,E,c=Math.sqrt(A);B=-V+c,E=B>=0?Math.pow(B,1/3):-Math.pow(-B,1/3),B=-V-c,B>=0?E+=Math.pow(B,1/3):E-=Math.pow(-B,1/3),s.push(E-P)}else if(0>A){var b=Math.sqrt(-y/3),e=Math.atan2(Math.sqrt(-A),-V)/3,J=Math.cos(e),k=Math.sin(e),N=Math.sqrt(3);s.push(2*b*J-P),s.push(-b*(J+N*k)-P),s.push(-b*(J-N*k)-P)}else{var B;B=V>=0?-Math.pow(V,1/3):Math.pow(-V,1/3),s.push(2*B-P),s.push(-B-P)}return s},Hb.prototype._70I=function(){var Y=this;return Y._p1.distanceToSquared(Y._p2)<1e-10&&Y._p3.distanceToSquared(Y._p4)<1e-10},Hb.prototype.insertKnot=function(p){var K=this,V=K._p1,y=K._p2,z=K._p3,v=K._p4,o=V.clone().lerp(y,p),f=y.clone().lerp(z,p),F=z.clone().lerp(v,p),P=o.clone().lerp(f,p),T=f.clone().lerp(F,p),X=P.clone().lerp(T,p);return K._70I()?(V.clone().lerp(v,p),[new Bf.Math.CubicBezier(V,V.clone(),X.clone(),X),new Bf.Math.CubicBezier(X,X.clone(),v.clone(),v)]):[new Bf.Math.CubicBezier(V,o,P,X),new Bf.Math.CubicBezier(X,T,F,v)]};var Sd=u.Default.getInternal().ui().EdgeUI,pk={_47O:function(x){var f=this,w=pk.getBackups()._47O;Bf.inEdit(f.gv)||w.call(f,x)}};Bf.Inject.registAsModule(pk,Sd);var Dm=u.Default.getInternal().ui().NodeUI,Yo={_47O:function(x){var C=this,P=Yo.getBackups()._47O;Bf.inEdit(C.gv)||P.call(C,x)},getSelectWidth:function(){var T=this,S=T.gv,$=T._data;if(S.isEditable($)&&Bf.inEdit(S))return 0;var n=Yo.getBackup("getSelectWidth");return n.call(T)}};Bf.Inject.registAsModule(Yo,Dm);var ur=u.graph.GraphView,ip={_editPointSize:function(){var E=u.Default.isTouchable,y=Bf.getStyle("pointSize");return y[E?0:1]}(),isPointEditable:function(b){var l=this;if(Bf.inEdit(l))return l._pointEditableFunc?l._pointEditableFunc(b):!0;var h=ip.getBackup("isPointEditable");h.call(l,b)},isEditable:function(K){var H,B=this,s=ip.getBackup("isEditable");if(H=K instanceof Bf.Group?!0:s.call(B,K),!Bf.inEdit(B))return H;if(!(K instanceof u.Edge))return H;if(!K.s("2d.editable"))return!1;var c=B.getEditableFunc();return c?c(K):!0},_42:function(E,b){var x=this,z=ip.getBackups()._42;if(z.call(x,E,b),Bf.inEdit(x)){var K=x.getEditInteractor();K.drawImpl()}}};Bf.Inject.registAsModule(ip,ur);var no=u.Default.getInternal().ui().ShapeUI,On={_47O:function(x){var R=this,O=On.getBackups()._47O;Bf.inEdit(R.gv)||O.call(R,x)}};Bf.Inject.registAsModule(On,no);var nb=u.graph.DefaultInteractor,jl={handle_mousewheel:function(m){var O=this,B=jl.getBackup("handle_mousewheel");Bf.inEdit(O.gv)||B.call(O,m)}};Bf.Inject.registAsModule(jl,nb);var Kf=u.graph.MoveInteractor,Sj={_calcShift:function(b,w){var A=this,y=Sj.getBackup("_calcShift"),H=A.gv;if(!Bf.inEdit(H))return y.call(A,b,w);var V=H.getEditInteractor(),l=V.getSubModule("Move").calcShift(b,w,A);return l||y.call(A,b,w)},clear:function(Q){var Z=this,h=Sj.getBackup("clear");h.call(Z,Q);var L=Z.gv;if(Bf.inEdit(L)){var G=L.getEditInteractor();G.getSubModule("Move").clear(Q)}}};Bf.Inject.registAsModule(Sj,Kf);var ym=Bf.Rect=function(J){this.catalog="Rect",this._interactor=J};ym.prototype={},ym.prototype.constructor=ym,ym.prototype.gatherInfo=function(w,b){var G=this;if(1===b.length){var Y=b[0];return Y instanceof u.Shape&&Y._70I()?G.gatherLine(w,Y):rd(Y,w)?!1:G.gatherSingleTarget(w,Y)}return b.length>1?G.gatherMultiTargets(w,b):!1},ym.prototype.gatherSingleTarget=function(H,M){if(M.getCorners){var o,U=this,i=U.info;U.target=M,o=U.screenInfo={};var y=M.getCorners();i.LT=new Bf.Math.Vector2(y[0]),i.LB=new Bf.Math.Vector2(y[1]),i.RB=new Bf.Math.Vector2(y[2]),i.RT=new Bf.Math.Vector2(y[3]),i.T=i.LT.clone().add(i.RT).divideScalar(2),i.B=i.LB.clone().add(i.RB).divideScalar(2),i.L=i.LT.clone().add(i.LB).divideScalar(2),i.R=i.RT.clone().add(i.RB).divideScalar(2);for(var c in i)o[c]=Bf.toScreenPosition(H,i[c]);var R=U._interactor,S=R.getStyle("checkSize"),P=function(n,T,w){var X=T.clone().sub(n).setLength(-S),A=w.clone().sub(n).setLength(-S),Z=X.add(A).add(n);return Z};return o.rotLT=P(o.LT,o.RT,o.LB),o.rotLB=P(o.LB,o.LT,o.RB),o.rotRB=P(o.RB,o.LB,o.RT),o.rotRT=P(o.RT,o.LT,o.RB),o.rotT=o.rotLT.clone().add(o.rotRT).divideScalar(2),o.rotB=o.rotLB.clone().add(o.rotRB).divideScalar(2),o.rotL=o.rotLT.clone().add(o.rotLB).divideScalar(2),o.rotR=o.rotRT.clone().add(o.rotRB).divideScalar(2),o.rotation=M.getRotation(),U.gatherConnectInfo(),!0}},ym.prototype.gatherConnectInfo=function(){var e=this,E=e.target,I=e._interactor,j=e.screenInfo,$=I.gv;if($.isConnectActionVisible(E)&&I.getStyle("connectGuideVisible")){var U;E.s&&(U=E.s("connectGuideShift")),U||(U=I.getStyle("connectGuideShift"));var Y=E.getAnchor(),V=E.getSize(),x=E.toGlobal({x:V.width*(U[0]-Y.x),y:V.height*(U[1]-Y.y)});x=Bf.toScreenPosition($,x),j.P1?x.add(j.P2.clone().sub(j.P1).setLength(U[2])):(x.add(j.RT.clone().sub(j.LT).setLength(U[2])),x.add(j.LB.clone().sub(j.LT).setLength(U[3]))),j.connect=x}},ym.prototype.gatherMultiTargets=function(T,r){var L=Bf.Group.findOrCreateGroup(r);if(!L)return!1;var _=this;return _.editing&&"rotate"!==_.editing.mode||L.calcInfo(),_.gatherSingleTarget(T,L)},ym.prototype.gatherLine=function(R,A){this.target=A;var b=this.screenInfo={},g=A.getPoints(),Q=Bf.getDataMatrix(A);return b.P1=Bf.toScreenPosition(R,Q.apply(g.get(0))),b.P2=Bf.toScreenPosition(R,Q.apply(g.get(1))),this.gatherConnectInfo(),!0},ym.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],ym.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],ym.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],ym.prototype.check=function(o,f,P){if(u.Default.isLeftButton(f)){var C=this;if(C.editing=null,C.tipInfo=null,C.screenInfo){var J=C.target,t=o.isEditable(J),K=C.screenInfo;if(t&&K.connect){var i=C._checkConnect(P);if(i)return i}if(K.P1)return C._checkLine(P);var b,z,U,y=null,S=C._interactor,Q=S.getStyle("checkSize");if(t&&o.isRectEditable(J))for(z=0;z<Bf.Rect.ResizeKeys.length;z++)if(U=Bf.Rect.ResizeKeys[z],Bf.checkHit(P,K[U],Q)){y=U,b="resize";break}if(!y&&t&&o.isRotationEditable(J)&&!S.getStyle("rotateAsClock")){var D=S.getStyle("rotateCheckSize");for(z=0;z<Bf.Rect.RotateKeys.length;z++)if(U=Bf.Rect.RotateKeys[z],Bf.checkHit(P,K[U],D)){y=U,b="rotate";
break}}if(!y)return S.setCursor("default"),void 0;if("rotate"===b){var v,q=o.lp(f);if(J instanceof Bf.Group){var x=S.getStyle("groupRotateModeKey");"string"==typeof x&&(x=[x]);for(var E=!1,A=0,I=x.length;I>A;A++)if(f[x[A]]){E=!0;break}var s=S.getStyle("groupRotateModeDefault");v=E?"batch"===s?"block":"batch":s}var Y="batch"===v?J.getAnchor2():J.getPosition(),e=Math.atan2(q.y-Y.y,q.x-Y.x);S._setRotateCursor(e),C.editing={mode:b,key:y,pos:Y,flipY:J.getScale().y<0,rotation:J.getRotation(),hitRot:e},v&&(C.editing.groupRotateMode=v)}else{var G=Bf.Rect.ResizeKeys.indexOf(y),W=Bf.Rect.ResizeDirection[G],l=Math.cos(J.getRotation()),M=Math.sin(J.getRotation()),j=W.x*Math.sign(J.getScale().x),T=W.y*Math.sign(J.getScale().y),r=Math.atan2(-M*j-l*T,l*j-M*T),Z=(Math.round(r/(Math.PI/4))+8)%8,g=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][Z];this._interactor.setCursor(g);var N=J.getWidth(),n=J.getHeight(),L=J.getAnchor();C.editing={mode:b,key:y,rect:{x:-N*L.x,y:-n*L.y,width:N,height:n},anchor:L,matrix:J.getMatrix()}}return y}}},ym.prototype._checkLine=function(v){var y=this;y.screenInfo;var f,n=y._interactor.getStyle("checkSize");if(Bf.checkHit(v,y.screenInfo.P1,n))f="P1";else{if(!Bf.checkHit(v,y.screenInfo.P2,n))return this._interactor.setCursor("default"),void 0;f="P2"}return y.editing={mode:"line",key:f},f},ym.prototype._checkConnect=function(W){var r=this,A=r.screenInfo,y=r._interactor,v=y.getStyle("connectGuideIntersectSize"),o=A.connect,p=W.x,K=o.x;if(K>p&&v>K-p&&Math.abs(o.y-W.y)<v||p>=K&&Bf.checkHit(W,o,v)){var N="connect",t=C.getConnectAction(y.gv);if(r.editing={mode:N},t&&t.delete)if(r.target instanceof Bf.Group){var J=!0;y.gv.sm().getSelection().each(function(Q){t.delete.visible.call(null,y.gv,Q)||(J=!1)}),r.editing.hasDeleteAction=J}else t.delete.visible.call(null,y.gv,r.target)&&(r.editing.hasDeleteAction=!0);return y.setCursor("default"),N}},ym.prototype._fireEditEvent=function(q,p){var C=this._interactor,F=this.editing;if(F){var G=F.mode;G="rotate"===G?"Rotation":"connect"===G?"Connection":G[0].toUpperCase()+G.slice(1),C.fi({kind:q+"Edit"+G,event:p})}},ym.prototype.startEdit=function(E,c){E.startDragging(c);var S=this;S._interactor.fi({kind:"prepareEdit",event:c});var u=S.editing,v=S.target;if(u){if(S._fireEditEvent("begin",c),"rotate"===u.mode)return u.groupRotateMode&&v.beginRotate(u),void 0;if("connect"!==u.mode)("line"===u.mode||v&&0===v.getRotation())&&(S._inSmartGuide=!0,S._interactor.rectGuide.gatherRects());else if(u.hasDeleteAction){var $=E.gv,H=S._interactor.getStyle("connectGuideGarbageShift");u.garbageInfo={x:$.getWidth()*H[0]+H[2],y:$.getHeight()*H[1]+H[3],size:S._interactor.getStyle("connectGuideGarbageIntersectsize")},E._42()}}},ym.prototype._46O=function(k){var B,e,b=this,c=b.editing,Y=b.target;if(c){if("connect"===c.mode&&!c.canceled&&!c.deleted)try{c.garbageInfo&&c.garbageInfo.hover?C.doDeleteConnectionAction(b._interactor.gv,Y):C.doConnectAction(b._interactor.gv,Y,c.target)}catch(h){console.error(h)}e=c.freezeFlag,B=b.editing.groupRotateMode,b._fireEditEvent("end",k),b.editing=null}b.tipInfo=null,b._inSmartGuide&&(b._interactor.rectGuide.clear(),b._inSmartGuide=!1),B&&Y&&Y.endRotate(),Y instanceof u.Block&&(e===l?delete Y._freezeSyncFromChildren:Y._freezeSyncFromChildren=e,Y.updateFromChildren())},ym.prototype.handleNormalStateDelete=function(){var X=this,g=X.editing;if(g&&"connect"===g.mode&&!g.canceled&&!g.deleted){if(g.garbageInfo){try{C.doDeleteConnectionAction(X._interactor.gv,X.target)}catch(T){console.error(T)}g.garbageInfo=null}return g.cursorPos=null,g.targetCorners=null,g.deleted=!0,X._interactor._42(),!0}},ym.prototype.handleNormalStateKeyDown=function(y){var o=this,H=o.editing;return!H||"connect"!==H.mode||H.canceled||H.deleted?void 0:u.Default.isEsc(y)?(H.cursorPos=null,H.targetCorners=null,H.canceled=!0,o._interactor._42(),!0):void 0},ym.prototype.handleEdit=function(L,l){var A=this,Z=A.editing;if(Z){var D,G,y,E,_,h=A.target,j=Z.key,U=Z.mode,t=L.lp(l),O=A._interactor;if("connect"===U){if(Z.canceled)return;if(Z.deleted)return;Z.cursorPos=O._getLogicalPoint(l);var R=Z.garbageInfo;return R&&Bf.checkHit(Z.cursorPos,R,R.size)?(R.hover=!0,Z.target=null,Z.targetCorners=null):(R&&(R.hover=!1),Z.target=L.getDataAt(t,function(p){return L.isSelectable(p)?bh(p)?!0:!1:!1})||null,Z.targetCorners=Bf.getTargetCornersOnScreen(L,Z.target)),O._42(),void 0}if("rotate"===U){var r,m,v=Z.pos,P=Math.atan2(t.y-v.y,t.x-v.x);if(Z.groupRotateMode?m=P-Z.hitRot:(r=P-Z.hitRot,m=Z.rotation+r),m%=2*Math.PI,0>m&&(m+=2*Math.PI),!u.Default.isCtrlDown(l)){var V,i;oe(l)?(V=O.getStyle("shiftRotateRound"),i=V/2):(V=O.getStyle("rotateRound"),i=O.getStyle("rotateSensitivity")),m=Bf.roundTo(m,V,i)}Z.groupRotateMode?(r=m-(Z.lastRotation||0),0!==r&&(h.addRotation(r,Z.groupRotateMode),Z.lastRotation=m)):h.setRotation(m),O._setRotateCursor(P),m>Math.PI&&(m-=2*Math.PI);var b=180*(m/Math.PI);b=b.toFixed(2),D=""+b+"°"}else if("resize"===U){var B=Z.rect;y=B.x,E=B.y;var s,d=B.width,Y=B.height,e=Z.anchor,W=Z.matrix,w=h.s&&h.s("keepAspectRatio")||O.getStyle("keepAspectRatio");oe(l)&&(w=!w);var x=A._unionPointMode1,c=A._unionPointMode2;if(A._inSmartGuide&&!u.Default.isCtrlDown(l)&&!w){var I;"L"===j||"R"===j?I="x":("T"===j||"B"===j)&&(I="y"),A._adsorbedToClosest(t,I),_=!0}s=W.tfi(t);var f;"LT"===j?(B=x(s,{x:y+d,y:E+Y},d,Y,w),f=9):"T"===j?(B=c({x:y,y:s.y},{x:y+d,y:E+Y},d,Y,w,"v"),f=1):"RT"===j?(B=x(s,{x:y,y:E+Y},d,Y,w),f=33):"L"===j?(B=c({x:s.x,y:E},{x:y+d,y:E+Y},d,Y,w,"h"),f=8):"R"===j?(B=c({x:y,y:E},{x:s.x,y:E+Y},d,Y,w,"h"),f=32):"LB"===j?(B=x(s,{x:y+d,y:E},d,Y,w),f=12):"B"===j?(B=c({x:y,y:E},{x:y+d,y:s.y},d,Y,w,"v"),f=4):"RB"===j&&(B=x(s,{x:y,y:E},d,Y,w),f=36);var S=W.tf(B.x+B.width*e.x,B.y+B.height*e.y);h instanceof u.Block&&(Z.hasOwnProperty("freezeFlag")||(Z.freezeFlag=h._freezeSyncFromChildren,h._freezeSyncFromChildren=!0)),h.setPosition(S),h.setSize(B.width,B.height),_&&(G=h.getRect(),O.rectGuide.gatherLines({node:h,x:G.x,y:G.y,w:G.width,h:G.height},I,f)),D=""+Math.round(B.width)+" * "+Math.round(B.height)}else if("line"===U){if(oe(l)){var k=h.getPoints(),$="P1"===j?k.get(1):k.get(0),H={x:t.x-$.x,y:t.y-$.y},M=O.getStyle("shiftLineRotateRound"),n=A._shiftDirList;if(!n||A._shiftRotateRound!==M){A._shiftRotateRound=M,A._shiftDirList=n=[];for(var q=0;q<Math.PI;q+=M)n.push({x:K(q),y:z(q)})}for(var C,F=0,N=0,o=n.length;o>N;N++){var g=n[N],T=g.x*H.x+g.y*H.y;Math.abs(T)>Math.abs(F)&&(F=T,C=g)}t={x:$.x+C.x*F,y:$.y+C.y*F},O.rectGuide.clear()}else A._inSmartGuide&&!u.Default.isCtrlDown(l)&&(A._adsorbedToClosest(t),_=!0);var X=Bf.getDataMatrix(h).applyInverse(t);h.setPoint("P1"===j?0:1,X,!0);var Q=h.getPoints(),p=Q.get(0),J=Q.get(1);y=p.x-J.x,E=p.y-J.y,D=" "+Math.round(Math.sqrt(y*y+E*E))+" ",_&&(G=h.getRect(),O.rectGuide.gatherLines({node:h,x:G.x,y:G.y,w:G.width,h:G.height}))}if(D){var a=u.Default.getLogicalPoint(l,O._canvas);a.x+=Bf.Icons.TipShiftX,a.y+=Bf.Icons.TipShiftY,A.tipInfo={helperPos:a,text:D,size:D.length}}A._fireEditEvent("between",l)}},ym.prototype._unionPointMode1=function(F,R,b,f,L){if(L&&b&&f){var B=F.x-R.x,X=F.y-R.y;Math.abs(B*f)<Math.abs(X*b)?(X=Math.sign(X)*Math.abs(B*f/b),F.y=R.y+X):(B=Math.sign(B)*Math.abs(X*b/f),F.x=R.x+B)}return u.Default.unionPoint(F,R)},ym.prototype._unionPointMode2=function(U,n,c,f,Z,s){var R=u.Default.unionPoint(U,n);if(Z&&c&&f){var L;"v"===s?(L=R.x+R.width/2,R.width=c*R.height/f,R.x=L-R.width/2):(L=R.y+R.height/2,R.height=f*R.width/c,R.y=L-R.height/2)}return R},ym.prototype._adsorbedToClosest=function(w,V){var j=this,g=j._interactor,H=g.rectGuide.findClosest(w,V),P=g.gridGuide.findClosest(w,V),Y=1/0,T=1/0;H&&(isFinite(H.x)&&(Y=H.x),isFinite(H.y)&&(T=H.y)),P&&(isFinite(P.x)&&Math.abs(P.x)<Math.abs(Y)&&(Y=P.x),isFinite(P.y)&&Math.abs(P.y)<Math.abs(T)&&(T=P.y)),isFinite(Y)&&(w.x+=Y),isFinite(T)&&(w.y+=T)},ym.prototype._42=function(O,A,z){var $=this;$.info={},$.screenInfo=null;var p=$._interactor;if(!p.editDetail&&$.gatherInfo(A,z)){var m=$.editing,T=m?m.groupRotateMode:null,v=$.screenInfo;"block"!==T&&(v.P1?Bf.Icons.DrawIcon(p,O,Bf.Icons.Line,v):Bf.Icons.DrawIcon(p,O,Bf.Icons.Rect,v),v.connect&&(Bf.Icons.DrawIcon(p,O,Bf.Icons.ConnectGuide,{rotation:v.rotation,connect:v.connect,cursorPos:m?m.cursorPos:null}),m&&(m.targetCorners&&Bf.Icons.DrawIcon(p,O,Bf.Icons.NodeHoverGuide,m.targetCorners),m.garbageInfo&&Bf.Icons.DrawIcon(p,O,Bf.Icons.ConnectGuideGarbage,m.garbageInfo))),$.tipInfo&&Bf.Icons.DrawIcon(p,O,Bf.Icons.TipHelper,$.tipInfo)),$.target instanceof Bf.Group&&$.target._42(p,O,A)}};var ae=Bf.Anchor=function(c){this.catalog="Anchor",this._interactor=c};ae.prototype={},ae.prototype.constructor=ae,ae.prototype.gatherInfo=function(V,J){var T=this;if(1===J.length){var w=J[0];if(!w.getAnchor)return;if(w instanceof u.Shape&&w._70I())return;if(rd(w,V))return;return T.gatherSingleTarget(V,J[0])}return J.length>1?T.gatherMultiTargets(V,J):!1},ae.prototype.gatherSingleTarget=function(V,e){var Z=this;return Z.info.POS=e.getPosition(),Z.screenInfo.POS=Bf.toScreenPosition(V,Z.info.POS),Z.target=e,!0},ae.prototype.gatherMultiTargets=function(g,X){var A=this,f=Bf.Group.findOrCreateGroup(X);return f?(A.screenInfo.POS=Bf.toScreenPosition(g,f.getAnchor2()),A.target=f,!0):!1},ae.prototype.isVisible=function(){var g=this,o=g._interactor;if(o.getStyle("anchorVisible")===!1)return!1;var F=g.target;if(F){if(this.editing)return!0;var A=F.getAnchor(),P=o.getStyle("anchorOutsideVisibleThreshold");if(A.x<-P||A.x>1+P||A.y<-P||A.y>1+P)return!0;var q=F.getSize(),r=F.getScale(),O=Math.min(Math.abs(q.width*r.x),Math.abs(q.height*r.y));if(O*o.gv._zoom<o.getStyle("anchorHideThreshold"))return!1}return!0},ae.prototype.check=function(A,D,H){if(u.Default.isLeftButton(D)){var m=this,r=m._interactor;if(m.isVisible()&&r.getStyle("anchorMovable")!==!1){m.editing=null,m.tipInfo=null;var G=m.target;if(G&&A.isAnchorEditable(G)&&A.isEditable(G)){var I;if(m.screenInfo&&(I=m.screenInfo.POS)&&Bf.checkHit(H,new Bf.Math.Vector2(I),r.getStyle("checkSize"))){if(G instanceof Bf.Group)return m.editing={},!0;var h=G.getWidth(),j=G.getHeight(),b=G.getAnchor();return m.editing={rect:{x:-h*b.x,y:-j*b.y,width:h,height:j},anchor:b,matrix:G.getMatrix()},!0}}}}},ae.prototype.startEdit=function(M,X){M.startDragging(X),M.fi({kind:"beginEditAnchor",event:X})},ae.prototype._46O=function(q){var k=this;k.editing&&(k.editing=null,k._interactor.fi({kind:"endEditAnchor",event:q})),k.tipInfo=null},ae.prototype.handleEdit=function(Y,U){var O=this,o=O.target;if(o){var X=O.editing;if(X){var f=Y.lp(U),e=O._interactor;if(o instanceof Bf.Group)return o.setAnchor2(f),e._42(),void 0;var C=X.matrix,l=C.tfi(f),F=X.rect,E=(l.x-F.x)/F.width,j=(l.y-F.y)/F.height;if(!u.Default.isCtrlDown(U)){var D=e.getStyle("anchorRound"),k=e.getStyle("anchorSensitivity");E=Bf.roundTo(E,D,k),j=Bf.roundTo(j,D,k)}o.setAnchor(E,j,!0);var I=u.Default.getLogicalPoint(U,e._canvas);I.x+=Bf.Icons.TipShiftX,I.y+=Bf.Icons.TipShiftY;var w=""+E.toFixed(2)+", "+j.toFixed(2);O.tipInfo={helperPos:I,text:w,size:w.length},e.fi({kind:"betweenEditAnchor",event:U})}}},ae.prototype._42=function(H,P,k){var W=this;W.info={},W.screenInfo={};var u=W._interactor;u.editDetail||W.gatherInfo(P,k)&&W.isVisible()&&(Bf.Icons.DrawIcon(u,H,Bf.Icons.Anchor,W.screenInfo),W.tipInfo&&Bf.Icons.DrawIcon(u,H,Bf.Icons.TipHelper,W.tipInfo))};var Uk=Bf.RotateX=function(z){this.catalog="RotateX",this._interactor=z};Uk.prototype={},Uk.prototype.constructor=Uk,Uk.prototype.gatherInfo=function(Z,d){var $=this;if(1===d.length){var m=d[0];return m instanceof u.Shape&&m._70I()||rd(m,Z)?!1:$.gatherSingleTarget(Z,m)}return d.length>1?$.gatherMultiTargets(Z,d):!1},Uk.prototype.gatherSingleTarget=function(){var U=new u.Math.Vector2,n=new u.Math.Vector2,W=new u.Math.Vector2,$=new u.Math.Vector2,N=function(Y,u){var N=Y.x-u.x,_=Y.y-u.y;return N*N+_*_};return function(R,i){if(i.getCorners){var X=this,m=i.getCorners(),q=15,v=i.getPosition();U.copy(m[0]),W.copy(m[1]),$.copy(m[3]),n.copy(U).add($).divideScalar(2).add(U.sub(W).setLength(q/R.getZoom()));var A=Math.max(N(v,m[0]),N(v,m[1]),N(v,m[2]),N(v,m[3]));return X.info.POS=n.clone(),X.screenInfo.POS=Bf.toScreenPosition(R,X.info.POS),X.screenInfo.LEN=Math.sqrt(A)*R.getZoom()+q,X.screenInfo.CENTER=Bf.toScreenPosition(R,v),X.target=i,!0}}}(),Uk.prototype.gatherMultiTargets=function($,a){var l=this,M=Bf.Group.findOrCreateGroup(a);if(!M)return!1;var l=this;return l.gatherSingleTarget($,M)},Uk.prototype.isVisible=function(){var g=this._interactor;if(!g.getStyle("rotateAsClock"))return!1;var l=this.target;if(!l)return!0;var k=g.gv;return k.isEditable(l)&&k.isRotationEditable(l)?!0:!1},Uk.prototype.check=function(C,B,k){var K=this,i=K._checkImpl(C,B,k);return(i||K._clockPainted)&&K._interactor._42(),i},Uk.prototype._checkImpl=function(p,O,k){if(u.Default.isLeftButton(O)){var $=this;$.editing=null,$.tipInfo=null;var g;if($.screenInfo&&(g=$.screenInfo.POS)&&$.isVisible()){var i=$._interactor;if(Bf.checkHit(k,g,i.getStyle("checkSize"))){var Z=$.target,f=p.lp(O),t=Z.getPosition(),b=Math.atan2(f.y-t.y,f.x-t.x);return i._setRotateCursor(b),$.editing={pos:t,rotation:Z.getRotation(),hitRot:b,groupRotateMode:"block",screenInfo:{CENTER:$.screenInfo.CENTER,LEN:$.screenInfo.LEN}},!0}}}},Uk.prototype.startEdit=function(A,C){A.startDragging(C),A.fi({kind:"beginEditRotation",event:C}),this.target instanceof Bf.Group&&this.target.beginRotate(this.editing)},Uk.prototype._46O=function(I){var y=this;y.editing&&(y.editing=null,y._interactor.fi({kind:"endEditRotation",event:I})),y.target instanceof Bf.Group&&y.target.endRotate(),y.tipInfo=null},Uk.prototype.handleEdit=function(a,q){var V=this,M=V.editing;if(M){var n,J,w=V.target,G=a.lp(q),L=V._interactor,s=M.pos,v=Math.atan2(G.y-s.y,G.x-s.x),R=w instanceof Bf.Group;if(R?J=v-M.hitRot:(n=v-M.hitRot,J=M.rotation+n),J%=2*Math.PI,0>J&&(J+=2*Math.PI),!u.Default.isCtrlDown(q)){var P,U;oe(q)?(P=L.getStyle("shiftRotateRound"),U=P/2):(P=L.getStyle("rotateRound"),U=L.getStyle("rotateSensitivity")),J=Bf.roundTo(J,P,U)}R?(n=J-(M.lastRotation||0),0!==n&&(w.addRotation(n,M.groupRotateMode),M.lastRotation=J)):w.setRotation(J),L._setRotateCursor(v),J>Math.PI&&(J-=2*Math.PI);var f=180*(J/Math.PI),_=""+f.toFixed(2)+"°",h=u.Default.getLogicalPoint(q,L._canvas);h.x+=Bf.Icons.TipShiftX,h.y+=Bf.Icons.TipShiftY,V.tipInfo={helperPos:h,text:_,size:_.length},L.fi({kind:"betweenEditRotation",event:q})}},Uk.prototype._42=function(s,z,V){var P=this;P._clockPainted=!1,P.info={},P.screenInfo={};var E=P._interactor;E.editDetail||P.gatherInfo(z,V)&&P.isVisible()&&(Bf.Icons.DrawIcon(E,s,Bf.Icons.RoundPoint,P.screenInfo.POS),P.tipInfo&&Bf.Icons.DrawIcon(E,s,Bf.Icons.TipHelper,P.tipInfo),P.editing&&P.drawClock(s))},Uk.prototype.drawClock=function(r){r.save();var J=this;J._clockPainted=!0;var q=J.editing||{},m=q.screenInfo||J.screenInfo,h=m.LEN,Q=h+8,N=h+18;r.save(),r.translate(m.CENTER.x,m.CENTER.y),r.beginPath(),r.strokeStyle="rgb(150, 150, 150)";for(var F,n,O,G,v,B=0;360>B;B++)F=B*Math.PI/180,0===B%5&&(n=z(F)*h,O=K(F)*h,G=z(F)*Q,v=K(F)*Q,r.moveTo(n,O),r.lineTo(G,v)),0===B%45&&(n=z(F)*h,O=K(F)*h,G=z(F)*N,v=K(F)*N,r.moveTo(n,O),r.lineTo(G,v));r.stroke(),r.rotate(-g);var t=q.lastRotation||J.target.getRotation();r.beginPath(),r.fillStyle="rgba(255, 0, 0, 0.1)",r.strokeStyle="rgb(157, 157, 157)",r.moveTo(0,0),r.arc(0,0,N,0,t,!1),r.fill(),r.beginPath(),r.moveTo(0+N,0),r.arc(0,0,N,0,t,!1),r.stroke(),r.restore()};var kj=Bf.Curve=function(y){this.catalog="Curve",this._interactor=y};kj.prototype={},kj.prototype.constructor=kj,f.defineProperties(kj.prototype,{activing:{get:function(){return this._activing},set:function(r){var A=this;if(r)A._activing=new Bf.CurveActiving(this,r);else{var G=A._activing;G&&G.dispose(),A._activing=null}}}}),kj.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},kj.prototype.setUp=function(){var e=this,U=e._interactor;U&&U.gv.mp(e._onGraphviewPropertyChanged,e)},kj.prototype._onGraphviewPropertyChanged=function(c){("zoom"===c.property||"translateX"===c.property||"translateY"===c.property)&&this._handleDataChanged()},kj.prototype.tearDown=function(){var h=this,x=h._interactor;x&&x.gv.ump(h._onGraphviewPropertyChanged,h)},kj.prototype.canEnterEditDetailMode=function(){var l=this,y=l._interactor,R=y._getValidSelection();if(1===R.length){var s=R[0],C=s instanceof u.Edge;if(s instanceof u.Shape||C){if(C){var S=s.s("edge.type");if(S&&"points"!==S)return}var U=y.gv;if(U.isPointEditable(s)&&U.isEditable(s))return l.target=s,!0}}},kj.prototype.canQuitEditDetailMode=function(n){var p=this,m=p._interactor._getLogicalPoint(n);return p._checkEditRealPoint(m)?void 0:p._interactor.gv.getDataAt(n)!==p.target?!0:void 0},kj.prototype.preHandleScroll=function(){var q=this.editing;return q&&q.inEdit?!0:void 0},kj.prototype.getCurrentSelectintStatus=function(){var H=this;if(H.activing&&!H.activing.selections){if(H.activing.status!=l)return H.activing.status;var s=function(B){var A=H.activing.status;H.activing.status=B,H._interactor.fp("shapePointStatus",A,B)},W=Bf.Curve.PointType,f=H.activing.point,C=H.activing.pairs;if(!C||1!==C.length)return s(W.Mirrored);var T=C[0],t=T.c1&&T.c1.isNearEnough(f),K=T.c2&&T.c2.isNearEnough(f);if(!T.c1||!T.c2)return t||K?s(W.Straight):s(W.Disconnected);if(t&&K)return s(W.Straight);if(t||K)return s(W.Asymmetric);var $=T.c1.clone().sub(f),h=T.c2.clone().sub(f);return Math.abs($.x*h.y-$.y*h.x)>1e-5||$.x*h.x>0?s(W.Disconnected):Math.abs($.length()-h.length())>1e-5?s(W.Asymmetric):s(W.Mirrored)}},kj.prototype.handle_keydown=function(i){var z=this;if(z._interactor.editDetail){var x=Bf.Curve.PointType;"1"===i.key?z._setCurrentSelectionStatus(x.Straight):"2"===i.key?z._setCurrentSelectionStatus(x.Mirrored):"3"===i.key?z._setCurrentSelectionStatus(x.Disconnected):"4"===i.key&&z._setCurrentSelectionStatus(x.Asymmetric)}},kj.prototype.setCurrentSelectionStatus=function(G){var Y=this,j=Y._interactor;if(j){var D=j.gv;D.dm().beginTransaction(),this._setCurrentSelectionStatus(G),D.dm().endTransaction()}},kj.prototype._setCurrentSelectionStatus=function(D){var v=this,I=v.activing;if(I){var S=v.getCurrentSelectintStatus();if(null!==S&&S!==D){I.status=D;var R=v.activing.point,Y=v.activing.pairs;if(Y&&1===Y.length){var n=Y[0],y=v.screenInfo.curve,G=Bf.Curve.PointType,w=function(){v._writeToHt(),v._interactor.fp("shapePointStatus",S,D)};if(D===G.Straight)return y.moveCtrlPoint(n,R,"c1"),y.moveCtrlPoint(n,R,"c2"),w(),void 0;if(S===G.Straight){var J=y.findPairs(R,!0),L=J[0],X=L.r1||R,h=L.r2||R,$=h.clone().sub(X).multiplyScalar(.25);return y.moveCtrlPoint(n,R.clone().sub($),"c1"),y.moveCtrlPoint(n,R.clone().add($),"c2"),w(),void 0}var j=n.c1,f=n.c2;if(j&&f){if(D===G.Mirrored)return y.moveCtrlPoint(n,R.clone().multiplyScalar(2).sub(f),"c1"),w(),void 0;if(D===G.Asymmetric&&S===G.Disconnected){var c=j.clone().sub(R).length(),$=R.clone().sub(f).setLength(c).add(R);return y.moveCtrlPoint(n,$,"c1"),w(),void 0}}I._firePointChange(),v._interactor.fp("shapePointStatus",S,D)}}}},kj.prototype._handleDataChanged=function(){var C="points,segments,shape,position,rotation,scale".split(",");return function(G){var K=this;if(K.screenInfo&&K.target){if(G&&C.indexOf(G.property)<0)return;var $=K._interactor;K.gatherSingleTarget($.gv,K.target,!0),K.check($.gv,null,new Bf.Math.Vector2($._lastClientPoint)),$._42()}}}(),kj.prototype.gatherSingleTarget=function(i,G,H){var R,n,I=this;I.screenInfo&&I.screenInfo.curve&&(n=I.screenInfo.curve._curves);var t=I.editing;R=t?I.screenInfo:I.screenInfo={};var A,Q,U=G instanceof u.Edge;U?(A=G.s("edge.segments"),Q=G.s("edge.points")||new u.List):(A=G._58O,Q=G._59O),R.S=A;var m,F=R.P=[],E=Bf.getDataMatrix(G);if(G instanceof u.Polyline&&(m=G.getElevation()||0,R.E=[]),Q.each(function(g){R.E&&R.E.push(g.e||m),g=E.apply(g);var a=Bf.toScreenPosition(i,g);F.push(a.x,a.y)}),U){var y=Bf.toScreenPosition(i,G._lastSourcePoint),D=Bf.toScreenPosition(i,G._lastTargetPoint);F.splice(0,0,y.x,y.y),F.push(D.x,D.y)}if(!R.S||!R.S.size()){R.S=new u.List,R.S.add(1);for(var a=0;a<F.length/2-1;a++)R.S.add(2)}if((!t||H)&&I.convertToCubicBezier(n),I.activing&&(H||!I.editing||"realPoint"===I.editing.type)){var C=R.curve.findPairs(I.activing.point);I.activing.pairs=C}U&&"points"!==G.s("edge.type")&&I._writeToHt()},kj.prototype._convertToNewPoint=function(y,O,B){var j,Y,D;for(j=0,Y=O.length;Y>j;j++){if(D=O[j],D._p1.isNearEnough(y))return D._p1;if(D._p4.isNearEnough(y))return D._p4}if(B)for(j=0,Y=Math.min(B.length,Y);Y>j;j++){if(D=B[j],D._p1===y)return O[j]._p1;if(D._p4===y)return O[j]._p4}},kj.prototype.convertToCubicBezier=function(r){var Z,N,k=this,w=new Bf.Math.Curve,y=k.screenInfo;if(w.createFromHtShape(y.P,y.S,y.E),y.curve=w,k.activing){var F=w._curves;if(Z=k.activing.point,N=k._convertToNewPoint(Z,F,r),N&&(k.activing.point=N),k.activing.selections){var P=-1,I=k.activing.selections;I.forEach(function(J){P++,N=k._convertToNewPoint(J,F,r),N&&(I[P]=N)})}}},kj.prototype.check=function(K,X,_){if(!X||u.Default.isLeftButton(X)){var D=this;if(D._interactor.setCursor("default"),D.editing=null,D.highlight=null,D.tipInfo=null,D.screenInfo){if(eo())return D._interactor._42(),!0;if(D._checkEditCtrlPoint(_))return D._interactor._42(),!0;if(D._checkEditRealPoint(_))return D._interactor._42(),!0;if(D._checkEditElevation(_))return D._interactor._42(),!0;var S=D.screenInfo.curve,p=S.checkPoint(_,D._interactor.getStyle("curveIntersectSize"));if(p){var M=D.highlight={};M.type="insertKnot",M.bezier=p.bezier,M.point=p.intersection}return D._interactor._42(),!0}}},kj.prototype._checkEditRealPoint=function(L){var K,Y,C,c,W,J,R=this,o=R.screenInfo.curve._curves,P=R._interactor.getStyle("curvePointIntersectSize"),X=1/0;for(P*=P,C=0,c=o.length;c>C;C++)K=o[C],W=K._p1,J=L.distanceToSquared(W),X>J&&(X=J,Y=W),W=K._p4,J=L.distanceToSquared(W),X>J&&(X=J,Y=W);if(X>P)return!1;var u=R.highlight={};return u.type="changeRealPoint",u.point=Y,R.editing={type:"realPoint",point:Y,shiftGuide:{point:Y.clone(),dir:"x",limit:0}},R._interactor.setCursor("crosshair"),!0},kj.prototype._checkEditElevation=function(O){var o=this;if(!o._interactor.getStyle("curveElevationVisible"))return!1;var b=o.activing;if(!b)return!1;var S=b.getCurrentEditingPoint();if(!S)return!1;var B=o._interactor,K=B.getStyle("curveElevationGuideShift"),d=B.getStyle("curveElevationIntersectSize"),E=O.distanceToSquared({x:S.x+K[0],y:S.y+K[1]});if(!(E>d*d)){var e=o.highlight={};e.type="elevation";var v=new Bf.Math.Vector2(O.x,O.y,S.e);return o.editing={type:"elevation",startPoint:v},o._interactor.setCursor("crosshair"),!0}},kj.prototype._checkEditCtrlPoint=function(m){var o=this;if(o.activing&&!o.activing.selections){var f=o.getCurrentSelectintStatus();if(f!==Bf.Curve.PointType.Straight){var X=o.activing.pairs;if(X){var q=o._interactor.getStyle("curvePointIntersectSize");q*=q;var v,g,p,s,T,b,k,G,t,N=1/0;for(k=0,t=X.length;t>k;k++)for(s=X[k],G=0;2>G;G++)T=0===G?"c1":"c2",s[T]&&(b=m.distanceToSquared(s[T]),N>b&&(N=b,v=s,g=k,p=T));if(N>q)return!1;o.activing.hlpair=v,o.activing.hltype=p;var h=o.highlight={};return h.type="changeCtrlPoint",h.point=v[p],o.editing={type:"ctrlPoint",pair:v,pairId:g,ctrlType:p,direction:v[p].clone().sub(o.activing.point).normalize()},o._interactor.setCursor("crosshair"),!0}}}},kj.prototype.startEdit=function(K,y){K.startDragging(y);var A=this;A.highlight&&"insertKnot"===A.highlight.type&&(A.insertKnot(),A.gatherSingleTarget(A._interactor.gv,A.target),A.activing=null,A._checkEditRealPoint(A._interactor._getLogicalPoint(y)));var w=A._activing;if(w){var h=A.editing?A.editing.type:null;"ctrlPoint"===h?w.editingCtrl={pairId:A.editing.pairId,type:w.hltype}:"realPoint"===h&&(w.editingCtrl=!1)}var j=A.highlight,X=u.Default.isCtrlDown(y);if(!j||eo()){var k=A._interactor.gv;if(!k.setFocus(y)||k._scrolling)return;return k.isPannable()&&ci(y)&&!X&&(A._pan={tx:k.tx(),ty:k.ty()},K.fi({kind:"beginPan",event:y})),void 0}if("changeRealPoint"===j.type){var J,r=A.activing?A.activing.point:null,O=A.activing?A.activing.selections:null;if(X&&A.activing)r===j.point?(O?(A.activing={point:O[0]},O.length>1&&(O.splice(0,1),A.activing.selections=O)):A.activing=null,A.editing=null):O&&(J=O.indexOf(j.point))>=0?(O.length>1?O.splice(J,1):delete A.activing.selections,A.editing=null):O?(O.push(r),A.activing={point:j.point,selections:O}):A.activing={point:j.point,selections:[r]};else if(O)r===j.point||((J=O.indexOf(j.point))>=0?(O.splice(J,1,r),A.activing={point:j.point,selections:O}):A.activing={point:j.point});else{var M;r===j.point&&(M=A.activing.status),A.activing={point:j.point},M&&(A.activing.status=M)}K.fi({kind:"beginEditPoint",event:y})}},kj.prototype.insertKnot=function(){var V=this,b=V.highlight,i=V.screenInfo.curve;i.insertKnot(b.bezier,b.point.t),V._writeToHt()},kj.prototype._writeToHt=function(){var P,W,F,w,d=this,n=d.screenInfo.curve,K=n.toHtShape(),J=K.points,q=[],U=K.segments,D=d._interactor.gv,j=d.target,p=j instanceof u.Edge,a=Bf.getDataMatrix(j).invert();w=j instanceof u.Polyline,w&&(F=j.getElevation());for(var Q=0,R=J.length;R>Q;Q++)P=J[Q],W=Bf.toWorldPosition(D,P),W=a.apply(W),P.e!=l&&P.e!==F&&(W.e=P.e),q.push(W);if(j._writing=!0,p){j.s("edge.type","points"),j.setStyle("edge.segments",U),j.setStyle("edge.points",q.slice(1,q.length-1)),j.setStyle("edge.source.offset.x",0),j.setStyle("edge.source.offset.y",0),j.setStyle("edge.target.offset.x",0),j.setStyle("edge.target.offset.y",0);var v=d._nextChangeEdgeHost;delete d._nextChangeEdgeHost,v&&("source"===v.type?j.setSource(v.host):j.setTarget(v.host)),d._writeEdgeHostAnchor("source",q[0]),d._writeEdgeHostAnchor("target",q[q.length-1])}else q.length?(j.setSegments(U),j.setPoints(q,!0)):j.removeFromDataModel();delete j._writing},kj.prototype._writeEdgeHostAnchor=function(F,u){var Z=this,N=Z.target,H=Z._calcHostAnchor(N,F,u);N.s("edge."+F+".anchor.x",H.x),N.s("edge."+F+".anchor.y",H.y),H.offsetX||H.offsetY?(N.s("edge."+F+".offset.x",H.offsetX),N.s("edge."+F+".offset.y",H.offsetY)):(N.s("edge."+F+".offset.x",0),N.s("edge."+F+".offset.y",0))},kj.prototype._calcHostAnchor=function(m,e,H,k){k||(k="source"===e?m.getSource():m.getTarget());var Q=this._interactor.gv,v=Q.calculateAttachPoint(k,H);if(v)return v.info;var d=k.getRotation(),r=k.getAnchor();if(rd(k,Q)&&(d=0),d){var b=k.getMatrix(),x=b.tfi(H),V=k.getSize();return{x:x.x/V.width+r.x,y:x.y/V.height+r.y}}var t=He(Q,k),i={x:(H.x-t.x)/t.width,y:(H.y-t.y)/t.height};return i},kj.prototype._handlePanning=function(C){var F=this,z=F._pan;if(z){z.started=!0;var t=F._interactor,Z=t.gv,h=t._lastClientPoint,v=kg(C);Z.setTranslate(z.tx+v.x-h.x,z.ty+v.y-h.y),F.gatherSingleTarget(t.gv,F.target),t._42(),t.fi({kind:"betweenPan",event:C})}},kj.prototype.handleEdit=function(N,M){var G=this,_=G.editing;if(G._pan)return G._handlePanning(M),void 0;if(_){_.inEdit=!0;var J,z,Z,q=G._interactor._getLogicalPoint(M),c=u.Default.isCtrlDown(M),D=u.Default.isShiftDown(M),U=_.type,r=G.activing;if(G._guideInfo=null,"ctrlPoint"===U&&D){var k=G.editing.direction.clone();J=r.point;var C=k.dot(q.clone().sub(J));q=k.setLength(C).add(J)}else if("ctrlPoint"===U||"realPoint"===U){var k;if("realPoint"===U&&D){var E=G.editing.shiftGuide;z=E.point;var s=Math.abs(q.x-z.x),y=Math.abs(q.y-z.y);s>y&&s>E.limit&&"y"===E.dir&&(E.dir="x"),y>s&&y>E.limit&&"x"===E.dir&&(E.dir="y"),k=E.dir,"x"===k?(q.y=z.y,E.limit=Math.max(E.limit,s)):"y"===k&&(q.x=z.x,E.limit=Math.max(E.limit,y))}var O=G._isEditEdgeSourceTarget();if(O){var Y=G._editEdgeSourceTarget(O,q,c);Y&&(Z=Y.tipText)}else if(!c){var F=G._guidingToEdit(q,k),h="realPoint"===U?G._interactor.gridGuide.findClosest(q,k,!0):null,a=1/0,t=1/0;h&&(h.x&&(a=h.x),h.y&&(t=h.y));var S=!1;F&&(F.xList&&(Math.abs(F.x)<=Math.abs(a)?(S=!0,a=F.x):delete F.xList),F.yList&&(Math.abs(F.y)<=Math.abs(t)?(S=!0,t=F.y):delete F.yList),S&&(G._guideInfo=F)),isFinite(a)&&(q.x+=a),isFinite(t)&&(q.y+=t),S&&(F.v=q)}}var g=G.screenInfo.curve;if("realPoint"===_.type){J=_.point,J.e!==l&&(q.e=J.e),g.moveRealPoint(J,q),_.point=q,G.highlight.point=q;var X=r.status,o=r.selections;if(G.activing={point:q,status:X},o){var e=q.clone().sub(J),K=0;o.forEach(function(M){var l=M.clone().add(e);g.moveRealPoint(M,l),o[K++]=l}),G.activing.selections=o}}else if("ctrlPoint"===_.type){var j=r.pairs,V=j[_.pairId];g.moveCtrlPoint(V,q,_.ctrlType);var H=r.status,L=Bf.Curve.PointType;if((H===L.Mirrored||H===L.Asymmetric)&&V.c1&&V.c2){var J=new Bf.Math.Vector2(r.point),f="c1"===_.ctrlType?"c2":"c1";if(H===Bf.Curve.PointType.Mirrored)g.moveCtrlPoint(V,J.clone().multiplyScalar(2).sub(q),f);else if(H===L.Asymmetric){var C=V[f].clone().sub(J).length(),T=J.clone().sub(V[_.ctrlType]).setLength(C).add(J);isNaN(T.x)||g.moveCtrlPoint(V,T,f)}}r._firePointChange()}else if("elevation"===_.type){z=_.startPoint;var p=z.e+(z.y-q.y)/N._zoom;G._setCurrentPointImpl("e",p),r._firePointChange(),Z="E: "+Bf.toFixed(p)}var B=u.Default.getLogicalPoint(M,G._interactor._canvas);if(B.x+=Bf.Icons.TipShiftX,B.y+=Bf.Icons.TipShiftY,!Z){var A=Bf.toWorldPosition(N,q);Z=""+Bf.toFixed(A.x)+", "+Bf.toFixed(A.y)}G.tipInfo={helperPos:B,text:Z,size:Z.length},G._writeToHt(),G._interactor.fi({kind:"betweenEditPoint",event:M})}},kj.prototype._setCurrentPointImpl=function(f,o){var E=this,B=E._activing;if(!B)return!1;var n=E.target;if(!n)return!1;var r=B.getCurrentEditingPoint();if(!r)return!1;var q=B.editingCtrl;if(!q)var C=r.clone();if("e"===f)r.e=o;else{var S;if("x"===f||"y"===f){var I=B._lastFirePoint;S="x"===f?{x:o,y:I?I.y:0}:{x:I?I.x:0,y:o}}else"object"==typeof f?(S=f,f.e!==l&&(r.e=f.e)):(S={x:arguments[0],y:arguments[1]},arguments[2]!==l&&(r.e=arguments[2]));var c=Bf.getDataMatrix(n);S=Bf.toScreenPosition(E._interactor.gv,c.apply(S)),r.x=S.x,r.y=S.y}if(!q){var J=C.multiplyScalar(-1).add(r);r.e&&C.e&&(J.e=r.e-C.e),E.screenInfo.curve.moveCtrlDueToRealPointMovement(r,J)}return!0},kj.prototype.setCurrentPoint=function(J,l){return this._setCurrentPointImpl(J,l)?(this._writeToHt(),!0):!1},kj.prototype._isEditEdgeSourceTarget=function(){var h=this,c=h.target;if(!(c instanceof u.Edge))return!1;var x=h.editing.point,t=h.screenInfo.curve._curves;return x===t[0]._p1?"source":x===t[t.length-1]._p4?"target":!1},kj.prototype._editEdgeSourceTarget=function(U,P,o){var p,a=this,$=a.target;if(p="source"===U?$.getSource():$.getTarget()){var T=a._interactor.gv,s=Bf.toWorldPosition(T,P),u=a._calcHostAnchor($,U,s,p);if(a._interactor.getStyle("edgeHostDetectPerFrame")||u.x<0||u.x>1||u.y<0||u.y>1){var j=T.getDataAt(s,function(e){return T.isSelectable(e)?bh(e)?!0:!1:!1});if(j){var F=a._calcHostAnchor($,U,s,j);p=j,a._nextChangeEdgeHost={type:U,host:j},u=F}}var f;if(!o){var h=a._interactor.getStyle("anchorRound"),w=a._interactor.getStyle("anchorSensitivity");f=T.calculateAttachPoint(p,s),f?u=f.info:(u.x=Bf.roundTo(u.x,h,w),u.y=Bf.roundTo(u.y,h,w))}if(!o){var z=p.getAttachPosition(u.x,u.y,u.offsetX,u.offsetY),A=Bf.toScreenPosition(T,z);P.x=A.x,P.y=A.y}a._edgeHostGuideInfo={corners:Bf.getTargetCornersOnScreen(T,p),attach:f?f.index:-1,host:p};var E=""+u.x.toFixed(2)+", "+u.y.toFixed(2);return(u.offsetX||u.offsetY)&&(E+=" offset: "+u.offsetX.toFixed(2)+", "+u.offsetY.toFixed(2)),{host:p,anchor:u,tipText:E}}},kj.prototype._guidingToEdit=function(t,r){var z,o,W=this;if(z=W.screenInfo.curve){o=z._curves;var d,y,N,T,v,u,e,U,B=1/0,E=1/0,C=[];for(W.editing&&"realPoint"===W.editing.type&&(U=W.editing.point),v=0,u=2*o.length;u>v;v++)e=o[Math.floor(v/2)][v%2?"_p4":"_p1"],C.indexOf(e)>=0||(C.push(e),U&&U===e||(N=e.x-t.x,T=e.y-t.y,Math.abs(N)<Math.abs(B)?(B=N,d=[e]):N===B&&d.push(e),Math.abs(T)<Math.abs(E)?(E=T,y=[e]):T===E&&y.push(e)));var b=W._interactor.getStyle("smartGuideSensitivity");if((Math.abs(B)>b||"y"===r)&&(d=null),(Math.abs(E)>b||"x"===r)&&(y=null),d||y){var F=!1,j={};if(d&&(F=!0,j.xList=d,j.x=B),y&&(F=!0,j.yList=y,j.y=E),F)return j}}},kj.prototype._46O=function(R){var e=this;e.editing&&(e.editing=null,e._interactor.fi({kind:"endEditPoint",event:R})),e._guideInfo=null,e._edgeHostGuideInfo=null,e._pan&&(e._pan=null,e._interactor.fi({kind:"endPan",event:R})),e.tipInfo=null},kj.prototype._canDeletePoint=function(I,K){var N=this.target;if(!(N instanceof u.Edge))return!0;var Q=I._curves[0],Z=I._curves[I._curves.length-1];
return Q._p1===K||Z._p4===K?!1:!0},kj.prototype.handleDelete=function(){var A=this;if(A.activing&&A.screenInfo){var m=u.Default.isShiftDown(),Z=A.screenInfo.curve;A._canDeletePoint(Z,A.activing.point)&&Z.deleteRealPoint(A.activing.point,m),A.activing.selections&&A.activing.selections.forEach(function(h){A._canDeletePoint(Z,h)&&Z.deleteRealPoint(h,m)}),A.activing=null,delete A.editing,delete A.tipInfo,delete A._pan,A._writeToHt(),A._interactor.fp("deleteShapePoint",!1,!0)}},kj.prototype.handleDoubleClick=function(h){var Q=this,F=Q._interactor._getLogicalPoint(h);if(Q.screenInfo&&Q._checkEditRealPoint(F)){var E=Q.getCurrentSelectintStatus(),K=Bf.Curve.PointType;return E=E===K.Mirrored?K.Straight:K.Mirrored,Q._setCurrentSelectionStatus(E),Q._interactor._42(),!0}},kj.prototype._drawHighlight=function(t){var s=this,E=s.highlight;if(E){var p=E.bezier,Z=s._interactor;p&&Bf.Icons.DrawIcon(Z,t,Bf.Icons.ShapeHighlightCurve,[p._p1.x,p._p1.y,p._p2.x,p._p2.y,p._p3.x,p._p3.y,p._p4.x,p._p4.y]);var g=E.point;g&&"insertKnot"===E.type&&Bf.Icons.DrawIcon(Z,t,Bf.Icons.ShapeHighlighPoint,g)}},kj.prototype._drawGuide=function(n){var f=this,B=f._guideInfo;if(B){var D,M,A,e,x=B.v;for(D=0;2>D;D++)if(e=0===D?B.xList:B.yList)for(M=0,A=e.length;A>M;M++)Bf.Icons.DrawIcon(f._interactor,n,Bf.Icons.ShapeGuideLine,[x.x,x.y,e[M].x,e[M].y])}},kj.prototype._drawCurrentPoint=function(O){var X=this;if(X.activing){var P=X.activing,_=X.getCurrentSelectintStatus(),C=X._interactor;if(_!==Bf.Curve.PointType.Straight){var z=P.pairs;P.hlpair,P.hltype;var D=P.selections,j=P.editingCtrl;if(z&&!D){var f,m,l;for(m=0,l=z.length;l>m;m++)f=z[m],j&&m===j.pairId&&f[j.type]?Bf.Icons.DrawIcon(C,O,Bf.Icons.ShapeActivingCtrl,{point:f.point,c1:f.c1,c2:f.c2,hl:j.type}):Bf.Icons.DrawIcon(C,O,Bf.Icons.ShapeActivingCtrl,f)}}Bf.Icons.DrawIcon(C,O,Bf.Icons.ShapeHighlighRealPoint,X.activing.point),D&&D.forEach(function(z){Bf.Icons.DrawIcon(C,O,Bf.Icons.ShapeHighlighRealPoint,z)})}},kj.prototype.clear=function(){var J=this;J.editing=null,J._guideInfo=null,J.activing=null,J.highlight=null},kj.prototype._42=function(_){var h=this;h.info={},h.editing||(h.screenInfo=null);var J=h._interactor;if(!J.editDetail)return h.clear(),void 0;var O=J.gv;if(!h.target||!O.isSelected(h.target)||!O.isVisible(h.target))return J.editDetail=!1,h.clear(),void 0;if(h.gatherSingleTarget(O,h.target),Bf.Icons.DrawIcon(J,_,Bf.Icons.ShapeBgCurve,h.screenInfo),h._drawHighlight(_),h._drawCurrentPoint(_),h._getRealPoint().forEach(function(K){Bf.Icons.DrawIcon(J,_,Bf.Icons.ShapePoint,K)}),h._drawGuide(_),h.tipInfo&&Bf.Icons.DrawIcon(J,_,Bf.Icons.TipHelper,h.tipInfo),h._edgeHostGuideInfo){Bf.Icons.DrawIcon(J,_,Bf.Icons.NodeHoverGuide,h._edgeHostGuideInfo.corners);var I=h._edgeHostGuideInfo.host;if(I){var X=O.getAttachPoints(I);if(X&&X.length)for(var V=0,H=X.length;H>V;V++){var w=X[V],E=I.getAttachPosition(w.x,w.y,w.offsetX,w.offsetY);E=Bf.toScreenPosition(O,E),E.isAttach=h._edgeHostGuideInfo.attach===V,Bf.Icons.DrawIcon(J,_,Bf.Icons.AttachPoint,E)}}}if(h._interactor.getStyle("curveElevationVisible")&&h.target instanceof u.Polyline&&h.activing){var c=h.activing.getCurrentEditingPoint();c&&Bf.Icons.DrawIcon(J,_,Bf.Icons.EdgeElevationGuide,c)}},kj.prototype._getRealPoint=function(){var i,T=this.screenInfo,s=T.P,D=T.S,z=-1,W=[],F=-1,a=D.length;return D.each(function(G){F++;var H=1;if(3===G)H=2;else if(4===G)H=3;else if(5===G)return;z+=H,i=F+1>=a?!0:1===D.get(F+1)?!0:!1,W.push({point:{x:s[2*z],y:s[2*z+1]},segmentIndex:F,pointIndex:z,isEnd:i})}),W},kj.prototype.getEditingPointsInfo=function(R){var m=this,L=m.activing;if(!L)return!1;var r=L.point;if(!r)return!1;var t=this._getRealPoint(),H=[{screen:r}];L.selections&&L.selections.forEach(function(M){H.push({screen:M})});var W,P,J=t.length;return H.forEach(function(q){for(W=0;J>W;W++)if(P=t[W],q.screen.isNearEnough(P.point)){q.segmentIndex=P.segmentIndex,q.pointIndex=P.pointIndex,q.point=m.target.getPoints().get(P.pointIndex);break}}),R&&H.sort(function(i,X){return i.segmentIndex-X.segmentIndex}),H};var Vl=Bf.MoveHelper=function(A){var p=this;p.catalog="Move",p._interactor=A};Vl.prototype={},Vl.prototype.constructor=Vl,Vl.prototype.calcShift=function(h,p,P){var i,K,d=this,b=d._interactor.gv,R=b.lp(p);if("beginMove"===h&&d._gatherGridInfo(P._lastLogicalPoint||R),i=d._target){var O=i.downPosition;if(O){var J=d._interactor.getStyle("moveSensitivity")/b._zoom;if(O.distanceTo(R)<J)return{x:0,y:0};delete i.downPosition}var f;K=u.Default.isShiftDown(p),K&&(R=d._dealShiftDown(R),f=i.shiftGuide.dir);var W,x=i.rawPos={x:i.pos.x+R.x-i.lp.x,y:i.pos.y+R.y-i.lp.y};if(u.Default.isCtrlDown(p)){if(W=d._calcShiftByAddon(),d._target.node instanceof Bf.Group){var Q=d._target.node;Q._position.x+=W.x,Q._position.y+=W.y}return W}for(var X,s=i.x+x.x,V=i.y+x.y,k={x:s,y:V},E={x:s+i.w/2,y:V+i.h/2},M={x:s+i.w,y:V+i.h},A=d._interactor.rectGuide,m=d._interactor.gridGuide,n=[A.findClosest(k,f),A.findClosest(E,f),A.findClosest(M,f),m.findClosest(k,f),m.findClosest(E,f),m.findClosest(M,f)],F=1/0,H=1/0,o=0,l=n.length;l>o;o++)X=n[o],X&&(s=X.x,V=X.y,isFinite(s)&&Math.abs(s)<Math.abs(F)&&(F=s),isFinite(V)&&Math.abs(V)<Math.abs(H)&&(H=V));if(isFinite(F)||(F=0),isFinite(H)||(H=0),W=d._calcShiftByAddon(F,H),d._target.node instanceof Bf.Group){var Q=d._target.node;Q._position.x+=W.x,Q._position.y+=W.y}var j=i.node;if(!rd(j,b)){var c=x.x+F,e=x.y+H;d._interactor.rectGuide.gatherLines({node:j,x:i.x+c,y:i.y+e,w:i.w,h:i.h},f)}return W}},Vl.prototype._calcShiftByAddon=function(v,y){var V=this._target,B=V.rawPos,U=V.node.getPosition();return v=v||0,y=y||0,{x:B.x-U.x+v,y:B.y-U.y+y}},Vl.prototype._dealShiftDown=function(p){var E=this,u=E._target.shiftGuide,Y=E._target.lp,f=Math.abs(p.x-Y.x),d=Math.abs(p.y-Y.y);f>d&&f>u.limit&&"y"===u.dir&&(u.dir="x"),d>f&&d>u.limit&&"x"===u.dir&&(u.dir="y");var G=u.dir;return"x"===G?(p.y=Y.y,u.limit=Math.max(u.limit,f)):"y"===G&&(p.x=Y.x,u.limit=Math.max(u.limit,d)),p},Vl.prototype._gatherGridInfo=function(F){var I,w=this,T=w._interactor,x=T._getValidSelection();if(x.length){if(1===x.length){if(I=x[0],!I.getRect)return w._target=null,void 0}else if(I=Bf.Group.findOrCreateGroup(x),!I)return w._target=null,void 0}else{var x=T.gv.sm().getSelection();if(x.length&&(I=x.get(0),!I.getRect))return w._target=null,void 0}var M=I.getPosition(),f=I.getRect();w._target={node:I,x:f.x-M.x,y:f.y-M.y,w:f.width,h:f.height,lp:{x:F.x,y:F.y},pos:{x:M.x,y:M.y},shiftGuide:{dir:"x",limit:0},downPosition:new Bf.Math.Vector2(F)},T.rectGuide.gatherRects()},Vl.prototype.clear=function(){var a=this;a._interactor.rectGuide.clear(),a._interactor._42()};var Iq="directional",Pn="point",sd="spot",jr="light.color",ig=function(c,m){Tf(m)&&Ub.test(m)?Rp(c,m):An(m)&&m.modelType?pc(c,m):oo[c]=m},id=function(f){if(An(f))return f.modelType?f.uuid?oo[f.uuid]:(f.uuid=u.Math.generateUUID(),pc(f.uuid,f),l):f;var p=oo[f];return f&&p===l&&Ub.test(f)&&(Vq&&Vq[f]||Rp(f,f)),p};No(C,{graph3dViewAttributes:h,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:b/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Kl,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:b/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:ig,getShape3dModel:id,createMatrix:function(g,S){wc(g)||(g=[g]);for(var z=g.length-1;z>=0;z--){var j=g[z];S=Ed(j.mat,j.s3,j.r3,j.rotationMode,j.t3,S)}return S},transformVec:function(x,l){return ho(x,l)},createBoxModel:function(){return{vs:yd,ns:Ej,uv:zf,is:ei}},createRoundRectModel:function(N,J){return wj.roundRect(N,J)},createStarModel:function(n,J){return wj.star(n,J)},createRectModel:function(e,J){return wj.rect(e,J)},createTriangleModel:function(C,$){return wj.triangle(C,$)},createRightTriangleModel:function(t,Q){return wj.rightTriangle(t,Q)},createParallelogramModel:function(E,d){return wj.parallelogram(E,d)},createTrapezoidModel:function(I,z){return wj.trapezoid(I,z)},createSmoothSphereModel:function(M,C,D,v,S,l,j){return un(new Mq(M,C,D,v,S,l,j))},createSphereModel:function(J,Q,v,B,T,b){return J?sq(J,Q,v,B,T,b):C.createSmoothSphereModel()},createSmoothConeModel:function(W,j,o,c,R){return td(W,j,o,c,R)},createConeModel:function(r,k,H,h,Q,$){return r?ce(r,k,H,h,Q,$):td($)},createSmoothCylinderModel:function(q,A,G,t,E,W,p,T){return un(new Rl(q,A,G,t,E,W,p,T))},createCylinderModel:function(T,c,h,i,g,d,b){return T?Rf(T,c,h,i,g,d,b):cr(d,b)},createSmoothTorusModel:function(m,D,X,M,O,R){return un(new qf(m,D,X,M,O,R))},createTorusModel:function(B,I,_,D,i,F,K){return B?Vf(B,I,_,D,i,F,K):Jc(F,K)},createExtrusionModel:function(p,I,H,t,r,s,i,j){return $k(p,I,H,t,r,s,i,j)},createSmoothRingModel:function(a,z,D,j,i,Z){for(var x=[],W=0;W<a.length-1;W+=2)x.push({x:a[W],y:a[W+1]});for(a=$b(x,z,D)[0],x=[],W=0;W<a.length;W++){var _=a[W];x.push(new $f(_.x,0,_.y))}return un(new Ir(x,Z,j,i))},createTextGeometry:function(N,J){return un(new ko(N,J))},loadFontFace:function(P,O){C.xhrLoad(P,function(v){if(!v)return O();var w;try{w=JSON.parse(v)}catch(s){w=JSON.parse(v.substring(65,v.length-2))}Oj.loadFace(w),O&&O(w.familyName.toLowerCase())},O?null:{sync:!0})},createRingModel:function(w,e,Z,b,I,G,v,W,E,$){for(var r=[],i=0;i<w.length-1;i+=2)r.push({x:w[i],y:w[i+1]});G=G||C.shapeSide,v=v||0,W=W||G;var m,O,q,x,g,H,s,V,a,u,i,D,t,F,d,n,S,Q,f=[],R=[],l=E?[]:h,B=E?[]:h,M=$?[]:h,c=$?[]:h,T=b?[]:h,y=b?[]:h,X=I?[]:h,A=I?[]:h,w=$b(r,e,Z),L=Kp(w),U=0,J=2*Math.PI/G;return w.forEach(function(o){if(q=o.length,q>1){if(x=o[0],b)for(H=x.x,V=x.y,i=v;W>i;i++)D=i+1,t=i*J,F=D*J,d=z(t),n=K(t),S=z(F),Q=K(F),T.push(d*H,V,-n*H,S*H,V,-Q*H,0,V,0),y.push(.5-.5*d,.5-.5*n,.5-.5*S,.5-.5*Q,.5,.5);for(u=0;q>u;u++){for(g=o[u],H=x.x,s=g.x,V=x.y,a=g.y,m=U/L,U+=Im(x,g),O=U/L,i=v;W>i;i++)D=i+1,t=i*J,F=D*J,d=z(t),n=K(t),S=z(F),Q=K(F),f.push(d*s,a,-n*s,S*s,a,-Q*s,d*H,V,-n*H,S*s,a,-Q*s,S*H,V,-Q*H,d*H,V,-n*H),R.push(i/G,O,D/G,O,i/G,m,D/G,O,D/G,m,i/G,m),E&&i===v&&(l.push(0,V,0,0,a,0,d*s,a,-n*s,d*s,a,-n*s,d*H,V,-n*H,0,V,0),B.push(0,.5-V,0,.5-a,2*s,.5-a,2*s,.5-a,2*H,.5-V,0,.5-V)),$&&D===W&&(M.push(0,V,0,S*s,a,-Q*s,0,a,0,S*s,a,-Q*s,0,V,0,S*H,V,-Q*H),c.push(1,.5-V,1-2*s,.5-a,1,.5-a,1-2*s,.5-a,1,.5-V,1-2*H,.5-V));x=g}if(I)for(H=x.x,V=x.y,i=v;W>i;i++)D=i+1,t=i*J,F=D*J,d=z(t),n=K(t),S=z(F),Q=K(F),X.push(S*H,V,-Q*H,d*H,V,-n*H,0,V,0),A.push(.5-.5*S,.5+.5*Q,.5-.5*d,.5+.5*n,.5,.5)}}),{vs:f,uv:R,bottom_vs:X,bottom_uv:A,top_vs:T,top_uv:y,from_vs:l,from_uv:B,to_vs:M,to_uv:c}}},!0),No(O,{"3d.move.mode":l,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":l,"edge.gradient.color":l,"edge.source.t3":l,"edge.target.t3":l,"light.type":Pn,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":b/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":mi,"wf.short":!1,"wf.mat":l,"wf.geometry":!1,batch:l,"transparent.mask":!1,brightness:l,"select.brightness":.7,"repeat.uv.length":l,alphaTest:.4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":Ak,"label.t3":l,"label.r3":l,"label.texture.scale":2,"label.rotationMode":fs,"label.light":!1,"label.blend":l,"label.reverse.flip":!1,"label.reverse.color":kq,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Ak,"label2.t3":l,"label2.r3":l,"label2.texture.scale":2,"label2.rotationMode":fs,"label2.light":!1,"label2.blend":l,"label2.reverse.flip":!1,"label2.reverse.color":kq,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Ak,"note.t3":l,"note.r3":l,"note.texture.scale":2,"note.rotationMode":fs,"note.light":!1,"note.blend":l,"note.reverse.flip":!1,"note.reverse.color":kq,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Ak,"note2.t3":l,"note2.r3":l,"note2.texture.scale":2,"note2.rotationMode":fs,"note2.light":!1,"note2.blend":l,"note2.reverse.flip":!1,"note2.reverse.color":kq,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:l,"shape3d.color":qq,"shape3d.top.color":l,"shape3d.bottom.color":l,"shape3d.from.color":l,"shape3d.to.color":l,"shape3d.image":l,"shape3d.top.image":l,"shape3d.bottom.image":l,"shape3d.from.image":l,"shape3d.to.image":l,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":l,"shape3d.side.to":l,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":l,"shape3d.opacity":l,"shape3d.reverse.flip":!1,"shape3d.reverse.color":kq,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":l,"shape3d.uv.scale":l,"shape3d.top.uv.offset":l,"shape3d.top.uv.scale":l,"shape3d.bottom.uv.offset":l,"shape3d.bottom.uv.scale":l,"shape3d.from.uv.offset":l,"shape3d.from.uv.scale":l,"shape3d.to.uv.offset":l,"shape3d.to.uv.scale":l,"shape3d.top.cap":l,"shape3d.bottom.cap":l,"shape3d.start.angle":0,"shape3d.sweep.angle":x,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":l,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":qq,"all.image":l,"all.blend":l,"all.opacity":l,"all.reverse.flip":!1,"all.reverse.color":kq,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":l,"all.uv.offset":l,"all.uv.scale":l,"all.discard.selectable":!0,mat:l,"left.mat":l,"right.mat":l,"top.mat":l,"bottom.mat":l,"front.mat":l,"back.mat":l},!0);var uo,Em=!1,$i=[0,0,0,0],Uf={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:nh,2:lp,3:mj,4:Sh,5:Ak,6:ii}},Pf=function(d,m,J,n){if(m.getFaceVisible(d,J)){zd(m,or(d,m.getFaceMat(d,J)||m.getMat(d)));var M=m._26I;m.getFaceReverseCull(d,J)?M.enable(M.CULL_FACE):M.disable(M.CULL_FACE),vm(M,m._prg.uFixPickReverseColor,Uf[J]),os(M),bm(M,n,6),lj(M),Wb(m)}},Or=function(Q){return Q instanceof ah},ch=function(n){return[n.x,n.e||0,n.y]},Wc=function(H,$,f){for(var $=Rm($),u=$[0],R=$[1],o=$[2];f--;)H.push(u,R,o)},Af=function(q,N,X){for(var N=Rm(N),z=N[0],F=N[1],g=N[2],J=N[3];X--;)q.push(z,F,g,J)},fg=function(M,m,_){if(m)for(var i,$,f,H=m[0],w=m[1],r=m[2],a=m[4],s=m[5],u=m[6],p=m[8],o=m[9],q=m[10],g=m[12],k=m[13],G=m[14],c=_.length,U=0,U=0;c>U;U+=3)i=_[U],$=_[U+1],f=_[U+2],M.push(H*i+a*$+p*f+g,w*i+s*$+o*f+k,r*i+u*$+q*f+G);else hn(M,_)},Lj=function(Z,Y){var e=Y.s("light.intensity"),S=Rm(Y.s(jr)),G=S[0],z=S[1],q=S[2];1!==e&&(G*=e,z*=e,q*=e),Z.push(G,z,q,Y.s("light.disabled")?1:0)},Yk=function(K,k,A){vm(k,A.uHeadlightRange,K._headlightRange);var Y=K._headlightIntensity,g=Rm(K._headlightColor);1!==Y&&(g=[g[0]*Y,g[1]*Y,g[2]*Y]),vm(k,A.uHeadlightColor,[g[0],g[1],g[2],K._headlightDisabled?1:0]);var m=K._59O,d=K._spots,l=K._dirs;if(m.length){var j=[],v=[],i=[];m.forEach(function(C){Lj(j,C),hn(v,K._transformPointToViewSpace(C.p3())),i.push(C.s("light.range"))}),k.uniform4fv(A.uPointColor,j),k.uniform1fv(A.uPointRange,i),k.uniform3fv(A.uPointPosition,v)}if(d.length){var q=[],t=[],H=[],P=[],S=[],I=[];d.forEach(function(c){Lj(q,c),hn(t,K._transformPointToViewSpace(c.p3())),hn(S,K._transformDirectionToViewSpace(c.p3(),c.s("light.center"))),H.push(c.s("light.range")),P.push(z(c.s("light.angle")/2)),I.push(c.s("light.exponent"))}),k.uniform4fv(A.uSpotColor,q),k.uniform1fv(A.uSpotRange,H),k.uniform1fv(A.uSpotAngle,P),k.uniform1fv(A.uSpotExponent,I),k.uniform3fv(A.uSpotPosition,t),k.uniform3fv(A.uSpotDirection,S)}if(l.length){var X=[],h=[];l.forEach(function(d){Lj(X,d),hn(h,K._transformDirectionToViewSpace(d.p3()))}),k.uniform4fv(A.uDirColor,X),k.uniform3fv(A.uDirDirection,h)}},Vi=function(n){return n>0&&0===(n-1&n)},mq=function(S){return S=m(0,M(b,S)),S=m(As,M(b-As,S))},mm=function(){return.05+J()/2},op=function(C,A,X,N){var c,o=C.getEye();return C.isOrtho()?(c=Fn(C.getCenter(),o),c[0]+=N[0],c[1]+=N[1],c[2]+=N[2]):c=o,Ji(A,X,N,c)},Ji=function(b,q,U,R){var $=Mr(b,q),l=Fn(R,U,!0),s=Mr(l,q);if(r(s)<As)return h;var t=($-Mr(U,q))/s;return[U[0]+l[0]*t,U[1]+l[1]*t,U[2]+l[2]*t]},Qg=function(c,p){return{x:2*c.x-p.x,y:2*c.y-p.y}},Cf=function(t,R,n,f){var O,s;if(!t)return O=i(R.y-n.y,n.x-R.x),{x:R.x+f*K(O),y:R.y+f*z(O)};if(!n)return O=i(t.y-R.y,R.x-t.x),{x:R.x+f*K(O),y:R.y+f*z(O)};var N=Fn([t.x,t.y,0],[R.x,R.y,0],!0),r=Fn([n.x,n.y,0],[R.x,R.y,0],!0),g=-(N[0]+r[0])/2,I=-(N[1]+r[1])/2,C=W(g*g+I*I);if(As>C)return O=i(t.y-R.y,R.x-t.x),{x:R.x+f*K(O),y:R.y+f*z(O)};var e=t.x-R.x,X=t.y-R.y,V=n.x-R.x,B=n.y-R.y,M=W(e*e+X*X),o=W(V*V+B*B);O=H(Mr(N,r))/2,s=N[1]*r[0]-N[0]*r[1]>0?-1:1,g/=C,I/=C;var j=f/K(O),T=m(M,o)/z(O);C=Math.min(j,T);var $={x:R.x+s*C*g,y:R.y+s*C*I};return n.b&&j>o/z(O)&&($.adjust=!0),$},Si=function(P){var r=P[1],J=P[2],K=P[3],q=P[6],M=P[7],O=P[11];P[1]=P[4],P[2]=P[8],P[3]=P[12],P[4]=r,P[6]=P[9],P[7]=P[13],P[8]=J,P[9]=q,P[11]=P[14],P[12]=K,P[13]=M,P[14]=O},Gn=function(P){var Y=P[0],x=P[1],k=P[2],B=P[3],s=P[4],K=P[5],M=P[6],A=P[7],I=P[8],i=P[9],F=P[10],b=P[11],C=P[12],O=P[13],u=P[14],t=P[15],c=Y*K-x*s,Q=Y*M-k*s,r=Y*A-B*s,G=x*M-k*K,z=x*A-B*K,p=k*A-B*M,m=I*O-i*C,$=I*u-F*C,J=I*t-b*C,d=i*u-F*O,o=i*t-b*O,g=F*t-b*u,X=c*g-Q*o+r*d+G*J-z*$+p*m;return X?(X=1/X,P[0]=(K*g-M*o+A*d)*X,P[1]=(k*o-x*g-B*d)*X,P[2]=(O*p-u*z+t*G)*X,P[3]=(F*z-i*p-b*G)*X,P[4]=(M*J-s*g-A*$)*X,P[5]=(Y*g-k*J+B*$)*X,P[6]=(u*r-C*p-t*Q)*X,P[7]=(I*p-F*r+b*Q)*X,P[8]=(s*o-K*J+A*m)*X,P[9]=(x*J-Y*o-B*m)*X,P[10]=(C*z-O*r+t*c)*X,P[11]=(i*r-I*z-b*c)*X,P[12]=(K*$-s*d-M*m)*X,P[13]=(Y*d-x*$+k*m)*X,P[14]=(O*Q-C*G-u*c)*X,P[15]=(I*G-i*Q+F*c)*X,void 0):h},pe=function(M,x){if(x){var w=x[0],y=x[1],e=x[2];M[12]=M[0]*w+M[4]*y+M[8]*e+M[12],M[13]=M[1]*w+M[5]*y+M[9]*e+M[13],M[14]=M[2]*w+M[6]*y+M[10]*e+M[14],M[15]=M[3]*w+M[7]*y+M[11]*e+M[15]}},Mk=function(p,J){if(J){var U=J[0],i=J[1],L=J[2];p[0]=p[0]*U,p[1]=p[1]*U,p[2]=p[2]*U,p[3]=p[3]*U,p[4]=p[4]*i,p[5]=p[5]*i,p[6]=p[6]*i,p[7]=p[7]*i,p[8]=p[8]*L,p[9]=p[9]*L,p[10]=p[10]*L,p[11]=p[11]*L}},Me=function(R,k,e){var T=k[0],H=k[1],P=k[2],l=k[3],r=k[4],f=k[5],K=k[6],b=k[7],y=k[8],g=k[9],A=k[10],h=k[11],v=k[12],Y=k[13],$=k[14],E=k[15],i=e[0],O=e[1],V=e[2],Z=e[3];return R[0]=i*T+O*r+V*y+Z*v,R[1]=i*H+O*f+V*g+Z*Y,R[2]=i*P+O*K+V*A+Z*$,R[3]=i*l+O*b+V*h+Z*E,i=e[4],O=e[5],V=e[6],Z=e[7],R[4]=i*T+O*r+V*y+Z*v,R[5]=i*H+O*f+V*g+Z*Y,R[6]=i*P+O*K+V*A+Z*$,R[7]=i*l+O*b+V*h+Z*E,i=e[8],O=e[9],V=e[10],Z=e[11],R[8]=i*T+O*r+V*y+Z*v,R[9]=i*H+O*f+V*g+Z*Y,R[10]=i*P+O*K+V*A+Z*$,R[11]=i*l+O*b+V*h+Z*E,i=e[12],O=e[13],V=e[14],Z=e[15],R[12]=i*T+O*r+V*y+Z*v,R[13]=i*H+O*f+V*g+Z*Y,R[14]=i*P+O*K+V*A+Z*$,R[15]=i*l+O*b+V*h+Z*E,R},Cd=function(O,p,m,e){var a,x,F,Y,N,j,H,s,n,X,D=p[0],$=p[1],u=p[2],Q=e[0],I=e[1],i=e[2],t=m[0],o=m[1],_=m[2];return r(D-t)<As&&r($-o)<As&&r(u-_)<As?Jj(O):(H=D-t,s=$-o,n=u-_,X=1/W(H*H+s*s+n*n),H*=X,s*=X,n*=X,a=I*n-i*s,x=i*H-Q*n,F=Q*s-I*H,X=W(a*a+x*x+F*F),X?(X=1/X,a*=X,x*=X,F*=X):(a=0,x=0,F=0),Y=s*F-n*x,N=n*a-H*F,j=H*x-s*a,X=W(Y*Y+N*N+j*j),X?(X=1/X,Y*=X,N*=X,j*=X):(Y=0,N=0,j=0),O[0]=a,O[1]=Y,O[2]=H,O[3]=0,O[4]=x,O[5]=N,O[6]=s,O[7]=0,O[8]=F,O[9]=j,O[10]=n,O[11]=0,O[12]=-(a*D+x*$+F*u),O[13]=-(Y*D+N*$+j*u),O[14]=-(H*D+s*$+n*u),O[15]=1,O)},xf=function(h,D,C,m,K){var s=1/a(D/2),W=1/(m-K);return h[0]=s/C,h[1]=0,h[2]=0,h[3]=0,h[4]=0,h[5]=s,h[6]=0,h[7]=0,h[8]=0,h[9]=0,h[10]=(K+m)*W,h[11]=-1,h[12]=0,h[13]=0,h[14]=2*K*m*W,h[15]=0,h},bb=function(z,O,t,W,F,J,n){var d=1/(O-t),j=1/(W-F),v=1/(J-n);return z[0]=-2*d,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=-2*j,z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[10]=2*v,z[11]=0,z[12]=(O+t)*d,z[13]=(F+W)*j,z[14]=(n+J)*v,z[15]=1,z},Do=function(a,A){var i=A[0],$=A[1],c=A[2],Y=A[3],M=i*i+$*$+c*c+Y*Y,P=M?1/M:0;return a[0]=-i*P,a[1]=-$*P,a[2]=-c*P,a[3]=Y*P,a},Yl=function(G,o){var U=o[0]+o[5]+o[10],j=0;return U>0?(j=2*Math.sqrt(U+1),G[3]=.25*j,G[0]=(o[6]-o[9])/j,G[1]=(o[8]-o[2])/j,G[2]=(o[1]-o[4])/j):o[0]>o[5]&o[0]>o[10]?(j=2*Math.sqrt(1+o[0]-o[5]-o[10]),G[3]=(o[6]-o[9])/j,G[0]=.25*j,G[1]=(o[1]+o[4])/j,G[2]=(o[8]+o[2])/j):o[5]>o[10]?(j=2*Math.sqrt(1+o[5]-o[0]-o[10]),G[3]=(o[8]-o[2])/j,G[0]=(o[1]+o[4])/j,G[1]=.25*j,G[2]=(o[6]+o[9])/j):(j=2*Math.sqrt(1+o[10]-o[0]-o[5]),G[3]=(o[1]-o[4])/j,G[0]=(o[8]+o[2])/j,G[1]=(o[6]+o[9])/j,G[2]=.25*j),G},Zj=function(A,t,e){var F=t[0],Z=t[1],c=t[2],i=t[3],_=F+F,E=Z+Z,M=c+c,w=F*_,n=F*E,$=F*M,k=Z*E,j=Z*M,s=c*M,J=i*_,Y=i*E,I=i*M;return A[0]=1-(k+s),A[1]=n+I,A[2]=$-Y,A[3]=0,A[4]=n-I,A[5]=1-(w+s),A[6]=j+J,A[7]=0,A[8]=$+Y,A[9]=j-J,A[10]=1-(w+k),A[11]=0,A[12]=e[0],A[13]=e[1],A[14]=e[2],A[15]=1,A},Bo=function(){var L=[0,0,0],T=[0,0,0],v=[0,0,0],b=function(V,b,D){V[0]=b[1]*D[2]-b[2]*D[1],V[1]=b[2]*D[0]-b[0]*D[2],V[2]=b[0]*D[1]-b[1]*D[0]},d=function(q){return q[0]*q[0]+q[1]*q[1]+q[2]*q[2]},G=function(C){var i=Math.sqrt(d(C));C[0]/=i,C[1]/=i,C[2]/=i},x=function(K,N,d){K[0]=N[0]-d[0],K[1]=N[1]-d[1],K[2]=N[2]-d[2]};return function(H,z,P){var h=Jr();return x(v,H,z),0===d(v)&&(v[2]=1),G(v),b(L,P,v),0===d(L)&&(1===Math.abs(P[2])?v[0]+=1e-4:v[2]+=1e-4,G(v),b(L,P,v)),G(L),b(T,v,L),h[0]=L[0],h[4]=T[0],h[8]=v[0],h[1]=L[1],h[5]=T[1],h[9]=v[1],h[2]=L[2],h[6]=T[2],h[10]=v[2],h}}(),Hj=function(o,Z){if(o.vr.enable){var Y=o.vr.getViewMatrix(Z);if(Y)return Y}return Cd(Z?Z:Jr(),o._eye,o._center,o._up)},Se=function(B){if(B.vr.enable){var O=B.vr.getProjectMatrix();if(O)return O}var L=B.getAspect(),e=B._near,p=B._far,q=Jr();if(B._ortho){var M=B._orthoWidth/2,Q=M/L;bb(q,-M,M,-Q,Q,e,p)}else xf(q,B._fovy,L,e,p);return q},vp=function(E,c){if(!E)return h;var X=0,i=1,Z=2,x=[],C=0,a=E.length,T=a/3;if(c){for(;a>C;C++)x[C]=0;for(C=0;C<c.length;C+=3){var Q=[],t=[],R=[];Q[X]=E[3*c[C+1]+X]-E[3*c[C]+X],Q[i]=E[3*c[C+1]+i]-E[3*c[C]+i],Q[Z]=E[3*c[C+1]+Z]-E[3*c[C]+Z],t[X]=E[3*c[C+2]+X]-E[3*c[C+1]+X],t[i]=E[3*c[C+2]+i]-E[3*c[C+1]+i],t[Z]=E[3*c[C+2]+Z]-E[3*c[C+1]+Z],R[X]=Q[i]*t[Z]-Q[Z]*t[i],R[i]=Q[Z]*t[X]-Q[X]*t[Z],R[Z]=Q[X]*t[i]-Q[i]*t[X];for(var n=0;3>n;n++)x[3*c[C+n]+X]+=R[X],x[3*c[C+n]+i]+=R[i],x[3*c[C+n]+Z]+=R[Z]}}else for(C=0;T>C;C+=3){var Q=[],t=[],R=[];Q[X]=E[3*(C+1)+X]-E[3*C+X],Q[i]=E[3*(C+1)+i]-E[3*C+i],Q[Z]=E[3*(C+1)+Z]-E[3*C+Z],t[X]=E[3*(C+2)+X]-E[3*(C+1)+X],t[i]=E[3*(C+2)+i]-E[3*(C+1)+i],t[Z]=E[3*(C+2)+Z]-E[3*(C+1)+Z],R[X]=Q[i]*t[Z]-Q[Z]*t[i],R[i]=Q[Z]*t[X]-Q[X]*t[Z],R[Z]=Q[X]*t[i]-Q[i]*t[X];for(var n=0;3>n;n++)x[3*(C+n)+X]=R[X],x[3*(C+n)+i]=R[i],x[3*(C+n)+Z]=R[Z]}for(C=0;a>C;C+=3){var A=[];A[X]=x[C+X],A[i]=x[C+i],A[Z]=x[C+Z];var U=W(A[X]*A[X]+A[i]*A[i]+A[Z]*A[Z]);0===U&&(U=As),A[X]=A[X]/U,A[i]=A[i]/U,A[Z]=A[Z]/U,x[C+X]=A[X],x[C+i]=A[i],x[C+Z]=A[Z]}return new es(x)},ms=function(D,$,K,k){if(K||(K=D.createTexture()),$){var g=D.TEXTURE_2D,P=D.REPEAT,G=D.CLAMP_TO_EDGE,A=D.TEXTURE_MIN_FILTER;k!==D.NEAREST&&(k=D.LINEAR),yf(D,K),D.texImage2D(g,0,D.RGBA,D.RGBA,D.UNSIGNED_BYTE,$),Jk(D,D.TEXTURE_MAG_FILTER,k);var U=$.naturalWidth||$.width,t=$.naturalHeight||$.height;Vi(U)&&Vi(t)&&!$.clampToEdge?(Jk(D,D.TEXTURE_WRAP_S,P),Jk(D,D.TEXTURE_WRAP_T,P),Jk(D,A,D.LINEAR_MIPMAP_LINEAR),D.generateMipmap(g)):(Jk(D,D.TEXTURE_WRAP_S,G),Jk(D,D.TEXTURE_WRAP_T,G),Jk(D,A,k)),yf(D,h)}return K},tb=function(x,o){var S=new Uint8Array(4);return o=o||x.createTexture(),yf(x,o),Jk(x,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texImage2D(x.TEXTURE_2D,0,x.RGBA,1,1,0,x.RGBA,x.UNSIGNED_BYTE,S),o},Vo=function(V){V._26I&&V._prg&&(V._26I.deleteProgram(V._prg),V._prg=h)},gc=function(L,z,d,P){var r=L.createShader(d);return L.shaderSource(r,P),L.compileShader(r),L.attachShader(z,r),r},qp=function(p){return p.createBuffer()},yf=function(F,O){F.bindTexture(F.TEXTURE_2D,O)},Ue=function(n,T){n.frameStack?n.frameStack.push(T):n.frameStack=[T],n.bindFramebuffer(n.FRAMEBUFFER,T)},$q=function(D){var b=D.frameStack;if(b){if(b.pop(),b.length)return D.bindFramebuffer(D.FRAMEBUFFER,b[b.length-1]),void 0;D.frameStack=null}D.bindFramebuffer(D.FRAMEBUFFER,null)},Jk=function(l,N,V){l.texParameteri(l.TEXTURE_2D,N,V)},mg=function(m,h){m.enable(m.POLYGON_OFFSET_FILL),m.polygonOffset(h[0],h[1])},el=function(o){o.disable(o.POLYGON_OFFSET_FILL)},Sg=function(J,i){if(i){var i=Rm(i);J.clearColor(i[0],i[1],i[2],i[3])}},Kk=function(J,r){vm(J,r.uFix,!0),an(J,r.aNormal)},Pr=function(B,g){vm(B,g.uFix,!1),Rr(B,g.aNormal)},jq=function(s,b,S,x,I,e,J,v){s._picking||(S?(vm(s,b.uBlend,!0),vm(s,b.uBlendColor,S)):vm(s,b.uBlend,!1),vm(s,b.uLight,x==h?!0:x),cg(I)&&1!==I&&vm(s,b.uPartOpacity,I),vm(s,b.uReverseFlip,e==h?!1:e),vm(s,b.uFixPickReverseColor,J||kq)),v?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE)},se=function(R,i){R._picking||vm(R,i.uPartOpacity,1)},os=function(){var G=[0,0,1,1];return function(Z,o,S,N,L,Q,v,i,H){return S?(vm(Z,o.uTexture,!0),vm(Z,o.uDiscardSelectable,Yg(N)?N:!0),Rr(Z,o.aUv),Xn(Z,L,Q,o.aUv,2),H?(vm(Z,o.uBlendTexture,!0),Z.activeTexture(Z.TEXTURE1),yf(Z,H),Z.uniform1i(o.uBlendSampler,1)):(vm(Z,o.uBlendTexture,!1),Z.activeTexture(Z.TEXTURE1),yf(Z,Z._emptyBlendTexture)),Z.activeTexture(Z.TEXTURE0),yf(Z,S),Z.uniform1i(o.uSampler,0),v?(G[0]=v[0],G[1]=v[1]):(G[0]=0,G[1]=0),i?(G[2]=i[0],G[3]=i[1]):(G[2]=1,G[3]=1),vm(Z,o.uOffsetScale,G),void 0):(Z.activeTexture(Z.TEXTURE0),yf(Z,Z._emptyTexture),Z.activeTexture(Z.TEXTURE1),yf(Z,Z._emptyBlendTexture),void 0)}}(),lj=function(F,u,f){F.activeTexture(F.TEXTURE0),yf(F,h),F.activeTexture(F.TEXTURE1),yf(F,h),f&&(an(F,u.aUv),vm(F,u.uTexture,!1),vm(F,u.uBlendTexture,!1))},Wq=function(r,T,z,p,j,y){!z||e||wm||r.lineWidth(z),p&&!r._picking&&vm(r,T.uFixPickReverseColor,p),j&&Xn(r,j,y,T.aPosition)},jm=function(C,D,c,G){uo&&(G=C[uo]),C.drawArrays(G==h?C.TRIANGLES:G,D,c);var X=C._renderInfo;X&&(X.calls++,X.vertices+=c,(G==h||G===C.TRIANGLES)&&(X.faces+=c/3),G===C.LINES&&(X.lines+=c/2))},bm=function(V,J,z,I){uo&&(I=V[uo]),V.drawElements(I==h?V.TRIANGLES:I,z,V.UNSIGNED_SHORT,J==h?0:2*J);var W=V._renderInfo;W&&(W.calls++,W.vertices+=z,(I==h||I===V.TRIANGLES)&&(W.faces+=z/3),I===V.LINES&&(W.lines+=z/2))},Hf=function(E,p,A,e,O){var t=E.ARRAY_BUFFER;E.bindBuffer(t,p),A&&E.bufferData(t,A,E.STATIC_DRAW),e!=h&&E.vertexAttribPointer(e,O?O:3,E.FLOAT,!1,0,0)},Xn=function(Q,t,N,g,T){return N?(np(Q,Q.ARRAY_BUFFER,t,N),g!=h&&Q.vertexAttribPointer(g,T?T:3,Q.FLOAT,!1,0,0),void 0):Hf(Q,t,N,g,T)},fl=function(e,u,M){var K=e.ELEMENT_ARRAY_BUFFER;e.bindBuffer(K,u),M&&e.bufferData(K,M,e.STATIC_DRAW)},qb=function(w,J,L){np(w,w.ELEMENT_ARRAY_BUFFER,J,L)},np=function(c,F,q,r){var H=r._bufId;H||(H=r._bufId=u.Math.generateIncreasingID());var q,i=c._bufPool;(q=i[H])&&q._buf?c.bindBuffer(F,q._buf):(q=i[H]={_buf:qp(c)},c.bindBuffer(F,q._buf),c.bufferData(F,r,c.STATIC_DRAW)),q._fid=c._renderInfo.frame},vm=function(F,H,C){if(C!=h&&H!=h){C=Rm(C);var u=C.length;3===u?F.uniform3fv(H,C):4===u?F.uniform4fv(H,C):16===u?F.uniformMatrix4fv(H,!1,C):Yg(C)?F.uniform1i(H,C?1:0):2===u?F.uniform2fv(H,C):F.uniform1f(H,C)}},Rr=function(c,M){M!=h&&M>=0&&c.enableVertexAttribArray(M)},an=function(A,P){P!=h&&P>=0&&A.disableVertexAttribArray(P)},Wb=function(a,r){var E=a.getGL(),G=a._prg;a._7O=a._8O.pop(),r&&(vm(E,G.uMVMatrix,a._7O),a._6O=r,vm(E,G.uNMatrix,r))},aq=function(F,W){return W||(W=Jr()),Fj(W,F),Gn(W),Si(W),W},zd=function(K,i){var G=K.getGL(),S=K._prg,R=K._7O;i&&(K._8O.push(Xg(R)),vm(G,S.uMMatrix,i),Me(R,R,i),K._7O=R),vm(G,S.uMVMatrix,R),vm(G,S.uNMatrix,aq(R,K._6O))},Uo=function(Q,i,H,X,b,O){if(H){if(X){var r=H.value++,q=2147483648|r,C=[(255&q>>16)/255,(255&q>>8)/255,(255&q)/255,(255&q>>24)/255];H[r]={data:b,part:O}}else C=$i;return vm(Q,i.uFixPickReverseColor,C),C}},vl=function(){var r={center:function(S,q,h,G,n){var Q=-q[1]/2,X={x:-q[0]/2,y:Q,width:q[0],height:q[1]},u=hm(S,X,h);return[u.x+G,-u.y-n,mm()]},front:function(x,H,M,c,C){var q=-H[1]/2,U={x:-H[0]/2,y:q,width:H[0],height:H[1]},r=hm(x,U,M);return[r.x+c,-r.y-C,H[2]/2+mm()]},back:function(a,U,B,y,A){var K=-U[0]/2,F=-U[1]/2,t={x:K,y:F,width:U[0],height:U[1]},J=hm(a,t,B);return[-J.x-y,-J.y-A,-U[2]/2-mm()]},left:function(r,m,$,Z,y){var B=-m[1]/2,b={x:-m[2]/2,y:B,width:m[2],height:m[1]},L=hm(r,b,$);return[-m[0]/2-mm(),-L.y-y,L.x+Z]},right:function(_,U,A,L,E){var I=-U[2]/2,q=-U[1]/2,y={x:I,y:q,width:U[2],height:U[1]},S=hm(_,y,A);return[U[0]/2+mm(),-S.y-E,-S.x-L]},top:function(Q,c,f,j,O){var z={x:-c[0]/2,y:-c[2]/2,width:c[0],height:c[2]},C=hm(Q,z,f);return[C.x+j,c[1]/2+mm(),C.y+O]},bottom:function(U,z,y,O,g){var o=-z[2]/2,X={x:-z[0]/2,y:o,width:z[0],height:z[2]},W=hm(U,X,y);return[W.x+O,-z[1]/2-mm(),-W.y-g]}};return function(v,B,O,p,k,z){return r[p](v,B,O,k||0,z||0)}}(),gj=function(Y,U,P,B,O,A,I,V,_,v){if(O&&(U[0]+=O[0],U[1]+=O[1],U[2]+=O[2]),pe(Y,P),V){var Z=Jr();if(Ij(Z,_,v),ho(U,Z),pe(Y,U),Y.auto=V,Y.pos=ho([0,0,0],Y),A){var l=Y.mat2=Jr();Ij(l,A,I)}}else Ij(Y,_,v),pe(Y,U),B===nh?ed(Y,-g):B===lp?ed(Y,g):B===mj?mn(Y,-g):B===Sh?mn(Y,g):B===ii&&ed(Y,b),Ij(Y,A,I);return Y},ks=function(Z,V){var L=V.auto,t=V.mat2,l=Z.gv;if(L){var U,O=Jr(),P=[0,0,0,0];U="string"==typeof L?[L.indexOf("x")<0?l._eye[0]:l._center[0],L.indexOf("y")<0?l._eye[1]:l._center[1],L.indexOf("z")<0?l._eye[2]:l._center[2]]:l._eye,Yl(P,Cd(Jr(),U,l._center,l._up)),Zj(O,Do(P,P),V.pos),t&&Me(O,O,t),zd(l,O)}else zd(l,V)},ri=function(t,r,s,a,Z){var m=t.s,w=t.gv,i=w.getGL(),J=w._prg,l=w._buffer,p=w._1O;ms(i,wo,p),ks(t,s),jq(i,J,m(r+".blend"),m(r+".light"),m(r+".opacity"),m(r+".reverse.flip"),m(r+".reverse.color"),m(r+".reverse.cull")),os(i,J,p,Z,l.uv,Qk),Xn(i,l.vs,a,J.aPosition),Xn(i,l.ns,rk,J.aNormal),qb(i,l.is,Cm),bm(i,0,Cm.length),lj(i,J,p),se(i,J),Wb(w)},hs=function(B,G,Z){var W=B.gv,j=B.data,_=B[G]={blend:W.getBodyColor(j)||W.getFaceBlend(j,G),light:W.getFaceLight(j,G),color:W.getFaceColor(j,G),opacity:W.getFaceOpacity(j,G),transparent:W.getFaceTransparent(j,G),reverseFlip:W.getFaceReverseFlip(j,G),reverseColor:W.getFaceReverseColor(j,G),reverseCull:W.getFaceReverseCull(j,G),texture:W.getFaceImage(j,G),blendTexture:W.getFaceBlendImage(j,G),discardSelectable:W.getFaceDiscardSelectable(j,G)};if("csg"!==G){_.uv=W.getFaceUv(j,G)||Z&&Z[G+"Uv"],_.uvScale=W.getFaceUvScale(j,G)||Z&&Z[G+"UvScale"],_.uvOffset=W.getFaceUvOffset(j,G)||Z&&Z[G+"UvOffset"];var P=W.getFaceMat(j,G);P&&(_.mat=or(j,P))}return _},Ud=function(P,M,N,b,W){if(b){if(!W(b.transparent))return;var Y=P.data,K=P.gv,l=K._buffer,H=K.getTexture(b.texture,Y),X=K.getTexture(b.blendTexture,Y);os(M,N,H,b.discardSelectable,l.uv,b.tuv,b.uvOffset,b.uvScale,X),jq(M,N,b.blend,b.light,b.opacity,b.reverseFlip,b.reverseColor,b.reverseCull),vm(M,N.uDiffuse,b.color||O["color.empty"]),Xn(M,l.vs,b.vs,N.aPosition),Xn(M,l.ns,b.ns,N.aNormal),jm(M,0,b.vs.length/3),se(M,N),lj(M,N,H)}},Vk=function(i,_,z,s,J,P){var c,F,m,M,S,X,R,x,v,h,D,e=[s-_,J-z],C=i?i.length:0;for(m=0;C>m;m++){for(M=2,c=i[m],S=c[0],X=c[1];M+1<c.length;){if(R=c[M],x=c[M+1],F=Ee(_,z,s,J,S,X,R,x,!0)){v=[R-S,x-X],h=Im(v),v[0]/=h,v[1]/=h,h=Mr(e,v),h=h>0?P:-P,D=[v[0]*h,v[1]*h];break}S=R,X=x,M+=2}if(D)break}if(D)for(s=_+D[0],J=z+D[1],m=0;C>m;m++)for(M=2,c=i[m],S=c[0],X=c[1];M+1<c.length;){if(R=c[M],x=c[M+1],F=Ee(_,z,s,J,S,X,R,x,!0))return[0,0];S=R,X=x,M+=2}return D?D:[s-_,J-z]},Lg=u.graph3d={},_i=function(P,g,c){Wh(s+".graph3d."+P,g,c)},ag="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",gp="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";
No(C,{setBatchInfo:function(E,J){zc[E]=J},getBatchInfo:function(d){return zc[d]}},!0);var vn=[1,1,1],kr=[1,0,0,0,0,1,0,1,1,1,1,0],Co=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],bk=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],uk=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Wl=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],Nd=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Md=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],Um=function(p,U){Bg(p,U,"_batchModelMap","_batchIndexMap"),yb(p,U,"_wireframeModelMap","_wireframeIndexMap"),yb(p,U,"_polylineModelMap","_polylineIndexMap"),yb(p,U,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),yb(p,U,"_polylineModelMapSwap","_polylineIndexMapSwap")},Bg=function(B,q,e,F){if(!q)return B[e]={},B[F]={},void 0;var s=q._id,Z=B[F],L=Z[s];if(L){var V=B[e],f=L.batch,x=V[f],N=x.ds,p=L.index;if(x.invalidate=!0,delete Z[s],N.splice(p,1),Qq(N))return delete V[f],void 0;for(var Y=L.begin,j=L.size,u=3*Y,m=3*j,R=4*Y,E=4*j,d=x.vs,X=x.ps,z=x.uv,D=x.cs,O=x.bs,T=x.rs,I=x.ns,W=x.ls;p<N.length;p++)L=Z[N[p]._id],L.index--,L.begin-=j;d.splice(u,m),X.splice(R,E),z&&z.splice(2*Y,2*j),D&&D.splice(R,E),O&&O.splice(u,m),T&&T.splice(Y,j),I&&I.splice(u,m),W&&W.splice(Y,j)}},yb=Bg,fq=function(n,W,O,M){if(!M)return h;var N=W[M];if(!N){var l=zc[M]||Ln,I=l.image?[]:h;N=W[M]={vs:[],ns:[],uv:I,cs:I?h:l.color?h:[],bs:l.blend?[]:h,ps:[],rs:l.brightness?[]:h,ds:[]}}return N.invalidate=!0,n[O._id]={index:N.ds.length,begin:N.vs.length/3,batch:M},N.ds.push(O),N},lc=function(m,P){return P!=h&&1!==P?[m[0]*P,m[1]*P,m[2]*P,m[3]]:m},pn=function(i,j,d){var Q=i.getBrightness(j),N=Rm(d.color||"white"),_=N[3]<1,X=Math.ceil(d.width)||1,U=(_?"T":"O")+X,M=i._wireframeIndexMap,z=i._wireframeModelMap,G=z[U];G||(G=z[U]={vs:[],cs:[],ps:[],ds:[],T:_,W:X});var f,Z=i.getData3dUI(j),b=_n(Z);if(d.geometry){if(!b)return;if(f=Fl(b),!f)return}else f=d.short?go:Ac;G.invalidate=!0;var P=G.vs,L=G.cs,u=G.ds,w=M[j._id]={index:u.length,begin:P.length/3,batch:U};u.push(j);var E=or(j,d.mat),A=Z._calcAnchorMat(j);A&&Me(E,E,A),fg(P,E,f);var x=w.size=P.length/3-w.begin;Af(L,lc(N,Q),x)},Vp=function(P,o,r,J,b,A,i,k,C){var G=P.getBrightness(o);G==h&&(G=1);var u=lc(Rm(J),G),X=u[3]<1;A=Math.ceil(A)||1;var F=(X?"T":"O")+A;if(i){var w=i[0],U=(i[1]||w)+w;F+="-"+w+"-"+U,C&&(F+="-"+vi(C)+"-"+G,C=lc(Rm(C),G))}var d=P._polylineIndexMap,W=P._polylineModelMap,Z=W[F];Z||(Z=W[F]={vs:[],cs:[],ps:[],ds:[],ls:i?[]:h,T:X,W:A},i&&(Z.D=w,Z.G=U,Z.A=C)),Z.invalidate=!0;var _,H=Z.vs,s=Z.cs,e=Z.ds,q=Z.ls,I=d[o._id]={index:e.length,begin:H.length/3,batch:F};e.push(o),hn(H,r);var E,M=I.size=H.length/3-I.begin,Q=r.length,V=0,B=[];if(i||b)for(_=0;Q>_;_+=6)E=Im([r[_],r[_+1],r[_+2]],[r[_+3],r[_+4],r[_+5]]),B.push(E),V+=E;if(V&&b){var v,T=lc(Rm(b),G),R=[T[0]-u[0],T[1]-u[1],T[2]-u[2],T[3]-u[3]],y=0;for(_=0;Q>_;_+=6)v=y/V,Af(s,[u[0]+R[0]*v,u[1]+R[1]*v,u[2]+R[2]*v,u[3]+R[3]*v],1),y+=B[_/6],v=y/V,Af(s,[u[0]+R[0]*v,u[1]+R[1]*v,u[2]+R[2]*v,u[3]+R[3]*v],1)}else Af(s,u,M);if(i)for(y=k||0,_=0;Q>_;_+=6)q.push(y),y+=B[_/6],q.push(y)},Sn=function(x,b,o){if(b)for(var p=4*b.begin,S=o[b.batch].ps,O=0;O<b.size;O++)S[p++]=x[0],S[p++]=x[1],S[p++]=x[2],S[p++]=x[3]},Ap=function(I,H){var B=H+["32"],G=I[H],L=I[B];G?L&&L.length===G.length?(L.set(G),L._bufId=null):I[B]=new es(G):delete I[B]},In=function(O,L,w,q,$,C,n,I,l){if(wc(w))w.forEach(function(D){In(O,L,D,q,$,C,n,I,l)});else if(Tf(w))In(O,L,_n(q,w),q,$,C,n,I,l);else if(An(w)){var j,b=pf(w.mat,L,O),X=pf(w.s3,L,O),F=pf(w.t3,L,O),A=pf(w.r3,L,O);if((X||A||F||b)&&(j=Ed(b,X,A,pf(w.rotationMode,L,O),F),C.push(j)),w.shape3d)In(O,L,w.shape3d,q,$,C,n,I,w);else{var H=q.s;l=l||Ln;var r=C[0],h=C.length,V=H("shape3d.color",w.color,l.color);if($||($=H("shape3d.blend",w.blend,l.blend)),h>1){r=Xg(r);for(var p=1;h>p;p++)Me(r,r,C[p])}w.vs&&H(ki,w.visible,l.visible)&&Fp(r,n,I,w.vs,w.uv,w.is,$,V),w.top_vs&&H(Ug,w.topVisible,l.topVisible)&&Fp(r,n,I,w.top_vs,w.top_uv,w.top_is,$,H("shape3d.top.color",w.topColor,l.topColor)||V),w.bottom_vs&&H(li,w.bottomVisible,l.bottomVisible)&&Fp(r,n,I,w.bottom_vs,w.bottom_uv,w.bottom_is,$,H("shape3d.bottom.color",w.bottomColor,l.bottomColor)||V),w.from_vs&&H(ln,w.fromVisible,l.fromVisible)&&Fp(r,n,I,w.from_vs,w.from_uv,w.from_is,$,H("shape3d.from.color",w.fromColor,l.fromColor)||V),w.to_vs&&H(Mp,w.toVisible,l.toVisible)&&Fp(r,n,I,w.to_vs,w.to_uv,w.to_is,$,H("shape3d.to.color",w.toColor,l.toColor)||V)}j&&C.pop()}},Fp=function(l,L,r,d,f,g,A,b){var I,H=L.cs,N=L.uv,U=L.bs;if(g){I=g.length;for(var u=0;I>u;u++){var D=g[u];fg(r,l,[d[3*D],d[3*D+1],d[3*D+2]]),N&&hn(N,[f[2*D],f[2*D+1]])}}else I=d.length/3,fg(r,l,d),N&&hn(N,f);H&&Af(H,b,I),U&&(A?Wc(U,A,I):hn(U,vn,I))},mr=function(E,V,K,s){var T=[];s?In(E.gv,E.data,s,E,E.getBodyColor(),[V],K,T):(Qi(E,nh,V,K,T),Qi(E,lp,V,K,T),Qi(E,Ak,V,K,T),Qi(E,ii,V,K,T),Qi(E,mj,V,K,T),Qi(E,Sh,V,K,T),Qi(E,"csg",V,K,T)),T.length&&(hn(K.vs,T),hn(K.ns,vp(T)))},Qi=function(Y,F,f,r,A){var l=Y[F];if(l){var N=l.tuv;if(N){var O,M,g,i,s=l.uvScale,n=l.uvOffset;if(s)for(O=N.length,M=s[0],g=s[1],i=0;O>i;i+=2)N[i]*=M,N[i+1]*=g;if(n)for(O=N.length,M=n[0],g=n[1],i=0;O>i;i+=2)N[i]+=M,N[i+1]+=g}Fp(f,r,A,l.vs,N,h,l.blend,l.color)}},Lf=function(x,i,d,m,h,Q,L,U){var w,O=d.cs,K=d.uv,t=d.bs;if(x.getFaceVisible(i,Q)){var r=x.getFaceMat(i,Q);if(r&&(h=or(i,r)),fg(L,h,U),O&&Af(O,x.getFaceColor(i,Q),6),K){var s=x.getFaceUv(i,Q)||m[Q+"Uv"],$=x.getFaceUvScale(i,Q)||m[Q+"UvScale"],a=x.getFaceUvOffset(i,Q)||m[Q+"UvOffset"];s=s?[s[6],s[7],s[0],s[1],s[2],s[3],s[2],s[3],s[4],s[5],s[6],s[7]]:kr;var F=s[0],j=s[1],g=s[2],M=s[3],n=s[4],z=s[5],q=s[6],H=s[7],y=s[8],C=s[9],B=s[10],S=s[11];if($){var V=$[0],E=$[1];F*=V,j*=E,g*=V,M*=E,n*=V,z*=E,q*=V,H*=E,y*=V,C*=E,B*=V,S*=E}if(a){var X=a[0],e=a[1];F+=X,j+=e,g+=X,M+=e,n+=X,z+=e,q+=X,H+=e,y+=X,C+=e,B+=X,S+=e}K.push(F,j,g,M,n,z,q,H,y,C,B,S)}t&&(w=x.getBodyColor(i)||x.getFaceBlend(i,Q),w?Wc(t,w,6):hn(t,vn,6))}},Mg=function(p,y,Z,m){var n=p.getGL(),e=p._prg,t=p._buffer;if(!p.drawFilter&&!Xb(y)){zd(p),Kk(n,e);for(var X in y){var E=y[X];if(!(m&&!E.T||!m&&E.T)){E.invalidate?(E.invalidate=!1,Ap(E,"vs"),Ap(E,"cs"),Ap(E,"ls"),Ap(E,"ps")):Z&&Ap(E,"ps");var v=E.vs32,u=Z?E.ps32:E.cs32;Wq(n,e,E.W,h,t.vs,v);var b=E.D,d=!p._dashDisabled&&b;vm(n,e.uAlphaTest,O.alphaTest),d&&(vm(n,e.uDash,!0),vm(n,e.uDashDistance,b),vm(n,e.uDashGapDistance,E.G),Rr(n,e.aLineDistance),Xn(n,t.lineDistance,E.ls32,e.aLineDistance,1),vm(n,e.uDiffuse,E.A||O["color.empty"]));var J=!p._batchColorDisabled;J&&(vm(n,e.uBatchColor,!0),Rr(n,e.aBatchColor),Xn(n,t.batchColor,u,e.aBatchColor,4)),os(n),jm(n,0,v.length/3,n.LINES),lj(n),J&&(vm(n,e.uBatchColor,!1),an(n,e.aBatchColor)),d&&(vm(n,e.uDash,!1),an(n,e.aLineDistance))}}Pr(n,e)}},Km=function(m,T,Z){var W,c,Y,V,M,D,k,A,N,u,e,y=m.getGL(),I=m._prg,U=m._buffer,s=m._batchModelMap;if(!Xb(s)){zd(m);for(W in s)if(c=zc[W]||Ln,!(Z&&!c.transparent||!Z&&c.transparent)&&(Y=s[W],T||!c.transparentMask)){var r=Z&&c.autoSort!==!1&&(m._33Q||Y.invalidate);if(Y.invalidate?(Y.invalidate=!1,Ap(Y,"vs"),Ap(Y,"ns"),Ap(Y,"cs"),Ap(Y,"rs"),Ap(Y,"ps"),Ap(Y,"bs"),Ap(Y,"uv")):T&&Ap(Y,"ps"),M=Y.vs32,D=T?Y.ps32:Y.cs32,N=Y.uv32,k=Y.bs32,A=Y.rs32,e=M.length/3,r&&(Y.is=vq(M,m.getEye())),e){V=c.light,u=m.getTexture(c.image),jq(y,I,h,c.light,c.opacity,c.reverseFlip,c.reverseColor,c.reverseCull),D?m._batchColorDisabled||(vm(y,I.uBatchColor,!0),Rr(y,I.aBatchColor),Xn(y,U.batchColor,D,I.aBatchColor,4)):vm(y,I.uDiffuse,c.color||O["color.empty"]);var f=c.alphaTest;vm(y,I.uAlphaTest,f===l?O.alphaTest:f);var t=k&&!m._batchBlendDisabled;t&&(vm(y,I.uBatchBlend,!0),Rr(y,I.aBatchBlend),Xn(y,U.batchBlend,k,I.aBatchBlend));var H=A&&!m._batchBrightnessDisabled;H&&(vm(y,I.uBatchBrightness,!0),Rr(y,I.aBatchBrightness),Xn(y,U.batchBrightness,A,I.aBatchBrightness,1)),N?os(y,I,u,c.discardSelectable,U.uv,N,c.uvOffset,c.uvScale):os(y),Xn(y,U.vs,M,I.aPosition),Xn(y,U.ns,Y.ns32,I.aNormal),Y.is?(fl(y,U.is,Y.is),bm(y,0,e)):jm(y,0,e),N?lj(y,I,u):lj(y),D&&!m._batchColorDisabled&&(vm(y,I.uBatchColor,!1),an(y,I.aBatchColor)),t&&(vm(y,I.uBatchBlend,!1),an(y,I.aBatchBlend)),H&&(vm(y,I.uBatchBrightness,!1),an(y,I.aBatchBrightness)),se(y,I)}}}},vq=function(t,N){for(var h=t.length/3,u=new Array(h),m=h/3,v=new Array(m),T=0;m>T;T++)v[T]=T;v.sort(function(K,i){var Y=9*K,M=[(t[Y]+t[Y+3]+2*t[Y+6])/4,(t[Y+1]+t[Y+4]+2*t[Y+7])/4,(t[Y+2]+t[Y+5]+2*t[Y+8])/4];Y=9*i;var $=[(t[Y]+t[Y+3]+2*t[Y+6])/4,(t[Y+1]+t[Y+4]+2*t[Y+7])/4,(t[Y+2]+t[Y+5]+2*t[Y+8])/4],k=Im(N,M)-Im(N,$);return k>0?-1:0>k?1:0});for(var T=0;m>T;T++){var b=3*T,O=3*v[T];u[b]=O,u[b+1]=O+1,u[b+2]=O+2}return new Ff(u)},me={obj:function(b,H){var z={mat:b.mat,s3:b.s3,r3:b.r3,rotationMode:b.rotationMode,t3:b.t3,cube:b.cube==h?!0:b.cube,center:b.center==h?!0:b.center,ignoreMtls:b.ignoreMtls,ignoreTransparent:b.ignoreTransparent,ignoreColor:b.ignoreColor,ignoreImage:b.ignoreImage,ignoreNormal:b.ignoreNormal,prefix:b.prefix,flipY:b.flipY,flipFace:b.flipFace,reverseFlipMtls:b.reverseFlipMtls,finishFunc:function(T,u){if(T){var u=[];for(var w in T){var l=T[w];u.rawS3=l.rawS3,u.push(l),b.eachModel&&b.eachModel(w,l)}u.json=b,H(u)}else H()}};C.loadObj(b.obj,b.mtl,z)}};C.getModelTypeHandlers=function(){return me},C.setModelTypeHandler=function(b,O){me[b]=O},C.getModelTypeHandler=function(p){return me[p]},C.handleModelLoaded=function(){},C.handleUnfoundModel=function(){};var Vq=h,Gk=h,ul=function(K){Vq&&!K._loadingModelView_&&(Gk||(Gk={}),Gk[K._loadingModelView_=on()]=K)},Rp=function(k,U){Vq||(Vq={});var L=Vq[k];if(L){if(L.url===U)return;L.request.onload=fk,L.request.onerror=fk}var R=new xd;if(Vq[k]={request:R,url:U},U=C.beforeLoadURL(U),U.data){var X=C.parse(U.data);pc(k,X,U)}else{R.onload=function(c){if(200===this.status||0===this.status){delete Vq[k];var V=C.parse(c.target.response||c.target.responseText);pc(k,V,U)}else wr(k,C.handleUnfoundModel(k,U)||h)},R.onerror=function(){wr(k,C.handleUnfoundModel(k,U)||h)};var o={};o.url=encodeURI(U),o.sync=!1,R.send(o)}},pc=function(g,G,i){var c=G.modelType;if(!c)return wr(g,G),C.handleModelLoaded(g,G),void 0;var w=C.getModelTypeHandler(c);if(w){if(Vq||(Vq={}),Vq[g])return;Vq[g]=!0;var R=function(V){V?(wr(g,V),C.handleModelLoaded(g,V)):wr(g,C.handleUnfoundModel(g,i)||h)};w(G,R)}else wr(g,C.handleUnfoundModel(g,i)||h)},wr=function(u,c){if(oo[u]=c,delete Vq[u],Xb(Vq)&&(Vq=h,Gk)){for(var N in Gk){var K=Gk[N];K.invalidateAll&&K.invalidateAll(l,"modelLoaded",u),K.redraw&&K.redraw(),K.iv(),delete K._loadingModelView_}Gk=h}if(c&&Gk)for(var N in Gk){var K=Gk[N];K.invalidateAll&&K.invalidateAll(l,"modelLoading",u),K.redraw&&K.redraw(),K.iv()}},Qk=new es([0,0,0,1,1,1,1,0]),rk=new es([0,0,1,0,0,1,0,0,1,0,0,1]),Cm=new Ff([0,1,2,2,3,0]),yd=new es([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),ei=new Ff([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),zf=new es([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Ej=vp(yd,ei),Be=(new es([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Ff([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[nh,Ak,lp,ii,mj,Sh]),Ac=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],go=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],sq=function(L,E,H,y,X,f){f=f||16,L=L||16,E=E||0,H=H||L;var i,c,I,_,C,Q,G,Y,n=.5,J=[],v=[],U=x/L,A=b/f;for(i=0;f>i;i++)for(C=i+1,_=i*A,Y=C*A,c=E;H>c;c++)Q=c+1,I=c*U,G=Q*U,J.push(n*K(_)*z(I),n*z(_),-n*K(_)*K(I),n*K(Y)*z(G),n*z(Y),-n*K(Y)*K(G),n*K(_)*z(G),n*z(_),-n*K(_)*K(G),n*K(_)*z(I),n*z(_),-n*K(_)*K(I),n*K(Y)*z(I),n*z(Y),-n*K(Y)*K(I),n*K(Y)*z(G),n*z(Y),-n*K(Y)*K(G)),v.push(c/L,i/f,Q/L,C/f,Q/L,i/f,c/L,i/f,c/L,C/f,Q/L,C/f);if(y){var e=[],S=[];for(I=E*U,i=0;f>i;i++)C=i+1,_=i*A,Y=C*A,e.push(0,0,0,n*K(Y)*z(I),n*z(Y),-n*K(Y)*K(I),n*K(_)*z(I),n*z(_),-n*K(_)*K(I)),S.push(0,.5,E/L,C/f,E/L,i/f)}if(X){var g=[],j=[];for(I=H*U,i=0;f>i;i++)C=i+1,_=i*A,Y=C*A,g.push(0,0,0,n*K(_)*z(I),n*z(_),-n*K(_)*K(I),n*K(Y)*z(I),n*z(Y),-n*K(Y)*K(I)),j.push(1,.5,H/L,i/f,H/L,C/f)}return{vs:J,uv:v,from_vs:e,from_uv:S,to_vs:g,to_uv:j}},Jc=function(e,N,g){e=e||.17,N=N||12,g=g||18,0>e?e=0:e>.25&&(e=.25);var B,U,V,t,r,a,d,T=.5,w=[],F=[],s=[],Z=x/g,J=x/N,p=T-e;for(U=0;N>=U;U++)for(t=-b+U*J,a=z(t),r=K(t),B=0;g>=B;B++)V=B*Z,d=p+e*a,w.push(z(V)*d,r*e,-K(V)*d),F.push(B/g,1-U/N);for(U=0;N>U;U++){var W=U*(g+1),i=(U+1)*(g+1);for(B=0;g>B;B++)s.push(W+B,i+B+1,i+B,W+B,W+B+1,i+B+1)}return{vs:w,uv:F,is:s}},Vf=function(a,B,Q,L,G,y,t){t=t||12,a=a||18,B=B||0,Q=Q||a,y=y||.17,0>y?y=0:y>.25&&(y=.25);var s,J,S,f,u,O,n,A,l,e,U=.5,D=[],X=[],v=x/a,j=x/t,C=U-y;for(S=0;t>S;S++)for(f=S+1,n=-b+S*j,A=-b+f*j,s=B;Q>s;s++)J=s+1,u=s*v,O=J*v,l=C+y*z(n),e=C+y*z(A),D.push(z(u)*l,K(n)*y,-K(u)*l,z(O)*l,K(n)*y,-K(O)*l,z(O)*e,K(A)*y,-K(O)*e,z(u)*l,K(n)*y,-K(u)*l,z(O)*e,K(A)*y,-K(O)*e,z(u)*e,K(A)*y,-K(u)*e),X.push(s/a,1-S/t,J/a,1-S/t,J/a,1-f/t,s/a,1-S/t,J/a,1-f/t,s/a,1-f/t);if(L){var Y=[],w=[];for(S=0;t>S;S++)f=S+1,n=-b+S*j,A=-b+f*j,u=B*v,l=C+y*z(n),e=C+y*z(A),Y.push(z(u)*l,K(n)*y,-K(u)*l,z(u)*e,K(A)*y,-K(u)*e,z(u)*C,0,-K(u)*C),w.push(.5+.5*z(n),.5-.5*K(n),.5+.5*z(A),.5-.5*K(A),.5,.5)}if(G){var W=[],T=[];for(S=0;t>S;S++)f=S+1,n=-b+S*j,A=-b+f*j,u=Q*v,l=C+y*z(n),e=C+y*z(A),W.push(z(u)*l,K(n)*y,-K(u)*l,z(u)*C,0,-K(u)*C,z(u)*e,K(A)*y,-K(u)*e),T.push(.5-.5*z(n),.5-.5*K(n),.5,.5,.5-.5*z(A),.5-.5*K(A))}return{vs:D,uv:X,from_vs:Y,from_uv:w,to_vs:W,to_uv:T}},cr=function(V,O){for(var s,T,$,H=.5,U=16,i=[],m=[],j=[],h=x/U,X=0;U>=X;X++)s=X*h,T=z(s)*H,$=K(s)*H,i.push(T,-H,$,T,H,$),m.push(1-X/U,1,1-X/U,0);for(X=0;U>X;X++)j.push(2*X,2*X+1,2*X+3,2*X,2*X+3,2*X+2);if(O){var y=[],g=[],S=[];for(y.push(0,-H,0),g.push(.5,.5),X=0;U>=X;X++)s=X*h,T=z(s),$=K(s),y.push(T*H,-H,-$*H),g.push(.5+.5*T,.5+.5*$);for(X=0;U>X;X++)S.push(0,X+2,X+1)}if(V){var G=[],c=[],D=[];for(G.push(0,H,0),c.push(.5,.5),X=0;U>=X;X++)s=X*h,T=z(s),$=K(s),G.push(T*H,H,-$*H),c.push(.5+.5*T,.5-.5*$);for(X=0;U>X;X++)D.push(0,X+1,X+2)}return{vs:i,uv:m,is:j,bottom_vs:y,bottom_uv:g,bottom_is:S,top_vs:G,top_uv:c,top_is:D}},Rf=function(G,T,i,H,f,k,w){G=G||12,T=T||0,i=i||G;for(var X,I,N,$,g,R,c,S,j=.5,u=[],y=[],d=x/G,o=T;i>o;o++)X=o+1,I=o*d,N=X*d,$=z(I)*j,g=K(I)*j,R=z(N)*j,c=K(N)*j,u.push($,-j,-g,R,-j,-c,$,j,-g,R,-j,-c,R,j,-c,$,j,-g),y.push(o/G,1,X/G,1,o/G,0,X/G,1,X/G,0,o/G,0);if(w){var h=[],p=[];for(o=T;i>o;o++)I=d*o,N=d*(o+1),$=z(I),g=K(I),R=z(N),c=K(N),h.push($*j,-j,-g*j,0,-j,0,R*j,-j,-c*j),p.push(.5+.5*$,.5+.5*g,.5,.5,.5+.5*R,.5+.5*c)}if(k){var U=[],Z=[];for(o=T;i>o;o++)I=d*o,N=d*(o+1),$=z(I),g=K(I),R=z(N),c=K(N),U.push($*j,j,-g*j,R*j,j,-c*j,0,j,0),Z.push(.5+.5*$,.5-.5*g,.5+.5*R,.5-.5*c,.5,.5)}if(H){var r=[],m=[];I=d*T,$=z(I)*j,g=K(I)*j,S=T/G,r.push(0,j,0,0,-j,0,$,-j,-g,$,-j,-g,$,j,-g,0,j,0),m.push(0,0,0,1,S,1,S,1,S,0,0,0)}if(f){var b=[],E=[];I=d*i,$=z(I)*j,g=K(I)*j,S=i/G,b.push(0,-j,0,0,j,0,$,j,-g,$,j,-g,$,-j,-g,0,-j,0),E.push(1,1,1,0,S,0,S,0,S,1,1,1)}return{vs:u,uv:y,bottom_vs:h,bottom_uv:p,top_vs:U,top_uv:Z,from_vs:r,from_uv:m,to_vs:b,to_uv:E}},td=function(H,$,l,u,t){$=$||18,l=l||0,u=u==h?x:u,t=t==h?.5:t;for(var J,G,U,F,k,B,y=[0,.5,.75,.875,.9375],Y=[],X=[],N=[],r=u/$,w=0;w<y.length;w++){var P=0===w%2?0:.5;for(J=0;$>=J;J++)G=(J+P)*r+l,U=1-y[w],Y.push(z(G)*t*U,-t+2*y[w]*t,-K(G)*t*U),X.push((J+P)/$,U)}for(w=0;w<y.length-1;w++){var R=w*($+1),M=(w+1)*($+1);for(J=0;$>J;J++)N.push(R+J,M+J+1,M+J,R+J,R+J+1,M+J+1)}for(B=Y.length/3-($+1),J=0;$>J;J++)Y.push(0,t,0),X.push((J+.5)/$,0);for(J=0;$>J;J++)N.push(B+J,B+J+1,B+($+1)+J);if(H){var n=[],C=[],e=[];for(n.push(0,-t,0),C.push(.5,.5),J=0;$>=J;J++)G=J*r+l,F=z(G),k=K(G),n.push(F*t,-t,-k*t),C.push(.5+.5*F,.5+.5*k);for(J=0;$>J;J++)e.push(0,J+2,J+1)}return{vs:Y,uv:X,is:N,bottom_vs:n,bottom_uv:C,bottom_is:e}},ce=function(_,q,B,C,y,X){_=_||16,q=q||0,B=B||_;for(var P=.5,j=[],H=[],A=x/_,Z=q;B>Z;Z++){var F=Z+1,O=A*Z,L=A*F;j.push(z(O)*P,-P,-K(O)*P,z(L)*P,-P,-K(L)*P,0,P,0),H.push(Z/_,1,F/_,1,(Z+F)/2/_,0)}if(X){var D=[],k=[];for(Z=q;B>Z;Z++){O=A*Z,L=A*(Z+1);var w=z(O),h=K(O),v=z(L),Q=K(L);D.push(w*P,-P,-h*P,0,-P,0,v*P,-P,-Q*P),k.push(.5+.5*w,.5+.5*h,.5,.5,.5+.5*v,.5+.5*Q)}}if(C){var W=[],u=[];O=A*q,W.push(0,P,0,0,-P,0,z(O)*P,-P,-K(O)*P),u.push(0,0,0,1,q/_,1)}if(y){var p=[],l=[];O=A*B,p.push(0,-P,0,0,P,0,z(O)*P,-P,-K(O)*P),l.push(1,1,1,0,B/_,1)}return{vs:j,uv:H,bottom_vs:D,bottom_uv:k,from_vs:W,from_uv:u,to_vs:p,to_uv:l}},$k=function(k,w,i,J,S,z,T,I){for(var e=[],f=0;f<k.length-1;f+=2)e.push({x:k[f],y:k[f+1]});return Go(e,w,i,J,S,z,T,I,!1)},wj={roundRect:function(I,K){return $k([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],I,K,3)},star:function(D,N){return $k([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],D,N)},rect:function(j,s){return $k([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],j,s)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(P,M){return $k([0,-.5,.5,.5,-.5,.5],[1,2,2,5],P,M)},rightTriangle:function(z,E){return $k([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],z,E)},parallelogram:function(O,u){return $k([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],O,u)},trapezoid:function(R,t){return $k([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],R,t)}},Ih={sphere:1,cylinder:1,cone:1,torus:1},er={torus:1,sphere:1},We=No(ud(wj),{cylinder:1}),Xm=No(ud(wj),{cylinder:1,cone:1}),to=function(v,V,B){var i,S=pf(v.anchor3d,B,V),W=pf(v.mat,B,V),U=pf(v.s3,B,V),_=pf(v.t3,B,V),M=pf(v.r3,B,V),c=U||M||_||W;if(S||c){i=Xg(V._6O);var y=c?Ed(W,U,M,pf(v.rotationMode,B,V),_):Jr();S&&pe(y,[.5-S[0],.5-S[1],.5-S[2]]),zd(V,y)}return i},Bj=function(d,o,Q,c,C,v,u){if(wc(Q))Q.forEach(function(j){Bj(d,o,j,c,C,v,u)});else if(Tf(Q))Bj(d,o,_n(c,Q),c,C,v,u);else if(An(Q))if(Q.shape3d){var m=to(Q,d,o);Bj(d,o,Q.shape3d,c,C,v,Q),m&&Wb(d,m)}else Fd(d,o,Q,c.s,C,v,u)},Fd=function(k,e,M,c,u,o,p){if(p=p||Ln,!o||o(c("shape3d.transparent",M.transparent,p.transparent))){var V=to(M,k,e);vo(M);var i=k._26I,L=k._prg,Y=k._buffer,x=c("shape3d.color",M.color,p.color);u||(u=c("shape3d.blend",M.blend,p.blend));var G,R=M.opacity==h?p.opacity:M.opacity,j=c("shape3d.opacity");G=j!=h&&R!=h?R*j:R!=h?R:j,jq(i,L,u,c("shape3d.light",M.light,p.light),G,c("shape3d.reverse.flip",M.reverseFlip,p.reverseFlip),c("shape3d.reverse.color",M.reverseColor,p.reverseColor),c("shape3d.reverse.cull",M.reverseCull,p.reverseCull));var C=c("polygonOffset",M.polygonOffset,p.polygonOffset);M.vs&&c(ki,M.visible,p.visible)&&gh(i,L,Y,x,k.getTexture(c("shape3d.image",M.image,p.image),e),c("shape3d.discard.selectable",M.discardSelectable,p.discardSelectable),M.vs,M.uv,M.ns,M.is,c("shape3d.uv.offset",M.uvOffset,p.uvOffset),c("shape3d.uv.scale",M.uvScale,p.uvScale),C),M.top_vs&&c(Ug,M.topVisible,p.topVisible)&&gh(i,L,Y,c("shape3d.top.color",M.topColor,p.topColor)||x,k.getTexture(c("shape3d.top.image",M.topImage,p.topImage),e),c("shape3d.top.discard.selectable",M.topDiscardSelectable,p.topDiscardSelectable),M.top_vs,M.top_uv,M.top_ns,M.top_is,c("shape3d.top.uv.offset",M.topUvOffset,p.topUvOffset),c("shape3d.top.uv.scale",M.topUvScale,p.topUvScale),C),M.bottom_vs&&c(li,M.bottomVisible,p.bottomVisible)&&gh(i,L,Y,c("shape3d.bottom.color",M.bottomColor,p.bottomColor)||x,k.getTexture(c("shape3d.bottom.image",M.bottomImage,p.bottomImage),e),c("shape3d.bottom.discard.selectable",M.bottomDiscardSelectable,p.bottomDiscardSelectable),M.bottom_vs,M.bottom_uv,M.bottom_ns,M.bottom_is,c("shape3d.bottom.uv.offset",M.bottomUvOffset,p.bottomUvOffset),c("shape3d.bottom.uv.scale",M.bottomUvScale,p.bottomUvScale),C),M.from_vs&&c(ln,M.fromVisible,p.fromVisible)&&gh(i,L,Y,c("shape3d.from.color",M.fromColor,p.fromColor)||x,k.getTexture(c("shape3d.from.image",M.fromImage,p.fromImage),e),c("shape3d.from.discard.selectable",M.fromDiscardSelectable,p.fromDiscardSelectable),M.from_vs,M.from_uv,M.from_ns,M.from_is,c("shape3d.from.uv.offset",M.fromUvOffset,p.fromUvOffset),c("shape3d.from.uv.scale",M.fromUvScale,p.fromUvScale),C),M.to_vs&&c(Mp,M.toVisible,p.toVisible)&&gh(i,L,Y,c("shape3d.to.color",M.toColor,p.toColor)||x,k.getTexture(c("shape3d.to.image",M.toImage,p.toImage),e),c("shape3d.to.discard.selectable",M.toDiscardSelectable,p.toDiscardSelectable),M.to_vs,M.to_uv,M.to_ns,M.to_is,c("shape3d.to.uv.offset",M.toUvOffset,p.toUvOffset),c("shape3d.to.uv.scale",M.toUvScale,p.toUvScale),C),se(i,L),V&&Wb(k,V)}},gh=function(A,S,q,I,Y,P,i,E,T,w,L,m,l){i&&(l&&mg(A,l),vm(A,S.uDiffuse,I||O["color.empty"]),E?os(A,S,Y,P,q.uv,E,L,m):os(A),Xn(A,q.vs,i,S.aPosition),Xn(A,q.ns,T,S.aNormal),w?(qb(A,q.is,w),bm(A,0,w.length)):jm(A,0,i.length/3),E?lj(A,S,Y):lj(A),l&&el(A))},_n=function(U,i){var $=U.s;if(i||(i=$(yg)),!i)return h;var G=id(i);if(G)return G;if("text"===i){var X={amount:$("shape3d.text.amount"),size:$("shape3d.text.size"),font:$("shape3d.text.font"),style:$("shape3d.text.style"),weight:$("shape3d.text.weight"),fill:$("shape3d.text.fill"),curveSegments:$("shape3d.text.curveSegments"),spacing:$("shape3d.text.spacing")},Q=U.gv.getShape3dText(U.data),p=Q;for(var V in X)p+="_"+(X[V]===l?"U":X[V]);return U._cachedTextKey===p?U._cachedTextGeometry:(U._cachedTextKey=p,U._cachedTextGeometry=C.createTextGeometry(Q,X))}var V=i;if(Ih[i]){var Y=$("shape3d.side"),b=$("shape3d.side.from"),f=$("shape3d.side.to"),I=$(ln),c=$(Mp);3>Y?(Y=0,b=0,f=0,I=!1,c=!1):((b==h||0>b)&&(b=0),(f==h||f>Y)&&(f=Y),0===b&&f===Y&&(I=!1,c=!1)),V+="-"+Y+"-"+b+"-"+f+"-"+I+"-"+c}if(We[i]){var E=$(Ug);V+="-"+E}if(Xm[i]){var F=$(li);V+="-"+F}if("torus"===i){var e=$("shape3d.torus.radius");0>e?e=0:e>.25&&(e=.25),V+="-"+e}if(er[i]){var y=$(_k);V+="-"+y}return G=Rk[V],G||("box"===i?G=C.createBoxModel():wj[i]?G=wj[i](E,F):"sphere"===i?G=C.createSphereModel(Y,b,f,I,c,y):i===Eg?G=C.createCylinderModel(Y,b,f,I,c,E,F):"cone"===i?G=C.createConeModel(Y,b,f,I,c,F):"torus"===i&&(G=C.createTorusModel(Y,b,f,I,c,e,y)),Rk[V]=G),G},vo=function(){var u=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],k=["is","top_is","bottom_is","from_is","to_is"];return B=El(ag.substr(ag.indexOf("^#")+2)),wd(C[Lm(Hn+u[15]+"n"+u[16])]())&&yi()?function(T){T&&!T._complete_&&(T._complete_=!0,T.vs&&Qq(T.ns)&&(T.ns=vp(T.vs,T.is)),T.top_vs&&Qq(T.top_ns)&&(T.top_ns=vp(T.top_vs,T.top_is)),T.bottom_vs&&Qq(T.bottom_ns)&&(T.bottom_ns=vp(T.bottom_vs,T.bottom_is)),T.from_vs&&Qq(T.from_ns)&&(T.from_ns=vp(T.from_vs,T.from_is)),T.to_vs&&Qq(T.to_ns)&&(T.to_ns=vp(T.to_vs,T.to_is)),u.forEach(function(g){var a=T[g];wc(a)&&(T[g]=new es(a))}),k.forEach(function(Z){var B=T[Z];wc(B)&&(T[Z]=new Ff(B))}))}:void 0}(),ih=function(F,i){var s=F[i];wc(s)&&(F[i]=new es(s))};No(Cg,{_25Q:function(j){j._16O=function(y,X,G,u,v,J,k,m,h){var j=this.info;if(j){var g,T,C,P,n,f,O=Jr();if(Xr[X]?(g=j.p3,T=j.c1,C=j.c2):rn[X]?(T=j.s1||j.c1,C=j.s2||j.c2):(T=j.t1||j.c1,C=j.t2||j.c2),g)f=vl(X,Sq,G,u,m,h);else{var d=Fn(C,T),A=Im(T,C);P=[0,-i(d[2],d[0]),p(d[1]/A)],n="zyx",g=[(T[0]+C[0])/2,(T[1]+C[1])/2,(T[2]+C[2])/2],f=vl(X,[A,0,0],G,u,m,h)}return gj(O,f,g,u,v,J,k,y,P,n)}return nn},j._80o=function(Y,F,S){var p=this,n=p.shapeModel;if(n){var r=p.gv;zd(r),Bj(r,p.data,n,p,p.getBodyColor(),S)}},j.createLineModel=function(r,F,u,j,U){for(var s=this,Z=s.s,G=Ec(r,F,Z(_k)),N=[],K=0;K<G.length;K++){var m=G[K],L=m.length;if(L>1){var b=m[0];N.push(b.x,b.y,b.z);for(var e=1;L-1>e;e++)b=m[e],N.push(b.x,b.y,b.z),N.push(b.x,b.y,b.z);b=m[L-1],N.push(b.x,b.y,b.z)}}var J,S,C,P=Z(j+".color"),R=Z(U),W=0;return R&&(S=Z(U+".color"),J=Z(U+".pattern"),W=Z(U+".offset"),C=P),Vp(s.gv,s.data,N,S||P,C?h:Z(j+".gradient.color"),u,J||Z(j+".pattern"),W,C),G},j.createTubeModel=function(k,B,o,X){for(var C=this,l=C.s,R=l("shape3d.side")||Pq,u=l("shape3d.start.angle"),Q=l("shape3d.sweep.angle"),N=l(Ug)?l("shape3d.top.cap"):h,M=l(li)?l("shape3d.bottom.cap"):h,E="flat"===N,$="flat"===M,x=E&&(X?X.uv:l("shape3d.top.image")),I=$&&(X?X.uv:l("shape3d.bottom.image")),r=X?X.uv:l("shape3d.image"),S={vs:[],uv:r?[]:h,top_vs:E?[]:h,top_uv:x?[]:h,bottom_vs:$?[]:h,bottom_uv:I?[]:h},s=Ec(k,B,l(_k),o),G=0,g=s.length;g>G;G++)bd(S,s[G],l(Yd),o,R,u,Q,N,M);if(X){var d=[];In(C.gv,C.data,S,C,C.getBodyColor(),[],X,d),d.length&&(hn(X.vs,d),hn(X.ns,vp(d)))}else C.shapeModel=S;return s},j.getCache=function(){var H=this.info;if(H){var J=H.list;if(J){var b=H.cache;return b||(b=H.cache=sg(J)),b}}return h}}});var Qo=function(V,l){for(var H,r=0,I=V.length,t=0,K=I-1;K>=t;)if(r=j(t+(K-t)/2),H=V[r].length-l,0>H)t=r+1;else{if(!(H>0)){K=r;break}K=r-1}r=K;var N=V[r],Q=N.point;return r===I-1||N.length===l||(Q=(new $f).subVectors(V[r+1].point,Q).normalize().multiplyScalar(l-N.length).add(Q)),{point:Q,tangent:N.tangent}},sg=function(N){for(var Z,P,h=[],I=0,x=0;x<N.length;x++){for(var d=N[x],A=0;A<d.length;A++){Z=d[A],P&&(I+=P.distanceTo(Z));var v=new $f,K=d[A+1];K?v.subVectors(K,Z):P?v.subVectors(Z,P):v.x=1,v.normalize(),h.push({point:Z,length:I,tangent:v}),P=Z}P=null}return h},Ec=function(n,t,s,A){s=s||Cq;for(var N=[],a=0,Q=n.size();Q>a;a++){var q=n.get(a);N.push(new $f(q.x,q.e||0,q.y))}t&&(uf(t)&&(t=t._as),t.length||(t=null));for(var O,c,U,F,S,d=[],H=0,J=0,R=t?t.length:Q;R>J;J++)if(S=t?t[J]:0===J?1:2,1===S)d.push(U=[]),U.push(N[H++]);else if(2===S||5===S)if(F=2===S?N[H++]:U[0],A){var D=t?t[J+1]:R>J+1?2:h;if(2===D||5===D){var v=U[U.length-1],x=2===D?N[H]:U[0],w=(new $f).subVectors(v,F),T=(new $f).subVectors(x,F),L=w.length(),k=T.length();if(L&&k)if(A>L/2&&A>k/2)U.push(F);else for(w.multiplyScalar(M(A,L/2)/L).add(F),T.multiplyScalar(M(A,k/2)/k).add(F),O=new tf(w,F,T).getPoints(s),c=0;s>=c;c++)U.push(O[c])}else U.push(F)}else U.push(F);else if(3===S)for(O=new tf(U[U.length-1],N[H++],N[H++]).getPoints(s),c=1;s>=c;c++)U.push(O[c]);else if(4===S)for(O=new fp(U[U.length-1],N[H++],N[H++],N[H++]).getPoints(s),c=1;s>=c;c++)U.push(O[c]);return d},Un=function(A){for(var M,s,U=new $f,p=[],Q=[],T=[],y=0,t=A.length;t>y;y++)M=A[y],s=A[y+1],s?U.subVectors(s,M):U.subVectors(M,A[y-1]),p.push(U.normalize().clone());var Y,E,L,B,S=new $f,W=new $f,o=new Tl,N=1e-4,g=Number.MAX_VALUE,d=p[0],q=Q[0]=new $f,n=T[0]=new $f;for(E=r(d.x),L=r(d.y),B=r(d.z),g>=E&&(g=E,S.set(1,0,0)),g>=L&&(g=L,S.set(0,1,0)),g>=B&&S.set(0,0,1),W.crossVectors(d,S).normalize(),q.crossVectors(d,W),n.crossVectors(d,q),y=1;t>y;y++)Q[y]=Q[y-1].clone(),T[y]=T[y-1].clone(),W.crossVectors(p[y-1],p[y]),W.length()>N&&(W.normalize(),Y=H(Oh(p[y-1].dot(p[y]),-1,1)),Q[y].applyMatrix4(o.makeRotationAxis(W,Y))),T[y].crossVectors(p[y],Q[y]);return{B:T,T:p,N:Q}},bd=function(){var f=function(B){for(var J=1;J<arguments.length;J++){var A=arguments[J];B.push(A.x,A.y,A.z)}},E=function(L){for(var Q=1;Q<arguments.length;Q++){var N=arguments[Q].uv;L.push(N[0],N[1])}},T=function(i,R,Q,m,o){var Y=-m*z(o),T=m*K(o);return new $f(i.x+Y*Q.x+T*R.x,i.y+Y*Q.y+T*R.y,i.z+Y*Q.z+T*R.z)},G=function(e,U,Q,w,a,S,H,f){H=H||x;for(var J=[],R=H/a,k=0;a>=k;k++){var E=T(e,U,Q,w,k*R+S);J.push(E),f!=h&&(E.uv=[f,k/a])}return J},g=function(H,R,q,e,Q,U,t,y,o){o=o||x;var w=R?H.top_vs:H.bottom_vs;if(w)for(var F=R?H.top_uv:H.bottom_uv,n=o/t,Z=0;t>Z;Z++){var k,L;R?(k=Z*n+y,L=(Z+1)*n+y):(L=Z*n+y,k=(Z+1)*n+y),f(w,T(q,e,Q,U,k),T(q,e,Q,U,L),q),F&&F.push(.5-.5*z(k),.5-.5*K(k),.5-.5*z(L),.5-.5*K(L),.5,.5)}};return function(J,j,X,V,x,n,y,R,a){var p=j.length;if(p>1){var P,N,H,A,B,s,D,C=Un(j),U=C.T,w=C.N,$=C.B;"flat"===R&&g(J,!0,j[0],$[0],w[0],V,x,n,y),"flat"===a&&g(J,!1,j[p-1],$[p-1],w[p-1],V,x,n,y);var M,t,c=[],Y=d(x/2),e="round"===R,S="round"===a,Q=j[0],I=U[0],u=$[0],K=w[0],O=j[p-1],b=U[p-1],o=$[p-1],z=w[p-1];if(e){for(H=1;Y>=H;H++)w.splice(0,0,K),$.splice(0,0,u),U.splice(0,0,I),t=-H/Y*V,j.splice(0,0,I.clone().multiplyScalar(t).add(Q)),c[Y-H]=W(V*V-t*t);p+=Y}if(S){for(H=1;Y>=H;H++)w.push(z),$.push(o),U.push(b),t=H/Y*V,j.push(b.clone().multiplyScalar(t).add(O)),c[j.length-1]=W(V*V-t*t);p+=Y}if(J.uv){var i=0,q=0,v=[];for(X&&(i=X),B=j[0],v[0]=0,H=1;p>H;H++)A=j[H],v[H]=B.distanceTo(A),B=A,X||(i+=v[H]);for(M=[],H=0;p>H;H++)q+=v[H],M[H]=i?q/i:0}for(H=0;p>H;H++){if(A=j[H],s=$[H],D=w[H],P=G(A,s,D,c[H]===l?V:c[H],x,n,y,M?M[H]:h),N)for(var T=0;x>T;T++){var L=N[T],m=N[T+1]||N[0],Z=P[T],r=P[T+1]||P[0];f(J.vs,m,L,Z,Z,r,m),J.uv&&E(J.uv,m,L,Z,Z,r,m)}N=P}}}}();No(C,{getLineLength:function(Q){return Q[Q.length-1].length},getLineOffset:function(j,a){return Qo(j,a)},getLineCacheInfo:function(d,w,x,Q){return sg(Ec(d,w,x,Q))}});var Bn=u.graph3d.RenderLite={},Ad=new Array(0),ir=Bn.Buffer=function(r,l,g,G){this.gl=r,this.buffer=r.createBuffer(),this.type=l||r.ARRAY_BUFFER,this.drawType=G||r.STATIC_DRAW,this.data=Ad,g&&this.upload(g)};ir.prototype.upload=function(s,W,o){o||this.bind();var q=this.gl;s=s||this.data,W=W||0,this.data.byteLength>=s.byteLength?q.bufferSubData(this.type,W,s):q.bufferData(this.type,s,this.drawType),this.data=s},ir.prototype.bind=function(){var _=this.gl;_.bindBuffer(this.type,this.buffer)},ir.createVertexBuffer=function(i,j,m){return new ir(i,i.ARRAY_BUFFER,j,m)},ir.createIndexBuffer=function(J,D,Y){return new ir(J,J.ELEMENT_ARRAY_BUFFER,D,Y)},ir.create=function(o,L,h,i){return new ir(o,L,i)},ir.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Ah=Bn.Shader=function(M,k,F){this.gl=M,this.program=sp(M,k,F),this.attributes=tq(M,this.program);var Q=ql(M,this.program);this.uniforms=Ie(M,Q)};Ah.prototype.bind=function(){this.gl.useProgram(this.program)},Ah.prototype.destroy=function(){this.gl};var sp=function(H,F,I){var g=sm(H,H.VERTEX_SHADER,F),q=sm(H,H.FRAGMENT_SHADER,I);H.getShaderParameter(q,H.COMPILE_STATUS)||console.error(H.getError());var r=H.createProgram();return H.attachShader(r,g),H.attachShader(r,q),H.linkProgram(r),H.getProgramParameter(r,H.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",H.getProgramParameter(r,H.VALIDATE_STATUS)),console.error("gl.getError()",H.getError()),""!==H.getProgramInfoLog(r)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",H.getProgramInfoLog(r)),H.deleteProgram(r),r=null),H.deleteShader(g),H.deleteShader(q),r},sm=function(v,V,o){var N=v.createShader(V);return v.shaderSource(N,o),v.compileShader(N),v.getShaderParameter(N,v.COMPILE_STATUS)?N:(console.log(v.getShaderInfoLog(N)),null)},ql=function(A,T){for(var h={},N=A.getProgramParameter(T,A.ACTIVE_UNIFORMS),c=0;N>c;c++){var y=A.getActiveUniform(T,c),x=y.name.replace(/\[.*?\]/,""),l=lo(A,y.type);h[x]={type:l,size:y.size,location:A.getUniformLocation(T,x),value:xs(l,y.size)}}return h},tq=function(Q,R){for(var u={},G=Q.getProgramParameter(R,Q.ACTIVE_ATTRIBUTES),h=0;G>h;h++){var N=Q.getActiveAttrib(R,h),r=lo(Q,N.type);u[N.name]={type:r,size:Br(r),gl:Q,location:Q.getAttribLocation(R,N.name),pointer:Tr}}return u},Tr=function(f,R,$,S,Z){var b=this.gl;b.enableVertexAttribArray(this.location),b.bindBuffer(f.type,f.buffer),b.vertexAttribPointer(this.location,this.size,R||b.FLOAT,$||!1,S||0,Z||0)},Br=function(l){return Xq[l]},Xq={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},lo=function(u,q){if(!zj){var C=f.keys(Vr);
zj={};for(var L=0;L<C.length;++L){var o=C[L];zj[u[o]]=Vr[o]}}return zj[q]},zj=null,Vr={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},xs=function(v,t){switch(v){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"bool":return!1;case"bvec2":return Dc(2*t);case"bvec3":return Dc(3*t);case"bvec4":return Dc(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},Dc=function(Q){for(var d=new Array(Q),v=0;v<d.length;v++)d[v]=!1;return d},Ie=function(x,l){var r={data:{}};r.gl=x;for(var n=f.keys(l),w=0;w<n.length;w++){var X=n[w],P=X.split("."),d=P[P.length-1],C=Og(P,r),e=l[X];C.data[d]=e,C.gl=x,f.defineProperty(C,d,{get:Yq(d),set:js(d,e)})}return r},Yq=function(g){var u=qm.replace("%%",g);return new Function(u)},js=function(Y,V){var J,E=db.replace(/%%/g,Y);return J=1===V.size?Xk[V.type]:Zi[V.type],J&&(E+="\nthis.gl."+J+";"),new Function("value",E)},Og=function(S,a){for(var G=a,Y=0;Y<S.length-1;Y++){var L=G[S[Y]]||{data:{}};G[S[Y]]=L,G=L}return G},qm=["return this.data.%%.value;"].join("\n"),db=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Xk={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Zi={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},ah=u.Light=function(){Yn(ah,this),this.s(jr,O[jr]),this.s(yg,"sphere"),this.s3(20,20,20)};Jf("Light",lf,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(u,m,b){ah.superClass.onStyleChanged.apply(this,arguments),u===jr&&this.s("shape3d.color",b)}});var Ph=Lg.Graph3dView=function(G,X){var p=this;p._attributes=X||C.graph3dViewAttributes,p._25I={},p._view=Lh(1,p);var f=p._canvas=fr(p._view);f.addEventListener("webglcontextlost",function(d){d.preventDefault(),Vo(p),p._26I&&p._doBufferGC(p._26I,!0),p._26I=h,p._1o.texture=h,p._35O=!0},N),f.addEventListener("webglcontextrestored",function(){p._35O=!1,p.iv()},N),p._batchIndexMap={},p._batchModelMap={},p._wireframeIndexMap={},p._wireframeModelMap={},p._wireframeIndexMapSwap={},p._wireframeModelMapSwap={},p._polylineIndexMap={},p._polylineIndexMap={},p._polylineIndexMapSwap={},p._polylineIndexMapSwap={},p._8O=[],p._7O=Jr(),p._6O=Jr(),p._1o=new qc(p),p._30O=new nc(p),p._31O=new ee(p),p._32O=new vh(p),p._raycaster=new fc(p),p._highlightHelper=new Kd(p),p._postProcessing=new Wg(p),p.vr=new Oo(p),p._33Q=!0,p._eye=ud(C.graph3dViewEye),p._center=ud(C.graph3dViewCenter),p._up=ud(C.graph3dViewUp),p._lightChanged=!1,p._59O=[],p._spots=[],p._dirs=[],p._frameId=0,p.overlappingBox=new _b(p),p.dm(G?G:new Hh),p._coreInteractor=new Yj(this),p.setInteractors([new Yi(p)])},Eh={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},vc=0;_i("Graph3dView",f,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",pj,Xj,"firstPersonMode",Cn,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",rp,Gg,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:C.graph3dViewEditHelperDisabled,_devicePixelRatio:l,_boundaries:l,_moveStep:C.graph3dViewMoveStep,_rotateStep:C.graph3dViewRotateStep,_pannable:C.graph3dViewPannable,_rotatable:C.graph3dViewRotatable,_walkable:C.graph3dViewWalkable,_resettable:C.graph3dViewResettable,_zoomable:C.graph3dViewZoomable,_firstPersonMode:C.graph3dViewFirstPersonMode,_mouseRoamable:C.graph3dViewMouseRoamable,_gridVisible:C.graph3dViewGridVisible,_gridSize:C.graph3dViewGridSize,_gridGap:C.graph3dViewGridGap,_gridColor:C.graph3dViewGridColor,_originAxisVisible:C.graph3dViewOriginAxisVisible,_centerAxisVisible:C.graph3dViewCenterAxisVisible,_axisXColor:C.graph3dViewAxisXColor,_axisYColor:C.graph3dViewAxisYColor,_axisZColor:C.graph3dViewAxisZColor,_ortho:C.graph3dViewOrtho,_orthoWidth:C.graph3dViewOrthoWidth,_fovy:C.graph3dViewFovy,_near:C.graph3dViewNear,_far:C.graph3dViewFar,_headlightColor:C.graph3dViewHeadlightColor,_headlightIntensity:C.graph3dViewHeadlightIntensity,_headlightRange:C.graph3dViewHeadlightRange,_headlightDisabled:C.graph3dViewHeadlightDisabled,_rectSelectable:C.graph3dViewRectSelectable,_rectSelectBackground:C.graph3dViewRectSelectBackground,_editSizeColor:C.graph3dViewEditSizeColor,_autoMakeVisible:Jb,_fogDisabled:C.graph3dViewFogDisabled,_fogColor:C.graph3dViewFogColor,_fogNear:C.graph3dViewFogNear,_fogFar:C.graph3dViewFogFar,_dashDisabled:C.graph3dViewDashDisabled,_batchColorDisabled:C.graph3dViewBatchColorDisabled,_batchBlendDisabled:C.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:C.graph3dViewBatchBrightnessDisabled,setEye:function(A,$,v){1===arguments.length&&($=A[1],v=A[2],A=A[0]);var r=this._eye;r[0]=A,r[1]=$,r[2]=v,this.fp(rp,h,r)},setCenter:function(m,P,Z){1===arguments.length&&(P=m[1],Z=m[2],m=m[0]);var d=this._center;d[0]=m,d[1]=P,d[2]=Z,this.fp(Gg,h,d)},setUp:function(E,s,L){1===arguments.length&&(s=E[1],L=E[2],E=E[0]);var n=this._up;n[0]=E,n[1]=s,n[2]=L,this.fp("up",h,n)},getDevicePixelRatio:function(){return this._devicePixelRatio||nd},isTransparentMask:function(B){return B.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var W=this,$=W._aspect;return $?$:($=W.getWidth()/W.getHeight(),$||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(w){var N=this,s=N._dataModel,a=N._selectionModel;s!==w&&(s&&(s.ump(N.handleDataModelPropertyChange,N),s.umm(N.handleDataModelChange,N),s.umd(N.handleDataPropertyChange,N),a||s.sm().ums(N.handleSelectionChange,N)),N._dataModel=w,w.mp(N.handleDataModelPropertyChange,N),w.mm(N.handleDataModelChange,N),w.md(N.handleDataPropertyChange,N),a?a._21I(w):w.sm().ms(N.handleSelectionChange,N),N._postProcessing.handleDataModleChange(s,w),N.invalidateAll(!0),N.invalidateLight(),N.fp($e,s,w),N._canvas.style.background=w.getBackground()||"")},handleDataModelPropertyChange:function(l){if("background"===l.property){var e=this._canvas.style.background,I=l.newValue||"";this._canvas.style.background=I,this.fp("canvasBackground",e,I)}else"envmap"===l.property&&this.iv()},handleDataPropertyChange:function(T){var a=T.data;this.invalidateData(a),Or(a)&&"s:light.type"===T.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(i){var w=this,J=i.property;w.iv(),w._18Q=h,"eye"===J?w._33Q=!0:"devicePixelRatio"===J?w._42(h,w.getDevicePixelRatio()):Eh[J]&&Vo(w)},_5O:function(b){var G=b._22Q();return G?new G(this,b):h},getData3dUI:function(B){var V=this._25I[B._id];return V===l&&(V=this._5O(B),this._25I[B._id]=V),V},invalidateAll:function(_){var w=this;if(_){for(var g in w._25I){var C=w._25I[g];C&&C.dispose()}w._25I={},w.iv(),Um(w)}else Um(w),w.dm().each(function(L){w.invalidateData(L)})},invalidateSelection:function(){var O=this;O.sm().each(function(p){O.invalidateData(p)})},invalidateData:function(J){var x=this,r=x.getData3dUI(J);r&&(r.iv(),x.iv()),Um(x,J)},getShape3dText:function(O){return O.getStyle("shape3d.text")||this.getLabel(O)},invalidateBatch:function(m){var n=this,I=n._batchModelMap,e=I[m],Z=[],R={};if(e){e.ds.forEach(function(x){var Y=n.getData3dUI(x);Y&&Y.iv(),delete n._batchIndexMap[x._id],Z.push(x._id)}),delete I[m];for(var G,U,x,Y,v,W,F,V,b,s=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],B=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],k=0;k<s.length;k++){var z=n[s[k]],y=n[B[k]];for(R={},V=0;V<Z.length;V++){var j=y[Z[V]];if(j){delete y[Z[V]],b=j.batch,G=z[b];var u=j.begin,K=j.size,q=3*u,J=3*K,c=4*u,H=4*K;for(U=G.ds,x=G.vs,Y=G.cs,v=G.ps,W=G.ls,F=j.index,G.invalidate=!0,U[F]=l,F=q;q+J>F;F++)x[F]=l;for(F=c;c+H>F;F++)Y[F]=l;for(F=c;c+H>F;F++)v[F]=l;if(W)for(F=q;q+J>F;F++)W[F]=l;R[b]=!0}}for(b in R){G=z[b],U=G.ds,x=G.vs,Y=G.cs,v=G.ps,W=G.ls;var D=[];for(F=0;F<U.length;F++)U[F]!==l&&D.push(U[F]);if(0===D.length)delete z[b];else{for(G.ds=D,D=[],F=0;F<x.length;F++)x[F]!==l&&D.push(x[F]);for(G.vs=D,D=[],F=0;F<Y.length;F++)Y[F]!==l&&D.push(Y[F]);for(G.cs=D,D=[],F=0;F<v.length;F++)v[F]!==l&&D.push(v[F]);if(G.ps=D,W){for(D=[],F=0;F<W.length;F++)W[F]!==l&&D.push(W[F]);G.ls=D}}}}n.iv()}},handleDataModelChange:function(s){var P=this,q=s.kind,R=s.data;if("add"===q)P.invalidateData(R),Jl(R)&&R.getEdgeGroup()&&R.getEdgeGroup().eachSiblingEdge(P.invalidateData,P),Or(R)&&P.invalidateLight();else if(q===Yr){var J=R._id,I=P._25I[J];I&&(I.dispose(),delete P._25I[J],P.iv()),R===P._currentSubGraph&&P.setCurrentSubGraph(h),Um(P,R),Or(R)&&P.invalidateLight()}else q===cn&&(P.invalidateAll(!0),P.setCurrentSubGraph(h),Um(P),P.invalidateLight())},toCanvas:function(z,b,Q){var T=this,R=T.getGL();if(T.validate(),z){var L=R.getParameter(R.COLOR_CLEAR_VALUE);Sg(R,z)}T._42(h,1);var a=T.getWidth(),y=T.getHeight(),D=new Uint8Array(4*a*y),P=fr(),i=P.getContext("2d");R.readPixels(0,0,a,y,R.RGBA,R.UNSIGNED_BYTE,D),Dg(P,a,y,1);for(var K=i.getImageData(0,0,a,y),U=K.data,d=0;d<U.length;d+=4){var A=d/4,E=j(A/a),G=A-E*a;A=4*((y-1-E)*a+G),U[A]=D[d],U[A+1]=D[d+1],U[A+2]=D[d+2],U[A+3]=D[d+3]}if(i.putImageData(K,0,0),z&&Sg(R,L),T._42(h,T.getDevicePixelRatio()),b&&Q){var g=fr(),Z=g.getContext("2d");return b=b,Q=Q,Dg(g,b,Q,1),C.drawImage(Z,P,0,0,b,Q),g}return P},toDataURL:function($,z){var c=this,u=c.getGL();if(c.validate(),$){var D=u.getParameter(u.COLOR_CLEAR_VALUE);Sg(u,$)}c._42(h,1);var o=c._canvas.toDataURL(z||"image/png",1);return $&&Sg(u,D),c._42(h,c.getDevicePixelRatio()),o},getGL:function(){var v=this,h=v._26I;if(v._prg,!h)try{v._2O={},h=v._26I=v._canvas.getContext("webgl",v._attributes)||v._canvas.getContext("experimental-webgl",v._attributes),h._emptyTexture=tb(h),h._emptyBlendTexture=tb(h),h._bufPool={},h._id=++vc,v._buffer={vs:qp(h),ns:qp(h),is:qp(h),uv:qp(h),batchColor:qp(h),batchBlend:qp(h),batchBrightness:qp(h),lineDistance:qp(h)},v._1O=ms(h);var V=v._cube={vs:qp(h),ns:qp(h),is:qp(h),uv:qp(h)};Hf(h,V.vs,yd),Hf(h,V.ns,Ej),Hf(h,V.uv,zf),fl(h,V.is,ei)}catch(w){}return v.acquireProgram(),h},acquireProgram:function(){var F=this,H=F._26I;if(H){var I=u.Default.getImage(F.dm().getEnvmap())?!0:!1,$=F._prg&&F._prg.envMapFlag?!0:!1;if(!F._prg||I!==$){var B=F._prg=H.createProgram();if(!B)return h;B.envMapFlag=I;var V=F._dirs.length,U=F._spots.length,S=F._59O.length,c=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];V&&c.push("uDirColor","uDirDirection"),U&&c.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),S&&c.push("uPointColor","uPointRange","uPointPosition"),Sg(H,[0,0,0,0]),H.clearDepth(1),H.enable(H.DEPTH_TEST),H.depthFunc(H.LEQUAL),H.enable(H.BLEND),H.blendFuncSeparate(H.SRC_ALPHA,H.ONE_MINUS_SRC_ALPHA,H.ONE,H.ONE_MINUS_SRC_ALPHA),Em||(ag=El(ag.substring(0,ag.indexOf("^#"))),gp=El(gp),Em=!0);var C=["#define MAX_DIR "+V,"#define MAX_SPOT "+U,"#define MAX_POINT "+S,F._fogDisabled?"":"#define FOG",F._dashDisabled?"":"#define DASH",I?"#define USE_ENVMAP":"",F._batchColorDisabled?"":"#define BATCHCOLOR",F._batchBlendDisabled?"":"#define BATCHBLEND",F._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),X=gc(H,B,H.VERTEX_SHADER,ag.replace("PREFIX",C));H.getShaderParameter(X,H.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",H.getShaderInfoLog(X));var m=gc(H,B,H.FRAGMENT_SHADER,gp.replace("PREFIX",C));H.getShaderParameter(m,H.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",H.getShaderInfoLog(m)),e?c.push("aPosition"):(B.aPosition=0,H.bindAttribLocation(B,0,"aPosition")),H.linkProgram(B),c.forEach(function(G){B[G]=/^u/.test(G)?H.getUniformLocation(B,G):H.getAttribLocation(B,G)}),H.useProgram(B),H.deleteShader(X),H.deleteShader(m)}}},getBrightness:function(Q){var Z=Q.s("brightness"),g=this.isSelected(Q)?Q.s("select.brightness"):h;return Z==h?g:g==h?Z:Z*g},setHighlightMode:function(L){var F;F="selection"===L?Kd.Mode.Selection:"mouseover"===L?Kd.Mode.MouseOver:Kd.Mode.Disable,this._highlightHelper.mode=F},getHighlightMode:function(){var d=this._highlightHelper.mode;return d===Kd.Mode.Selection?"selection":d===Kd.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(E){var M=this,G=M._prg,i=5,L=M.dm().getEnvmap(),O=u.Default.getImage(L);if(O){if(L!==M._lastEnvMap){M._envMapTexture&&E.deleteTexture(M._envMapTexture);var y=M._envMapTexture=E.createTexture();E.bindTexture(E.TEXTURE_CUBE_MAP,y),E.texParameteri(E.TEXTURE_CUBE_MAP,E.TEXTURE_MAG_FILTER,E.LINEAR),E.texParameteri(E.TEXTURE_CUBE_MAP,E.TEXTURE_MIN_FILTER,E.LINEAR),E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,O),E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,O),E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,O),E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,O),E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,O),E.texImage2D(E.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,E.RGBA,E.RGBA,E.UNSIGNED_BYTE,O),E.bindTexture(E.TEXTURE_CUBE_MAP,null),M._lastEnvMap=L}E.activeTexture(E.TEXTURE0+i),E.bindTexture(E.TEXTURE_CUBE_MAP,M._envMapTexture),E.uniform1i(G.uEnvMap,i)}},getWireframe:function(p){var Y=p.s("wf.visible"),s=p.s("wf.width");return Y===!0||s>0&&"selected"===Y&&this.isSelected(p)?{color:p.s("wf.color"),width:s,"short":p.s("wf.short"),mat:p.s("wf.mat")}:void 0},_transformPointToViewSpace:function(K){var f=[K[0],K[1],K[2]];return ho(f,this._viewMatrix),f},_transformDirectionToViewSpace:function(M,K){var V=[M[0],M[1],M[2]];ho(V,this._viewMatrix);var y=K?[K[0],K[1],K[2]]:[0,0,0];ho(y,this._viewMatrix);var i=y[0]-V[0],u=y[1]-V[1],c=y[2]-V[2],j=Math.sqrt(i*i+u*u+c*c);return j?[i/j,u/j,c/j]:[i,u,c]},getWireframeGeometry:function(r){return r.s("wf.geometry")?{color:r.s("wf.color"),width:r.s("wf.width"),mat:r.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(B){return B.s("body.color")},getMat:function(P){return P.getMat?P.getMat():P.s("mat")},getFaceMat:function(o,u){return o.getFaceMat?o.getFaceMat(u):o.s(u+".mat")},getFaceBlend:function(S,D){return S.s(D+".blend")||S.s("all.blend")},getFaceColor:function(z,H){return z.s(H+".color")||z.s("all.color")},getFaceImage:function(f,i){return f.s(i+".image")||f.s("all.image")},getFaceBlendImage:function(j,W){return j.s(W+".blend.image")||j.s("all.blend.image")},getFaceDiscardSelectable:function(z,Z){var K=z.s(Z+".discard.selectable");return K==h?z.s("all.discard.selectable"):K},getFaceUv:function(j,U){return j.s(U+".uv")||j.s("all.uv")},getFaceUvOffset:function(A,o){return A.s(o+".uv.offset")||A.s("all.uv.offset")},getFaceUvScale:function(A,_){return A.s(_+".uv.scale")||A.s("all.uv.scale")},getFaceLight:function(L,V){var y=L.s(V+".light");return y==h?L.s("all.light"):y},getFaceVisible:function(B,v){var $=B.s(v+".visible");return $==h?B.s("all.visible"):$},getFaceOpacity:function(o,G){var J=o.s(G+".opacity");return J==h?o.s("all.opacity"):J},getFaceTransparent:function(V,_){var P=V.s(_+".transparent");return P==h?V.s("all.transparent"):P},getFaceReverseColor:function(A,z){return A.s(z+".reverse.color")||A.s("all.reverse.color")},getFaceReverseFlip:function(r,T){var t=r.s(T+".reverse.flip");return t==h?r.s("all.reverse.flip"):t},getFaceReverseCull:function(I,W){var M=I.s(W+".reverse.cull");return M==h?I.s("all.reverse.cull"):M},getTextureMap:function(){return this._2O},deleteTexture:function(d){var S=this,v=S._2O[d];v&&(delete S._2O[d],S.getGL().deleteTexture(v))},invalidateShape3dCachedImage:function(U){var m=this.getData3dUI(U);m.invalidateCachedTexture(this.getGL())},isInteractive:function(e){return e.s("interactive")},getTexture:function(O,p){if(!O)return h;var c=this,M=c.getGL(),i=c._2O[O];if(!i){var w=ef(O);if(!w)return M._emptyTexture;if(w.uuid||(w.uuid=u.Math.generateUUID()),w.tagName){if(w.dynamic)return ms(M,w,c._1O);i=c._2O[O]=ms(M,w)}else{var S,o=p&&p.s("shape3d.image.cache")&&!c.isInteractive(p),T=c.vr.isPresenting();if(T&&(p._textureUpdateFrame===M._renderInfo.frame?o=!0:p._textureUpdateFrame=M._renderInfo.frame),o&&(S=c.getData3dUI(p),i=S.getCachedTexture()),!i){if(o){if(M._renderInfo.cacheTimeCost>C.graph3dMaxVectorCacheTime)return c.redraw(),M._emptyTexture;if(!Dh(w,p))return M._emptyTexture}var G,k=p&&p.s("shape3d.fixSizeOnScreen"),n=k?M.NEAREST:M.LINEAR;k||p&&p.s("shape3d.vector.dynamic")&&(S||(S=c.getData3dUI(p)),k=S.getVectorDynamicSize(),k&&(G=c.getDevicePixelRatio(),k[0]*=G,k[1]*=G));var r,D,B=p&&p.s("shape3d.texture.scale")||1;if(k?(G||(G=c.getDevicePixelRatio()),r=k[0]>0?k[0]:B*iq(w,p)*G,D=k[1]>0?k[1]:B*Yh(w,p)*G):(r=B*iq(w,p),D=B*Yh(w,p)),r>=1&&D>=1){var A=0;o&&(A=Date.now());var U=yp(r,D);if(!S&&p&&(S=c.getData3dUI(p)),S&&S.interactiveInfo){var f=O;"object"==typeof f&&(f=f.uuid||(f.uuid=u.Math.generateUUID()));var F=S.interactiveInfo[f]={};U.interactiveInfo=F.bodyInfo={compInfos:[],matrix:new Er,rect:{x:0,y:0,width:r,height:D}}}oi(U,w,0,0,r,D,p,c),U.interactiveInfo&&(U.interactiveInfo=null),U.restore(),o||T?(i=ms(M,wo,null,n),S.setCachedTexture(i),M._renderInfo.cacheTimeCost+=Date.now()-A,wo=null):i=ms(M,wo,c._1O,n)}}}}return i},redraw:function(){this.iv()},validateImpl:function(){var A=this;if(A._lightChanged){A._lightChanged=!1;var c=[],I=[],g=[];A.dm().each(function(i){if(Or(i)){var E=i.s("light.type");E===Pn?c.push(i):E===sd?I.push(i):E===Iq&&g.push(i)}}),(c.length!==A._59O.length||I.length!==A._spots.length||g.length!==A._dirs.length)&&Vo(A),A._59O=c,A._spots=I,A._dirs=g}A._42(),A._1o.iv()},getRenderInfo:function(){var M=this.getGL();return M?M._renderInfo:void 0},getDebugTip:function(){var W=this,l=W.getRenderInfo();if(l){var Q=W.getGL()._validBufCount||0,y="Draw Calls: "+l.calls+"<br/>"+"Vertices: "+l.vertices+"<br/>"+"Faces: "+l.faces+"<br/>"+"Lines: "+l.lines+"<br/>"+"Buffer Count: "+Q;return W.vr.isPresenting()&&(y+="<br/>VR fps: "+W.vr.getFps()),y}},_42:function(l,B){var y=this;if(!y._35O&&(!zg||rf(zg))){var L,e;l&&(l instanceof lf?e=l:L=l);var A=y._canvas,D=y.getGL(),T=y._prg;if(D){var r=y.getWidth(),p=y.getHeight();B?l||Dg(A,r,p,B):(B=y.getDevicePixelRatio(),l||r===A.clientWidth&&p===A.clientHeight||Dg(A,r,p,B)),D.clear(D.COLOR_BUFFER_BIT),y.drawFilter||(D._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:l?y._frameId:++y._frameId,cacheTimeCost:0});var w=function(){if(y.overlappingBox.clear(),y._81O=h,D.clear(D.DEPTH_BUFFER_BIT),vm(D,T.uBrightness,1),vm(D,T.uOpacity,1),vm(D,T.uPartOpacity,1),D._picking=!!l,vm(D,T.uPick,!!l),vm(D,T.uTexture,!1),vm(D,T.uBlendTexture,!1),vm(D,T.uAlphaTest,O.alphaTest),vm(D,T.uTransparent,!1),vm(D,T.uFix,!1),vm(D,T.uBatchColor,!1),vm(D,T.uBatchBlend,!1),vm(D,T.uBatchBrightness,!1),vm(D,T.uReflectivity,y._envmapReflectivity||.5),vm(D,T.uCameraPosition,y.getEye()),vm(D,T.uPMatrix,y._projectMatrix=Se(y)),vm(D,T.uViewMatrix,Hj(y,y._7O)),y.bindEnvMap(D),y._viewMatrix=Xg(y._7O),l||(Yk(y,D,T),y._fogDisabled||(vm(D,T.uFogColor,y._fogColor),vm(D,T.uFogNear,y._fogNear),vm(D,T.uFogFar,y._fogFar))),Rr(D,T.aPosition),Rr(D,T.aNormal),an(D,T.aUv),an(D,T.aBatchColor),an(D,T.aBatchBlend),an(D,T.aBatchBrightness),an(D,T.aLineDistance),e){var B=D.getParameter(D.COLOR_CLEAR_VALUE);D.clearColor(0,0,0,0),D.disable(D.BLEND),an(D,T.aNormal),Hf(D,y._cube.vs,h,T.aPosition),fl(D,y._cube.is),Pf(e,y,nh,0),Pf(e,y,Ak,6),Pf(e,y,lp,12),Pf(e,y,ii,18),Pf(e,y,mj,24),Pf(e,y,Sh,30),Rr(D,T.aNormal),Sg(D,B)}else if(L){L.value=2;var B=D.getParameter(D.COLOR_CLEAR_VALUE);D.clearColor(0,0,0,0),D.disable(D.BLEND),y._95I(D,T,L),Km(y,L),Mg(y,y._polylineModelMap,L),Mg(y,y._wireframeModelMap,L),vm(D,T.uTransparent,!0),y._95I(D,T,L,!0),Km(y,L,!0),Mg(y,y._polylineModelMap,L,!0),Mg(y,y._wireframeModelMap,L,!0),vm(D,T.uTransparent,!1),D.clear(D.DEPTH_BUFFER_BIT),y._swapLineMap(),y._95I(D,T,L,!1,!0),Mg(y,y._polylineModelMap,L),Mg(y,y._wireframeModelMap,L),y._swapLineMap(),y._swapLineMap(),y._95I(D,T,L,!1,!0),Mg(y,y._polylineModelMap,L),Mg(y,y._wireframeModelMap,L),vm(D,T.uTransparent,!0),y._95I(D,T,L,!0,!0),Mg(y,y._polylineModelMap,L,!0),Mg(y,y._wireframeModelMap,L,!0),vm(D,T.uTransparent,!1),y._swapLineMap(),D.disable(D.DEPTH_TEST),y.drawFilter||y._30O._42(D,T,L),D.enable(D.DEPTH_TEST),Sg(D,B)}else D.disable(D.BLEND),y.drawSky(D,T),y._31O._42(D,T),y._95I(D,T),Km(y),Mg(y,y._polylineModelMap),Mg(y,y._wireframeModelMap),D.enable(D.BLEND),vm(D,T.uTransparent,!0),D.depthMask(!1),y._95I(D,T,h,!0),Km(y,h,!0),Mg(y,y._polylineModelMap,h,!0),Mg(y,y._wireframeModelMap,h,!0),D.depthMask(!0),vm(D,T.uTransparent,!1),D.clear(D.DEPTH_BUFFER_BIT),y._swapLineMap(),D.disable(D.BLEND),y._95I(D,T,h,!1,!0),Mg(y,y._polylineModelMap),Mg(y,y._wireframeModelMap),D.enable(D.BLEND),vm(D,T.uTransparent,!0),D.depthMask(!1),y._95I(D,T,h,!0,!0),Mg(y,y._polylineModelMap,h,!0),Mg(y,y._wireframeModelMap,h,!0),D.depthMask(!0),vm(D,T.uTransparent,!1),y._swapLineMap(),D.disable(D.DEPTH_TEST),D.disable(D.BLEND),y._32O._42(D,T),y._30O._42(D,T),y._highlightHelper._42(D,T),D.enable(D.DEPTH_TEST);Hf(D,h),fl(D,h)},t=!1,R=r*B,F=p*B,d=y.vr;d.enable&&d._42(D,R,F,w)&&(t=!0);var P=y.envRenderer;P&&P.enable&&P._42(D,R,F,w)&&(t=!0);var I=y._postProcessing;I._42(D,R,F,w,l)&&(t=!0),t||(y.setViewport(D,0,0,r*B,p*B),w()),y._33Q=!1,y.drawFilter||y.countFrame(),y._doBufferGC(D)}}},enablePostProcessing:function(Q,S){return this._postProcessing.enableModule(Q,S)},getPostProcessingModule:function(c){return this._postProcessing.getModule(c)},setViewport:function(z,Y,I,r,q){this._viewport=[Y,I,r,q],z.viewport(Y,I,r,q)},getViewport:function(){return this._viewport},setBufferGCInterval:function(t){this._bufferGCInterval=t},_doBufferGC:function(j,$){var L,X,Q=j._bufPool,J=0,h=0,Y=j._renderInfo.frame,x=this._bufferGCInterval||10;for(L in Q)J++,X=Q[L],X&&($||Y-X._fid>x?(j.deleteBuffer(X._buf),X._buf=null,Q[L]=null):h++);if(J/2>h&&J>128){var N={};for(L in Q)Q[L]&&(N[L]=Q[L]);j._bufPool=N}j._validBufCount=h},_swapLineMap:function(){var g=this;k=g._polylineModelMap,g._polylineModelMap=g._polylineModelMapSwap,g._polylineModelMapSwap=k,k=g._wireframeModelMap,g._wireframeModelMap=g._wireframeModelMapSwap,g._wireframeModelMapSwap=k,k=g._polylineIndexMap,g._polylineIndexMap=g._polylineIndexMapSwap,g._polylineIndexMapSwap=k,k=g._wireframeIndexMap,g._wireframeIndexMap=g._wireframeIndexMapSwap,g._wireframeIndexMapSwap=k},_updateSkyBox:function(z){if(this._skyBox&&z){var n=z.property,G=!1,I=this._skyBox;if("eye"===n||"forceUpdate"===n){var e=this._eye;I.p3(e[0],e[1],e[2]),G=!0}if("near"===n||"far"===n||"forceUpdate"===n){var K=this._near,W=this._far,l=I.getFinalScale3d();if(l[0]/=2,l[1]/=2,l[2]/=2,l[0]<=K||l[0]>=W||l[1]<=K||l[1]>=W||l[2]<=K||l[2]>=W){var r=2*K*W/(K+W),i=Math.min(l[0],l[1],l[2]),d=r/i,h=I.getScale3d();I.setScale3d(h[0]*d,h[1]*d,h[2]*d),G=!0}}G&&this.invalidateData(I)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(e){var Y=this._skyBox;Y&&(this._skyBoxStyleMap&&Y.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&Y.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&Y.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=e,this.ump(this._updateSkyBox,this),e&&(e.dm()&&e.dm().remove(e),this._skyBoxStyleMap=u.Default.clone(e.getStyleMap()),this._skyBoxAnchor3d=e.getAnchor3d(),e.setAnchor3d(.5,.5,.5),this._skyBoxP3=e.p3().slice(0),e.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",Y,e)},drawSky:function(g,v,Q){var o=this,L=o._skyBox;if(L){var K=o._headlightIntensity,d=Rm(o._headlightColor),v=o._prg;1!==K&&(d=[d[0]*K,d[1]*K,d[2]*K]),vm(g,v.uHeadlightColor,[d[0],d[1],d[2],1]);var G=o.getData3dUI(L);G&&G._42(g,v,Q,function(){return!0}),g.clear(g.DEPTH_BUFFER_BIT),vm(g,v.uHeadlightColor,[d[0],d[1],d[2],o._headlightDisabled?1:0])}},_95I:function(j,p,c,t,e){function u(r){if(!!r.s("shape3d.alwaysOnTop")==!!e&&m.isVisible(r)&&(!Y||I)){if(!c&&m.isTransparentMask(r))return;var B=m.getData3dUI(r);B&&B._42(j,p,c,s)}}var m=this,s=function(Z){return t?Z:!Z};m.sky&&j.clear(j.DEPTH_BUFFER_BIT);var U=m.drawFilter;U?m.dm().each(function(S){U(S)||u(S)}):m.dm().each(function(p){u(p)})},getLogicalPoint:function(A){return Oq(A,this._canvas)},isRectOverlapping:function(o){var b=this.getData3dUI(o);return b._rectOverlapping},getHitFaceInfo:function(j){j.target&&(j=this.lp(j));var n=this.getDataInfoAt(j);if(n){var q=this._1o.face(n.data,Ge(j.x,j.y));if(q)return{data:n.data,face:q}}return h},unproject:function(g,X){var f=this,E=f.getWidth(),a=f.getHeight(),v=g.target?f.lp(g):g,G=v.x-E/2,Z=v.y-a/2,D=2*(G/E),N=2*(-1*Z/a);X=X||0;var Q=Jr(),W=Se(f),l=Hj(f);Me(Q,W,l),Gn(Q);var Y=ph([D,N,X,1],Q);return[Y[0]/Y[3],Y[1]/Y[3],Y[2]/Y[3]]},getDataAt:function(C){var S=this.getDataInfoAt(C);return S?S.data:h},getDataInfoAt:function(h,K){return h.target&&(h=this.lp(h)),this._1o.get(Ge(h.x,h.y,K),!0)},getDatasInRect:function(y){return this._1o.get(y)},setEditable:function(O){var o=this,Q=o._editable;o._editable=O,this.fp(eg,Q,O)},isEditable:function(u){var x=this;return x._editable?bh(u)?u.s("3d.editable")?x._editableFunc?x._editableFunc(u):!0:!1:!1:!1},isSelectable:function(t){return t.s("3d.selectable")&&this.sm().isSelectable(t)},isMovable:function(Z){var H=this;return Jl(Z)&&Z.getStyle(Nj)!==_c?!1:Z.s("3d.movable")?H._movableFunc?H._movableFunc(Z):!0:!1},isSizeEditable:function(b){return bh(b)?this._sizeEditableFunc?this._sizeEditableFunc(b):!0:!1},isRotationEditable:function(X){return bh(X)&&X.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(X):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(g){this.setZoom(Je,g)},zoomOut:function(T){this.setZoom(1/Je,T)},setZoom:function(p,w){if(1!==p){var b=this;if(b._ortho)return b.setOrthoZoom(p,w),void 0;b._14o&&b._14o.stop(!0);var q=1/p,E=b._eye,o=b._center,u=o[0]+(E[0]-o[0])*q-E[0],U=o[1]+(E[1]-o[1])*q-E[1],n=o[2]+(E[2]-o[2])*q-E[2];if(!(Im(E,o)<b._moveStep&&1>q)){if(w=Td(w)){var x=ud(E);return w.action=function(N){b.fi({kind:b._zooming?"betweenZoom":"beginZoom"}),b._zooming=1,E[0]=x[0]+u*N,E[1]=x[1]+U*N,E[2]=x[2]+n*N,b.fp(rp,h,E)},w._37o=function(){delete b._14o,delete b._zooming,b.fi({kind:"endZoom"}),b.onZoomEnded()},b._14o=Qb(w)}E[0]+=u,E[1]+=U,E[2]+=n,b.fp(rp,h,E)}}},setOrthoZoom:function(Q,W){if(1!==Q){var A=this;A._14o&&A._14o.stop(!0);var Z=A._orthoWidth,I=Z/Q-Z;if(!(Z<A._moveStep&&Q>1))return(W=Td(W))?(W.action=function(z){A.fi({kind:A._zooming?"betweenZoom":"beginZoom"}),A._zooming=1,A.setOrthoWidth(Z+I*z)},W._37o=function(){delete A._14o,delete A._zooming,A.fi({kind:"endZoom"}),A.onZoomEnded()},A._14o=Qb(W)):(A.setOrthoWidth(Z/Q),void 0)}},getPositionInfo:function(D){var V=this,j=V._eye,R=V._center,M=V.getAspect(),$=D?Mr(Fn(R,j,!0),Fn(D,j)):Im(j,R);if(V._ortho){var U=V._orthoWidth;return{length:$,height:U/M,width:U}}var w=2*a(V._fovy/2)*$;return{length:$,height:w,width:w*M}},getCenterInfo:function(){var U=this;return U._81O||(U._81O=U.getPositionInfo()),ud(U._81O)},rotate:function(F,S,Y,O){var d=this;if(F||S){O==h&&(O=d._firstPersonMode),d._88O&&d._88O.stop(!0);var C=d._center,L=d._eye,s=d.getCenterInfo().length,G=O?C:L,m=O?L:C,E=Fn(G,m),t=i(E[0],E[2]),w=i(W(E[0]*E[0]+E[2]*E[2]),E[1]),T=O?Gg:rp;return O&&(S=-S),(Y=Td(Y))?(Y.action=function(M){d.fi({kind:d._rotating?"betweenRotate":"beginRotate"}),d._rotating=1;var n=t+F*M,U=w+S*M;U=mq(U),E[0]=s*K(U)*K(n),E[1]=s*z(U),E[2]=s*K(U)*z(n),G[0]=m[0]+E[0],G[1]=m[1]+E[1],G[2]=m[2]+E[2],d.fp(T,h,G)},Y._37o=function(){delete d._88O,delete d._rotating,d.fi({kind:"endRotate"}),d.onRotateEnded()},d._88O=Qb(Y)):(t+=F,w+=S,w=mq(w),E[0]=s*K(w)*K(t),E[1]=s*z(w),E[2]=s*K(w)*z(t),G[0]=m[0]+E[0],G[1]=m[1]+E[1],G[2]=m[2]+E[2],d.fp(T,h,G),void 0)}},pan:function(C,b,x,j){if(C||b){var y=this;j==h&&(j=y._firstPersonMode),y._89O&&y._89O.stop(!0);var e=Hj(y),w=[e[0]*C,e[4]*C,e[8]*C],q=[e[1]*b,e[5]*b,e[9]*b],B=w[0]+q[0],M=w[1]+q[1],Q=w[2]+q[2],X=y._center,c=y._eye;if(j){var _=Vk(y.getBoundaries(),c[0],c[2],c[0]+B,c[2]+Q,W(B*B+Q*Q));B=_[0],Q=_[1]}if(x=Td(x)){var P=ud(c),s=ud(X);return x.action=function(U){y.fi({kind:y._panning?"betweenPan":"beginPan"}),y._panning=1,X[0]=s[0]+B*U,X[1]=s[1]+M*U,X[2]=s[2]+Q*U,c[0]=P[0]+B*U,c[1]=P[1]+M*U,c[2]=P[2]+Q*U,y.fp(rp,h,c),y.fp(Gg,h,X)},x._37o=function(){delete y._89O,delete y._panning,y.fi({kind:"endPan"}),y.onPanEnded()},y._89O=Qb(x)}X[0]+=B,X[1]+=M,X[2]+=Q,c[0]+=B,c[1]+=M,c[2]+=Q,y.fp(rp,h,c),y.fp(Gg,h,X)}},walk:function(X,b,x){if(X){var E=this;x==h&&(x=E._firstPersonMode),E._90O&&E._90O.stop(!0);var M=E._center,m=E._eye,g=Fn(M,m,!0);if(x){var Q=Vk(E.getBoundaries(),m[0],m[2],m[0]+g[0]*X,m[2]+g[2]*X,r(X));if(X=Im(Q),!X)return;g=[Q[0]/X,0,Q[1]/X]}if(b=Td(b)){var _=ud(m),V=ud(M);return b.action=function(d){E.fi({kind:E._walking?"betweenWalk":"beginWalk"}),E._walking=1;var p=X*d;m[0]=_[0]+g[0]*p,m[1]=_[1]+g[1]*p,m[2]=_[2]+g[2]*p,M[0]=V[0]+g[0]*p,M[1]=V[1]+g[1]*p,M[2]=V[2]+g[2]*p,E.fp(rp,h,m),E.fp(Gg,h,M)},b._37o=function(){delete E._90O,delete E._walking,E.fi({kind:"endWalk"}),E.onWalkEnded()
},E._90O=Qb(b)}m[0]+=g[0]*X,m[1]+=g[1]*X,m[2]+=g[2]*X,M[0]+=g[0]*X,M[1]+=g[1]*X,M[2]+=g[2]*X,E.fp(rp,h,m),E.fp(Gg,h,M)}},handleScroll:function(s,g){s.preventDefault();var S=this,G=S._moveStep,X=S.getDataInfoAt(s);if(X){var C=X.data;if(C&&S.isInteractive(C)){var W=S.intersectObject(s,C);if(W){var H=W.part,P=ef(C.s(H+".image")||C.s("shape3d."+H+".image")||C.s("all.image")||C.s("shape3d.image"));if(P&&pf(P.scrollable,C,S))return}}}S.isFirstPersonMode()?S.isPannable()&&S.pan(0,g>0?G:-G):S.isZoomable()&&S.setZoom(0>g?1/ep:ep)},handlePinch:function(m,n){this.isZoomable()&&this.setZoom(n>m?1/ns:ns)},reset:function(){this.setCenter(C.graph3dViewCenter),this.setEye(C.graph3dViewEye),this.setUp(C.graph3dViewUp)},moveSelection:function(K,x,T){var q=this;q.dm().beginTransaction(),fo(this.sm().toSelection(this.isMovable,this),K,x,T),q.dm().endTransaction()},getMoveMode:function(P,x){var X=x.s("3d.move.mode");if(X)return X;var v="88",V="89",r="90";return oe(P)||lq[v]&&lq[V]&&lq[r]?"xyz":lq[v]&&lq[V]?"xy":lq[v]&&lq[r]?"xz":lq[V]&&lq[r]?"yz":lq[v]?"x":lq[V]?"y":lq[r]?"z":"xz"},handleTick:function(){var h=this,O=!1,G=h._moveStep,S=G,f=!1,n=!0,q=h._rotateStep*(n?-1:1);if(h.isWalkable()||(S=0),h.isPannable()||(G=0),h.isRotatable()||(q=0),h._32Q){var F=(cf()-h._32Q)/50;S*=F,G*=F,q*=F}h._31Q&&(Mi(h._31Q),delete h._31Q,delete h._32Q),dr()&&(O=!0,h.pan(-G,0,f,n)),km()&&(O=!0,h.pan(G,0,f,n)),gi()&&(O=!0,oe()?h.pan(0,G,f,n):h.walk(S,f,n)),be()&&(O=!0,oe()?h.pan(0,-G,f,n):h.walk(-S,f,n)),$j()&&(O=!0,h.rotate(-q,0,f,n)),Mb()&&(O=!0,h.rotate(q,0,f,n)),Pl()&&(O=!0,h.rotate(0,-q/2,f,n)),Bm()&&(O=!0,h.rotate(0,q/2,f,n)),O&&(h._32Q=cf(),h._31Q=Yb(h.handleTick,h))},handleKeyDown:function(b){var k=this;!lk(b)&&oq[b.keyCode]?k.handleTick():Zb(b)?k.selectAll():ub(b)?k.handleDelete(b):eo(b)&&this.isResettable()&&k.reset()},checkDoubleClickOnNote:function(P,u,X){var z=this;if(X===ve){if(u.s("note.toggleable"))return u.s(Po,!u.s(Po)),z.fi({kind:"toggleNote",event:P,data:u,part:X}),!0}else if(X===en&&u.s("note2.toggleable"))return u.s(hp,!u.s(hp)),z.fi({kind:"toggleNote2",event:P,data:u,part:X}),!0;return!1},checkDoubleClickOnRotation:function(v,G,z){return z===Xh?(G.setRotationX(0),!0):z===br?(G.setRotationY(0),!0):z===Ip?(G.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(K){var W=this;if(W.isOrtho())return W.getWidth()/W.getOrthoWidth();var M=W.getCenter(),w=W.getHeight(),R=W.getEye(),N=[M[0]-R[0],M[1]-R[1],M[2]-R[2]],Z=[K[0]-R[0],K[1]-R[1],K[2]-R[2]],r=Math.sqrt(N[0]*N[0]+N[1]*N[1]+N[2]*N[2]),Y=1/Math.tan(W.getFovy()/2);return w*r*Y/(Z[0]*N[0]+Z[1]*N[1]+Z[2]*N[2])},inViewSpace:function(w){var _,h=this,z=h._transformPointToViewSpace(w),Q=h.getAspect(),L=h.getNear(),I=h.getFar();return-z[2]<L||-z[2]>I?!1:h.isOrtho()?(_=h.getOrthoWidth()/2,Math.abs(z[0])<=_&&Math.abs(z[1]*Q)<=_):(_=Math.sqrt(z[0]*z[0]+z[1]*z[1]+z[2]*z[2])*Math.tan(h.getFovy()/2),Math.abs(z[1]<=_)&&Math.abs(z[0])<=_*Q)},toViewPosition:function(B){var L=this,h=L.getWidth()/2,x=L.getHeight()/2,E=L._18Q;return E&&E._wh===h/x||(E=Se(L),L._18Q=Me(E,E,Hj(L)),L._18Q._wh=h/x),B=ph([B[0],B[1],B[2],1],E),{x:h+h*B[0]/B[3],y:x-x*B[1]/B[3]}},getHitPosition:function(w,z,K){var x=this,A=x.getWidth(),N=x.getHeight(),M=w.target?x.lp(w):w,b=M.x-A/2,B=M.y-N/2,E=x.getCenterInfo(),j=Hj(x);z=z?z:[0,0,0],K=K?K:[0,1,0],b=b/A*E.width,B=-1*B/N*E.height;var Z=[j[0]*b,j[4]*b,j[8]*b],Y=[j[1]*B,j[5]*B,j[9]*B],d=[Z[0]+Y[0],Z[1]+Y[1],Z[2]+Y[2]],p=x.getCenter(),v=op(x,z,K,[d[0]+p[0],d[1]+p[1],d[2]+p[2]]);return v?v:[0,0,0]},intersectObject:function(r,E){return this._raycaster.intersectObject(r,E)},intersectObjects:function(G,V,B){return this._raycaster.intersectObjects(G,V,B)},getLineLength:function(x){this.validate();var K=this.getData3dUI(x);if(K&&K.getCache){var z=K.getCache();if(z)return z[z.length-1].length}return 0},getLineOffset:function(y,_){var W=this.getData3dUI(y);if(W&&W.getCache){var r=W.getCache();if(r)return Qo(r,_)}return h},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(w,N,V){var d=this,t=d.getEye();t=[t[0],t[1],t[2]];var A=d.getCenter();if(A=[A[0],A[1],A[2]],w||(w=t),N||(N=A),d._flyAnim&&d._flyAnim.stop(!0),V=Td(V),!V)return d.setEye(w[0],w[1],w[2]),d.setCenter(N[0],N[1],N[2]),delete d._flyAnim,!0;var f=[w[0]-t[0],w[1]-t[1],w[2]-t[2]],D=[N[0]-A[0],N[1]-A[1],N[2]-A[2]];return V.action=function(c){d.setCenter(A[0]+D[0]*c,A[1]+D[1]*c,A[2]+D[2]*c),d.setEye(t[0]+f[0]*c,t[1]+f[1]*c,t[2]+f[2]*c)},V._37o=function(){delete d._flyAnim},d._flyAnim=Qb(V)},flyTo:function(){function j(M,d,x){if(x instanceof u.Node){V.fromArray(or(x,d.getMat(x)));var C=x.getAnchor3d();M.push((new tc).set(0-C.x,0-C.y,0-C.z).applyMatrix4(V)),M.push((new tc).set(0-C.x,0-C.y,1-C.z).applyMatrix4(V)),M.push((new tc).set(0-C.x,1-C.y,0-C.z).applyMatrix4(V)),M.push((new tc).set(0-C.x,1-C.y,1-C.z).applyMatrix4(V)),M.push((new tc).set(1-C.x,0-C.y,0-C.z).applyMatrix4(V)),M.push((new tc).set(1-C.x,0-C.y,1-C.z).applyMatrix4(V)),M.push((new tc).set(1-C.x,1-C.y,0-C.z).applyMatrix4(V)),M.push((new tc).set(1-C.x,1-C.y,1-C.z).applyMatrix4(V))}}var g=new tc,D=new tc,Y=new tc,B=new tc,V=new cc,y=new u.Math.Quaternion,t=new Vc;return function(U,b,W){var O=this;if(W!==l)b={animation:b,ratio:W};else{var I=typeof b;("boolean"===I||"object"===I&&b.duration)&&(b={animation:b})}b=b||{},g.fromArray(O.getEye()),D.fromArray(O.getCenter());var E,f,Z=[],M=b.center,r=b.distance===l;if(M&&Y.fromArray(M),U instanceof u.Node)M||Y.fromArray(U.p3()),r&&(j(Z,O,U),E=Z.length);else{if(U||(U=O.dm().getDatas()),!U.length)return;if((r||!M)&&(Z=[],U.forEach(function(L){j(Z,O,L)}),E=Z.length),!E)return;if(!M){for(Y.set(0,0,0),f=0;E>f;f++)Y.add(Z[f]);Y.multiplyScalar(1/E)}}if(O.setCenter(Y.x,Y.y,Y.z),B.subVectors(g,D),b.direction||b.worldDirection){!b.worldDirection&&U instanceof u.Node?y.setFromEuler(t.set(U.r3(),U.getRotationMode(),!0)):y.set(0,0,0,1);var s=B.length();B.fromArray(b.worldDirection||b.direction).applyQuaternion(y).setLength(s)}if(r){for(var e,i,F,T,z,V=O.getNear(),d=10,W=b.ratio||.8;d--;){for(O._eye[0]=B.x+Y.x,O._eye[1]=B.y+Y.y,O._eye[2]=B.z+Y.z,e=Se(O),Me(e,e,Hj(O)),T=!0,z=-1/0,f=0;E>f;f++){if(F=Z[f],i=ph([F.x,F.y,F.z,1],e),i[3]<V&&d){B.multiplyScalar(2),T=!1;break}z=Math.max(z,Math.max(Math.abs(i[0]),Math.abs(i[1]))/W-i[3])}if(T)break}B.setLength(z+B.length()).add(Y)}else B.setLength(b.distance).add(Y);O._flyAnim&&O._flyAnim.stop(!0);var X=Td(b.animation);if(X){O.setEye(g.x,g.y,g.z),O.setCenter(D.x,D.y,D.z);var w=(new tc).subVectors(B,g),c=(new tc).subVectors(Y,D),H=new tc,v=new tc;return X.action=function(T){H.copy(g).addScaledVector(w,T),v.copy(D).addScaledVector(c,T),O.setCenter(v.x,v.y,v.z),O.setEye(H.x,H.y,H.z)},X._37o=function(){delete O._flyAnim},{lastEye:g,lastCenter:D,eye:B,center:Y,animation:O._flyAnim=Qb(X)}}return O.setEye(B.x,B.y,B.z),delete O._flyAnim,{lastEye:g,lastCenter:D,eye:B,center:Y}}}(),getBoundingBox:function(){function t(f,T,n){H.fromArray(or(n,T.getMat(n)));var h=n.getAnchor3d();f.push((new tc).set(0-h.x,0-h.y,0-h.z).applyMatrix4(H)),f.push((new tc).set(0-h.x,0-h.y,1-h.z).applyMatrix4(H)),f.push((new tc).set(0-h.x,1-h.y,0-h.z).applyMatrix4(H)),f.push((new tc).set(0-h.x,1-h.y,1-h.z).applyMatrix4(H)),f.push((new tc).set(1-h.x,0-h.y,0-h.z).applyMatrix4(H)),f.push((new tc).set(1-h.x,0-h.y,1-h.z).applyMatrix4(H)),f.push((new tc).set(1-h.x,1-h.y,0-h.z).applyMatrix4(H)),f.push((new tc).set(1-h.x,1-h.y,1-h.z).applyMatrix4(H))}var H=new cc;return function(T){if(T=T||this.sm().getSelection(),T instanceof u.Node&&(T=[T]),0===T.length)return h;var n=[];T.forEach(function(A){t(n,this,A)},this);var l=[1/0,1/0,1/0],F=[-1/0,-1/0,-1/0];return n.forEach(function(b){l[0]=Math.min(b.x,l[0]),l[1]=Math.min(b.y,l[1]),l[2]=Math.min(b.z,l[2]),F[0]=Math.max(b.x,F[0]),F[1]=Math.max(b.y,F[1]),F[2]=Math.max(b.z,F[2])}),{min:l,max:F}}}()}),Lg.RenderEnv=function(q){this.gv=q,this.enable=!1},f.defineProperties(Lg.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(V){this._debugOn=V,this.capture&&this.capture()}}}),f.assign(Lg.RenderEnv.prototype,{renderEnvToCube:function(Q,h,d,b){var N=this,n=N.gv;if(!Q||!h||!d)return N.enable=!1,N._42=null,void 0;N.enable=!0;var f=Math.floor(b/Q*h),W=n.getGL(),y=N._renderTargets;y?y.length<d&&(y=N._renderTargets=y.concat(new Array(d-y.length))):y=N._renderTargets=new Array(d);for(var Y=0;d>Y;Y++)y[Y]?y[Y].setSize(W,b,f):y[Y]=new Lg.RenderTarget(n,W,b,f);var w=!1;N.capture=function(){w=!0,n._42(),w=!1};var i=new tc,A=new tc,$=new tc,C=new tc,m=(new tc).setY(0),D=2*Math.PI/d,H=Q/2/Math.tan(Math.PI/d),j=2*Math.atan2(h/2,H),E=Q/h;N._42=function(f,U,s,Y){var t=N._debugOn;if(!w&&!t)return!1;i.copy(n.getEye()),C.copy(n.getCenter()).sub(i);var R=Math.atan2(C.z,C.x),u=n.getNear(),M=n.getFovy(),Q=n.getAspect();A.copy(n.getCenter());for(var T,Z=0;d>Z;Z++)if(T=y[Z],m.setZ(Math.cos(R)).setX(Math.sin(R)).multiplyScalar(H),R-=D,$.addVectors(i,m),n.setNear(H),n.setCenter([$.x,$.y,$.z]),n.setFovy(j),n.setAspect(E),t){var P=Math.round(U/d);f.viewport(P*Z,0,P,s),Y()}else Ue(f,T.frame),f.viewport(0,0,T.width,T.height),f.clear(f.COLOR_BUFFER_BIT),Y(),$q(f),T.assureTexture();return n.setNear(u),n.setCenter([A.x,A.y,A.z]),n.setFovy(M),n.setAspect(Q),!0},N.capture()},getTextureInfo:function(w){var L=this._renderTargets;if(!L)return null;var X=this._renderTargets[w];return X?{index:w,texture:X.texture,textureName:X.uuid}:null}}),f.assign(Lg.Graph3dView.prototype,{renderEnvToCube:function(V,Y,U,r){var w=this;w.envRenderer||(w.envRenderer=new Lg.RenderEnv(w)),w.envRenderer.renderEnvToCube(V,Y,U,r)}}),Lg.RenderTarget=function(b,D,L,g,Q){var i=this;Q=Q||{},i.uuid=u.Math.generateUUID(),i.gv=b,i.init(b,D,Q),i.setSize(D,L,g)},f.assign(Lg.RenderTarget.prototype,{init:function(z,H,u){var E=this,J=E.texture=H.createTexture();H.activeTexture(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,J),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_S,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_WRAP_T,H.CLAMP_TO_EDGE),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MIN_FILTER,u.minFilter||H.LINEAR),H.texParameteri(H.TEXTURE_2D,H.TEXTURE_MAG_FILTER,u.magFilter||H.LINEAR),H.bindTexture(H.TEXTURE_2D,null),E.render=H.createRenderbuffer(),E.frame=H.createFramebuffer(),z._2O[E.uuid]=J},assureTexture:function(){var D=this,j=D.uuid,P=D.gv._2O;P[j]||(P[j]=D.texture)},setSize:function(i,N,l){var E=this;if(E.width!==N||E.height!==l){var G=i.RGBA,p=i.TEXTURE_2D,t=i.RENDERBUFFER,u=i.FRAMEBUFFER;yf(i,E.texture),i.texImage2D(p,0,G,N,l,0,G,i.UNSIGNED_BYTE,h),i.bindRenderbuffer(t,E.render),i.renderbufferStorage(t,i.DEPTH_COMPONENT16,N,l),Ue(i,E.frame),i.framebufferTexture2D(u,i.COLOR_ATTACHMENT0,p,E.texture,0),i.framebufferRenderbuffer(u,i.DEPTH_ATTACHMENT,t,E.render),yf(i,h),i.bindRenderbuffer(t,h),$q(i),E.width=N,E.height=l}},toCanvas:function(){var W=this,k=W.gv.getGL();Ue(k,W.frame);var S=W.width,u=W.height,Z=new Uint8Array(4*S*u);k.readPixels(0,0,S,u,k.RGBA,k.UNSIGNED_BYTE,Z),$q(k);var y=w.createElement("canvas");y.width=S,y.height=u;var N=y.getContext("2d"),o=N.createImageData(S,u);return o.data.set(Z),N.putImageData(o,0,0),y}});var Wj=Lg.Interactor=function(E){this.gv=E};_i("Interactor",f,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Yi=Lg.DefaultInteractor=function(h){Yn(Yi,this,[h])};_i("DefaultInteractor",Wj,{handle_contextmenu:function(z){ll(z)},handle_mousewheel:function(Q){this.gv.handleScroll(Q,Q.wheelDelta/40)},handle_DOMMouseScroll:function(k){2===k.axis&&this.gv.handleScroll(k,-k.detail)},handle_keydown:function(B){this.gv.handleKeyDown(B)},handle_mousedown:function(c){this.handle_touchstart(c)},handle_touchstart:function(t){ll(t);var W=this,d=W.gv,$=ci(t),R=d.getDataInfoAt(t),D=R?R.data:h,o=R?R.part:h,b=d.sm(),s=Fb(t),f=Gd(t);d.setFocus(t)&&(W._62O=h,W._57I=h,D?lk(t)?b.co(D)?b.rs(D):b.as(D):b.co(D)||b.ss(D):$&&(lk(t)?d.isRectSelectable()&&(W._62O=zp):W._57I=kg(t)),W._31Q&&(Mi(W._31Q),delete W._31Q,delete W._32Q),W._62O||(d.isFirstPersonMode()&&(oe(t)||f>2?W._62O="pan":d.isMouseRoamable()||Sl?(W._62O="roaming",W.foward=s&&ci(t),W._32Q=cf(),W._31Q=Yb(W.tick,W)):$||(W._62O="roaming")),W._62O||($&&s&&te[o]?(W._62O=o,W.p3=D.p3()):$&&s&&bh(D)&&d.isSelected(D)?d.isMovable(D)?(W._62O="move",W.p3=D.p3(),W.movedata=D):d.isInteractive(D)&&(W._62O="none"):Sl&&(f>2?W._62O="pan":2===f&&(W.dist=nl(t),W._62O="pinch")))),W.point=d.lp(t),_f(W,t),fi(t)?d.handleDoubleClick(t,D,o):d.handleClick(t,D,o))},tick:function(){var N=this,F=N.gv,s=F._moveStep;N.point&&F.isWalkable()&&(N._32Q&&(s*=(cf()-N._32Q)/50),F.walk(N.foward?s:-s),N._32Q=cf(),N._31Q=Yb(N.tick,N))},handle_mouseup:function(R){this.handle_touchend(R)},handle_touchend:function(S){var A=this._57I;A&&(Im(A,kg(S))<=1&&this.gv.sm().cs(),this._57I=h)},handleWindowMouseMove:function(W){this.handleWindowTouchMove(W)},handleWindowTouchMove:function(N){var p,h,Z=this,U=Z.gv,n=Z._62O,$=Z.point,V=U.dm(),j=U.lp(N),W=j.x-$.x,B=j.y-$.y,i=U.getWidth(),Y=U.getHeight();if(i&&Y){var S=-x*W/i,v=-x*B/Y;if("roaming"===n)Z.rotate(N,S/2,v/2);else if(n===Xh||n===br||n===Ip)U._86O||V.beginTransaction(),U.fi({kind:U._86O?"betweenEditRotation":"beginEditRotation",event:N}),U._86O=1,U.sm().each(function(L){if(bh(L)&&U.isRotationEditable(L)){var $=r(S)>r(v)?S:v;n===Xh?L.setRotationX(L.getRotationX()+$):n===br?L.setRotationY(L.getRotationY()+$):n===Ip&&L.setRotationZ(L.getRotationZ()+$)}});else if("move"===n||te[n]){n===$n||n===Bb||n===md?(U._87O||V.beginTransaction(),U.fi({kind:U._87O?"betweenEditScale":"beginEditScale",event:N}),U._87O=1):(U._moving||V.beginTransaction(),U.fi({kind:U._moving?"betweenMove":"beginMove",event:N}),U._moving=1);var z,Q=Z.p3,M=U.getPositionInfo(Q),t=Hj(U);z=n===ke?"x":n===qn?"y":n===Eo?"z":n===$n?"sx":n===Bb?"sy":n===md?"sz":U.getMoveMode(N,Z.movedata),W=W/i*M.width,B=-1*B/Y*M.height;var O,g,o=[t[0]*W,t[4]*W,t[8]*W],J=[t[1]*B,t[5]*B,t[9]*B],m=o[0]+J[0],L=o[1]+J[1],b=o[2]+J[2],f=[Q[0]+m,Q[1]+L,Q[2]+b],A=Fn(U.getEye(),f,!0);if("xyz"===z?(O=f,U.moveSelection(m,L,b)):"xz"===z?(O=op(U,Q,[0,1,0],f),O&&U.moveSelection(O[0]-Q[0],0,O[2]-Q[2])):"xy"===z?(O=op(U,Q,[0,0,1],f),O&&U.moveSelection(O[0]-Q[0],O[1]-Q[1],0)):"yz"===z?(O=op(U,Q,[1,0,0],f),O&&U.moveSelection(0,O[1]-Q[1],O[2]-Q[2])):"x"===z||"sx"===z?(A[0]=0,O=op(U,Q,A,f),O&&(g=O[0]-Q[0],"x"===z?U.moveSelection(g,0,0):U.sm().each(function(Q){bh(Q)&&U.isSizeEditable(Q)&&(p=Q.getScaleX()+g/100,h=p/Q.getScaleX(),Q.setScaleX(p),oe(N)&&(Q.setScaleY(Q.getScaleY()*h),Q.setScaleTall(Q.getScaleTall()*h)))}))):"y"===z||"sy"===z?(A[1]=0,O=op(U,Q,A,f),O&&(g=O[1]-Q[1],"y"===z?U.moveSelection(0,g,0):U.sm().each(function(O){bh(O)&&U.isSizeEditable(O)&&(p=O.getScaleTall()+g/100,h=p/O.getScaleTall(),O.setScaleTall(p),oe(N)&&(O.setScaleY(O.getScaleY()*h),O.setScaleX(O.getScaleX()*h)))}))):("z"===z||"sz"===z)&&(A[2]=0,O=op(U,Q,A,f),O&&(g=O[2]-Q[2],"z"===z?U.moveSelection(0,0,g):U.sm().each(function(n){bh(n)&&U.isSizeEditable(n)&&(p=n.getScaleY()+g/100,h=p/n.getScaleY(),n.setScaleY(p),oe(N)&&(n.setScaleX(n.getScaleX()*h),n.setScaleTall(n.getScaleTall()*h)))}))),!O)return;Z.p3=O}else if(n===zp){var e=Z.div;e||(e=Z.div=Ki(),Pp(Z.getView(),e),e.op=$,e.style.background=U.getRectSelectBackground()),U.fi({kind:U._rectSelecting?"betweenRectSelect":"beginRectSelect",event:N}),U._rectSelecting=1,e.rect=Vn(e.op,j),rr(e,e.rect)}else if("pinch"===n&&2===Gd(N)){U.fi({kind:U._pinching?"betweenPinch":"beginPinch",event:N}),U._pinching=1;var g=nl(N);U.handlePinch(g,Z.dist),Z.dist=g}else"pan"===n||oe(N)?Z.pan(N,W,B):"none"===n||U.isFirstPersonMode()||(ci(N)?Z.rotate(N,S,v):(Z.pan(N,W,0),U.isWalkable()&&(U.fi({kind:U._walking?"betweenWalk":"beginWalk",event:N}),U._walking=1,U.walk(B/U.getHeight()*U.getCenterInfo().height))));Z.point=j}},pan:function(H,F,t){var o=this.gv;if(o.isPannable()){var R=o.getWidth(),O=o.getHeight();if(!R||!O)return;var r=o.getCenterInfo(),z=F/R*r.width,v=-1*t/O*r.height;o.fi({kind:o._panning?"betweenPan":"beginPan",event:H}),o._panning=1,o.pan(-z,-v)}},rotate:function(U,l,O){var J=this.gv;J.isRotatable()&&(J.fi({kind:J._rotating?"betweenRotate":"beginRotate",event:U}),J._rotating=1,J.rotate(l,O))},handleWindowMouseUp:function(d){this.handleWindowTouchEnd(d)},handleWindowTouchEnd:function(U){var K=this,F=K.gv,W=F.dm(),A=K.div;if(A){var l=F.getDatasInRect(A.rect);if(!l.isEmpty()){var V=F.sm(),H=V.toSelection();l.each(function(g){V.co(g)?H.remove(g):H.add(g)}),V.ss(H)}Oe(A)}F._moving&&(delete F._moving,F.fi({kind:"endMove",event:U}),F.onMoveEnded(),W.endTransaction()),F._panning&&(delete F._panning,F.fi({kind:"endPan",event:U}),F.onPanEnded()),F._rotating&&(delete F._rotating,F.fi({kind:"endRotate",event:U}),F.onRotateEnded()),F._86O&&(delete F._86O,F.fi({kind:"endEditRotation",event:U}),W.endTransaction()),F._87O&&(delete F._87O,F.fi({kind:"endEditScale",event:U}),W.endTransaction()),F._pinching&&(delete F._pinching,F.fi({kind:"endPinch",event:U}),F.onPinchEnded()),F._rectSelecting&&(delete F._rectSelecting,F.fi({kind:"endRectSelect",event:U}),F.onRectSelectEnded()),F._walking&&(delete F._walking,F.fi({kind:"endWalk",event:U}),F.onWalkEnded()),K.dist=K.point=K._62O=K.p3=K.movedata=K.div=K._57I=K._32Q=K._31Q=K.foward=h}});var Ab=Lg.MapInteractor=function(g){Yn(Ab,this,[g]),this._minPhi=0,this._maxPhi=5*b/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right"};_i("MapInteractor",Wj,{handle_contextmenu:function(w){ll(w)},handle_mousewheel:function(w){this.gv.handleScroll(w,w.wheelDelta/40)},handle_DOMMouseScroll:function($){2===$.axis&&this.gv.handleScroll($,-$.detail)},handle_keydown:function($){this.gv.handleKeyDown($)},handle_mousedown:function(i){this.handle_touchstart(i)},handle_touchstart:function(i){ll(i);var E=this,J=E.gv;if(J.setFocus(i)){J.lp(i);var $=J.getDataInfoAt(i),d=$?$.data:h,Z=$?$.part:h;if(!d||!J.isInteractive(d)){var u=E.editing={point:J.lp(i)};Sl?u.touch=!0:(u.touch=!1,u.pan="left"===this.panButton===ci(i)),_f(E,i)}fi(i)?J.handleDoubleClick(i,d,Z):J.handleClick(i,d,Z)}},handle_mouseup:function(n){this.handle_touchend(n)},handle_touchend:function(){},handleWindowMouseMove:function(M){this.handleWindowTouchMove(M)},handleWindowTouchMove:function(u){var e=this,w=e.gv,f=e.editing;if(f){var L=w.lp(u),r=f.point,R=L.x-r.x,d=L.y-r.y;if(!f.moved){if(Math.abs(R)<e.threshold&&Math.abs(d)<e.threshold&&!(u.touches&&u.touches.length>1))return;f.moved=!0}if(f.point=L,f.touch){var J=u.touches.length;if(2!==J)e.pan(u,R,d);else{if(1>=J)return;var p=u.touches,H={x:p[0].clientX,y:p[0].clientY},M={x:p[1].clientX,y:p[1].clientY},g={x:M.x-H.x,y:M.y-H.y},a=f.lastCenter,o=Math.atan2(g.y,g.x),Z=f.theta,N=0;Z==h?Z=f.theta=o:(N=o-Z,f.thetaStarted||Math.abs(N)>e.touchRotateThreshold?(f.thetaStarted=!0,f.theta=o):N=0);var n=b*(H.y+M.y)/2/w.getHeight(),S=f.phi,K=0;S==h?S=f.phi=n:(K=n-S,f.phiStarted||Math.abs(K)>e.touchRotateThreshold?(f.phiStarted=!0,f.phi=n):K=0);var O,I=Math.sqrt(g.x*g.x+g.y*g.y),T=f.vlen;if(T){var Y=H.x-a.x,W=H.y-a.y,F=M.x-a.x,q=M.y-a.y,v=Math.sqrt(Y*Y+W*W),k=Math.sqrt(F*F+q*q),z=T/2,P=e._sign2(v-z),s=e._sign2(k-z);0>P*s||0===P&&0===s?(O=1,f.vlen=I):(O||(O=I/T),f.scaleStarted||Math.abs(O-1)>e.touchScaleThreshold?(f.vlen=I,f.scaleStarted=!0):O=1)}else T=f.vlen=I,O=1;1!==O&&w.setZoom(O),(K||N)&&e.rotate(u,N,-K),f.lastCenter={x:(M.x+H.x)/2,y:(M.y+H.y)/2}}}else if(f.pan)e.pan(u,R,d);else{var _=w.getWidth(),A=w.getHeight();if(!_||!A)return;var m=-x*R/_,Q=-x*d/A;e.rotate(u,m,Q)}}},_sign2:function(V){return Math.abs(V)<this._touchScaleCheckAccuracy?0:V>0?1:-1},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(p){var w=this,E=w.editing;if(w.editing=null,E){var $=w.gv;if(E.moved||E.pan!==("left"===this.panButton))$._panning=null,$._rotating=null,$.fi({kind:E.pan?"endPan":"endRotate",event:p});else{var A=$.getDataAt(p);A?$.sm().setSelection([A]):$.sm().clearSelection()}}},pan:function(K,T,g){var I=this,C=I.gv;if(C.isPannable()){var c=C.getWidth(),q=C.getHeight();if(c&&q){var u=C.getCenterInfo(),l=-T/c*u.width,m=1*g/q*u.height;C.fi({kind:C._panning?"betweenPan":"beginPan",event:K}),C._panning=1;var t=I.keepHorizon,d=I.editing.touch;if((d&&K.touches&&K.touches.length>1||!d&&oe(K))&&(t=!t),!t)return C.pan(l,m);if(l||m){var v=Hj(C),w=[v[0]*l,v[4]*l,v[8]*l],R=[v[1],0,v[9]],r=Math.sqrt(R[0]*R[0]+R[2]*R[2]);r&&(R=[R[0]/r*m,0,R[2]/r*m]);var j=w[0]+R[0],o=w[1]+R[1],s=w[2]+R[2],X=C._center,S=C._eye;X[0]+=j,X[1]+=o,X[2]+=s,S[0]+=j,S[1]+=o,S[2]+=s,C.fp(rp,h,S),C.fp(Gg,h,X)}}}},rotate:function(o,N,u){var m=this,f=m.gv;if(f.isRotatable()){var F=f._center,x=f._eye,A=Fn(x,F),R=i(W(A[0]*A[0]+A[2]*A[2]),A[1]),j=R+u;j=Math.max(m.minPhi,Math.min(m.maxPhi,j)),u=j-R,f.fi({kind:f._rotating?"betweenRotate":"beginRotate",event:o}),f._rotating=1,f.rotate(N,u)}}}),f.defineProperties(Ab.prototype,{panButton:{get:function(){return this._panButton},set:function(C){this._panButton=C}},minPhi:{get:function(){return this._minPhi},set:function(W){this._minPhi=W}},maxPhi:{get:function(){return this._maxPhi},set:function(g){this._maxPhi=g}},keepHorizon:{get:function(){return this._keepHorizon},set:function(R){this._keepHorizon=R}},threshold:{get:function(){return this._threshold},set:function(c){this._threshold=c}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(t){this._touchScaleThreshold=t}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(w){this._touchRotateThreshold=w}}});var qc=function(W){this.gv=W};Wh(qc,f,{_iv:!0,iv:function(){this._iv=!0},face:function(F,E){var a=this,M=a.gv.getGL();if(!M||!bh(F))return h;var K=E.x,J=E.width,O=E.height,Y=a.height-E.y-O,y=j(J/2),R=new Uint8Array(4*J*O),A=0;for(a.iv(),a.validate(F),Ue(M,a.frame),M.readPixels(K,Y,J,O,M.RGBA,M.UNSIGNED_BYTE,R),$q(M),a.iv();y>=A;A++)for(var P=y-A,I=y+A,u=P;I>=u;u++)for(var W=P;I>=W;W++)if(u===P||u===I||W===P||W===I){var N=Uf.m[R[4*(u*J+W)]];if(N)return N}},get:function(e,J){this.validate();var U=this,Q=U.gv.getGL();if(!Q)return h;var l,g,y=e.x,_=e.width,A=e.height,B=U.height-e.y-A,p=j(_/2),Z=new Uint8Array(4*_*A),b=0,r=Z.length,E=J?h:new mo,d=J?h:{};if(Ue(Q,U.frame),Q.readPixels(y,B,_,A,Q.RGBA,Q.UNSIGNED_BYTE,Z),$q(Q),J){for(;p>=b;b++)for(var V=p-b,I=p+b,T=V;I>=T;T++)for(var G=V;I>=G;G++)if((T===V||T===I||G===V||G===I)&&(l=U.info(Z,4*(T*_+G))))return l}else for(;r>b;b+=4)l=U.info(Z,b),l&&(g=l.data,d[g._id]||(E.add(g),d[g._id]=g));return E},info:function(Z,q){return this.colorMap[(Z[q]<<16)+(Z[q+1]<<8)+Z[q+2]+((127&Z[q+3])<<24)]},validate:function(m){var S=this,N=S.gv,X=N.getGL();if(X){var H=N.getWidth(),i=N.getHeight(),P=X.RGBA,x=X.TEXTURE_2D,o=X.RENDERBUFFER,J=X.FRAMEBUFFER;S.texture||(S.texture=ms(X),S.render=X.createRenderbuffer(),S.frame=X.createFramebuffer()),(S.width!==H||S.height!==i)&&(yf(X,S.texture),X.texImage2D(x,0,P,H,i,0,P,X.UNSIGNED_BYTE,h),Jk(X,X.TEXTURE_MIN_FILTER,X.LINEAR),X.bindRenderbuffer(o,S.render),X.renderbufferStorage(o,X.DEPTH_COMPONENT16,H,i),Ue(X,S.frame),X.framebufferTexture2D(J,X.COLOR_ATTACHMENT0,x,S.texture,0),X.framebufferRenderbuffer(J,X.DEPTH_ATTACHMENT,o,S.render),yf(X,h),X.bindRenderbuffer(o,h),$q(X),S.width=H,S.height=i),S._iv&&(S._iv=!1,Ue(X,S.frame),N._42(m||(S.colorMap={}),1),$q(X))}}});var ee=function(B){this.gv=B};Wh(ee,f,{gap:0,size:0,_42:function(K,T){var J=this,O=J.gv,q=O._gridGap,U=O._gridSize;if(O._gridVisible){if(J.gap!==q||J.size!==U){for(var S=[],I=O._gridSize/2,W=q*I,x=0;2*I+1>x;x++){var X=6*x,o=6*(2*I+1)+X;S[X]=-W,S[X+1]=0,S[X+2]=-W+x*q,S[X+3]=W,S[X+4]=0,S[X+5]=-W+x*q,S[o]=-W+x*q,S[o+1]=0,S[o+2]=-W,S[o+3]=-W+x*q,S[o+4]=0,S[o+5]=W}J.vs=new es(S),J.gap=q,J.size=U}zd(O),Kk(K,T),os(K),Wq(K,T,1,O._gridColor,O._buffer.vs,J.vs),jm(K,0,J.vs.length/3,K.LINES),lj(K),Pr(K,T)}else J.vs=J.gap=J.size=h}});var vh=function(W){this.gv=W};Wh(vh,f,{_42:function(Z,m){var l=this.gv,H=l._buffer.vs,j=l._axisXColor,J=l._axisYColor,P=l._axisZColor,G=l._originAxisVisible,p=l._centerAxisVisible;if(G||p){var _=e?Z.TRIANGLES:Z.TRIANGLE_FAN,D=Z.LINES;if(zd(l),Kk(Z,m),os(Z),G){var O=l.getCenterInfo(),f=M(O.width,O.height)/5,x=.8*f,t=.05*f;Wq(Z,m,1.5,j,H,new es([0,0,0,f,0,0,x,t,0,x,0,t,x,-t,0,x,0,-t,x,t,0,0,0,0,0,f,0,t,x,0,0,x,t,-t,x,0,0,x,-t,t,x,0,0,0,0,0,0,f,t,0,x,0,t,x,-t,0,x,0,-t,x,t,0,x])),jm(Z,0,2,D),jm(Z,1,6,_),Wq(Z,m,h,J),jm(Z,7,2,D),jm(Z,8,6,_),Wq(Z,m,h,P),jm(Z,14,2,D),jm(Z,15,6,_)}if(p){var c=l._center,I=c[0],y=c[1],k=c[2],O=l.getPositionInfo(c);f=M(O.width,O.height)/20,Wq(Z,m,1.5,j,H,new es([I,y,k,I+f,y,k,I,y,k,I,y+f,k,I,y,k,I,y,k+f])),jm(Z,0,2,D),Wq(Z,m,h,J),jm(Z,2,2,D),Wq(Z,m,h,P),jm(Z,4,2,D)}lj(Z),Pr(Z,m)}}});var Kd=function(W){this.gv=W,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Kd.Mode.Disable};Kd.Mode={Disable:0,Selection:1,MouseOver:2},Wh(Kd,f,{onMouseOver:function(P){C.preventDefault(P);var W=this.gv.getDataAt(P);W!==this.mouseOverData&&(this.mouseOverData=W,this.gv.iv())},setFetchTargetFunc:function(P){this.fetchTargetFunc=P},_42:function(y,Z){var H,e=this,V=e._mode;if(V!==Kd.Mode.Disable&&(V===Kd.Mode.Selection?H=e.gv.sm().getSelection().toArray(function(p){return p.s("highlight.visible")}):V===Kd.Mode.MouseOver&&e.mouseOverData&&e.mouseOverData.s("highlight.visible")&&(H=[e.mouseOverData]),e.fetchTargetFunc&&(H=e.fetchTargetFunc(H)),H&&H.length)){var B=e.gv,s=B.vr.isPresenting(),R=B.getWidth();if(s){var L=B.getWidth;R/=2,B.getWidth=function(){return R};var p=B.getViewport()}var Q,u=B.getDevicePixelRatio(),W=R*u,N=B.getHeight()*u;(Q=e._renderTarget)?Q.setSize(y,W,N):e._renderTarget=Q=new Lg.RenderTarget(B,y,W,N),Ue(y,Q.frame),B.drawFilter=function(s){return H.indexOf(s)<0?!0:void 0},B._42({}),B.drawFilter=null,$q(y),s&&(B.getWidth=L,B.setViewport(y,p[0],p[1],p[2],p[3])),e.shader||(e.shader=new Bn.Shader(y,wk.vs,wk.fs));var r=e.shader;if(e.shader.bind(),y.enable(y.BLEND),y.activeTexture(y.TEXTURE0+0),y.bindTexture(y.TEXTURE_2D,Q.texture),r.uniforms.image=0,r.uniforms.textureSize=[W,N],r.uniforms.edgeWidth=O["highlight.width"],e.highlightColor!==O["highlight.color"]){var $=vi(e.highlightColor=O["highlight.color"]);e.highlightColorData=[$[0]/255,$[1]/255,$[2]/255,$[3]/255]}r.uniforms.edgeColor=e.highlightColorData,e.ibuffer?(e.ibuffer.upload(),e.vbuffer.upload()):(e.ibuffer=Bn.Buffer.createIndexBuffer(y,new Uint16Array([0,2,1,1,2,3])),e.vbuffer=Bn.Buffer.createVertexBuffer(y,new Float32Array([0,0,1,0,0,1,1,1]))),r.attributes.pos.pointer(e.vbuffer),y.drawElements(y.TRIANGLES,6,y.UNSIGNED_SHORT,0),y.disable(y.BLEND),y.bindTexture(y.TEXTURE_2D,null),y.useProgram(Z)}}}),f.defineProperties(Kd.prototype,{mode:{get:function(){return this._mode},set:function(S){var q=this._mode;S!==q&&(this._mode=S,S===Kd.Mode.MouseOver?this.gv.getView().addEventListener("mousemove",this.onMouseOver,!1):q===Kd.Mode.MouseOver&&this.gv.getView().removeEventListener("mousemove",this.onMouseOver))}}});var wk={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},nc=function(r){this.gv=r},ke="edit_tx",qn="edit_ty",Eo="edit_tz",Xh="edit_rx",br="edit_ry",Ip="edit_rz",$n="edit_sx",Bb="edit_sy",md="edit_sz",te={};te[ke]=1,te[qn]=1,te[Eo]=1,te[Xh]=1,te[br]=1,te[Ip]=1,te[$n]=1,te[Bb]=1,te[md]=1,Wh(nc,f,{_42:function(d,R,v){var s=this,_=s.gv,H=_.sm().ld();if(H&&_.isEditable(H)&&!_.isEditHelperDisabled()&&bh(H)&&(!_.isFirstPersonMode()||!_.isMouseRoamable()&&!Sl)){zd(_);var B,c,x=_.isMovable(H),X=_.isRotationEditable(H),V=_.isSizeEditable(H),e=_._axisXColor,h=_._axisYColor,I=_._axisZColor,t=_._editSizeColor,Q=H.p3(),E=Im(_.getEye(),Q)/10,Z=E/(v?5:10),C=.7*E,N=.4*C,b=Q[0],W=Q[1],j=Q[2];B=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],x&&s._17O(d,R,H,v,ke,e,B,[b,W-Z,j,b+C,W-Z,j,b+C,W,j,b+C,W,j,b,W,j,b,W-Z,j,b,W-Z,j+Z,b+C,W-Z,j+Z,b+C,W-Z,j,b+C,W-Z,j,b,W-Z,j,b,W-Z,j+Z]),c=b+C,V&&s._17O(d,R,H,v,$n,t,B,[c,W-Z,j,c+N,W-Z,j,c+N,W,j,c+N,W,j,c,W,j,c,W-Z,j,c,W-Z,j+Z,c+N,W-Z,j+Z,c+N,W-Z,j,c+N,W-Z,j,c,W-Z,j,c,W-Z,j+Z]),c+=N,X&&s._17O(d,R,H,v,Xh,e,B,[c,W-Z,j,c+N,W-Z,j,c+N,W,j,c+N,W,j,c,W,j,c,W-Z,j,c,W-Z,j+Z,c+N,W-Z,j+Z,c+N,W-Z,j,c+N,W-Z,j,c,W-Z,j,c,W-Z,j+Z]),B=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],x&&s._17O(d,R,H,v,qn,h,B,[b,W,j,b,W+C,j,b-Z,W+C,j,b-Z,W+C,j,b-Z,W,j,b,W,j,b,W,j,b,W,j-Z,b,W+C,j-Z,b,W+C,j-Z,b,W+C,j,b,W,j]),c=W+C,V&&s._17O(d,R,H,v,Bb,t,B,[b,c,j,b,c+N,j,b-Z,c+N,j,b-Z,c+N,j,b-Z,c,j,b,c,j,b,c,j,b,c,j-Z,b,c+N,j-Z,b,c+N,j-Z,b,c+N,j,b,c,j]),c+=N,X&&s._17O(d,R,H,v,br,h,B,[b,c,j,b,c+N,j,b-Z,c+N,j,b-Z,c+N,j,b-Z,c,j,b,c,j,b,c,j,b,c,j-Z,b,c+N,j-Z,b,c+N,j-Z,b,c+N,j,b,c,j]),B=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],x&&s._17O(d,R,H,v,Eo,I,B,[b,W,j,b,W,j+C,b,W-Z,j+C,b,W-Z,j+C,b,W-Z,j,b,W,j,b,W-Z,j,b-Z,W-Z,j,b-Z,W-Z,j+C,b-Z,W-Z,j+C,b,W-Z,j+C,b,W-Z,j]),c=j+C,V&&s._17O(d,R,H,v,md,t,B,[b,W,c,b,W,c+N,b,W-Z,c+N,b,W-Z,c+N,b,W-Z,c,b,W,c,b,W-Z,c,b-Z,W-Z,c,b-Z,W-Z,c+N,b-Z,W-Z,c+N,b,W-Z,c+N,b,W-Z,c]),c+=N,X&&s._17O(d,R,H,v,Ip,I,B,[b,W,c,b,W,c+N,b,W-Z,c+N,b,W-Z,c+N,b,W-Z,c,b,W,c,b,W-Z,c,b-Z,W-Z,c,b-Z,W-Z,c+N,b-Z,W-Z,c+N,b,W-Z,c+N,b,W-Z,c])}},_17O:function(X,n,F,a,R,t,y,r){var $=this.gv._buffer;Uo(X,n,a,!0,F,R),jq(X,n,h,!0,h,!0,h,!1),vm(X,n.uDiffuse,t),Hf(X,$.vs,new es(r),n.aPosition),Hf(X,$.ns,new es(y),n.aNormal),os(X),jm(X,0,12),lj(X),se(X,n)}});var fc=u.Raycaster=function(j){this.gv=j,this.maxTriangleTest=1/0};Jf("Raycaster",f,{intersect:function(w){var s=this,K=s.gv,i=K.getDataAt(w);return i?s.intersectObject(w,i):null},intersectObjects:function(j,Z,L){var w,i,p,v,u=this,Y=1/0,J=j.origin||(new tc).fromArray(u.gv.getEye()),l=u.maxTriangleTest,z=[];return Z.forEach(function(P){L&&L(P)===!1||P.s("intersect")!==!1&&z.push(P)}),z.sort(function(C,M){return J.distanceToSquared2(C.p3())-J.distanceToSquared2(M.p3())}),u.countTriangles=0,z.forEach(function(f){u.countTriangles>l||(w=u.intersectObject(j,f),w&&(i=J.distanceToSquared(w.world),Y>i&&(p=f,v=w,Y=i)))}),u.countTriangles=0,{data:p,intersect:v}},intersectObject:function(h,J){if(h instanceof Qr)return this._intersectObjectImpl(h,J);var G,t,$=this,c=$.gv;t=c.unproject(h);var C=c.getEye();c.isOrtho()?(G=Fn(c.getCenter(),C),G[0]+=G[0],G[1]+=G[1],G[2]+=G[2]):G=C,G=new tc(G);var R=new tc(t).sub(G).normalize(),v=new u.Math.Ray(G,R);return $._intersectObjectImpl(v,J)},_intersectObjectImpl:function(){function O(){var W=new tc;return W.subVectors(r,l),J.subVectors(a,l),W.cross(J).normalize(),W}function m(L,V,o,h,P,H,c){return vs.barycoordFromPoint(L,V,o,h,$),P.multiplyScalar($.x),H.multiplyScalar($.y),c.multiplyScalar($.z),P.add(H).add(c),P.clone()}var h=new cc,w=new cc,v=new Qr,A=new tc,i=new tc,F=new tc,E=new tc,H=new tc,a=new tc,l=new tc,r=new tc,D=new sn,c=new sn,q=new sn,J=new tc,X={vs:yd,is:ei,uv:zf},$=new tc;return function(I,_){var U=this.gv.getData3dUI(_),e=_.mat||U.mat;if(e){h.fromArray(e),w.getInverse(h),v.copy(I).applyMatrix4(w);var K,B,n="body",Y=U.shapeModel;if(Y||(Y=_n(U)),Y||(_ instanceof u.Node&&!(_ instanceof u.Shape)?(K=!0,Y=X):(B=!0,Y=[U.left,U.front,U.right,U.back,U.top,U.bottom])),!Y)return console.log("Can not find shape model."),null;
wc(Y)||(Y=[Y]);var b,j,M,S,W,R,g,k,V,C,t,z,Q,f,s,y,T=1/0,x=["","top_","bottom_"],N=!1;for(b=0,j=Y.length;j>b;b++)if(Q=Y[b])for(M=0,S=x.length;S>M;M++)if(f=x[M],g=Q[f+"vs"],k=Q[f+"is"],V=Q[f+"uv"]||Q[f+"tuv"],g){if(s=Q[f+"boundingBox"]){var t=v.intersectBox(s);if(!t)continue;if(v.origin.distanceTo(t)>T)continue;y=!1}else Q[f+"boundingBox"]=s=new u.Math.Box3,y=!0;for(W=0,R=k?k.length:g.length/3;R>W;W+=3)this.countTriangles++,k?(i.fromArray(g,3*k[W]),F.fromArray(g,3*k[W+1]),E.fromArray(g,3*k[W+2])):(i.fromArray(g,3*W),F.fromArray(g,3*(W+1)),E.fromArray(g,3*(W+2))),y&&(s.expandByPoint(i),s.expandByPoint(F),s.expandByPoint(E)),C=v.intersectTriangle(i,F,E,!0,A),C&&(z=v.origin.distanceTo(C),T>z&&(T=z,H.copy(C),a.copy(i),l.copy(F),r.copy(E),""!==f?n=f.slice(0,-1):K?n=Be[Math.floor(W/6)]:B&&(n=Be[b]),V&&(N=!0,k?(D.fromArray(V,2*k[W]),c.fromArray(V,2*k[W+1]),q.fromArray(V,2*k[W+2])):(D.fromArray(V,2*W),c.fromArray(V,2*(W+1)),q.fromArray(V,2*(W+2))))))}if(!isFinite(T))return null;var o,J=H.clone().applyMatrix4(h);N&&(o=m(H,a,l,r,D,c,q));var G=O(a,l,r),p=O(a.applyMatrix4(h),l.applyMatrix4(h),r.applyMatrix4(h)),P=v.direction.dot(G);return P>0&&(G.multiplyScalar(-1),p.multiplyScalar(-1)),{world:J,local:H.clone(),worldNormal:p,normal:G,uv:o,part:n}}}}()});var Xo=function(f,P){this.gv=f,this.s=function(T,l,G){return l==h&&(l=G),l==h?P.getStyle(T):pf(l,P,f)},this.data=P};Wh(Xo,f,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(v,J,o,n){var _=this,Q=_.data;if(!(Q instanceof _e)){var w,k,l,W,F,u,P,V=_.gv,D=Q._id,m=_.s("shape3d.alwaysOnTop")?null:_.s("batch"),X=V._batchIndexMap,g=V._batchModelMap,e=V.isSelectable(Q),M=V.getBrightness(Q),r=M!=h&&1!==M;if(_.needValidate(v)){if(l=fq(X,g,Q,m),_.validate(l,m?zc[m]||Ln:h),l&&(W=X[D],F=W.size=l.vs.length/3-W.begin,P=l.rs))for(M=r?M:1,u=0;F>u;u++)P.push(M);if(bh(Q)){var j=V.getWireframeGeometry(Q);if(j)pn(V,Q,j);else{var y=V.getWireframe(Q);y&&pn(V,Q,y)}}_.labelInfo=_.label2Info=_.noteInfo=_.note2Info=_._38o=h,_._24O(zk,"getLabel"),_._24O(cl,"getLabel2"),_._26O(ve,"getNote"),_._26O(en,"getNote2"),_._15O(),_.interactiveInfo=V.isInteractive(Q)?{}:h,_._iv=!1}r&&vm(v,J.uBrightness,M),vm(v,J.uAlphaTest,_.s("alphaTest")),vm(v,J.uUseEnvMap,Q.s("envmap")?!0:!1),vm(v,J.uReflectivity,Q.s("envmap")||.01),k=Uo(v,J,o,e,Q,kh),k&&(Sn(k,X[D],g),Sn(k,V._polylineIndexMap[D],V._polylineModelMap),Sn(k,V._wireframeIndexMap[D],V._wireframeModelMap)),X[D]||_._80o(v,J,n),V.isLabelVisible(Q)&&((w=_.labelInfo)&&(Uo(v,J,o,e,Q,zk),_._28O(w,zk,n)),(w=_.label2Info)&&(Uo(v,J,o,e,Q,cl),_._28O(w,cl,n))),V.isNoteVisible(Q)&&((w=_.noteInfo)&&(Uo(v,J,o,e,Q,ve),_._29O(w,ve,n)),(w=_.note2Info)&&(Uo(v,J,o,e,Q,en),_._29O(w,en,n))),(w=_._38o)&&_._99O(v,J,w,o,e,n),r&&vm(v,J.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return nn},_80o:function(){},dispose:function(){},_calcAnchorMat:function(H){if(H.hasOwnProperty("_anchor")||H.hasOwnProperty("_anchorElevation")){var R=H.getAnchor3d(),$={x:R.x-.5,y:R.y-.5,z:R.z-.5},l=Jr();return pe(l,[-$.x,-$.y,-$.z]),l}},getBodyColor:function(G){var J=this.data,B=this.gv.getBodyColor(J);return B?B:G?J.getStyle(G):h},_24O:function(l,D){var C=this,m=C.data,V=C.gv,j=C.s,z=V[D](m);if(z!=h){var E=j(l+".scale"),A=j(l+".max"),B=C[l+"Info"]={label:z,textureScale:j(l+".texture.scale"),color:V[D+"Color"](m),font:j(l+".font"),align:j(l+".align"),background:V[D+"Background"](m)},r=B.rect=oc(B,z);A>0&&A<r.width&&(B.labelWidth=r.width,r.width=A),r.x=r.y=0,r.width*=E,r.height*=E,B.mat=C._16O(j(l+".autorotate"),j(l+".position"),r,j(l+".face"),j(l+".t3"),j(l+".r3"),j(l+".rotationMode"));var O=r.width/2,e=r.height/2;B.vs=new es([-O,e,0,-O,-e,0,O,-e,0,O,e,0]),r.width/=E,r.height/=E}},_26O:function(H,q){var V=this,b=V.data,u=V.gv,v=V.s,n=u[q](b);if(n!=h){var U=v(H+".scale"),s=this[H+"Info"]={note:n,textureScale:v(H+".texture.scale"),expanded:v(H+".expanded"),font:v(H+".font"),color:v(H+".color"),align:v(H+".align"),borderWidth:v(H+".border.width"),borderColor:v(H+".border.color"),background:u[q+"Background"](b)};if(s.expanded){var t=v(H+".max"),F=oc(s,n);F.width+=6,F.height+=2,t>0&&t<F.width&&(s.labelWidth=F.width,F.width=t);var W={x:-F.width/2,y:-8-F.height,width:F.width,height:F.height+8}}else W={x:-6,y:-18,width:12,height:18};s.mat=V._16O(v(H+".autorotate"),v(H+".position"),h,v(H+".face"),v(H+".t3"),v(H+".r3"),v(H+".rotationMode")),s.rect=W,1!==U&&(W=ud(W),W.x*=U,W.height*=U,W.y=-W.height,W.width*=U);var D=W.x,c=W.y,Z=W.width,N=W.height;s.vs=new es([D,-c,0,D,-c-N,0,D+Z,-c-N,0,D+Z,-c,0])}},_28O:function(m,x,e){if(e(this.s(x+".transparent"))){var N=m.rect,S=m.textureScale,h=N.width*S,s=N.height*S;if(h>=1&&s>=1){var $=yp(h,s);1!==S&&($.translate($,N.x,N.y),$.scale(S,S),$.translate($,-N.x,-N.y)),$c($,m),$.restore(),ri(this,x,m.mat,m.vs,!0)}}},_29O:function(T,G,m){if(m(this.s(G+".transparent"))){var C=T.rect,q=T.textureScale,h=C.x,L=C.y,k=C.width*q,o=C.height*q;if(k>=1&&o>=1){C.x=C.y=0;var b=yp(k,o);1!==q&&b.scale(q,q),Mh(b,T),b.restore(),C.x=h,C.y=L,ri(this,G,T.mat,T.vs,!1)}}},_99O:function(E,_,d,q,w,i){if(d){var b=this,Y=b.gv,P=b.data,t=Y._buffer,N=Y._1O,O=d.icons;for(var p in O){var J=O[p],R=d.rects[p];if(R&&i(pf(J.transparent,P,Y))){Uo(E,_,q,w,P,p);var X=pf(J.shape3d,P,Y),F=X?[X]:pf(J.names,P,Y),M=F?F.length:0,s=pf(J.textureScale,P,Y)||1,G=pf(J.light,P,Y);G==h&&(G=X?!0:!1),jq(E,_,pf(J.blend,P,Y),G,pf(J.opacity,P,Y),pf(J.reverseFlip,P,Y),pf(J.reverseColor,P,Y),pf(J.reverseCull,P,Y));for(var V=0;M>V;V++){var Z=F[V],Q=R[V];if(ks(b,Q.mat),X)Bj(Y,P,_n(b,X),b);else{var k=ef(Z);if(k){var H=Q.width*s,U=Q.height*s;if(H>=1&&U>=1){var v=yp(H,U);Cr(v,k,pf(J.stretch,P,Y),0,0,H,U,P,Y),v.restore(),ms(E,wo,N),os(E,_,N,pf(J.discardSelectable,P,Y),t.uv,Qk),Hf(E,t.vs,Q.vs,_.aPosition),Xn(E,t.ns,rk,_.aNormal),qb(E,t.is,Cm),bm(E,0,Cm.length),lj(E,_,N)}}}Wb(Y)}se(E,_)}}}}});var ie=function(W,c){Yn(ie,this,[W,c])};Wh(ie,Xo,{_16O:function(_,G,x,A,d,E,w,i,Z){var s=this.data,C=s.getFinalScale3d(),y=vl(G,C,x,A,i,Z);if(s.hasOwnProperty("_anchor")||s.hasOwnProperty("_anchorElevation")){var l=s.getAnchor3d();y[0]-=(l.x-.5)*C[0],y[1]-=(l.y-.5)*C[1],y[2]-=(l.z-.5)*C[2]}return gj(Jr(),y,s.p3(),A,d,E,w,_,s.getFinalRotation3d(),s.getRotationMode())},clear:function(){var d=this;d.faceMat=d.mat=d.shapeModel=d.left=d.right=d.front=d.back=d.top=d.bottom=d.csg=h},needValidate:function(f){if(this._iv)return this._validateFrameId=f._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var w=f._renderInfo.frame;if(this._validateFrameId!==w)return this._validateFrameId=w,!0}return!1},validate:function(k,F){var S=this,I=S.gv,J=S.data,w=S.shapeName=S.s(yg),l=_n(S,w);S._updateAutoRotation(),S._updateFixSize2d(),S._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(yb(I,J,"_wireframeModelMap","_wireframeIndexMap"),yb(I,J,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var z=or(J,I.getMat(J),l?S.s("shape3d.scaleable"):!0),y=S._calcAnchorMat(J);if(y&&Me(z,z,y),J.mat=z,S.clear(),l||w==h)if(k){var r=[];l?In(I,J,l,S,S.getBodyColor(),[z],k,r):(Lf(I,J,k,F,z,nh,r,Co),Lf(I,J,k,F,z,lp,r,bk),Lf(I,J,k,F,z,mj,r,uk),Lf(I,J,k,F,z,Sh,r,Wl),Lf(I,J,k,F,z,Ak,r,Nd),Lf(I,J,k,F,z,ii,r,Md)),r.length&&(hn(k.vs,r),hn(k.ns,vp(r)))}else S.mat=z,(S.shapeModel=l)||(S._cubeUvs=null,S.vf(nh,0),S.vf(lp,16),S.vf(Ak,8),S.vf(ii,24),S.vf(mj,32),S.vf(Sh,40))},_updateAutoRotation:function(){var X=new Vc;return function(){var x=this,d=x.data,u=x.s("shape3d.autorotate");if(!u)return d._dynamicRotation&&delete d._dynamicRotation,void 0;var B,v=x.gv;B="string"==typeof u?[u.indexOf("x")<0?v._eye[0]:v._center[0],u.indexOf("y")<0?v._eye[1]:v._center[1],u.indexOf("z")<0?v._eye[2]:v._center[2]]:v._eye;var s=v._center,n=d.p3(),O=Bo([n[0]+B[0]-s[0],n[1]+B[1]-s[1],n[2]+B[2]-s[2]],n,v._up),y=d.r3();X.set(0,0,0,d.getRotationMode(),!0).setFromRotationMatrix(O),Math.abs(y[0]-X.x)<1e-5&&Math.abs(y[1]-X.y)<1e-5&&Math.abs(y[2]-X.z)<1e-5||(d._dynamicRotation=[X.x,X.y,X.z])}}(),_updateFixSize2d:function(){var u=this,K=u.data,N=u.s("shape3d.fixSizeOnScreen");if(!N)return K._dynamicScale3d&&delete K._dynamicScale3d,void 0;var k=u.gv;K.getFinalScale3d();var P=or(K,k.getMat(K)),I=ho([0,0,0],P),X=k.toViewPosition(I);if(!isNaN(X.x)&&!isNaN(X.y)){var t=ho([1,0,0],P),L=k.toViewPosition(t),Q=ho([0,1,0],P),q=k.toViewPosition(Q),$=L.x-X.x,l=q.y-X.y;if($&&l){var B=K._dynamicScale3d||[1,1,1],z=ef(K.s("shape3d.image")),e=N[0]>0?N[0]:z?iq(z,K):20,m=N[1]>0?N[1]:z?Yh(z,K):20,g=Math.abs($/e),Z=Math.abs(l/m);Math.abs(g-1)<.001&&Math.abs(Z-1)<.001||(K._dynamicScale3d=[B[0]/g,B[1]/Z,B[2]])}}},_updateOverlapping:function(){var h=this,c=h.s("hide.overlapping.group");if(!c)return h._rectOverlapping&&(h._rectOverlapping=l),void 0;var g,H,x,r=h.gv,m=h.data,Q=or(m,r.getMat(m)),s=1/0,J=1/0,G=-1/0,P=-1/0,y=m.getAnchor3d(),d=y.x,b=y.y,S=y.z;for(g=0;8>g;g++){if(H=ho([(g>>2)-d,(1&g>>1)-b,(1&g)-S],Q),x=r.toViewPosition(H),isNaN(x.x)||isNaN(x.y))return;s=Math.min(s,x.x),G=Math.max(G,x.x),J=Math.min(J,x.y),P=Math.max(P,x.y)}var a={x:s,y:J,w:G-s,h:P-J};h._rectOverlapping=r.overlappingBox.isOverlapping(c,a)},getVectorDynamicSize:function(){var v,a=this,Q=a.s("shape3d"),W=a.data;if("billboard"===Q||"plane"===Q||(v=W._currentCubeElementId)!=h){var H,E,X=a.gv,O=or(W,X.getMat(W)),l=W.getAnchor3d(),p=.5-l.x,U=.5-l.y,d=.5-l.z,n=a.s("shape3d.vector.dynamic.maxsize"),R=function(l,z){l[0]+=p,l[1]+=U,l[2]+=d,z[0]+=p,z[1]+=U,z[2]+=d;var V=X.toViewPosition(ho(l,O)),e=X.toViewPosition(ho(z,O)),g=V.x-e.x,A=V.y-e.y;return Math.min(n,Math.sqrt(g*g+A*A))};if("billboard"===Q)H=R([-.5,0,0],[.5,0,0]),E=R([0,-.5,0],[0,.5,0]);else if("plane"===Q)H=R([-.5,0,0],[.5,0,0]),E=R([0,0,-.5],[0,0,.5]);else if(W._currentCubeElementId!=h){var o=3*ei[v+1],I=3*ei[v],e=3*ei[v+2];H=R([yd[o],yd[o+1],yd[o+2]],[yd[e],yd[e+1],yd[e+2]]),E=R([yd[o],yd[o+1],yd[o+2]],[yd[I],yd[I+1],yd[I+2]])}return[H,E]}},getCachedTexture:function(){var A=this,O=A.data,i=O._currentCubeElementId;return i!=h?A._cubeCachedImage?A._cubeCachedImage[i]:null:A._shape3dCachedImage},setCachedTexture:function(d){var Q=this,g=Q.data,F=g._currentCubeElementId;F!=h?(Q._cubeCachedImage||(Q._cubeCachedImage={}),Q._cubeCachedImage[F]=d):Q._shape3dCachedImage=d},invalidateCachedTexture:function(l){var S,c,$,X=this;if(($=X._shape3dCachedImage)&&(l.deleteTexture($),X._shape3dCachedImage=null),c=X._cubeCachedImage){for(S in c)l.deleteTexture(c[S]);X._cubeCachedImage=null}},vf:function(a,X){var Z=this;if(Z.gv.getFaceVisible(Z.data,a)){var _=hs(Z,a);_.mat&&(Z.faceMat=!0);var z=_.uv;if(z){var h=Z._cubeUvs;h||(h=Z._cubeUvs=new es([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var N=0;8>N;N++)h[X+N]=z[N]}return _}},_80o:function(T,V,H){var j=this;if(j._rectOverlapping)return!0;var f=j.shapeModel;if(f||j.shapeName==h){var i=j.gv,l=j.data,D=i._cube;zd(i,j.mat),f?Bj(i,l,f,j,j.getBodyColor(),H):(Hf(T,D.vs,h,V.aPosition),Hf(T,D.ns,h,V.aNormal),fl(T,D.is),j._18O(T,V,j.left,0,H),j._18O(T,V,j.front,6,H),j._18O(T,V,j.right,12,H),j._18O(T,V,j.back,18,H),j._18O(T,V,j.top,24,H),j._18O(T,V,j.bottom,30,H)),Wb(i),j.faceMat&&(j._18O(T,V,j.left,0,H,!0),j._18O(T,V,j.front,6,H,!0),j._18O(T,V,j.right,12,H,!0),j._18O(T,V,j.back,18,H,!0),j._18O(T,V,j.top,24,H,!0),j._18O(T,V,j.bottom,30,H,!0))}},_18O:function(b,l,z,G,e,p){if(z){if(!e(z.transparent))return;if(p&&!z.mat||!p&&z.mat)return;var J=this.data.s("polygonOffset");J&&mg(b,J),p&&zd(this.gv,z.mat);var y=this,_=y.data;_._currentCubeElementId=G;var r=y.gv,K=r.getTexture(z.texture,_),n=z.uv,v=z.uvScale,F=z.uvOffset,g=z.discardSelectable;K?n?os(b,l,K,g,r._buffer.uv,y._cubeUvs,F,v):os(b,l,K,g,r._cube.uv,h,F,v):os(b),jq(b,l,z.blend,z.light,z.opacity,z.reverseFlip,z.reverseColor,z.reverseCull),vm(b,l.uDiffuse,z.color||O["color.empty"]),bm(b,G,6),se(b,l),lj(b,l,K),p&&Wb(r),J&&el(b),_._currentCubeElementId=null}}});var ui=function(T,k){Yn(ui,this,[T,k])};Wh(ui,Xo,{_25Q:1,validate:function(m){var _=this,T=_.gv,A=_.data,O=_.s,X=O("edge.width"),R=A._40I,i=A._41I;if(_.shapeModel=_.info=h,R&&i){var o,k,s,U,g,j,Z,E,c,Q,d=A.isLooped(),e=O(Nj),$=C.getEdgeType(e);if($){var x=$(A,Fg(_,T,A,d,e),T,_._19Q);if(!x.points||x.points.isEmpty())return;j=_.info={},Z=x.segments,g=x.points,E=g.size();for(var n=R.getElevation(),P=i.getElevation(),l=0;E>l;l++){var H=g.get(l);H.e==h&&(H.e=n+(P-n)*l/(E-1))}c=ch(g.get(0)),Q=ch(g.get(E-1));var v=E%2;0===v?(j.c1=ch(g.get(E/2-1)),j.c2=ch(g.get(E/2))):j.p3=ch(g.get((E-v)/2)),j.s1=c,j.s2=ch(g.get(1)),j.t1=ch(g.get(E-2)),j.t2=Q}else{g=new mo,j=_.info={};var V=O("edge.offset"),r=O("edge.center"),p=O("edge.source.t3"),D=O("edge.target.t3"),F=R.p3(),W=i.p3();if(p&&(F[0]+=p[0],F[1]+=p[1],F[2]+=p[2]),D&&(W[0]+=D[0],W[1]+=D[1],W[2]+=D[2]),e===_c){Z=O("edge.segments");var u=j.points=O(Qn)||vb;if(E=u.size()){c=ch(u.get(0)),Q=ch(u.get(E-1)),!r&&V&&(s=Fn(c,F,!0),V=M(V,Im(F,c)),F=[F[0]+s[0]*V,F[1]+s[1]*V,F[2]+s[2]*V],s=Fn(W,Q,!0),V=M(V,Im(Q,W)),W=[W[0]-s[0]*V,W[1]-s[1]*V,W[2]-s[2]*V]);var v=E%2;0===v?(o=ch(u.get(E/2-1)),k=ch(u.get(E/2))):j.p3=ch(u.get((E-v)/2)),j.s1=F,j.s2=c,j.t1=Q,j.t2=W}else!r&&V&&(s=Fn(W,F,!0),U=Im(F,W),V=hj(V,U),F=[F[0]+s[0]*V,F[1]+s[1]*V,F[2]+s[2]*V],W=[W[0]-s[0]*V,W[1]-s[1]*V,W[2]-s[2]*V]),o=F,k=W;g.add({x:F[0],y:F[2],e:F[1]}),g.addAll(u),g.add({x:W[0],y:W[2],e:W[1]})}else{var N=Fg(_,T,A,d,e);if(_._19Q||(N=-N),d){var b=F[0],J=F[1],t=F[2],L=R.getTall()/2+N;o=[b-N,J+L,t],k=[b+N,J+L,t],g.add({x:b-N,y:t,e:J}),g.add({x:b-N,y:t,e:J+L}),g.add({x:b+N,y:t,e:J+L}),g.add({x:b+N,y:t,e:J})}else{s=Fn(W,F,!0),U=Im(F,W);var G={x:F[0],y:F[2]},Y={x:W[0],y:W[2]},f=Cf(h,G,Y,N),z=f.x-G.x,B=f.y-G.y;V=hj(V,U),s[0]*=V,s[1]*=V,s[2]*=V,o=[F[0]+s[0]+z,F[1]+s[1],F[2]+s[2]+B],k=[W[0]-s[0]+z,W[1]-s[1],W[2]-s[2]+B],r?(g.add({x:F[0],y:F[2],e:F[1]}),g.add({x:o[0],y:o[2],e:o[1]}),g.add({x:k[0],y:k[2],e:k[1]}),g.add({x:W[0],y:W[2],e:W[1]})):(g.add({x:o[0],y:o[2],e:o[1]}),g.add({x:k[0],y:k[2],e:k[1]}))}}j.c1=o,j.c2=k}j.list=O(yg)===Eg?_.createTubeModel(g,Z,X/2,m):_.createLineModel(g,Z,X,"edge","edge.dash")}}});var Rq=function(S,K){Yn(Rq,this,[S,K])};Wh(Rq,ie,{_80o:function(x,w,t){var C=this,a=C.gv,S=C.shapeModel;zd(a,C.mat),S?Bj(a,C.data,S,C,C.getBodyColor(),t):(Ud(C,x,w,C.left,t),Ud(C,x,w,C.front,t),Ud(C,x,w,C.right,t),Ud(C,x,w,C.back,t),Ud(C,x,w,C.top,t),Ud(C,x,w,C.bottom,t)),Wb(a)},validate:function(g,G){var X,u,t=this,A=t.s,R=t.data,p=R.p3(),N=R._thickness/2,v=R.isClosePath(),c=R.getPoints(),O=R.getSegments(),$=A(_k),B=g&&g.uv;if(t.clear(),0>N)u=t.shapeModel=Go(c,O,A(Ug),A(li),$,A(Yd),R.getTall(),R.getShapeElevation(),v),A(ki)?A("shape3d.image")||delete u.uv:(delete u.vs,delete u.ns,delete u.uv),A("shape3d.top.image")||delete u.top_uv,A("shape3d.bottom.image")||delete u.bottom_uv;else if(A(yg)===Eg)X=$b(c,O,$,v),u=t.shapeModel={vs:[]},A("shape3d.image")&&(u.uv=[],u.sum=A(Yd)||Kp(X)||1,u.len=0),A(Ug)&&!v&&(u.top_vs=[],A("shape3d.top.image")&&(u.top_uv=[])),A(li)&&!v&&(u.bottom_vs=[],A("shape3d.bottom.image")&&(u.bottom_uv=[])),t._12O(X,N);else{var V,T,L,e,o,E,f,z,i,x;if(X=$b(c,O,$,v),o=t.vf(Ak,B,!1,G),N&&(E=t.vf(ii,B,!1,G),f=v?h:t.vf(nh,B,!1,G),z=v?h:t.vf(lp,B,!1,G),i=t.vf(mj,B,!1,G),x=t.vf(Sh,B,!1,G)),N){for(var F=0,U=X.length;U>F;F++)X[F]=t._tryRemoveBezierPoints(X[F],N);t._12O(X,N)}else o&&X.forEach(function(F){if(e=F.length,e>0)for(V=F[0],L=1;e>L;L++)T=F[L],t.addV(o.vs,V,T),V=T});t._20Q(X),g||(o&&(o.ns=vp(o.vs),ih(o,"vs"),ih(o,Tb)),N&&(E&&(E.ns=vp(E.vs),ih(E,"vs"),ih(E,Tb)),f&&(f.ns=vp(f.vs),ih(f,"vs"),ih(f,Tb)),z&&(z.ns=vp(z.vs),ih(z,"vs"),ih(z,Tb)),i&&(i.ns=vp(i.vs),ih(i,"vs"),ih(i,Tb)),x&&(x.ns=vp(x.vs),ih(x,"vs"),ih(x,Tb))))}var a=t.mat=Jr();pe(a,p),Ij(a,R.getFinalRotation3d(),R.getRotationMode());var _=R.getScale3d(),s=R._dynamicScale3d;s&&(_[0]*=s[0],_[1]*=s[1],_[2]*=s[2]),Mk(a,_),pe(a,Hp(p)),g&&(mr(t,a,g,u),t.clear())},_20Q:function(K){var i,Q,E,f,D,v,x,I=this,J=I.front,O=I.back,C=I.top,e=I.bottom,U=J?J.tuv:h,G=O?O.tuv:h,X=C?C.tuv:h,u=e?e.tuv:h,c=0;(U||G||X||u)&&(i=I.s(Yd)||Kp(K)||1,K.forEach(function(Y){if(Q=Y.length,Q>0)for(v=Y[0],E=1;Q>E;E++)x=Y[E],f=c/i,c+=Im(v,x),D=c/i,I._14O(J,f,D),I._14O(O,1-D,1-f),I._14O(C,f,D),I._14O(e,f,D),v=x}))},_14O:function(E,G,F){if(E){var y=E.uv,W=E.tuv;if(W){if(y)var O=y[0]+(y[6]-y[0])*G,j=y[1]+(y[7]-y[1])*G,q=y[2]+(y[4]-y[2])*G,A=y[3]+(y[5]-y[3])*G,R=y[2]+(y[4]-y[2])*F,Q=y[3]+(y[5]-y[3])*F,Z=y[0]+(y[6]-y[0])*F,C=y[1]+(y[7]-y[1])*F;else O=G,j=0,q=G,A=1,R=F,Q=1,Z=F,C=0;W.push(q,A,R,Q,Z,C,Z,C,O,j,q,A)}}},_13O:function(Y){var w=Y.uv,B=Y.tuv;B&&(w?B.push(w[2],w[3],w[4],w[5],w[6],w[7],w[6],w[7],w[0],w[1],w[2],w[3]):B.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(Q,g){var T=Q.length;if(4>T)return Q;var Z,i,A,X,s,t,e=!1,M=function(t){return Q[t]},n=function(u){return Q[T-1-u]};for(s=0;1>=s;s++)for(t=s?n:M,i=t(0),A=t(1),Z=2;T-1>Z;Z++)if(X=t(Z),!X.remove)if(X.b){var H=Cf(i,A,X,g);H.adjust?(X.remove=!0,e=!0):(i=A,A=X)}else i=A,A=X;if(!e)return Q;var u=[];for(Z=0;T>Z;Z++)Q[Z].remove||u.push(Q[Z]);return u},_12O:function(S,X){var Y,T,Z,J,K,t=this;S.forEach(function(V){if(K=V.length,K>0)for(Y={p:V[0],n:!0},J=1;K>J;J++)T=V[J],Z=K-1>J?V[J+1]:h,t.addPoint(Y,T,Z,X,V)})},addPoint:function(p,j,r,D,t){var L,$,e,F,J,o,I,v,Q,X=this,V=p.p,b=p.f,x=p.b,z=X.s("shape3d.side")||Pq,n=X.s("shape3d.start.angle"),M=X.s("shape3d.sweep.angle"),d=X.shapeModel,K=X.data.isClosePath();if(p.n&&(p.n=!1,b=K&&t.length>2?Cf(t[t.length-2],V,j,D):Cf(h,V,j,D),x=Qg(V,b),d?d.top_vs&&X._10O(x,b,z,n,M,d.top_vs,d.top_uv):(L=X.left)&&(X.addV(L.vs,x,b),X._13O(L))),$=r?Cf(V,j,r,D):K&&t.length>2?Cf(V,j,t[1],D):Cf(V,j,h,D),e=Qg(j,$),d){var i,Z,N=d.vs,E=d.uv,q=d.sum;for(E&&(i=d.len/q,d.len+=Im(V,j),Z=d.len/q),o=X._9O(x,b,z,n,M),I=X._9O(e,$,z,n,M),v=0;z>v;v++)Q=v+1,hn(N,o[Q]),hn(N,I[v]),hn(N,o[v]),hn(N,I[v]),hn(N,o[Q]),hn(N,I[Q]),E&&(F=v/z,J=Q/z,E.push(i,J,Z,F,i,F,Z,F,i,J,Z,J));!r&&d.bottom_vs&&X._10O(e,$,z,n,M,d.bottom_vs,d.bottom_uv,!0)}else!r&&(L=X.right)&&(X.addV(L.vs,$,e),X._13O(L)),(L=X.front)&&X.addV(L.vs,b,$),(L=X.back)&&X.addV(L.vs,e,x),(L=X.top)&&X.addH(L.vs,b,$,e,x,!0),(L=X.bottom)&&X.addH(L.vs,x,e,$,b);p.p=j,p.f=$,p.b=e},_10O:function(T,k,w,t,Z,m,o,j){var A,E,P=this,L=P.data,I=P._9O(T,k,w,t,Z),B=(T.x+k.x)/2,n=(T.y+k.y)/2,r=L.getShapeElevation(),O=0;for(O=0;w>O;O++)j?(hn(m,I[O]),hn(m,I[O+1])):(hn(m,I[O+1]),hn(m,I[O])),hn(m,[B,r,n]),o&&(j?(A=x*(O+1)/w+t,E=x*O/w+t):(A=x*O/w+t,E=x*(O+1)/w+t),o.push(.5-.5*z(E),.5-.5*K(E),.5-.5*z(A),.5-.5*K(A),.5,.5))},_9O:function(J,R,c,S,t){var N,Z,r=this,Y=r.data,p=[],E=(J.x+R.x)/2,F=(J.y+R.y)/2,v=Y.getTall()/2,I=Y.getShapeElevation(),y=0;for(t=t||x;c>=y;y++)N=t*y/c+S,Z=z(N),p.push([E+(J.x-E)*Z,I+v*K(N),F+(J.y-F)*Z]);return p},addV:function(R,U,c){var K=U.x,L=U.y,N=c.x,E=c.y,h=this.data,X=h.getShapeElevation(),b=h.getTall()/2;R.push(K,X-b,L,N,X-b,E,N,X+b,E,N,X+b,E,K,X+b,L,K,X-b,L)},addH:function(x,U,k,V,z,A){var o=this.data,S=o.getTall()/2,u=o.getShapeElevation()+(A?S:-S);x.push(U.x,u,U.y,k.x,u,k.y,V.x,u,V.y,V.x,u,V.y,z.x,u,z.y,U.x,u,U.y)},vf:function(F,E,$,M){var x,Z=this,W=Z.gv.getFaceVisible(Z.data,F);return($||W)&&(x=hs(Z,F,M),x.vs=[],x.tuv=W&&(x.texture||E)?[]:h,x.visible=W),x}});var Sk=function(D,X){Yn(Sk,this,[D,X])};Wh(Sk,Xo,{_25Q:1,validate:function(u){var L=this,M=L.data,V=L.s,e=M.getPoints(),p=e.size();if(L.shapeModel=L.info=h,p>1){var S=L.info={},o=M.getSegments(),k=M.getThickness(),D=ch(e.get(0)),z=ch(e.get(p-1)),O=p%2;0===O?(S.c1=ch(e.get(p/2-1)),S.c2=ch(e.get(p/2))):S.p3=ch(e.get((p-O)/2)),S.s1=D,S.s2=ch(e.get(1)),S.t1=ch(e.get(p-2)),S.t2=z,S.list=V(yg)===Eg?L.createTubeModel(e,o,k/2,u):L.createLineModel(e,o,k,"shape.border","shape.dash")}var U=M.p3(),b=L.mat=Jr();pe(b,U),Ij(b,M.getFinalRotation3d(),M.getRotationMode());var P=M.getScale3d(),K=M._dynamicScale3d;K&&(P[0]*=K[0],P[1]*=K[1],P[2]*=K[2]),Mk(b,P),pe(b,Hp(U))},_80o:function(n,r,Q){var e=this,f=e.shapeModel;if(f){var h=e.gv;zd(h,e.mat),Bj(h,e.data,f,e,e.getBodyColor(),Q),Wb(h)}}});var Oo=u.graph3d.VR=function(U){var A=this;A.gv=U,A._controllers=[],A.switch=new Nh(A),A._enable=!1,A._defaultCallLater=u.Default.callLater,A._defaultCancelLater=Mi,"undefined"!=typeof G&&"VRFrameData"in G&&(A._frameData=new G.VRFrameData),A.measureOflength=1,A.eyesOffset=[0,0,0],A._orientation=new u.Math.Quaternion,A._lastHeadPose=[0,0,0],A._offsetToBeAdd=[0,0,0],A._fpsInfo={time:0,fps:0,frames:0}};Wh(Oo,f,{ms_fire:!0,_42:function(b,H,I,a){var l=this,G=l.gv;if(!G.drawFilter&&l._deviceInAction){var v=l._device;if(v){var m=l._measureOflength;v.depthNear=G.getNear()*m,v.depthFar=G.getFar()*m;var J=l._offsetToBeAdd;if(l.eyesOffset[0]+=J[0],l.eyesOffset[1]+=J[1],l.eyesOffset[2]+=J[2],J[0]=0,J[1]=0,J[2]=0,v.isPresenting===!1)return l._controllers.forEach(function(U){U&&U.update()}),G.iv(),!1;var B=l._frameData;v.getFrameData(B);var P=B.pose.position;if(P){var Q=l.toViewPosition(P);G.setEye(Q),l._orientation.fromArray(B.pose.orientation);var d=new u.Math.Vector3(0,0,-10*l._scaleFactor);d.applyQuaternion(l._orientation),G.setCenter([Q[0]+d.x,Q[1]+d.y,Q[2]+d.z])}l._controllers.forEach(function($){$&&$.update()}),G.setViewport(b,0,0,H/2,I),l._viewMatrix=l._copyViewMatrix(B.leftViewMatrix),l._projectMatrix=l._copyProjectMatrix(B.leftProjectionMatrix),a(),G.setViewport(b,H/2,0,H/2,I),l._viewMatrix=l._copyViewMatrix(B.rightViewMatrix),l._projectMatrix=l._copyProjectMatrix(B.rightProjectionMatrix),a(),l._lastViewMatrix=l._viewMatrix,l._lastProjectMatrix=l._projectMatrix,l._viewMatrix=null,l._projectMatrix=null,l.submitFrame();var h=Date.now(),g=l._fpsInfo;return h-g.time>1e3?(g.fps=Math.round(1e3*(g.frames+1)/(h-g.time)),g.time=h,g.frames=0):g.frames++,!0}}},onVRDisplayPresentChange:function(){var p=this.isPresenting();this._injectGraphView(p),this.fp("present",!p,p)},getOrientation:function(){return this._orientation},addController:function(X){X=X||0;var $=this,R=$.getController(X);return R?R:(R=new Cj($,X),$._controllers.push(R),R)},getController:function(c){c=c||0;for(var o=this._controllers,U=0,y=o.length;y>U;U++)if(o[U]&&o[U].id===c)return o[U];return null},removeController:function(e){e=e||0;for(var Q=this._controllers,p=0,o=Q.length;o>p;p++)if(Q[p]&&Q[p].id===e)return Q.splice(p,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(U,N){var V=this,s=V._scaleFactor,m=V._eyesOffset,A=V._lastHeadPose;return A[0]=U[0]*s,A[1]=U[1]*s,A[2]=U[2]*s,N?(N[0]=A[0]+m[0],N[1]=A[1]+m[1],N[2]=A[2]+m[2],N):[A[0]+m[0],A[1]+m[1],A[2]+m[2]]},addEyesOffset:function(S,D,a){var A=this._offsetToBeAdd;A[0]+=S,A[1]+=D,A[2]+=a},_copyViewMatrix:function(D){var J=this.dup(D),u=this._scaleFactor;J[12]*=u,J[13]*=u,J[14]*=u;var j=this._eyesOffset;if(j&&(j[0]||j[1]||j[2])){var a=j[0],G=j[1],X=j[2];J[12]-=J[0]*a+J[4]*G+J[8]*X,J[13]-=J[1]*a+J[5]*G+J[9]*X,J[14]-=J[2]*a+J[6]*G+J[10]*X}return J},shutdown:function(){var g=this._device;g&&g.isPresenting&&g.exitPresent()},isPresenting:function(){var n=this._device;return n&&n.isPresenting},_copyProjectMatrix:function(B){var g=this.dup(B),_=this._scaleFactor;return g[14]*=_,g},dup:function(x,g){for(var W=x.length,Z=g||new Array(W);W--;)Z[W]=x[W];return Z},getViewMatrix:function(V){var U=this._viewMatrix;return U?this.dup(U,V):void 0},getProjectMatrix:function(){var s=this._projectMatrix;return s?this.dup(s):void 0},submitFrame:function(){var I=this;if(I._enable&&I._deviceInAction){var $=I._device;$&&$.isPresenting&&($.submitFrame(),I.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(X){var t=this.gv;return t.intersectObjects(X,t.dm().getDatas())},setDevice:function(O){var i=this;i._device=O},_injectGraphView:function(){var u,q,v;return function(h){var P=this.gv;if(!h)return u&&(P.getWidth=u,P.getHeight=q,P.getDevicePixelRatio=v),void 0;var G=this._device,w=G.getEyeParameters("left"),R=w.renderWidth,e=w.renderHeight;u=P.getWidth,q=P.getHeight,v=P.getDevicePixelRatio,P.getWidth=function(){return 2*R},P.getHeight=function(){return e},P.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(N){var w=this;if(!N)return Yb=u.Default.callLater=w._defaultCallLater,Mi=u.Default.cancelLater=w._defaultCancelLater,void 0;var w=this;Yb=u.Default.callLater=function(W,l,Q,v){var X=w._device;return X&&X.isPresenting?v?P(function(){Yb(W,l,Q)},v):X.requestAnimationFrame(function(){w._deviceInAction=!0,W.apply(l,Q),w._deviceInAction=!1}):w._defaultCallLater(W,l,Q,v)},Mi=u.Default.cancelLater=function(Q,P){var q=w._device;return q&&q.isPresenting?P?c(Q):q.cancelAnimationFrame(Q):w._defaultCancelLater(Q,P)}}}),f.defineProperties(Oo.prototype,{enable:{get:function(){return this._enable},set:function(d){var D=this;D._enable!==d&&(D._enable=d,d?(D.switch.showButton(),D._injectCallLaterFunc(!0)):(D.shutdown(),D.switch.hideButton(),D._injectCallLaterFunc(!1)),D.fp("enable",!d,d))}},measureOflength:{get:function(){return this._measureOflength},set:function(b){this._measureOflength=b;var L=this._scaleFactor=1/b;this._controllers.forEach(function(B){B&&B._setScaleFactor(L)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(l){this._eyesOffset=l}},controllerModel:{get:function(){return this._controllerModel},set:function(l){var w;"object"==typeof l?(w=l.mtl,l=l.obj):(w=l+".mtl",l+=".obj");var A=this,s=A._controllerModel;s&&s.obj===l&&s.mtl===w||(s=A._controllerModel={obj:l,mtl:w},C.loadObj(l,w,{finishFunc:function(e,r){A._controllerModel===s&&C.setShape3dModel("vrControllerModel",r)}}))}},interactive:{get:function(){return!!this._interactive},set:function(U){!!U!=!!this._interactive&&(this._interactive=U,U&&this.addController(0),this.gv.getCoreInteractor().enableVR(U))}}});var Cj=function(h,B){function W(f){var M=navigator.getGamepads&&navigator.getGamepads();if(M)for(var T=0,$=0,F=M.length;F>T;T++){var o=M[T];if(o){var a=o.id;if("OpenVR Gamepad"===a||"OpenVR Controller"===a||0===a.indexOf("Oculus Touch")||0===a.indexOf("Spatial Controller")){if($===f)return o;$++}}}}function b(P,G,L){return Math.abs(P[0]-G[0])<L&&Math.abs(P[1]-G[1])<L&&Math.abs(P[2]-G[2])<L?!0:!1}var Q=this;Q.vr=h,Q.id=B;var O,o,G=[0,0],Y=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],t=new lf;t.s("shape3d","vrControllerModel"),t.isController=!0,t.s("intersect",!1),Q.getGamepad=function(){return o},Q.isButtonPressed=function(c){for(var Q,i=0,b=Y.length;b>i;i++)if(Q=Y[i],Q.id===c)return Q.pressed;return!1},Q.getNode=function(){return t};var F=.003;Q.setRotationEpsilon=function(g){F=g};var x=5e-4,T=x;Q.setPositionEpsilon=function(n){x=n,T=n*Q.vr._scaleFactor},Q._setScaleFactor=function(J){t.s3(J,J,J),T=x*J},Q._setScaleFactor(Q.vr._scaleFactor);var A,M=new gr,i=new cc,k=[0,0,0],r=[0,0,0],P=new Vc,n=new tc,E=new Qr;Q.getRay=function(){return A?(E.origin.fromArray(k),E.direction.copy(n),A=!1,E):E},Q.update=function(){if(O=o,o=W(B),O!=o&&console.log("gamepad changed",o),!o||o.pose===l)return o=null,t.s("3d.visible",!1),void 0;if(C.getShape3dModel("vrControllerModel")){t.dm()||h.gv.dm().add(t),t.s("3d.visible",!0);var E=o.pose;if(null!==E){E.position&&(Q.vr.toViewPosition(E.position,k),b(t.p3(),k,T)||(A=!0,t.p3(k))),E.orientation&&(M.fromArray(E.orientation),n.set(0,0,-1).applyQuaternion(M).normalize(),i.makeRotationFromQuaternion(M),P.set(0,0,0,t.getRotationMode(),!0).setFromRotationMatrix(i),r[0]=P.x,r[1]=P.y,r[2]=P.z,b(t.r3(),r,F)||(A=!0,t.r3(r))),A&&h.fp("gamepad.pose",null,{position:k,rotation:r,id:B});var _=o.axes;(G[0]!==_[0]||G[1]!==_[1])&&(G=[_[0],_[1]],h.fp("gamepad.axes",null,{id:B,axes:G}));var s,V,N,q,w=o.buttons;for(s=0,V=w.length;V>s;s++)if(N=w[s],q=N.pressed,q!==Y[s].pressed){Y[s].pressed=q;var D={id:B},x="state";D[x]=D._62O=q?"down":"up",h.fp("gamepad.button."+Y[s].id,null,D)}}}}},Nh=function(h){this.vr=h,this._button=null};Wh(Nh,f,{showButton:function(){var y=this.assureButton();if(!y.parentNode){var U=this.vr.gv,j=U.getView();U._79O?j.insertBefore(y,U._79O):j.appendChild(y)}},hideButton:function(){var B=this._button;B&&B.parentNode&&B.parentNode.removeChild(B)},assureButton:function(){var T=this._button;return T?T:this._button=this.createButton(this.vr.gv)},createButton:function(J){function B(q,R){q.textContent=R&&R.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function y(b){H.style.display="",H.style.cursor="pointer",H.style.left="calc(50% - 50px)",H.style.width="100px",B(H,b),H.onmouseenter=function(){H.style.opacity="1.0"},H.onmouseleave=function(){H.style.opacity="0.5"},H.onclick=function(){b.isPresenting?b.exitPresent():b.requestPresent([{source:J.getCanvas()}])},J.vr.setDevice(b)}function V(){H.style.display="",H.style.cursor="auto",H.style.left="calc(50% - 75px)",H.style.width="150px",B(H,null),H.onmouseenter=null,H.onmouseleave=null,H.onclick=null,J.vr.setDevice(null)}function q(Z){Z.style.position="absolute",Z.style.bottom="20px",Z.style.padding="12px 6px",Z.style.border="1px solid #fff",Z.style.borderRadius="4px",Z.style.color="#000",Z.style.font="normal 13px sans-serif",Z.style.textAlign="center",Z.style.opacity="0.5",Z.style.outline="none",Z.style.zIndex="999"}if("getVRDisplays"in navigator){var H=this._button=w.createElement("button");return H.style.display="none",q(H),G.addEventListener("vrdisplayconnect",function(h){y(h.display)},N),G.addEventListener("vrdisplaydisconnect",function(){V()},N),G.addEventListener("vrdisplaypresentchange",function(j){B(H,j.display),J.vr.onVRDisplayPresentChange()},N),navigator.getVRDisplays().then(function(i){i.length>0?y(i[0]):V()}),H}var b=w.createElement("a");return b.href="https://webvr.info",b.innerHTML="当前不支持 webvr",b.style.left="calc(50% - 90px)",b.style.width="180px",b.style.textDecoration="none",q(b),b}}),f.defineProperties(Nh.prototype,{});var Wg=u.graph3d.PostProcessing=function(Q){function D(){if(!q){var Z=Q.getGL();q=new Lg.RenderTarget(Q,Z),U=new Bn.Shader(Z,C.vs,C.fs),n=Bn.Buffer.createIndexBuffer(Z,new Uint16Array([0,2,1,1,2,3])),Y=Bn.Buffer.createVertexBuffer(Z,new Float32Array([0,0,1,0,0,1,1,1]))}}var q,U,n,Y,k=this,F={},m=!1;!function(){f.keys(Wg).forEach(function(W){F[W]=new Wg[W](Q)})}(),k.getModule=function(K){return K?F[K]:F},k.getModuleList=function(){return f.keys(F)},k.handleDataModleChange=function(M,P){M&&(M.setPostProcessingData(k.serialize()),M.removeSerializeListener(k.onDataModelSerialize,k)),P&&(P.addSerializeListener(k.onDataModelSerialize,k),k.deserialize(P.getPostProcessingData()))},k.onDataModelSerialize=function(I){"serialize"===I.type?Q.dm()._postProcessingData=k.serialize():"deserialize"===I.type&&k.deserialize(Q.dm().getPostProcessingData())},k.serialize=function(){var f,D,U,I={};for(f in F)D=F[f],I[f]={enable:D.enable},U=D.serializeProperties,U&&U.forEach(function(O){I[f][O]=D[O]});return I},k.deserialize=function(x){if(x){var Y,S,A,K;for(Y in x)if(S=F[Y]){A=x[Y],k.enableModule(Y,A.enable);for(K in A)"enable"!==K&&(S[K]=A[K])}}else{var Y,S;for(Y in F)S=F[Y],S.enable=!1,S.resetProperties&&S.resetProperties()}},k.enableModule=function(Z,p){var U,E,H,M=Z.split(",");for(U=0,E=M.length;E>U;U++)H=M[U].trim(),F[H]&&(F[H].enable=p);m=!1;for(H in F)if(F[H].enable){m=!0;break}m&&D()};var C={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};k._42=function(J,v,i,L,w){if(m&&!w){q.setSize(J,v,i),Ue(J,q.frame),J.clear(J.COLOR_BUFFER_BIT|J.DEPTH_BUFFER_BIT),Q.setViewport(J,0,0,v,i),L();var y,T=q;for(y in F)T=F[y]._42(J,T)||T;return $q(J),Q.setViewport(J,0,0,v,i),J.clear(J.COLOR_BUFFER_BIT|J.DEPTH_BUFFER_BIT),U.bind(),J.activeTexture(J.TEXTURE0+0),J.bindTexture(J.TEXTURE_2D,T.texture),U.uniforms.image=0,n.upload(),Y.upload(),U.attributes.pos.pointer(Y),J.drawElements(J.TRIANGLES,6,J.UNSIGNED_SHORT,0),J.bindTexture(J.TEXTURE_2D,null),J.useProgram(Q._prg),!0}}},cm=u.graph3d.PostProcessing.Bloom=function(S){function e(){var e=S.getWidth(),J=S.getHeight();if(e&&J){j=[e,J],m=!0;var X,_=S.getGL(),Q=Math.round(j[0]/2),I=Math.round(j[1]/2);for(w=new Lg.RenderTarget(S,_,Q,I),X=0;G>X;X++)s.push(new Lg.RenderTarget(S,_,Q,I)),M.push(new Lg.RenderTarget(S,_,Q,I)),Q=Math.round(Q/2),I=Math.round(I/2);
d=new Bn.Shader(_,cm.highPassShader.vs,cm.highPassShader.fs);for(var X=0;G>X;X++)y[X]=new Bn.Shader(_,cm.blurShader.vs,cm.blurShader.fs.replace(/DEFINE_VALUE/g,$[X]));F=new Bn.Shader(_,cm.compositeShader.vs,cm.compositeShader.fs.replace(/NUM_MIPS/g,G)),W=new Bn.Shader(_,cm.finalShader.vs,cm.finalShader.fs),r=Bn.Buffer.createIndexBuffer(_,new Uint16Array([0,2,1,1,2,3])),g=Bn.Buffer.createVertexBuffer(_,new Float32Array([0,0,1,0,0,1,1,1]))}}var K,C,N,r,g,D=this,a=!1,m=!1;this.serializeProperties="strength,threshold,radius".split(","),this.resetProperties=function(){K=1.5,C=.55,N=.4},f.defineProperties(D,{enable:{get:function(){return a},set:function(u){!!a!=!!u&&(a=u,u&&!m&&e())}},strength:{get:function(){return K},set:function(c){K=c}},threshold:{get:function(){return C},set:function(v){C=v}},radius:{get:function(){return N},set:function(k){N=k}}}),this.resetProperties();var w,d,F,W,j=[256,256],s=[],M=[],G=5,$=[3,5,7,9,11],y=[];D._42=function(i,f){function R(T,l,k,L){Ue(i,l.frame),S.setViewport(i,0,0,l.width,l.height),L?L(i):i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT),t!==T&&T.bind();var C=0;for(var b in k){var M=k[b];M instanceof WebGLTexture&&(i.activeTexture(i.TEXTURE0+C),i.bindTexture(i.TEXTURE_2D,M),M=C,C++),T.uniforms[b]=M}for(t!==T&&(r.upload(),g.upload(),T.attributes.pos.pointer(g),t=T),i.drawElements(i.TRIANGLES,6,i.UNSIGNED_SHORT,0);C--;)i.activeTexture(i.TEXTURE0+C),i.bindTexture(i.TEXTURE_2D,null);$q(i)}if(a){m||e();var t;R(d,w,{smoothWidth:.01,luminosityThreshold:C,tDiffuse:f.texture});var T,P=w,U=Math.round(j[0]/2),A=Math.round(j[1]/2);for(T=0;G>T;T++)R(y[T],s[T],{colorTexture:P.texture,direction:[1,0],texSize:[U,A]}),R(y[T],M[T],{colorTexture:s[T].texture,direction:[0,1],texSize:[U,A]}),U=Math.round(U/2),A=Math.round(A/2),P=M[T];return R(F,s[0],{blurTexture1:M[0].texture,blurTexture2:M[1].texture,blurTexture3:M[2].texture,blurTexture4:M[3].texture,blurTexture5:M[4].texture,bloomStrength:K,bloomRadius:N,bloomTintColor:[1,1,1]}),R(W,f,{image:s[0].texture},function(G){G.enable(G.BLEND),G.blendEquation(G.FUNC_ADD),G.blendFunc(G.SRC_ALPHA,G.ONE)}),i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA),f}}};cm.highPassShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D tDiffuse;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","vec3 luma = vec3( 0.299, 0.587, 0.114 );","float v = dot( texel.xyz, luma );","vec4 outputColor = vec4(0.0, 0.0, 0.0, 0.0);","float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","gl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},cm.blurShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D colorTexture;","uniform vec2 texSize;","uniform vec2 direction;","#define KERNEL_RADIUS DEFINE_VALUE","#define SIGMA DEFINE_VALUE","float gaussianPdf(in float x, in float sigma) {","return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;","}","void main() {","vec2 invSize = 1.0 / texSize;","float fSigma = float(SIGMA);","float weightSum = gaussianPdf(0.0, fSigma);","vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;","for( int i = 1; i < KERNEL_RADIUS; i ++ ) {","float x = float(i);","float w = gaussianPdf(x, fSigma);","vec2 uvOffset = direction * invSize * x;","vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;","vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;","diffuseSum += (sample1 + sample2) * w;","weightSum += 2.0 * w;","}","gl_FragColor = vec4(diffuseSum/weightSum, 1.0);","}"].join("\n")},cm.compositeShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","varying vec2 vUv;","uniform sampler2D blurTexture1;","uniform sampler2D blurTexture2;","uniform sampler2D blurTexture3;","uniform sampler2D blurTexture4;","uniform sampler2D blurTexture5;","uniform sampler2D dirtTexture;","uniform float bloomStrength;","uniform float bloomRadius;","uniform vec3 bloomTintColor;","float lerpBloomFactor(const in float factor) {","float mirrorFactor = 1.2 - factor;","return mix(factor, mirrorFactor, bloomRadius);","}","void main() {","gl_FragColor = bloomStrength * ( lerpBloomFactor(1.0) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture1, vUv) + ","lerpBloomFactor(0.8) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture2, vUv) + ","lerpBloomFactor(0.6) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture3, vUv) + ","lerpBloomFactor(0.4) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture4, vUv) + ","lerpBloomFactor(0.2) * vec4(bloomTintColor, 1.0) * texture2D(blurTexture5, vUv) );","}"].join("\n")},cm.finalShader={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")},No(C,{accordionViewExpandIcon:Wp(oh),accordionViewCollapseIcon:Wp(oh,!0),accordionViewLabelColor:Ik,accordionViewLabelFont:Db,accordionViewTitleBackground:yn,accordionViewSelectBackground:mi,accordionViewSelectWidth:3,accordionViewSeparatorColor:l,splitViewDividerSize:1,splitViewDividerBackground:yn,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Ok,rect:[2,2,12,12],background:oh}]},propertyViewLabelColor:le,propertyViewLabelSelectColor:Ik,propertyViewLabelFont:Db,propertyViewExpandIcon:Wp(xc),propertyViewCollapseIcon:Wp(xc,!0),propertyViewBackground:Fh,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:bs,propertyViewColumnLineColor:bs,propertyViewSelectBackground:mi,listViewLabelColor:le,listViewLabelSelectColor:Ik,listViewLabelFont:Db,listViewRowLineVisible:!1,listViewRowLineColor:bs,listViewSelectBackground:mi,treeViewLabelColor:le,treeViewLabelSelectColor:Ik,treeViewLabelFont:Db,treeViewExpandIcon:Wp(Wm),treeViewCollapseIcon:Wp(Wm,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:bs,treeViewSelectBackground:mi,treeViewDoubleClickToToggle:!0,tableViewLabelColor:le,tableViewLabelSelectColor:Ik,tableViewLabelFont:Db,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:bs,tableViewColumnLineColor:bs,tableViewSelectBackground:mi,treeTableViewLabelColor:le,treeTableViewLabelSelectColor:Ik,treeTableViewLabelFont:Db,treeTableViewExpandIcon:Wp(Wm),treeTableViewCollapseIcon:Wp(Wm,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:bs,treeTableViewColumnLineColor:bs,treeTableViewSelectBackground:mi,tableHeaderLabelColor:le,tableHeaderLabelFont:Db,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Gf,tableHeaderBackground:Fh,tableHeaderMoveBackground:xr,tableHeaderInsertColor:mi,tableHeaderSortDescIcon:Fk(xc,!0),tableHeaderSortAscIcon:Fk(xc),tabViewTabGap:1,tabViewLabelColor:Ik,tabViewLabelFont:Db,tabViewTabBackground:yn,tabViewSelectWidth:3,tabViewSelectBackground:mi,tabViewMoveBackground:xr,tabViewInsertColor:mi,toolbarLabelColor:le,toolbarLabelSelectColor:Ik,toolbarLabelFont:Db,toolbarBackground:Fh,toolbarSelectBackground:mi,toolbarItemGap:8,toolbarSeparatorColor:Gh},!0);var Tm={translateX:1,sortColumn:1},sf={sortable:1,sortOrder:1,sortFunc:1},sr={focusData:1},hk={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},Vj={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},ar=function(n,c){c.add(n),n.hasChildren()&&n.eachChild(function(C){ar(C,c)})},pd=function(u,A,Z,y,U,K,g,r,w,s,l){var Y,E=Z.getValueType(s),q=Z.getAlign(s);if(Z.getEnumValues(s)){var O=Z.toEnumLabel(A,s),n=Ao||0,o=0,z=K,t=C.getTextSize(y,O).width;return Y=ef(Z.toEnumIcon(A,s)),Y&&(o=K+Ao/2,"center"===q?o+=(r-(n+t))/2:"right"===q&&(o=o+r-(n+t)),Pk(u,Y,o,g+w/2,s,l),z=o+Ao/2),O!=h&&(Y?ic(u,O,y,U,z,g,r-(z-K),w):ic(u,O,y,U,K,g,r,w,q)),void 0}return A=Z.formatValue(A),A!=h?E===jd?(ng(u,K,g,r,w,A),void 0):E===Uq||!E&&Yg(A)?(Y=ef(A?vk:lr),Pk(u,Y,K+r/2,g+w/2,s,l),void 0):(ic(u,A,y,U,K,g,r,w,q),void 0):void 0},Nf=function(e,m){var c=m.view,U=hh(e),n=m.column||m.property;c.getDataModel().beginTransaction(),m.editor=e,e.info=m,c.setCurrentEditor(e),c.getView().insertBefore(U,c._79O),rr(e,m.editorRect),e.setFocus?e.setFocus():Zn(e),e.commitValue=function(k,L){e._17Q&&(e=e._17Q),L||c.setValue(m.data,n,e.getValue?e.getValue():e.value),e.close&&e.close(),Oe(U)},n.onEditorCreated&&n.onEditorCreated(m)},Ib=function(I,x,V,s,O){var r=qs(I,V),j=x.value,W=x.view,y=O.getValueType(x.data);return r.onblur=r.onchange=function(){W.endEditing()},"input"===I?(j=O.formatValue(j),j!=h&&(r.value=j),r.onkeydown=function(B){dl(B)?W.endEditing():Di(B)&&W.endEditing(!0)},(y===Hn||y===ws)&&r.addEventListener(eq,C.numberListener,N)):I===zp&&s.forEach(function(h){var R=w.createElement("option");R.innerHTML=O.toEnumLabel(h),R.value=h,O.isEnumEqual(j,h)&&(R.selected=!0),Pp(r,R)}),Nf(r,x),r},zl=u.widget={},Oi=function(k,S,V){Wh(s+".widget."+k,S,V)};No(Cg,{ms_value:function(W){W.getValue=function(u){var p=this.getItemById(u),t=p.element;return Tf(t)?t:t?t.getValue?t.getValue():t.value:p.selected},W.setValue=function(I,b){var R=this.getItemById(I);if(R){var x=R.element;x&&!Tf(x)?x.setValue?x.setValue(b):x.value=b:Yg(b)?(R.selected=b,this.iv()):(R.element=b,this.iv())}},W.v=function(x,a){var s=this;if(2===arguments.length)s.setValue(x,a);else{if(!An(x))return s.getValue(x);for(var V in x)s.setValue(V,x[V])}return s}},_46o:function(g){g._icon=h,g._accessType=h,g._valueType=h,g._editable=!1,g._batchEditable=!0,g._align=nh,g._nullable=!0,g._emptiable=!1,g.setParent=$r,g.formatValue=function(F){var _=this,T=_._valueType;return _.getEnumValues()?_.toEnumLabel(F):T===Uq?!!F:F!=h&&T===Hn?R(F):F},g.setEnum=function(Y,f,g,K,e,X,J){var z=this;Y&&!wc(Y)&&Y.values&&(K=Y.editable,g=Y.icons,f=Y.labels,e=Y.strict,X=Y.maxHeight,J=Y.dropDownWidth,Y=Y.values),uf(Y)&&(Y=Y._as),uf(f)&&(f=f._as),uf(g)&&(g=g._as),z._enumValues=Y,z._enumLabels=f,z._enumIcons=g,z._enumEditable=K,z._enumStrict=e==h?!0:e,z._enumMaxHeight=X,z._enumDropDownWidth=J,Y&&Y.length&&cg(Y[0])&&(z._valueType=ws),z.fp("enum",!1,!0)},g.getEnumDropDownWidth=function(){return this._enumDropDownWidth},g.getEnumMaxHeight=function(){return this._enumMaxHeight},g.isEnumEditable=function(){return this._enumEditable},g.getEnumValues=function(){return this._enumValues},g.getEnumLabels=function(){return this._enumLabels},g.getEnumIcons=function(){return this._enumIcons},g.isEnumStrict=function(){return this._enumStrict},g.isEnumEqual=function(r,b){return this._enumStrict?r===b:r==b},g.toEnumLabel=function(w,h){var N=this,A=N.getEnumValues(h),$=N.getEnumLabels(h);if(A&&$)for(var G=0;G<A.length;G++)if(N.isEnumEqual(w,A[G]))return $[G];return w},g.toEnumIcon=function(R,h){var Y=this,n=Y.getEnumValues(h),u=Y.getEnumIcons(h);if(n&&u)for(var I=0;I<n.length;I++)if(Y.isEnumEqual(R,n[I]))return u[I];return l}},_45o:function(S){S._87o=function(x,T,k,l,N,U){if(x){var L=this,W=L._90I,D=Ki(1);L._columnLineVisible&&(N-=1),L._rowLineVisible&&(U-=1),0>=N||0>=U||(L._90I||(W=L._90I={}),W[T]||(W[T]=new mo),rr(D,L.tx()+k,L.ty()+l,N,U),Pp(D,x),L._view.insertBefore(D,L._79O),x.onParentAdded&&x.onParentAdded(D),W[T].add(D))}},S._76o=function(){var J=this,Q=J._90I;if(Q){for(var e in Q)Q[e].each(function(L){Oe(L)});delete J._90I}},S._77o=function(S){var h=this;if(h._90I){var P=h._90I[S];P&&(P.each(function(I){Oe(I)}),delete h._90I[S])}}},_47o:function(M){M.getValue=function(I,E){return E.getValue?E.getValue(I,E,this):Xc(I,E.getAccessType(),E.getName())},M.setValue=function(s,G,L){if(G.isEmptiable(s)||""!==L||(L=l),G.isNullable(s)||L!=h){var D=this,R=G.getName(s),O=G.getAccessType(s),V=G.getValueType(s);V===Hn&&Tf(L)?L=Q(L):V===ws&&Tf(L)?L=parseFloat(L):V===Uq&&Tf(L)&&(L="true"===L),D._batchEditable&&G._batchEditable&&D.isSelected(s)?D.sm().each(function(H){G.setValue?G.setValue(H,G,L,D):rl(H,O,R,L)}):G.setValue?G.setValue(s,G,L,D):rl(s,O,R,L)}},M.setCurrentEditor=function(N){this.endEditing(),this._currentEditor=N,this.redraw()},M.isEditing=function(Q,D){var V=this,r=V._currentEditor;if(!r)return!1;if(D){var n=r.info;return n?(n.column||n.property)===D&&n.data===Q:!1}return!0},M.endEditing=function(h){var l=this,j=l._currentEditor;j&&(delete l._currentEditor,j.commitValue&&j.commitValue(j.info,h),l.redraw(),l.getDataModel().endTransaction())},M.beginEditing=function(j){this.endEditing();var U=this,V=j.column||j.property;if(V.beginEditing)V.beginEditing(j);else{var m=j.data,P=j.value,_=U.getSelectBackground(m),t=V.getEnumValues(m),T=V.getSlider(m),L=V.getColorPicker(m);if(T){var y=Kh(zl.Slider,T);return y.setValue(P),y.getView().onblur=function(){U.endEditing()},y.isInstant()&&(y.onValueChanged=function(){U.setValue(m,V,y.getValue())}),Nf(y,j),void 0}if(L||V.getValueType(m)===jd){var b=Kh(zl.ColorPicker,L);return b.setValue(P),b.onClosed=function(){U.endEditing()},b.isInstant()&&(b.onValueChanged=function(e,G){U.setValue(m,V,G)}),Nf(b,j),b.open(),void 0}if(t){if(zl.ComboBox){var D=new zl.ComboBox;D.setValue(P),D.setValues(t),D.setLabels(V.getEnumLabels(m)),D.setIcons(V.getEnumIcons(m)),D.setEditable(V.isEnumEditable(m)),D.setStrict(V.isEnumStrict(m)),D.setMaxHeight(V.getEnumMaxHeight(m)),D.setDropDownWidth(V.getEnumDropDownWidth(m)),D.onClosed=function(){U.endEditing()},Nf(D,j),D.open()}else Ib(zp,j,_,t,V);return}var x=V.getValueType(m);if(x===Uq||Yg(P))return U.setValue(m,V,!P),void 0;if(V.getItemEditor(m)){var M=Xe(V.getItemEditor(m)),Z=new M(m,V,U,j),Y=Z.getView();return Y._17Q=Z,Z.setValue(P),gd(Y),Nf(Y,j),Z.editBeginning&&Z.editBeginning(),void 0}Ib("input",j,_,h,V)}}},_44o:function(W){W.init=function(G){var Q=this,j=Q.th=new _m(G),O=Q._view=Lh(1,Q);Q.tv=Q._tableView=G,Pp(O,j.getView()),Pp(O,G.getView()),j.mp(function(O){O.property===dd&&Q.iv()}),Q.iv()},W.getTableView=function(){return this.tv},W.getTableHeader=function(){return this.th},W.getDataModel=function(){return this.tv.dm()},W.getColumnModel=function(){return this.tv.getColumnModel()},W.setColumns=function(A){this.tv.setColumns(A)},W.addColumns=function(u){this.tv.addColumns(u)},W.endEditing=function(){this.tv.endEditing()},W.validateImpl=function(){var b=this,u=b.th,o=us(u),W={x:0,y:0,width:b.getWidth(),height:o};rr(u,W),W.y=o,W.height=m(0,b.getHeight()-o),rr(b.tv,W)}},ms_vs:function(S){S._41o=function(){return this._29I.height<this._59I},S._43o=function(){var F=this;F._41o()&&(F._58I||(P(function(){F._94O()},qo),F.iv()),F._58I=new Date)},S._94O=function(){var h=this;if(h._58I){var U=new Date;U.getTime()-h._58I.getTime()>=qo?(delete h._58I,h.iv()):P(function(){h._94O()},qo)}},S._93I=function(){var t=this,d=t._27I;if(t._58I||!t._autoHideScrollBar){d||Pp(t._79O,d=t._27I=Ki());var E=t._29I,$=E.height,U=t._59I,w=t.getScrollBarSize(),A=E.width-w-2,j=$*(-t.ty()/U),R=$*($/U),M=d.style;U>$?(Vh>R&&(j=j+R/2-Vh/2,0>j&&(j=0),j+Vh>$&&(j=$-Vh),R=Vh),M.visibility=Ei,M.background=t.getScrollBarColor(),M.borderRadius=w/2+ej,rr(d,A,j,w,R)):M.visibility=sl}else d&&(d.style.visibility=sl)}},ms_hs:function(S){S._40o=function(){return this._29I.width<this._91I},S._42o=function(){var L=this;L._40o()&&(L._95O||(P(function(){L._94I()},qo),L.iv()),L._95O=new Date)},S._94I=function(){var c=this;if(c._95O){var l=new Date;l.getTime()-c._95O.getTime()>=qo?(delete c._95O,c.iv()):P(function(){c._94I()},qo)}},S._92I=function(){var U=this,j=U._28I;if(U._95O||!U._autoHideScrollBar){j||Pp(U._79O,j=U._28I=Ki());var p=U._29I,J=p.width,W=U._91I,t=U.getScrollBarSize(),T=p.height-t-2,H=J*(-U.tx()/W),q=J*(J/W),D=j.style;W>J?(Vh>q&&(H=H+q/2-Vh/2,0>H&&(H=0),H+Vh>J&&(H=J-Vh),q=Vh),D.visibility=Ei,D.background=U.getScrollBarColor(),D.borderRadius=t/2+ej,rr(j,H,T,q,t)):D.visibility=sl}else j&&(j.style.visibility=sl)}}}),Tn(vk,Ng(16,16,[{type:ue,rect:[1,1,14,14],background:mi},{type:Cs,rect:[1,1,14,14],width:1,color:hb},{type:Fi,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Tn(lr,Ng(16,16,{type:Cs,rect:[1,1,14,14],width:1,color:hb})),Tn(fe,Ng(16,16,[{type:Ri,rect:[2,2,12,12],borderWidth:1,borderColor:hb,background:"#FFF"},{type:Ri,rect:[4,4,8,8],background:mi}])),Tn(Aj,Ng(16,16,{type:Ri,rect:[2,2,12,12],borderWidth:1,borderColor:hb})),Cg._15Q=function(t){t._29I=dm,t._59I=0,t._91I=0,t._5o=function(O){var r=this;r._30I=new mo,r._rows=new mo,r._rowMap={},r._31I=0,r._14I=0,r._view=Lh(1,r),r._canvas=fr(r._view),Pp(r._view,r._79O=Ki()),r.dm(O?O:new Hh)},t.getCheckIcon=function(o){var X=this.sm(),H=X.co(o);return X.sg()?ef(H?fe:Aj):ef(H?vk:lr)},t.checkData=function($){var w=this.sm(),u=w.co($);w.sg()&&u||(this._32o=1,u?w.rs($):w.as($),delete this._32o)},t.getDataAt=function(n){n.target&&(n=this.lp(n));var r=j(n.y/this._rowHeight),m=this._rows;return 0>r||r>=m.size()?h:m.get(r)},t.onDataDoubleClicked=function(){},t.onDataClicked=function(){},t.adjustTranslateX=function(){return 0},t.adjustTranslateY=function(p){var J=this.getHeight()-this._59I;return J>p&&(p=J),p>0?0:R(p)},t.onPropertyChanged=function(r){var y=this,N=r.property;hk[N]?y.ivm():sr[N]||y.redraw(),N===Xp?y._42o():N===cp&&y._43o()},t.getLabel=function(S){return S.toLabel()},t.getLabelFont=function(){return this._labelFont},t.getLabelColor=function(z){var M=this;if(M.isCheckMode()){if(M._focusData===z)return M._labelSelectColor}else if(M.isSelected(z))return M._labelSelectColor;return M._labelColor},t.getStartRowIndex=function(){return this._31I},t.getEndRowIndex=function(){return this._14I},t.getRowDatas=function(){return this._rows},t.getRowIndex=function(S){return this._rowMap[S._id]},t.getRowSize=function(){return this._rows.size()},t.getViewRect=function(){return ud(this._29I)},t.isVisible=function(E){return this._visibleFunc?this._visibleFunc(E):!0},t.getCurrentSortFunc=function(){return this._sortFunc},t.setDataModel=function(C){var R=this,j=R._dataModel,k=R._selectionModel;j!==C&&(j&&(j.umm(R.handleDataModelChange,R),j.umd(R.handleDataPropertyChange,R),j.umh(R.handleHierarchyChange,R),k||j.sm().ums(R.handleSelectionChange,R)),R._dataModel=C,C.mm(R.handleDataModelChange,R),C.md(R.handleDataPropertyChange,R),C.mh(R.handleHierarchyChange,R),k?k._21I(C):C.sm().ms(R.handleSelectionChange,R),R.fp("dataModel",j,C))},t.validateModel=function(){var w=this;w._rows.clear(),w._rowMap={},w.buildChildren(w._dataModel._roots);var N=w._rows=w._rows.toList(w.isVisible,w),Q=0,A=w.getCurrentSortFunc(),x=N.size();for(A&&N.sort(A);x>Q;Q++)w._rowMap[N.get(Q)._id]=Q},t.buildChildren=function(v){var P=this;v.each(function(x){P._rows.add(x),P.buildChildren(x._children)})},t.handleDataModelChange=function(){this.ivm()},t.handleDataPropertyChange=function(A){"parent"===A.property?this.ivm():this.invalidateData(A.data)},t.handleHierarchyChange=function(){this.ivm()},t.handleSelectionChange=function(L){L.datas.each(this.invalidateData,this),this.onSelectionChanged(L)},t.onSelectionChanged=function(M){var e=this,J=e.sm();!e.isAutoMakeVisible()||1!==J.size()||"set"!==M.kind&&"append"!==M.kind||e._32o||e.makeVisible(J.ld())},t.handleBackgroundClick=function(q){ci(q)&&!this.isCheckMode()&&this.sm().cs()},t.makeVisible=function(I){I&&(this._23I=I,this.iv())},t.scrollToIndex=function(O){var j=this,o=j._29I,_=o.height,C=j._rowHeight,k=C*O;O>=0&&O<j._rows.size()&&_>0&&(k+C>o.y+_?j.ty(-k+_-C):k<o.y&&j.ty(-k))},t.autoScroll=function(T,u){var a=this,w=a._rowHeight,M=w,h=w/4,z=a._29I,P=a.lp(T),E={x:a.tx(),y:a.ty()};return w>0&&z&&(P.x-z.x<M?a.translate(h,0):z.x+z.width-P.x<M&&a.translate(-h,0),P.y-z.y<M?a.translate(0,h):z.y+z.height-P.y<M&&a.translate(0,-h)),E.x=a.tx()-E.x,E.y=a.ty()-E.y,u&&(u.x+=E.x,u.y+=E.y),E},t.getTopRowOrderSelection=function(){var e=this.sm().getTopSelection(),K={},j=new mo;return e.each(function(M){K[M._id]=M}),this._rows.each(function(O){K[O._id]&&j.add(O)}),j},t.getRowOrderSelection=function(){var I=new mo;return this._rows.each(function(N){this.isSelected(N)&&I.add(N)},this),I},t.ivm=function(){this.invalidateModel()},t.invalidateModel=function(){var Y=this;Y._96I||(Y._96I=1,Y._32I=1,delete Y._24I),Y.iv()},t.redraw=function(){var y=this;y._32I||(y._32I=1,delete y._24I,y.iv())},t.invalidateData=function(T){var N=this;$?N.redraw():N._32I||(N._24I||(N._24I={}),N._24I[T._id]=T,N.iv())},t.getFocusData=function(){return this._focusData},t.setFocusDataById=function(N){this.setFocusData(this.dm().getDataById(N))},t.setFocusData=function(r){var t=this,u=t._focusData;u!==r&&(t._focusData=r,t.fp("focusData",u,r),u&&t.invalidateData(u),r&&(t.invalidateData(r),t.isAutoMakeVisible()&&t.makeVisible(r)))},t.drawRowBackground=function(a,P,Y,K,o,X,y){var z=this,w=z.isCheckMode();(P===z._focusData&&w||Y&&!w)&&ng(a,K,o,X,y,z.getSelectBackground(P))},t.drawData=function(f,I,J){var t=this,j=t._rowHeight,Q=j*J,$=t._29I,X=$.x,o=$.width;f.save(),f.beginPath(),f.rect(X,Q,o,j),f.clip(),t._87o(t.drawRow(f,I,t.isSelected(I),X,Q,o,j),J,X,Q,o,j),f.restore(),t._rowLineVisible&&ng(f,X,Q+j-1,o,1,t._rowLineColor)},t._12I=function(k){var l=this,p=l._31I,C=l._29I,I=C.x,M=C.y,N=C.width,L=C.height;for(k.beginPath(),k.rect(I,M,N,L),k.clip(),k.clearRect(I,M,N,L),l._76o(),l._93db(k);p<l._14I;p++)l.drawData(k,l._rows.get(p),p);l._92db(k)},t._13I=function(N){for(var I,F=this,L=F._rowHeight,e=F._29I,k=e.x,b=e.width,U=F._31I,u=F._30I;U<F._14I;U++)I=F._rows.get(U),F._24I[I._id]&&u.add({data:I,index:U});u.isEmpty()||(N.beginPath(),u.each(function(o){N.rect(k,o.index*L,b,L)}),N.clip(),u.each(function(B){N.clearRect(k,B.index*L,b,L)}),u.each(function(l){F._77o(l.index)}),F._93db(N),u.each(function(D){F.drawData(N,D.data,D.index)}),F._92db(N),u.clear())},t.preValidateModel=function(){this.endEditing&&this.endEditing()},t.validateImpl=function(){var H=this,J=H._canvas,e=H.getWidth(),E=H.getHeight(),_=H._rowHeight,o=H._32I;(e!==J.clientWidth||E!==J.clientHeight)&&(Dg(J,e,E),o=1);var V=Y&&!I;H._96I&&!V&&(H.preValidateModel(),H.validateModel());var U=H._29I,r={x:-H.tx(),y:-H.ty(),width:e,height:E},m=H._rows.size(),T=Uh(J),k=H._23I;o||Tg(r,U)||(o=1),H._29I=r,H._59I=m*_+H.getScrollBarSize(),H._31I=j(r.y/_),H._14I=d((r.y+r.height)/_),H._31I<0&&(H._31I=0),H._14I>m&&(H._14I=m),H._99I&&o&&H._99I(),Jq(T,H.tx(),H.ty(),1),o?H._12I(T):H._24I&&H._13I(T),H._93I(),H._92I(),T.restore(),H._32I=H._24I=H._96I=h,k&&(H.scrollToIndex(H.getRowIndex(k)),delete H._23I),H.tx(H.tx()),H.ty(H.ty())}},Cg._48o=function($){$._rootVisible=!0,$._rootData=h,$._35o=function(){this._expandMap={},this._levelMap={}},$.validateModel=function(){var h=this,b=h._rootData;h._rows.clear(),h._levelMap={},h._rowMap={},h._currentLevel=0,b?h._rootVisible?h.isVisible(b)&&h.buildData(b):h.buildChildren(b):h.buildChildren(),delete h._currentLevel},$.buildData=function(D){var e=this,g=D._id,M=e._rows;e._rowMap[g]=M.size(),M.add(D),e._levelMap[g]=e._currentLevel,e.isExpanded(D)&&(e._currentLevel++,e.buildChildren(D),e._currentLevel--)},$.buildChildren=function(X){var Z=this,S=X?X._children:Z._dataModel._roots,g=Z.getCurrentSortFunc();g&&Z.isChildrenSortable(X)?S.toList(Z.isVisible,Z).sort(g).each(Z.buildData,Z):S.each(function(b){Z.isVisible(b)&&Z.buildData(b)})},$.getLevel=function(o){return this._levelMap[o._id]},$.getToggleIcon=function(O){var J=this,I=J._loader,j=J._collapseIcon;return I&&!I.isLoaded(O)?j:O.hasChildren()?J.isExpanded(O)?J._expandIcon:j:h},$.isCheckMode=function(){return this._checkMode!=h},$.isChildrenSortable=function(){return!0},$.handleDataModelChange=function(Z){var r=this;Z.kind===Yr?delete r._expandMap[Z.data._id]:Z.kind===cn&&(r._expandMap={}),r.ivm()},$.toggle=function(B){var R=this;R.isExpanded(B)?R.collapse(B):R.expand(B)},$.isExpanded=function(v){return 1===this._expandMap[v._id]},$.expand=function(w){var B=this,s=B._loader;B.isExpanded(w)||(s&&!s.isLoaded(w)&&s.load(w),B._expandMap[w._id]=1,B.ivm(),B.onExpanded(w))},$.onExpanded=function(){},$.collapse=function(Y){var c=this;c.isExpanded(Y)&&(delete c._expandMap[Y._id],c.ivm(),c.onCollapsed(Y))},$.onCollapsed=function(){},$.expandAll=function(c){if(c)this.expand(c),c.eachChild(function(s){this.expandAll(s)},this);else{var m=this;m._dataModel.each(function(z){z.hasChildren()&&(m._expandMap[z._id]=1)}),m.ivm()}},$.collapseAll=function(){this._expandMap={},this.ivm()},$.makeVisible=function(b){if(b){var Q=this;if(!Q._rootData||b.isDescendantOf(Q._rootData)){for(var m=b._parent;m;)Q.expand(m),m=m._parent;Q._23I=b,Q.iv()}}},$.checkData=function($){var i,b=this,S=b._checkMode,e=b.sm(),l=e.co($);if(!e.sg()||!l){if(b._32o=1,S===Zq)l?e.rs($):e.as($);else if(S===bg)i=new mo($),i.addAll($._children);else if("descendant"===S)i=new mo,ar($,i);else if("all"===S&&(i=new mo,ar($,i),!l))for(var p=$._parent;p;)i.add(p),p=p._parent;i&&(l?e.rs(i):e.as(i)),delete b._32o}},$._97I=function(Z,u,U,T,v,X,Y){var Q=this,b=Q._indent,q=Q._levelMap[u._id],i=Q.getIconWidth(u),h=ef(Q.getToggleIcon(u));h?(T+=b*q,Pk(Z,h,T+b/2,v+Y/2,u,Q),T+=b):T+=b*(q+1),Q._checkMode&&(Pk(Z,Q.getCheckIcon(u),T+b/2,v+Y/2,u,Q),T+=b),Q.drawIcon(Z,u,T,v,i,Y),Q.drawLabel(Z,u,T+i,v,Y)}},Cg._14Q=function(R){R.getIcon=function(Z){return Z.getIcon()},R.getIconWidth=function(E){return this.getIcon(E)?this._indent:0},R.drawIcon=function(D,B,j,C,r,T){if(r){var t=this,O=t.getBodyColor(B),A=ef(t.getIcon(B),O);A&&(T-=t.isRowLineVisible()?1:0,Cr(D,A,pi,j,C,r,T,B,t,O),wg(D,t.getBorderColor(B),j,C,r,T))}},R.drawLabel=function(S,U,s,V,C){var F=this;ic(S,F.getLabel(U),F.getLabelFont(U),F.getLabelColor(U),s,V,0,C)}},Cg._50o=function(m){m._98I=function(){var E=this,$=E._39o=new Hh;E._60I=new mo,$.mm(E._17o,E),$.md(E._18o,E),$.mh(E._19o,E)},m.setColumns=function(B){this._39o.clear(),this.addColumns(B)},m.addColumns=function(T){var Y=this._39o;T.forEach(function(t){if(!(t instanceof Zr)){var S=Xe(t.className);t=Kh(S?S:Zr,t)}Y.add(t)})},m.onColumnClicked=function(){},m.onCheckColumnClicked=function(){},m._3Q=function(L){for(var c,X=0,V=this._60I,G=V.size();G>X;X++)if(c=V.get(X),c.column===L)return c;return h},m.getColumnAt=function(w){var r=this._4Q(w);return r?r.column:h},m._4Q=function(D){for(var O=this,P=D.target?O.lp(D).x:D.x,k=O._60I,l=0;l<k.size();l++){var o=k.get(l),X=o.startX;if(P>=X&&P<X+o.column.getWidth())return o}return h},m.getToolTip=function(p){var S=this,H=S.getDataAt(p),Q=S.getColumnAt(p);return H&&Q?Q.getToolTip(H,S):h},m.adjustTranslateX=function(X){var j=this.getWidth()-this._91I;return j>X&&(X=j),X>0?0:R(X)},m._99I=function(){var L=this,t=L._29I,F=L._60I;F.clear(),L._91I=0,L._39o._roots.each(function(A){if(A.isVisible()){var i=L._91I+A.getWidth();L._91I<=t.x+t.width&&i>=t.x&&F.add({column:A,startX:L._91I}),L._91I=i}}),L._91I+=L.getScrollBarSize()},m.drawData=function(c,u,B){var h=this,t=h._rowHeight,J=t*B,j=h.isSelected(u),z=h._29I,l=z.x,V=z.width;h.drawRowBackground(c,u,j,l,J,V,t),h._60I.each(function(N){var V=N.column,M=N.startX,k=V.getWidth();k>0&&!h.isEditing(u,V)&&(c.save(),c.beginPath(),c.rect(M,J,k,t),c.clip(),h._87o(h.drawCell(c,u,j,V,M,J,k,t),B,M,J,k,t),h._columnLineVisible&&ng(c,M+k-1,J,1,t,h._columnLineColor),c.restore())}),h._rowLineVisible&&ng(c,l,J+t-1,V,1,h._rowLineColor)},m.drawCell=function(r,i,S,l,m,N,c,y){var k=this;if(l.drawCell)return l.drawCell(r,i,S,l,m,N,c,y,k);var R=k.getValue(i,l);pd(r,R,l,k.getLabelFont(i,l,R),k.getLabelColor(i,l,R),m,N,c,y,i,k)},m.getColumnModel=function(){return this._39o},m._17o=function(){this.redraw()},m._18o=function(c){var K=this;c.data===K._sortColumn&&sf[c.property]?K.ivm():(K._42o(),K.redraw())},m._19o=function(){this.redraw()},m.getCurrentSortFunc=function(){var q=this,o=q._sortColumn;if(o&&o.isSortable()){var O=o.getSortFunc(),N=gl===o.getSortOrder()?1:-1;return O||(O=Ne),function(F,e){return O.call(q,q.getValue(F,o),q.getValue(e,o),F,e)*N}}return q._sortFunc},m.isCellEditable=function(L,d,c){return d.isEditable()&&this.isEditable()?d.isCellEditable?d.isCellEditable(L,d,c,this):!0:!1},m._37O=function(z,D){if(ci(D))for(var Y=this,Z=Y.lp(D),B=Y._60I,$=Y._rowHeight,i=Y._29I,F=i.x,m=i.y,a=i.width,c=i.height,u=0;u<B.size();u++){var s=B.get(u),f=s.startX,t=s.column,q=t.getWidth();if(t!==Y._31o&&t!==Y._4o&&Z.x>=f&&Z.x<f+q&&Y.isCellEditable(z,t,D)){var K={x:f,y:Y.getRowIndex(z)*$,width:q,height:$},U={x:K.x+Y.tx(),y:K.y+Y.ty(),width:K.width,height:K.height},V=0,r=0;return K.x<F?V=K.x-F:K.x+K.width>F+a&&(V=K.x+K.width-F-a),V&&(Y.tx(Y.tx()-V),U.x-=V),K.y<m?r=K.y-m:K.y+$>m+c&&(r=K.y+$-m-c),r&&(Y.ty(Y.ty()-r),U.y-=r),Y.beginEditing({data:z,column:t,value:Y.getValue(z,t),event:D,rect:K,editorRect:U,view:Y}),void 0}}}},zl.BaseItemEditor=function(e,u,c,b){this._data=e,this._column=u,this._master=c,this._editInfo=b},Oi("BaseItemEditor",f,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Lk=u.Tab=function(){Yn(Lk,this)};Jf("Tab",yh,{ms_ac:["view","closable","disabled"],_icon:h,_closable:!1,_disabled:!1,setParent:$r});var Zr=u.Column=function(){Yn(Zr,this)};Jf("Column",yh,{_46o:1,ms_ac:["accessType","valueType",Ei,eg,th,$h,"align",jd,"sortOrder",Bi,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:gl,_sortFunc:h,_sortable:!0,_clickable:!0,setWidth:function(G){16>G&&(G=16);var z=this._width;this._width=G,this.fp($h,z,G)},getToolTip:function(u,p){return this.formatValue(p.getValue(u,this))}});var Pi=u.Property=function(){Yn(Pi,this)};Jf("Property",yh,{_46o:1,ms_ac:["accessType","valueType",eg,th,"categoryName",jd,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:h,getToolTip:function(Q,f,T){var P=this;return f?P.formatValue(T.getValue(Q,P)):T.getPropertyName(P)}}),zl.AccordionView=function(){var V=this;V._20o={},V._21o=new mo,V._10o=h,V._9o=h,V._11o=h,V._view=Lh(0,V),V.iv()},Oi("AccordionView",f,{ms_v:1,ms_fire:1,ms_ac:[Ml,Wo,"titleHeight",eh,xb,"titleBackground","selectWidth",Fe,"orientation","separatorColor"],_expandIcon:C.accordionViewExpandIcon,_collapseIcon:C.accordionViewCollapseIcon,_titleHeight:zo,_labelColor:C.accordionViewLabelColor,_labelFont:C.accordionViewLabelFont,_titleBackground:C.accordionViewTitleBackground,_selectBackground:C.accordionViewSelectBackground,_selectWidth:C.accordionViewSelectWidth,_orientation:"v",_separatorColor:C.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(Q,k,e,w){var i=this,$=Ki();if(i._20o[Q])throw Q+" already exists";$.onmousedown=ll,$.style.cursor=Hm,$.addEventListener(Sl?we:tj,function(b){ll(b)},N),$.addEventListener(Sl?Sm:qe,function($){ll($),ci($)&&(i._10o===Q?i.collapse():i.expand(Q))},N),Pp(i._view,$),i._20o[Q]={content:k,div:$,canvas:fr($),icon:w},i._21o.add(Q),e&&i.expand(Q),i.iv()},remove:function(S){var o=this,n=o._20o[S];n&&(Oe(n.div),delete o._20o[S],o._21o.remove(S),o.iv())},clear:function(){var D=this;D._21o.toArray().forEach(D.remove,D),D._20o={},D._21o.clear(),D.iv()},isExpanded:function(D){return this._10o===D},expand:function(i){var s=this;s._20o[i]&&s._10o!==i&&(s._10o=i,s.onExpanded(i),s.iv())},onExpanded:function(){},collapse:function(){var X=this;X._10o&&(X.onCollapsed(X._10o),delete X._10o,X.iv())},onCollapsed:function(){},initCanvas:function(N,Z,R){Dg(N,Z,R);var i=Uh(N);return Jq(i,0,0,1),i.clearRect(0,0,Z,R),i},drawTitle:function(I,q,b,r,O){var k=this,l=ef(O.icon),U=k.isExpanded(q),F=k._titleHeight,L=k._titleBackground,v=k._selectWidth,E=k._separatorColor,o=ef(U?k._expandIcon:k._collapseIcon),Z=v+4;ng(I,0,0,b,r,L),U&&v&&ng(I,0,0,v,r,k._selectBackground),(U||k._21o.get(k._21o.size()-1)!==q)&&ng(I,0,r-1,b,1,E?E:yq(L)),l&&(Pk(I,l,Z+iq(l)/2,F/2),Z+=iq(l)+2),ic(I,q,k.getLabelFont(q),k.getLabelColor(q),Z,0,0,F),o&&Pk(I,o,b-iq(o)/2-4,F/2)
},validateImpl:function(){var Y=this,k=Y._view,K=0,p=0,r=Y.getWidth(),n=Y.getHeight(),d=Y._titleHeight,J=Y._21o.size()*d,C=Y._11o,Z=Y._9o;delete Y._11o,delete Y._9o,Y._21o.each(function(q){var Q,M,A=Y._20o[q],G=A.content,y=Y._10o===q;xg(Y)?(rr(A.div,K,0,d,n),Q=Y.initCanvas(A.canvas,d,n),uc(Q,0,n),Lc(Q,-g),Y.drawTitle(Q,q,n,d,A),Q.restore(),y?(M=m(0,r-J),G&&(Y._11o=G,Y._9o=hh(G),rr(G,K+d,0,M,n)),K+=d+M):K+=d):(rr(A.div,0,p,r,d),Q=Y.initCanvas(A.canvas,r,d),Y.drawTitle(Q,q,r,d,A),Q.restore(),y?(M=m(0,n-J),G&&(Y._11o=G,Y._9o=hh(G),rr(G,0,p+d,r,M)),p+=d+M):p+=d)});var y=Y._9o;C&&C!==Y._11o&&C.endEditing&&C.endEditing(),y&&y!==Z&&Pp(k,y),Z&&Z!==y&&Oe(Z)}}),zl.SplitView=function(P,m,B,s){var C=this,z=C._dividerDiv=Ki(),Q=C._60O=fr(),u=C._61O=fr(),X=Q.style,K=u.style;C._view=Lh(1,C),Pp(C._view,z),X.msTouchAction=Gp,X.pointerEvents=Gp,X.cursor=Hm,K.msTouchAction=Gp,K.pointerEvents=Gp,K.cursor=Hm,P&&C.setLeftView(P),m&&C.setRightView(m),B&&C.setOrientation(B),s!=h&&C.setPosition(s),C.setStatus(wf),new lb(C)},Oi("SplitView",f,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:C.splitViewDividerSize,_dividerBackground:C.splitViewDividerBackground,_dragOpacity:C.splitViewDragOpacity,_toggleIcon:C.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(x,f){var M=this,b=M._position;isNaN(x)||(f||(M._82O=0>x?-1:x>1?1:0),M._position=x,M.fp(Zo,b,x))},getLeftView:function(){return this._leftView},setLeftView:function(g){var A=this,u=A._leftView,C=A._view;if(A._leftView!==g){if(u&&u!==A._rightView){var X=hh(u);X.parentNode===C&&Oe(X)}if(A._leftView=g,g){var t=hh(g);t.parentNode!==C&&C.insertBefore(t,A._dividerDiv)}A.fp("leftView",u,g)}},getRightView:function(){return this._rightView},setRightView:function(A){var O=this,e=O._rightView,J=O._view;if(O._rightView!==A){if(e&&e!==O._leftView){var H=hh(e);H.parentNode===J&&Oe(H)}if(O._rightView=A,A){var $=hh(A);$.parentNode!==J&&J.insertBefore($,O._dividerDiv)}O.fp("rightView",e,A)}},validateImpl:function(){var y=this,E=y._draggable,q=y._position,A=y.getWidth(),U=y.getHeight(),X=y._dividerSize,Z=y._dividerBackground,J=Sl?18:8,l=y._dividerDiv,W=y._82O,i=y._60O,L=y._61O,n=y._toggleIcon,h=y._status,K=l.style,N=null,x=Sl?20:4,T=n.comps[0];X>=J||0===X?y._coverDiv&&(Oe(y._coverDiv),delete y._coverDiv):y._coverDiv||(y._coverDiv=Ki(),e&&(y._coverDiv.style.background=em),Pp(l,y._coverDiv)),y._togglable?i.parentNode||(Pp(l,i),Pp(l,L)):(Oe(i),Oe(L));var j=y._coverDiv,G=y._leftView,F=y._rightView;if(xg(y)){if(X>A&&(X=A),h===wf)if(1===W)var p=M(q,A),B=m(0,A-X-p);else-1===W?(B=M(-q,A),p=m(0,A-X-B)):(p=R((A-X)*q),B=m(0,A-X-p));else"cl"===h?(p=0,B=m(0,A-X)):"cr"===h&&(B=0,p=m(0,A-X));G&&rr(G,0,0,p,U),F&&rr(F,p+X,0,B,U),rr(l,p,0,X,U),y._22o=p,j&&(rr(j,X/2-J/2,0,J,U),j.style.cursor=E?Fr:""),l.style.cursor=E?Fr:"";var t=l.clientHeight/2,z=l.clientWidth;Dg(i,z,z),rr(i,0,t-z-x,z,z),N=Uh(i),Jq(N,0,0,1),T.rotation=-g,oi(N,n,0,0,z,z),N.restore(),Dg(L,z,z),rr(L,0,t+x,z,z),N=Uh(L),Jq(N,0,0,1),T.rotation=g,oi(N,n,0,0,z,z),N.restore()}else{if(X>U&&(X=U),h===wf)if(1===W)var Y=M(q,U),f=m(0,U-X-Y);else-1===W?(f=M(-q,U),Y=m(0,U-X-f)):(Y=R((U-X)*q),f=m(0,U-X-Y));else"cl"===h?(Y=0,f=m(0,U-X)):"cr"===h&&(f=0,Y=m(0,U-X));G&&rr(G,0,0,A,Y),F&&rr(F,0,Y+X,A,f),rr(l,0,Y,A,X),y._22o=Y,j&&(rr(j,0,X/2-J/2,A,J),j.style.cursor=E?Cl:""),K.cursor=E?Cl:"";var H=l.clientWidth/2,z=l.clientHeight;Dg(i,z,z),rr(i,H-z-x,0,z,z),N=Uh(i),Jq(N,0,0,1),T.rotation=0,oi(N,n,0,0,z,z),N.restore(),Dg(L,z,z),rr(L,H+x,0,z,z),N=Uh(L),Jq(N,0,0,1),T.rotation=b,oi(N,n,0,0,z,z),N.restore()}K.background=Z}});var lb=function(q){this.sv=q,this.addListeners()};Wh(lb,f,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(F){var j=this,J=j.sv,a=J._dividerDiv,f=J._60O,p=J._61O,w=J._status,h=F.target;if(h===f)w===wf?J.setStatus("cl"):"cr"===w&&J.setStatus(wf);else if(h===p)w===wf?J.setStatus("cr"):"cl"===w&&J.setStatus(wf);else if(Fb(F)&&(h===a||h===J._coverDiv)&&(ll(F),J.isDraggable())){J.getLeftView(),J.getRightView();var T=j.maskDiv=Ki();if(T.style.left=0,T.style.top=0,T.style.width=J.getWidth()+"px",T.style.height=J.getHeight()+"px",J.getView().appendChild(T),!J.isContinuousLayout()){var x=j.resizeDiv=Ki();x.style.left=a.style.left,x.style.top=a.style.top,x.style.width=a.style.width,x.style.height=a.style.height,x.style.opacity=J.getDragOpacity(),x.style.background=J.getDividerBackground(),Pp(j.getView(),x)}j._lastAbsPosition=J._22o,j._86o=xg(J)?kg(F).x:kg(F).y,_f(j,F)}},handleWindowTouchMove:function(J){Fb(J)&&this.update(J,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(V){var F=this;F.update(V,!0),F.sv.setStatus(wf),F.maskDiv&&Oe(F.maskDiv),F.resizeDiv&&Oe(F.resizeDiv),F.maskDiv=F.resizeDiv=h},handle_mousedown:function(S){ci(S)&&this.handle_touchstart(S)},handleWindowMouseMove:function(X){this.handleWindowTouchMove(X)},handleWindowMouseUp:function(A){this.handleWindowTouchEnd(A)},update:function(M,t){var B=this,F=B.sv,k=xg(F)?F.getWidth():F.getHeight(),a=F._dividerSize,o=B._lastAbsPosition-B._86o;xg(F)?(o+=kg(M).x,o>k-a&&(o=k-a),0>o&&(o=0),B.resizeDiv&&(B.resizeDiv.style.left=o+ej)):(o+=kg(M).y,o>k-a&&(o=k-a),0>o&&(o=0),B.resizeDiv&&(B.resizeDiv.style.top=o+ej)),t&&k!==a&&(1===F._82O?F.setPosition(o,1):-1===F._82O?F.setPosition(o-k+a,1):F.setPosition(o/(k-a),1))}}),zl.TabView=function(){var h=this,q=h._view=Lh(1,h),V=h._91O=Ki(1),I=h._tabModel=new Hh,H=I.sm(),s=h.invalidate;h._7o=new mo,h._canvas=fr(V),Pp(q,V),Pp(q,h._92O=Ki(1)),H.setSelectionMode(mh),H.ms(h.handleSelectionChange,h),I.mm(s,h),I.md(s,h),I.mh(s,h),h._interactor=new xn(h),h.iv()},Oi("TabView",f,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",eh,xb,"tabBackground","selectWidth",Fe,"moveBackground","insertColor"],_tabPosition:mj,_tabHeight:zo,_tabGap:C.tabViewTabGap,_labelColor:C.tabViewLabelColor,_labelFont:C.tabViewLabelFont,_tabBackground:C.tabViewTabBackground,_selectWidth:C.tabViewSelectWidth,_selectBackground:C.tabViewSelectBackground,_moveBackground:C.tabViewMoveBackground,_insertColor:C.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(t,u,i){var c,K=this._tabModel;return t instanceof Lk?(c=t,u&&c.setView(u)):(c=new Lk,c.setName(t),c.setView(u)),K.add(c),i&&K.sm().ss(c),c},getLabel:function(S){return S.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(H){this._23o=H,this.iv()},get:function(Y){var r=this,j=r._tabModel;if(cg(Y))return j._roots.get(Y);if(Tf(Y)){var I;return j.each(function(d){Y===r.getLabel(d)&&(I=d)}),I}return Y instanceof Lk?Y:h},select:function(s){this._tabModel.sm().ss(this.get(s))},remove:function(H){var w=this;if(H=w.get(H)){var y=w._tabModel,d=y._roots.indexOf(H);w._tabModel.remove(H),w.selectByIndex(--d)}},getCurrentTab:function(){return this._8o},hideTabView:function(D,V){V.parentNode===this._92O&&(Fo(V)?(V.style.display=Il,V._tab_=D):Oe(V),Rn())},showTabView:function(h,A){Fo(A)&&(A.style.display="block",A._tab_=h),A.parentNode!==this._92O&&(Pp(this._92O,A),Rn())},_24o:function(){var G,a=this,C=a._8o,l=a._9o,x=a._tabModel.sm().ld();x&&(G=hh(x.getView())),G!==l&&(l&&(C.getView()&&C.getView().endEditing&&C.getView().endEditing(),a.hideTabView(C,l)),G&&a.showTabView(x,G)),a._8o=x,a._9o=G,C!==x&&a.onTabChanged(C,x)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(q,h){this.selectByIndex(--h)},selectByIndex:function(k){var x=this,Z=x._tabModel,j=Z.size();if(j&&!Z.sm().ld()){k==h&&(k=0),k>=j&&(k=j-1),0>k&&(k=0);for(var U=k;U>=0;U--){var g=x.get(U);if(!g.isDisabled())return x.select(g),g}for(U=k+1;j>U;U++)if(g=x.get(U),!g.isDisabled())return x.select(g),g}},getTabWidth:function(M){var Y=4,r=ef(M.getIcon());r&&(Y+=iq(r,M)+4);var h=this.getLabel(M);return h&&(Y+=jh(this.getLabelFont(M),h).width+4),M.isClosable()&&(Y+=10),Y},drawTab:function(G,t,r,d,u,D,C){var o,N=this,p=N._tabPosition,i=r+4,F=N._selectWidth,W=ef(t.getIcon()),X=t.isDisabled(),J=N.getLabelColor(t),L=N.getLabelFont(t),n=N.getLabel(t),m=N._selectBackground,O=p===nh+"-vertical",x=p===lp+"-vertical";(O||x)&&(i=d+4),X&&(G.globalAlpha=pl),ng(G,r,d,u,D,C),t===N._8o&&F&&(p===mj?ng(G,r,d+D-F,u,F,m):p===nh?ng(G,r+u-F,d,F,D,m):p===lp?ng(G,r,d,F,D,m):O?ng(G,r+u-F,d,F,D,m):x?ng(G,r,d,F,D,m):ng(G,r,d,u,F,m));var v=u/2;if(O&&(uc(G,v,d+D/2),Lc(G,b),uc(G,-v,-d-D/2)),W){var y=Yh(W,t),q=iq(W,t);if(O||x){var c=r+u/2,z=i+y/2;uc(G,c,z),Lc(G,g),uc(G,-c,-z),Pk(G,W,r+u/2,i+y/2,t,N),uc(G,c,z),Lc(G,-g),uc(G,-c,-z),i+=y+4}else Pk(G,W,i+q/2,d+D/2,t,N),i+=q+4}return O||x?(uc(G,u/2,i+u/2),Lc(G,g),uc(G,-u/2,-i-u/2),ic(G,n,L,J,r,i,D,u),uc(G,u/2,i+u/2),Lc(G,-g),uc(G,-u/2,-i-u/2)):ic(G,n,L,J,i,d,u,D),O&&(uc(G,v,d+D/2),Lc(G,-b),uc(G,-v,-d-D/2)),t.isClosable()&&(o=x?{x:r+u-12,y:d+D-12,width:12,height:12}:{x:r+u-12,y:d+2,width:12,height:12},this.drawCloseIcon(t,G,J,o)),X&&(G.globalAlpha=1),o},drawCloseIcon:function(U,s,u,X){var l=X.x,L=X.y;s.strokeStyle=u,s.lineWidth=1,s.beginPath(),s.moveTo(l+2,L+8),s.lineTo(l+8,L+2),s.moveTo(l+8,L+8),s.lineTo(l+2,L+2),s.stroke()},getTabAt:function(O){var f=this._interactor._8Q(O);return f?f.tab:null},validateImpl:function(){var f=this;f._24o();var e,h=f._canvas,G=f._tabPosition,w=f._91O,M=f._92O,b=f._tabModel,N=f.getWidth(),P=f.getHeight(),A=f._tabHeight,F=f._7o,U=f._tabGap,n=G===mj,O=G===nh,T=G===lp,k=G===nh+"-vertical",u=G===lp+"-vertical",a=f._23o,v=0;if((O||T)&&b._roots.each(function(g){v=m(f.getTabWidth(g),v)}),n?(rr(w,0,0,N,A),e={x:0,y:A,width:N,height:m(0,P-A)}):O?(rr(w,0,0,v,P),e={x:v,y:0,width:m(0,N-v),height:P}):T?(rr(w,N-v,0,v,P),e={x:0,y:0,width:m(0,N-v),height:P}):k?(rr(w,0,0,A,P),e={x:A,y:0,width:m(0,N-A),height:P}):u?(rr(w,N-A,0,A,P),e={x:0,y:0,width:m(0,N-A),height:P}):(rr(w,0,P-A,N,A),e={x:0,y:0,width:N,height:m(0,P-A)}),rr(M,e),k||u){f._9o&&(e.x=0,rr(f._8o.getView(),e)),Dg(h,A,P);var l=Uh(h),r=0;if(Jq(l,0,f.ty(),1),l.clearRect(0,0,A,P),F.clear(),b._roots.each(function(T){var b,E=f.getTabWidth(T);a&&a.tab===T||(b=f.drawTab(l,T,0,r,A,E,f._tabBackground)),F.add({_75o:b,tab:T,startY:r,endY:r+E,height:E}),r+=E+U}),f._23Q=m(0,r-U),a){var K=a.position;f.drawTab(l,a.tab,0,a.startY,A,a.height,f._moveBackground),ng(l,0,K,A,1,f._insertColor)}if(l.restore(),f._selectionChanged){f._selectionChanged=!1;for(var p=f.ty(),Q=0;Q<F.size();Q++){var X=F.get(Q);if(X.tab===f._8o){if(X.endY+p<0){f.ty(-X.startY);break}if(X.startY+p>P){f.ty(P-X.endY);break}}}}f.ty(f.ty())}else if(O||T){f._9o&&(e.x=0,rr(f._8o.getView(),e)),Dg(h,v,P);var l=Uh(h),r=0;if(Jq(l,0,f.ty(),1),l.clearRect(0,0,v,P),F.clear(),b._roots.each(function(o){var k;a&&a.tab===o||(k=f.drawTab(l,o,0,r,v,A,f._tabBackground)),F.add({_75o:k,tab:o,startY:r,endY:r+A,height:A}),r+=A+U}),f._23Q=m(0,r-U),a){var K=a.position;f.drawTab(l,a.tab,0,a.startY,v,a.height,f._moveBackground),ng(l,0,K,v,1,f._insertColor)}if(l.restore(),f._selectionChanged){f._selectionChanged=!1;for(var p=f.ty(),Q=0;Q<F.size();Q++){var X=F.get(Q);if(X.tab===f._8o){if(X.endY+p<0){f.ty(-X.startY);break}if(X.startY+p>P){f.ty(P-X.endY);break}}}}f.ty(f.ty())}else{f._9o&&(e.y=0,rr(f._8o.getView(),e)),Dg(h,N,A);var l=Uh(h),L=0;if(Jq(l,f.tx(),0,1),l.clearRect(0,0,N,A),F.clear(),b._roots.each(function(D){var q,v=f.getTabWidth(D);a&&a.tab===D||(q=f.drawTab(l,D,L,0,v,A,f._tabBackground)),F.add({_75o:q,tab:D,startX:L,endX:L+v,width:v}),L+=v+U}),f._64I=m(0,L-U),a){var K=a.position;f.drawTab(l,a.tab,a.startX,0,a.width,A,f._moveBackground),jc(l,f._insertColor,K,0,A)}if(l.restore(),f._selectionChanged){f._selectionChanged=!1;for(var s=f.tx(),Q=0;Q<F.size();Q++){var X=F.get(Q);if(X.tab===f._8o){if(X.endX+s<0){f.tx(-X.startX);break}if(X.startX+s>N){f.tx(N-X.endX);break}}}}f.tx(f.tx())}for(var o=[],_=M.children,Q=0;Q<_.length;Q++){var y=_[Q],I=y._tab_;I&&!b.contains(I)&&o.push(y)}o.forEach(function(G){M.removeChild(G)})}});var xn=function(h){this.tv=h,this.addListeners()};Wh(xn,f,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(O){this.handleScroll(O,10*(O.wheelDelta/40))},handle_DOMMouseScroll:function(T){this.handleScroll(T,10*-T.detail)},handleScroll:function(Q,R){ll(Q);var X=this.tv,U=X._tabPosition;!X._40o()||U!==mj&&U!==Sh||X.tx(this.tv.tx()+R),!X._41o()||U!==nh&&U!==lp&&U!==nh+"-vertical"&&U!==lp+"-vertical"||X.ty(this.tv.ty()+R)},_8Q:function($){var S,O,r=this.tv,C=r._tabPosition,j=r._7o;if(C===mj||C===Sh){var Q=r.lp($).x;for(S=0;S<j.size();S++)if(O=j.get(S),O.startX<=Q&&Q<=O.endX)return O}else if(C===nh||C===lp||C===nh+"-vertical"||C===lp+"-vertical"){var G=r.lp($).y;for(S=0;S<j.size();S++)if(O=j.get(S),O.startY<=G&&G<=O.endY)return O}return h},isClickable:function(c){var b=this.tv,q=b._tabPosition,N=this._73o=this._8Q(c);return!b._40o()||q!==mj&&q!==Sh?!b._41o()||q!==nh&&q!==lp&&q!==nh+"-vertical"&&q!==lp+"-vertical"?N&&(!N.tab.isDisabled()||b.isMovable()):!0:!0},handle_mousemove:function(x){var u=this;Wf?u._74o=u._8Q(x):u.getView().style.cursor=u.isClickable(x)?Hm:""},handle_mousedown:function(A){this.handle_mousemove(A),this.handle_touchstart(A)},handle_touchstart:function(l){var F=this,V=F.tv,g=V._tabPosition;ll(l),ci(l)&&F.isClickable(l)&&(g===mj||g===Sh?(F.x=kg(l).x,F.lp=V.lp(l),F.tx=V.tx()):(F.y=kg(l).y,F.lp=V.lp(l),F.ty=V.ty()),_f(F,l))},handleWindowMouseMove:function(S){this.handleWindowTouchMove(S)},handleWindowTouchMove:function(X){var n,h=this,O=h.tv,N=O._tabPosition,t=h._73o;if(N===mj||N===Sh){if(n=kg(X).x-h.x,!h._25o&&!h.moving&&r(n)>2&&(O._40o()&&!lk(X)?h._25o=1:t&&O.isMovable()&&(h.moving=1)),h._25o)O.tx(h.tx+n);else if(h.moving){var o=h.lp.x+n,e=O._tabGap/2;O._7o.each(function(l){var q=l.endX,b=o-l.startX<q-o;o>=l.startX&&q>=o&&O._7Q({tab:t.tab,startX:t.startX+n,width:t.width,front:b,insertTab:l.tab,position:b?m(0,l.startX-e):M(O._64I,q+e)})})}}else if(n=kg(X).y-h.y,!h._25o&&!h.moving&&r(n)>2&&(O._41o()&&!lk(X)?h._25o=1:t&&O.isMovable()&&(h.moving=1)),h._25o)O.ty(h.ty+n);else if(h.moving){var C=h.lp.y+n,e=O._tabGap/2;O._7o.each(function(R){var E=R.endY,T=C-R.startY<E-C;C>=R.startY&&E>=C&&O._7Q({tab:t.tab,startY:t.startY+n,height:t.height,front:T,insertTab:R.tab,position:T?m(0,R.startY-e):M(O._23Q,E+e)})})}},handleWindowMouseUp:function(s){this.handleWindowTouchEnd(s)},handleWindowTouchEnd:function(){var F=this,$=F.tv,A=$._tabPosition,o=$.getTabModel(),z=o._roots,v=F._73o;if(F.moving){var R=$._23o;if(R&&R.insertTab!==R.tab){var r=R.tab,w=z.remove(r),P=z.indexOf(R.insertTab);P>=0&&(R.front||P++,P<=z.size()&&(z.add(r,P),o._38I(r,w,P)))}$._7Q(h),delete F.moving}else if(!F._25o&&v){r=v.tab;var t=F._74o;if(!t||t.tab===r)if(!r.isDisabled()&&bf(v._75o,F.lp)){var O=function(){var W=z.indexOf(r);o.remove(r),$.onTabClosed(r,W)};$.onTabClosing(r,O)&&O()}else r.isDisabled()||$._8o===r||o.sm().ss(r)}F._25o=F._73o=F._74o=A===mj||A===Sh?F.x=F.lp=F.tx=h:F.y=F.lp=F.ty=h}}),zl.PropertyView=function(N){var F=this;F._view=Lh(1,F),F._canvas=fr(F._view),Pp(F._view,F._79O=Ki()),F._rows=new mo,F._28o=new mo,F._26o={},F._26Q={};var z=F._propertyModel=new Hh,m=F.ivm;z.mm(m,F),z.md(m,F),z.mh(m,F),F.dm(N?N:new Hh),new Cb(F)},Oi("PropertyView",f,{ms_ac:[eh,Nk,xb,eg,th,"categorizable",Xl,Bi,Cn,Ml,Wo,Ii,Ym,Vm,"selectRowIndex",Fe,"background",dq,Kc,rs,Wr,ro],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:dm,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Ao,_background:C.propertyViewBackground,_expandIcon:C.propertyViewExpandIcon,_collapseIcon:C.propertyViewCollapseIcon,_scrollBarColor:qh,_scrollBarSize:ze,_autoHideScrollBar:is,_selectBackground:C.propertyViewSelectBackground,_rowHeight:mp,_rowLineVisible:C.propertyViewRowLineVisible,_rowLineColor:C.propertyViewRowLineColor,_10I:.5,_columnLineVisible:C.propertyViewColumnLineVisible,_columnLineColor:C.propertyViewColumnLineColor,_labelColor:C.propertyViewLabelColor,_labelSelectColor:C.propertyViewLabelSelectColor,_labelFont:C.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(k){0>k&&(k=0),k>1&&(k=1);var m=this,g=m._10I;m._10I=k,m.fp("columnPosition",g,k)},getPropertyName:function(r){return r.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(H,k,r){return r===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(M,O){return O===this._selectRowIndex?this._labelSelectColor:M.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(q){var O=this.getHeight()-this._59I;return O>q&&(q=O),q>0?0:R(q)},isExpanded:function(F){if(!F)return!0;var h=this._26o[F];return h?h.isExpanded:!(this._26Q[F]===!1)},toggle:function(i){var e=this;e.isExpanded(i)?e.collapse(i):e.expand(i)},expandAll:function(){this.validate();for(var I in this._26o)this.expand(I)},expand:function(e){if(e&&e!==Il){var J=this,_=J._26o[e];_&&!_.isExpanded&&(_.isExpanded=!0,J.onExpanded(e),J.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var h in this._26o)this.collapse(h)},collapse:function(T){if(T&&T!==Il){var $=this,X=$._26o[T];X&&X.isExpanded&&(X.isExpanded=!1,$.onCollapsed(T),$.ivm())}},onCollapsed:function(){},getCategoryName:function(b){if(!this.isCategorizable())return Il;var y=b.getCategoryName();return y?y:Il},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(w){var I=this,d=I._dataModel;d!==w&&(d&&(d.umd(I.handlePropertyChange,I),I._selectionModel||d.sm().ums(I.handleSelectionChange,I)),I._dataModel=w,w.md(I.handlePropertyChange,I),I._selectionModel?I._selectionModel._21I(w):w.sm().ms(I.handleSelectionChange,I),I.fp($e,d,w))},isVisible:function(M){return this._visibleFunc?this._visibleFunc(M):!0},onPropertyChanged:function(L){var u=this,x=L.property;Vj[x]?u.ivm():u.iv(),x===cp&&u._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:vb},handlePropertyChange:function(W){this._27o===W.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var J=this;J._96I||(J.setSelectRowIndex(-1),J._96I=1,J.iv())},redraw:function(){this.iv()},validateModel:function(){var w=this,u=w._rows,X=w._28o,Z={},c=new mo,m=w._27o;w.updateCurrentData(),m!==w._27o&&w.endEditing(),u.clear(),X.clear(),w.getRawProperties().each(function(h){if(w.isVisible(h)){c.add(h);var P=w.getCategoryName(h);Z[P]||(X.add(P,P===Il?0:l),Z[P]={isExpanded:w.isExpanded(P),properties:new mo})}}),w._sortFunc&&c.sort(w._sortFunc);for(var F in w._26o)w._26Q[F]=w.isExpanded(F);w._26o=Z,X.each(function(U){U!==Il&&u.add(U);var X=Z[U];X.isExpanded&&c.each(function(B){w.getCategoryName(B)===U&&(X.properties.add(B),u.add({property:B,data:w._27o}))},w)})},validateImpl:function(){var n=this;n._76o(),n._96I&&(n.validateModel(),delete n._96I);var b=n._canvas,z=n.getWidth(),G=n.getHeight(),M=-n.ty(),R=n._rowHeight,Q=n._indent,u=z-Q,W=n._rows,v=W.size(),t=n._9I=Q+u*n._10I,Z=n._59I=v*R;Dg(b,z,G),n._29I={x:0,y:M,width:z,height:G},n._31I=j(M/R),n._14I=d((M+G)/R),n._31I<0&&(n._31I=0),n._14I>v&&(n._14I=v);var l,I=Uh(b),r=n._background;Jq(I,0,-M,1),I.beginPath(),I.rect(0,M,z,G),I.clip(),I.clearRect(0,M,z,G),n._93db(I),r&&ng(I,0,0,Q,Z,r);for(var c=n._31I;c<n._14I;c++){var E=W.get(c),M=R*c;if(Tf(E))r&&ng(I,Q,M,u,R,r),l=ef(n.isExpanded(E)?n._expandIcon:n._collapseIcon),l&&Cr(I,l,pi,0,M,Q,R),I.save(),I.beginPath(),I.rect(Q,M,u,R),I.clip(),n.drawCategoryName(I,E,c,Q,M,u,R),I.restore();else{var q=E.property,P=E.data,l=ef(q.getIcon()),$=n._selectRowIndex===c?n.getSelectBackground():h;if(l&&Cr(I,l,pi,0,M,Q,R),$&&ng(I,Q,M,u,R,$),I.save(),I.beginPath(),I.rect(Q,M,t-Q,R),I.clip(),n.drawPropertyName(I,q,c,Q,M,t-Q,R),I.restore(),!n.isEditing(P,q)){var s=t+1,X=z-t-1;I.save(),I.beginPath(),I.rect(s,M,X,R),I.clip(),n._87o(n.drawPropertyValue(I,q,n.getValue(P,q),c,s,M,X,R,P),c,s,M,X,R),I.restore()}}n._rowLineVisible&&ng(I,Q,M+R-1,u,1,n._rowLineColor)}n._columnLineVisible&&(ng(I,t,0,1,Z,n._columnLineColor),ng(I,z-1,0,1,Z)),n._92db(I),n._93I(),I.restore(),n.ty(n.ty())},drawCategoryName:function(M,X,y,c,U,Q,Z){ic(M,X,this.getCategoryFont(X),this.getCategoryColor(X),c,U,Q,Z)},drawPropertyName:function(c,q,y,h,H,P,T){return q.drawPropertyName?(q.drawPropertyName(c,q,y,h,H,P,T,this),void 0):(ic(c,this.getPropertyName(q),this.getPropertyFont(q,y),this.getPropertyColor(q,y),h,H,P,T),void 0)},drawPropertyValue:function(E,w,O,f,z,d,W,p,P){return w.drawPropertyValue?w.drawPropertyValue(E,w,O,f,z,d,W,p,P,this):(pd(E,O,w,this.getLabelFont(w,O,f),this.getLabelColor(w,O,f),z,d,W,p,P,this),void 0)},isPropertyEditable:function(w){return w.isEditable()&&this.isEditable()},setProperties:function(I){this._propertyModel.clear(),this.addProperties(I)},addProperties:function(p){if(p){var I=this._propertyModel;p.forEach(function(L){if(!(L instanceof Pi)){var A=Xe(L.className);L=Kh(A?A:Pi,L)}I.add(L)})}},getRowIndexAt:function(K){var x=this,k=j(x.lp(K).y/x._rowHeight);return k>=0&&k<x._rows.size()?k:-1},getPropertyAt:function(X){var J=this,A=J.getRowIndexAt(X);return A>=0?J._rows.get(A).property:h},getToolTip:function(Y){var p=this,P=p.getPropertyAt(Y),L=p._27o;return P&&L?P.getToolTip(L,p._9I<p.lp(Y).x,p):h}});var Cb=function(L){this.pv=L,this.addListeners()};Wh(Cb,f,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(c){this.getView().style.cursor=c},clear:function(){var d=this;d._62O=d.cp=d.ty=d.p=h,d.setCursor(Zq)},handle_mousedown:function(f){this.handle_touchstart(f)},handle_touchstart:function(G){var S=this,l=S.pv;ll(G),l.setFocus(G)&&(ci(G)?(S.cp=kg(G),S.ty=l.ty(),S.p=l.getColumnPosition(),S.handle_touchmove(G)):l.setSelectRowIndex(l.getRowIndexAt(G)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(w){this.handle_touchend(w)},handle_touchend:function(u){var K=this;if(K.cp&&!K._62O){var P=K.pv,B=P.lp(u),G=B.x,f=B.y,Q=P._indent,N=P.getRowIndexAt(u),q=P._9I;if(N>=0){var t=P._rowHeight,I=t*N,h=P._rows.get(N),C=h.property;if(Tf(h))ef(P.isExpanded(h)?P._expandIcon:P._collapseIcon)&&G>=0&&Q>=G&&f>=I&&I+t>=f?P.toggle(h):fi(u)&&P.toggle(h);else if(G>q&&P.isPropertyEditable(C,u)){var l={x:q+1,y:I,width:P.getWidth()-q-1,height:t},y={x:l.x+P.tx(),y:l.y+P.ty(),width:l.width,height:l.height},n=0,F=P._29I;l.y<F.y?n=l.y-F.y:l.y+t>F.y+F.height&&(n=l.y+t-F.y-F.height),n&&(P.ty(P.ty()-n),y.y-=n),P.beginEditing({data:h.data,property:C,value:P.getValue(h.data,C),event:u,rect:l,editorRect:y,view:P})}}P.setSelectRowIndex(N)}K.clear()},handleWindowMouseMove:function(J){this.handleWindowTouchMove(J)},handleWindowTouchMove:function(J){var N=this,y=N.pv,i=N.ty,r=N.cp,G=kg(J),O=N._62O;if("p"===O)y.setTranslateY(i+G.y-r.y);else if("c"===O){var x=y.getWidth()-y._indent;if(x>16){var c=N.p-(r.x-G.x)/x,B=16/x;B>c&&(c=B),c>1-B&&(c=1-B),y.setColumnPosition(c)}}else"s"===O&&y.setTranslateY(i+(r.y-G.y)*y._59I/y._29I.height)},handle_mousemove:function(k){this.handle_touchmove(k)},handle_touchmove:function(o){if(!Wf&&ci(o)){var e=this,I=e.pv,V=r(I.lp(o).x-I._9I)<=(Sl?8:3);e.cp?e._62O||(V?(e._62O="c",_f(e)):r(kg(o).y-e.cp.y)>=2&&(e._62O=e.isV(o)?"s":"p",_f(e))):(V?e.setCursor(Fr):e.setCursor(Zq),e.isV(o)&&I._43o())}},isV:function(H){var S=this.pv,L=S._29I;return S._41o()&&L.x+L.width-S.lp(H).x<Ro},handle_mousewheel:function(h){this.handleScroll(h,h.wheelDelta/40)},handle_DOMMouseScroll:function(j){2===j.axis&&this.handleScroll(j,-j.detail)},handleScroll:function(X,y){var L=this.pv;ll(X),L.endEditing(),L.translate(0,y*L.getRowHeight())},handle_keydown:function(b){var z=this.pv,J=z._rows.size(),W=z._selectRowIndex+(Pl(b)?-1:1);(Pl(b)||Bm(b))&&(0>W&&(W=0),W>=J&&(W=J-1),z.setSelectRowIndex(W))}}),zl.ListView=function(m){this._5o(m),new yo(this)},Oi("ListView",f,{ms_ac:[eh,Nk,xb,dq,Xl,Kc,rs,Bi,Cn,Ii,Ym,Vm,Xj,Fe],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Ao,_rowHeight:mp,_rowLineVisible:C.listViewRowLineVisible,_rowLineColor:C.listViewRowLineColor,_scrollBarColor:qh,_scrollBarSize:ze,_autoMakeVisible:Jb,_autoHideScrollBar:is,_selectBackground:C.listViewSelectBackground,_labelColor:C.listViewLabelColor,_labelSelectColor:C.listViewLabelSelectColor,_labelFont:C.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(q){var w=this,Q=w._checkMode;w._checkMode=q,w.fp(up,Q,q)},drawRow:function(X,y,M,R,p,r,L){var P=this,v=0,S=P._indent,E=P.getIconWidth(y);P.drawRowBackground(X,y,M,R,p,r,L),P._checkMode&&(Pk(X,ef(P.getCheckIcon(y)),v+S/2,p+L/2,y,P),v+=S),P.drawIcon(X,y,v,p,E,L),P.drawLabel(X,y,v+E,p,L)}});var yo=function($){this.list=$,this._lastSelectDataTime=cf(),this.addListeners()};Wh(yo,f,{ms_listener:1,getView:function(){return this.list._view},clear:function(v){var p=this,r=p.list;v&&"d"===p._62O&&!p.dragCancel&&r.handleDragAndDrop(v,"end"),r.draggingData&&(r.draggingData=null,r.redraw()),p.dragCancel=p._62O=p._isV=p._isH=p.cp=p.tx=p.ty=h},handle_mousedown:function(O){this.handle_touchstart(O)},handle_touchstart:function(d){var G=this,C=G.list;if(ll(d),C.setFocus(d)){var i=C.getDataAt(d);G.cp=kg(d),G.tx=C.tx(),G.ty=C.ty(),ci(d)?i&&C.handleDragAndDrop&&!G.isV(d)&&!G.isH(d)&&(C.draggingData=i,C.redraw(),C.handleDragAndDrop(d,"prepare")):(i&&G._33o(d,i),G.clear(d))}},handleWindowMouseUp:function(E){this.clear(E)},handleWindowTouchEnd:function(A){this.clear(A)},handle_mouseup:function(J){this.handle_touchend(J)},handle_touchend:function(z){var d=this,H=d.list;if(!d._isV&&!d._isH&&d.cp&&!d._62O){var t=H.getDataAt(z);t?(H.isCheckMode()?d._34o(z,t):d._33o(z,t),fi(z)?H.onDataDoubleClicked(t,z):H.onDataClicked(t,z)):H.handleBackgroundClick(z)}d.clear(z)},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowTouchMove:function(X){var F=this,M=F.list,T=F._62O,p=F.tx,B=F.ty,Q=F.cp,I=kg(X),v=M._29I;"p"===T?M.setTranslate(p+I.x-Q.x,B+I.y-Q.y):"v"===T?M.ty(B+(Q.y-I.y)*M._59I/v.height):"h"===T?M.tx(p+(Q.x-I.x)*M._91I/v.width):"d"===T&&(F.dragCancel||M.handleDragAndDrop(X,"between"))},handle_mousemove:function(d){this.handle_touchmove(d)},handle_touchmove:function(s){if(!Wf&&ci(s)){var D=this,r=D.list;if(D._isV=D.isV(s),D._isH=D.isH(s),D.cp){if(!D._62O){if(Im(kg(s),D.cp)<2)return;D._isV?D._62O="v":D._isH?D._62O="h":r.draggingData&&!this.dragCancel?(D._62O="d",r.handleDragAndDrop(s,"begin")):D._62O="p",D._62O&&"d"!==D._62O&&r.draggingData&&(r.draggingData=null,r.redraw()),_f(D)}}else D._isV&&r._43o(),D._isH&&r._42o()}},isV:function(I){var c=this.list,l=c._29I;return c._41o()&&l.x+l.width-c.lp(I).x<Ro},isH:function(J){var N=this.list,F=N._29I;return N._40o()&&F.y+F.height-N.lp(J).y<Ro},handle_mousewheel:function(k){this.handleScroll(k,k.wheelDelta/40,k.wheelDelta!==k.wheelDeltaX)},handle_DOMMouseScroll:function(D){this.handleScroll(D,-D.detail,1)},handleScroll:function(O,h,N){var x=this.list;ll(O),x.endEditing&&x.endEditing(),N&&x._41o()?x.translate(0,h*x.getRowHeight()):x._40o()&&x.translate(10*h,0)},handle_keydown:function(N){if(!C.isInput(N.target)){var S,H=this.list,i=H.sm(),V=H._rows,t=V.size();if(Zb(N))H.selectAll();else if(ub(N))H.handleDelete&&H.handleDelete(N);else if(Di(N))"d"!==this._62O||this.dragCancel||(H.handleDragAndDrop(N,"cancel"),this.dragCancel=!0);else if(eo(N))H.isCheckMode()&&(S=H.getFocusData(),S&&H.checkData(S));else if(Pl(N)||Bm(N)){var D=H.isCheckMode();if(S=D?H.getFocusData():i.ld()){var f=H.getRowIndex(S);f>=0&&(Pl(N)?0!==f&&(S=V.get(f-1),D?H.setFocusData(S):i.ss(S)):f!==t-1&&(S=V.get(f+1),D?H.setFocusData(S):i.ss(S)))}else t>0&&(S=V.get(0),D?H.setFocusData(S):i.ss(S))}}},_34o:function(O,U){var t=this.list,M=t.lp(O).x;return M>=0&&M<=t._indent?(t.checkData(U),void 0):(t.setFocusData(U),void 0)},_33o:function(A,v){var i=this.list,s=i.sm(),n=s.ld();if(lk(A))i.isSelected(v)?s.rs(v):s.as(v);else if(oe(A))if(n)for(var C=i.getRowIndex(n),o=i.getRowIndex(v);C!==o;)C+=o>C?1:-1,s.as(i._rows.get(C));else s.ss(v);else if(ci(A)){var G=cf();if(s.contains(v)){var a=G-this._lastSelectDataTime;i.handleDataDoubleSelect&&a>500&&1500>a&&i.handleDataDoubleSelect(A,v)}s.ss(v),this._lastSelectDataTime=G}else s.contains(v)||s.ss(v)}}),zl.TreeView=function(L){var y=this;y._35o(),y._5o(L),new ld(y)},Oi("TreeView",f,{ms_ac:[eh,Nk,xb,"rootVisible",up,"rootData",Bi,Cn,Ii,Ym,Vm,Xl,dq,Kc,rs,Ml,Wo,Xj,Fe,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:h,_indent:Ao,_rowHeight:mp,_rowLineVisible:C.treeViewRowLineVisible,_rowLineColor:C.treeViewRowLineColor,_scrollBarColor:qh,_scrollBarSize:ze,_autoHideScrollBar:is,_expandIcon:C.treeViewExpandIcon,_collapseIcon:C.treeViewCollapseIcon,_autoMakeVisible:Jb,_selectBackground:C.treeViewSelectBackground,_labelColor:C.treeViewLabelColor,_labelSelectColor:C.treeViewLabelSelectColor,_labelFont:C.treeViewLabelFont,_doubleClickToToggle:C.treeViewDoubleClickToToggle,drawRow:function(W,L,I,Z,s,t,C){var D=this;D.drawRowBackground(W,L,I,Z,s,t,C),D._97I(W,L,I,0,s,t,C)},isOnToggleIcon:function(R){var H=this.getDataAt(R);if(H){var G=this.getIndent(),x=this.lp(R).x;if(ef(this.getToggleIcon(H))){var n=G*this.getLevel(H);if(x>=n&&n+G>=x)return!0}}return!1}});var ld=function(X){Yn(ld,this,[X])};Wh(ld,yo,{toggle:function(p,H,N,X){var M=this.list,z=M.lp(p).x;if(ef(M.getToggleIcon(H))){var B=N*X;if(z>=B&&B+N>=z)return M.toggle(H),!0}return M.isDoubleClickToToggle()&&fi(p)?(M.toggle(H),!0):!1},_34o:function(t,c){var k=this.list,$=k.lp(t).x,I=k._levelMap[c._id],W=k._indent,i=W*(I+1);return $>=i&&i+W>=$?(k.checkData(c),void 0):(this.toggle(t,c,W,I)||k.setFocusData(c),void 0)},_33o:function(g,V){var t=this,n=t.list;t.toggle(g,V,n._indent,n.getLevel(V))||ld.superClass._33o.call(t,g,V)},handle_keydown:function(u){if($j(u)||Mb(u)){var m=this.list,z=m._rows,Z=m.isCheckMode(),X=m.sm(),n=Z?m.getFocusData():X.ld();n?n.hasChildren()&&($j(u)?m.collapse(n):m.expand(n)):z.size()>0&&(n=z.get(0),Z?m.setFocusData(n):X.ss(n))}else ld.superClass.handle_keydown.call(this,u)}});var hd=zl.TableView=function(H){this._98I(),this._5o(H),new kb(this)};Oi("TableView",f,{ms_ac:[eh,Nk,xb,"sortMode",eg,th,dq,Kc,rs,Wr,ro,"sortColumn",Bi,Cn,Ii,Ym,Vm,Xj,Fe],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:je,_editable:!0,_batchEditable:!1,_rowHeight:mp,_rowLineVisible:C.tableViewRowLineVisible,_rowLineColor:C.tableViewRowLineColor,_columnLineVisible:C.tableViewColumnLineVisible,_columnLineColor:C.tableViewColumnLineColor,_scrollBarColor:qh,_scrollBarSize:ze,_autoHideScrollBar:is,_autoMakeVisible:Jb,_selectBackground:C.tableViewSelectBackground,_labelColor:C.tableViewLabelColor,_labelSelectColor:C.tableViewLabelSelectColor,_labelFont:C.tableViewLabelFont,getCheckColumn:function(){var z=this;if(!z._31o){var v=z._31o=new Zr;v.setEditable(!0),v.setWidth(40),v.getValue=z.getCheckColumValue,v.drawCell=z.drawCheckColumnCell}return z._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(h){var r=this,H=r._39o,L=r.getCheckColumn();h!==r.isCheckMode()&&(h?H.add(L,0):H.remove(L),r.fp(up,!h,h))},getCheckColumValue:function(H,Q,I){return I.isSelected(H)},drawCheckColumnCell:function(G,J,D,q,N,Y,p,P,Q){Pk(G,Q.getCheckIcon(J),N+p/2,Y+P/2,J,Q)}});var kb=function(o){Yn(kb,this,[o])};Wh(kb,yo,{_34o:function(q,d){var $=this.list,F=$._31o;if($.isCellEditable(d,F,q)){var J=$._3Q(F),u=$.lp(q).x;
if(J&&u>=J.startX&&u<J.startX+F.getWidth())return $.checkData(d),void 0}$._37O(d,q),$.setFocusData(d)},_33o:function(m,b){this.list._37O(b,m),kb.superClass._33o.apply(this,arguments)}});var Tk=zl.TreeTableView=function(Q){var b=this,h=b._4o=new Zr;b._35o(),b._98I(),b._5o(Q),h.setDisplayName("Name"),h.setEditable(!0),h.setWidth(180),h.drawCell=Cp,h.getValue=Th,b._39o.add(h),new Hl(b)},Cp=function(E,o,L,H,G,D,x,c,Q){Q._97I(E,o,L,G,D,x,c)},Th=function(l,i,n){return n.getLabel(l)};Oi("TreeTableView",f,{ms_ac:[eh,Nk,xb,"sortMode",eg,th,Xl,up,"rootData","rootVisible",Bi,Cn,"sortColumn",Ml,Wo,Ii,Ym,Vm,Xj,rs,dq,Kc,Wr,ro,Fe,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:je,_checkMode:h,_editable:!0,_batchEditable:!1,_indent:Ao,_rowHeight:mp,_rowLineVisible:C.treeTableViewRowLineVisible,_rowLineColor:C.treeTableViewRowLineColor,_columnLineVisible:C.treeTableViewColumnLineVisible,_columnLineColor:C.treeTableViewColumnLineColor,_expandIcon:C.treeTableViewExpandIcon,_collapseIcon:C.treeTableViewCollapseIcon,_scrollBarColor:qh,_scrollBarSize:ze,_autoHideScrollBar:is,_autoMakeVisible:Jb,_selectBackground:C.treeTableViewSelectBackground,_labelColor:C.treeTableViewLabelColor,_labelSelectColor:C.treeTableViewLabelSelectColor,_labelFont:C.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Hl=function(M){Yn(Hl,this,[M])};Wh(Hl,yo,{_34o:function(s,E){var f=this.list,M=f._4o,p=f._3Q(M),C=f.lp(s).x;if(p){var U=f._indent,T=p.startX+U*f.getLevel(E);if(ef(f.getToggleIcon(E))&&C>=T&&T+U>=C)return f.toggle(E),void 0;if(f.isCellEditable(E,M)&&(T+=U,C>=T&&T+U>=C))return f.checkData(E),void 0}f._37O(E,s),f.setFocusData(E)},_33o:function(Y,k){var F=this.list,V=F.lp(Y).x;if(ef(F.getToggleIcon(k))){var y=F._3Q(F._4o);if(y){var E=F._indent,e=y.startX+E*F.getLevel(k);if(V>=e&&e+E>=V)return F.toggle(k),void 0}}F._37O(k,Y),Hl.superClass._33o.apply(this,arguments)}});var _m=zl.TableHeader=function(R){var d=this,r=d._view=Lh(1,d),k=d._39o=R.getColumnModel(),M=d.iv;d.tv=d._tableView=R,d._60I=new mo,d._canvas=fr(r),r.style.background=C.tableHeaderBackground||"",r.style.height=Pb+ej,k.mm(M,d),k.md(M,d),k.mh(M,d),R.mp(function(f){Tm[f.property]&&d.iv()},d),new Ch(d),d.iv()};Oi("TableHeader",f,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",eh,xb,Xl,"moveBackground","insertColor",Wr,ro,"resizable","movable"],_checkIcon:lr,_movable:!0,_resizable:!0,_labelColor:C.tableHeaderLabelColor,_labelFont:C.tableHeaderLabelFont,_columnLineColor:C.tableHeaderColumnLineColor,_columnLineVisible:C.tableHeaderColumnLineVisible,_sortDescIcon:C.tableHeaderSortDescIcon,_sortAscIcon:C.tableHeaderSortAscIcon,_moveBackground:C.tableHeaderMoveBackground,_insertColor:C.tableHeaderInsertColor,_indent:Ao,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(n){return n.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(t){return t.getColor()||this._labelColor},getLabelAlign:function(O){return O._align},onPropertyChanged:function(){this.iv()},_5Q:function(M){this._61I=M,this.iv()},getLogicalPoint:function(n){return Oq(n,this._canvas,this.tv.tx())},validateImpl:function(){var s=this,C=s._canvas,a=s.getWidth(),B=s.getHeight(),u=s.tv,S=s._60I,N=s._61I,T=-u.tx(),G=0;(a!==C.clientWidth||B!==C.clientHeight)&&Dg(C,a,B),S.clear(),s._39o._roots.each(function(H){if(H.isVisible()){var u=G+H.getWidth();T+a>=G&&u>=T&&S.add({column:H,startX:G}),G=u}});var m=Uh(C);if(Jq(m,-T,0,1),m.beginPath(),m.rect(T,0,a,B),m.clip(),m.clearRect(T,0,a,B),S.each(function(k){var i=k.column,h=k.startX,u=i.getWidth();u>0&&(m.save(),m.beginPath(),m.rect(h,0,u,B),m.clip(),N&&N.column===i||s.drawColumn(m,i,h,0,u,B),s._columnLineVisible&&ng(m,h+u-1,0,1,B,s._columnLineColor),m.restore())}),N){var h=N.column,G=N.startX,l=N.position,i=h.getWidth();m.save(),m.beginPath(),m.rect(G,0,i,B),m.clip(),m.fillStyle=s._moveBackground,m.fill(),s.drawColumn(m,h,G,0,i,B),m.restore(),jc(m,s._insertColor,l,0,B)}m.restore()},_6Q:function(Z){var F=this.tv;return F._31o===Z&&F.sm().getSelectionMode()===Mj},drawColumn:function(D,s,Z,O,y,d){var m=this,A=m.tv,v=ef(s.getIcon()),t=m.getLabelAlign(s);if(m._6Q(s)){var o=ef(m._checkIcon);Pk(D,o,Z+y/2,O+d/2,s,m)}else{var S=m.getLabel(s),R=m.getLabelFont(s),n=m.getLabelColor(s),x=jh(R,S).width,c=v?m._indent:0;t===nh?(v&&Cr(D,v,pi,Z,O,c,d),ic(D,S,R,n,Z+c,O,y,d,nh)):t===lp?(v&&Cr(D,v,pi,Z+y-x-c,O,c,d),ic(D,S,R,n,Z,O,y,d,lp)):(v&&Cr(D,v,pi,Z+(y-x-c)/2,O,c,d),ic(D,S,R,n,Z+(y-x+c)/2,O,0,d,nh))}if(s.isSortable()&&A.getSortColumn()===s&&(v=ef(s.getSortOrder()===gl?m._sortAscIcon:m._sortDescIcon))){var T=iq(v,s)/2+2;Pk(D,v,t===lp?Z+T:Z+y-T,O+d/2,s,A)}}});var Ch=function(x){var V=this;V.th=x,V.tv=x._tableView,V.addListeners()};Wh(Ch,f,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(O){this.getView().style.cursor=O},handle_mousemove:function(z){if(!Wf){var v=this;delete v._29o,v.setCursor(Zq);for(var m=v.th,R=m._60I,d=m.lp(z).x,c=R.size()-1;c>=0;c--){var J=R.get(c),H=J.column,V=J.startX+H.getWidth();if(m.isResizable()&&r(V-d)<=(Sl?10:3))return v._29o=J,v.setCursor(Fr),void 0;d>J.startX&&V>d&&(v._29o=J),(H.isClickable()||H.isSortable()||m.isMovable()||v.tv.getCheckColumn&&H===v.tv.getCheckColumn())&&d>J.startX&&V>d&&v.setCursor(Hm)}}},handle_mousedown:function(S){this.handle_touchstart(S)},handle_touchstart:function(W){var $=this;ll(W),$.tv.endEditing(),$.handle_mousemove(W),$._29o&&($.x=kg(W).x,$.lx=$.th.lp(W).x,$.w=$._29o.column.getWidth(),_f($,W))},handleWindowMouseMove:function(k){this.handleWindowTouchMove(k)},handleWindowTouchMove:function(G){var f=this,S=f.th,u=f.getView().style.cursor,w=f._29o,R=kg(G).x-f.x;if(f.resizing||f.moving||(u===Fr?f.resizing=1:S.isMovable()&&u===Hm&&r(R)>2&&(f.moving=1)),f.resizing)w.column.setWidth(f.w+R);else if(f.moving){var g=f.lx+R;S._60I.each(function(z){var n=z.startX,u=n+z.column.getWidth();if(g>=n&&u>=g){var $={column:w.column,startX:w.startX+R,front:u-g>g-n,insertColumn:z.column};$.position=$.front?n:u,S._5Q($)}})}},_16Q:function(m,W){var k=this,L=k.tv,p=k.th,J=p._checkIcon;if(p._6Q(m)){var R=ef(J),j=k.lx,E=m.getWidth(),Z=iq(R,m);if(j>=W+E/2-Z&&W+E/2+Z>=j){p.setCheckIcon(J===vk?lr:vk);var K=L.sm(),N=L._rows;return J===vk?K.rs(N):K.ss(N),L.onCheckColumnClicked(m),!0}}return!1},handleWindowMouseUp:function(X){this.handleWindowTouchEnd(X)},handleWindowTouchEnd:function(j){var a=this,d=a.tv,I=a.th,H=a._29o;if(a.moving){var O=I._61I;if(O&&O.insertColumn!==O.column){var f=O.column,E=d.getColumnModel()._roots,M=E.remove(f),L=E.indexOf(O.insertColumn);L>=0&&(O.front||L++,L<=E.size()&&(E.add(f,L),d.getColumnModel()._38I(f,M,L)))}I._5Q(h),delete a.moving}else if(!a.resizing&&H){f=H.column;var n=I.lp(j).x,U=H.startX,p=!0;if(I.onColumnClicked){var Q=I.onColumnClicked(f,j,U);Q===!1&&(p=!1)}if(p&&n>=U&&n<=U+f.getWidth()&&!a._16Q(f,U)){if(f.isSortable()){var $=d.getSortMode(),Y=f.getSortOrder();$===je?d.getSortColumn()===f?(Y===Mf&&d.setSortColumn(h),f.setSortOrder(Y===gl?Mf:gl)):d.setSortColumn(f):"bistate"===$&&(d.getSortColumn()===f?f.setSortOrder(Y===gl?Mf:gl):d.setSortColumn(f))}d.onColumnClicked(f,j,U)}}a._29o=a.resizing=a.x=a.lx=a.w=h}}),zl.TablePane=function(F){this.init(new hd(F))},Oi("TablePane",f,{ms_v:1,_44o:1}),zl.TreeTablePane=function(G){this.init(new Tk(G))},Oi("TreeTablePane",f,{ms_v:1,_44o:1}),zl.Toolbar=function($){var e=this,y=e._view=Lh(1,e),t=y.style;t.background=C.toolbarBackground||"",t.height=zo+ej,e._canvas=fr(y),e._30o=new mo,e._90I=new mo,e.setItems($||[]),y.handleGroupSelectedChanged=function(G){if(G.isSelected()){var A=G.getGroupId();null!=A&&e._items.forEach(function(R){var e=R.element;e&&e!==G&&e.setSelected&&e.getGroupId&&e.getGroupId()===A&&e.setSelected(!1)})}},new Xi(e)},Oi("Toolbar",f,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[sj,eh,xb,Nk,Fe,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:C.toolbarLabelColor,_labelSelectColor:C.toolbarLabelSelectColor,_labelFont:C.toolbarLabelFont,_selectBackground:C.toolbarSelectBackground,_itemGap:C.toolbarItemGap,_separatorColor:C.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(I){var R=this.getItemInfoAt(I);return R?R.item.toolTip:h},getLabelColor:function(Q){return Q&&Q.selected&&Q.type!==vk&&Q.type!==Bd?this._labelSelectColor:this._labelColor},onPropertyChanged:function(c){this.iv(),c.property===sj&&this._items.forEach(function(H){Vb(H)})},redraw:function(){this.iv()},addItem:function(_,H){var c=this._items;H==h?c.push(_):c.splice(H,0,_),this.fp(sj,h,c)},removeItem:function(K){if(K)for(var L=this._items,y=0;y<L.length;y++)K===L[y]&&(L.splice(y,1),this.fp(sj,h,L))},removeItemById:function(C){if(C!=h)for(var X=this._items,E=0;E<X.length;E++)if(C===X[E].id){var c=X.splice(E,1)[0];return this.fp(sj,h,X),c}},getItemById:function(V){if(V!=h)for(var Y=this._items,l=0;l<Y.length;l++){var v=Y[l];if(V===v.id)return v}},setItemVisible:function(_,K){var B=this.getItemById(_);B&&(B.visible=K)},getItemInfos:function(){return this._30o},getItemInfoAt:function(F){var N=this,B=0,d=N._30o,r=N.lp(F),q=r.x,K=r.y;if(K>=0&&K<=N.getHeight())for(;B<d.size();B++){var i=d.get(B);if(i.startX<=q&&q<=i.endX)return i}return h},drawItem:function(f,k,R,W,K){if(k.visible===!1)return 0;if(Pj(k.visible)&&!k.visible())return 0;var t=this,j=k.disabled;j&&(f.globalAlpha=pl);var E=t.drawItemImpl(f,k,R,W,K),I=t._itemGap;return j&&(f.globalAlpha=1),this._currentItem!==k||"separator"===k||k.separator===!0||k.unfocusable||wg(f,t._separatorColor,R-I/2,0,E+I,W),E},drawItemImpl:function(b,P,O,$,i){var G=this,M=G._view,g=G._itemGap,y=$/2,w=P.type,N=P.element,Q=P.label;Tf(N)&&(Q=N,N=h);var q,K=G.getLabelFont(P),B=G.getLabelColor(P),J=P.selected,u=ef(P.icon),d=iq(u,P),c=0,x=d+(Q?jh(K,Q).width:0);if("separator"===P||P.separator===!0)return jc(b,G._separatorColor,O,$/4,y),1;if(N){u&&Pk(b,u,O+d/2,y,P,G),ic(b,Q,K,B,O+d,0,0,$);var I=hh(N);i||G._90I.add(I),I.parentNode!==M&&Pp(M,I),N.iv&&N.iv(),N.validate&&N.validate();var W=I.getBoundingClientRect(),e=W.width,S=I.style;return gd(I),S.left=G.tx()+O+x+ej,S.top=($-W.height)/2+ej,x+e}return w===Bd?q=ef(J?fe:Aj):w===vk&&(q=ef(J?vk:lr)),q?(c=iq(q,P),Pk(b,q,O+c/2,y,P,G),O+=c,x+=c):J&&ng(b,O-g/2,0,x+g,$,G.getSelectBackground(P)),u&&Pk(b,u,O+d/2,y,P,G),ic(b,Q,K,B,O+d,0,0,$),x},validateImpl:function(){var o=this,J=o._canvas,G=o.getWidth(),q=o.getHeight(),g=o._30o,e=o._items;Dg(J,G,q);var H=Uh(J),I=o._itemGap,_=I/2;Jq(H,o.tx(),0,1),H.clearRect(0,0,G,q);var y=o._90I;o._90I=new mo,g.clear(),e.forEach(function(i){var l=o.drawItem(H,i,_,q);g.add({item:i,startX:_,endX:_+l,width:l}),l&&(_+=l+I)}),y.each(function(s){o._90I.contains(s)||Oe(s)});var E=o._64I;o._64I=m(0,_),H.restore(),o._stickToRight?(o._65O=0,H=Uh(J),_=G-o._64I+I,Jq(H,0,0,1),H.clearRect(0,0,G,q),g.clear(),e.forEach(function(a){var y=o.drawItem(H,a,_,q,!0);g.add({item:a,startX:_,endX:_+y,width:y}),y&&(_+=y+I)}),H.restore()):o.tx(o.tx()),E!==o._64I&&o.onSumWidthChanged(E,o._64I)},onSumWidthChanged:function(){},handleClick:function(R,A){var a=this,v=R.type,O=R.action,z=R.groupId,V=R.selected;R.disabled||(z!=h?V||(R.selected=!0,this._items.forEach(function(P){P.groupId===z&&R!==P&&(P.selected=!1)}),O&&R.action(R,a,A)):v===vk||"toggle"===v?(R.selected=!V,O&&R.action(R,a,A)):O&&R.action(R,a,A)),Rn(),a.iv()}});var Xi=function(Y){this.tb=Y,this.addListeners()};Wh(Xi,f,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(T){this.handleScroll(T,10*(T.wheelDelta/40))},handle_DOMMouseScroll:function(M){this.handleScroll(M,10*-M.detail)},handleScroll:function(r,Q){ll(r);var Y=this.tb;Y.isScrollable()&&!Y._stickToRight&&(Y.tx(Y.tx()+Q),xl())},handle_mousemove:function(l){var r=this;Wf||r.setItem(l)},handle_mouseout:function(u){var T=this;u.target===T.getView()?T.tb.setCurrentItem(h):T.handle_mousemove(u)},handle_mousedown:function(k){this.handle_mousemove(k),this.handle_touchstart(k)},handle_touchstart:function(C){var Y=this,E=Y.tb,k=C.target;ci(C)&&(k===Y.getView()||k===E._canvas)&&(ll(C),E.setFocus(C)&&(this.setItem(C,!0),(E.isScrollable()||Y.info&&!Y.info.item.disabled)&&(Y.x=kg(C).x,Y.tx=E.tx(),_f(Y,C))))},handleWindowMouseMove:function(d){this.handleWindowTouchMove(d)},handleWindowTouchMove:function(Y){var G=this,z=G.tb;if(!z._stickToRight){var i=kg(Y).x-G.x;!G._25o&&r(i)>2&&z.isScrollable()&&(G._25o=1),G._25o&&z.tx(G.tx+i)}},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},handleWindowTouchEnd:function(n){var k=this,G=k.tb,X=k.info,S=k.tb.getItemInfoAt(n);if(!k._25o&&X){var e=X.item;S&&S.item===e&&G.handleClick(e,n)}k._25o=k.x=k.tx=h,k.setItem()},setItem:function(n,x){var o=this,N=o.tb,K=o.info=n?N.getItemInfoAt(n):h,s=K?K.item:h;N.setCurrentItem(s),x&&s&&Pj(s.onDown)&&s.onDown(n)}}),zl.BorderPane=function(){this._view=Lh(1,this),this.iv()},Oi("BorderPane",f,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(n,t){this._12o("leftView",n),t!=h&&this.setLeftWidth(t)},getRightView:function(){return this._rightView},setRightView:function(Z,k){this._12o("rightView",Z),k!=h&&this.setRightWidth(k)},getTopView:function(){return this._topView},setTopView:function(l,o){this._12o("topView",l),o!=h&&this.setTopHeight(o)},getBottomView:function(){return this._bottomView},setBottomView:function(O,K){this._12o("bottomView",O),K!=h&&this.setBottomHeight(K)},getCenterView:function(){return this._centerView},setCenterView:function(z){this._12o("centerView",z)},_12o:function(h,i){var u=this,m="_"+h,R=u._view,z=u[m];z!==i&&(z&&(z.getView?Oe(z.getView()):Oe(z)),u[m]=i,i&&(i.getView?Pp(R,i.getView(),1):Pp(R,i,1)),u.fp(h,z,i))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var y=this,C=y._topView,t=y._bottomView,E=y._leftView,u=y._rightView,f=y._centerView,V=y.getWidth(),W=y.getHeight(),n=0,F=0,j=V,K=W,v=0,A=0,s=0,k=0;C&&(v=y._topHeight==h?us(C):y._topHeight,F=v),t&&(A=y._bottomHeight==h?us(t):y._bottomHeight,K=W-A),E&&(s=y._leftWidth==h?wp(E):y._leftWidth,n=s),u&&(k=y._rightWidth==h?wp(u):y._rightWidth,j=V-k);var $=m(0,j-n),d=m(0,K-F);C&&rr(C,0,0,V,v),t&&rr(t,0,K,V,A),E&&rr(E,0,F,s,d),u&&rr(u,j,F,k,d),f&&rr(f,n,F,$,d)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);