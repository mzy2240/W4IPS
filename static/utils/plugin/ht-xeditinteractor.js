!function(D,I,Y){"use strict";var E="ht",C=D[E],X=C.Default,T=C.graph,O=X.getInternal(),A=O.ui(),s=A.NodeUI.prototype,F=A.ShapeUI.prototype,x=T.GraphView,G=x.prototype,N=A.EdgeUI.prototype,b=C.Node,j=C.Shape,g=C.Edge,L=C.Group,$=X.isTouchable,Q=X.preventDefault,S=D.setTimeout,p=X.grow,V=X.isDragging,k=X.getDistance,h=null,w=C.List,d="undefined"!=typeof Float32Array?Float32Array:Array,n=Math,c=n.PI,e="Crossing",m="No Crossing",K=c/2,M=2*c,u=n.atan2,a=n.sqrt,Z=n.pow,o=n.sin,t=n.cos,l=n.min,i=n.max,B=n.abs,J=n.ceil,q=n.round,W=X.unionPoint,P=X.unionRect,v=X.containsPoint,z=X.clone,R="rgb(52, 152, 219)",y="red",H={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},_={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var A=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],f=0;f<A.length;f++){var t=A[f];t=0===f%2?t/400*_.width:t/100*_.height,A[f]=t}return _.width>120&&(A[4]=_.width-26,A[6]=_.width-40,A[10]=_.width-40,A[12]=_.width-26,A[18]=33),A}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},r={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:R,rotation:.61},{type:"circle",rect:[200,120,70,70],background:R,rotation:.61},{type:"circle",rect:[200,220,70,70],background:R,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:R},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:R}]},U={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:y,rotation:.61}]},f={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:R},{type:"circle",rect:[0,210,90,90],background:R},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:R}]},vk={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:y},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:y}]},eg={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:R}]},Ah={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:y}]},bb={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},Id={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},rr=function(O){var e=O.touches[0];return e?e:O.changedTouches[0]},Qn=function(q,r,b,X){return u(X-r,b-q)},$j=function(d,k){return{x:d.x*k,y:d.y*k}},Xp=function(z,Q){z.each(function(g){return z.isSelected(g)?Q(g):void 0})},sl=function(B,y){B.reverseEach(function(X){return B.isSelected(X)?y(X):void 0})},vn=function(k,S,_){var Y,C,s,v,E,b=this,a=S,L=b.gv;if(k instanceof j){s=k.getSegments();var t=L.getDataUI(k);E=t._55O.$15l,s&&s.size()||(s=df(E)),k.isClosePath()&&s.indexOf(5)<0&&(s=new w(s._as),s.add(5)),Y=hl(k,t,a),C=E[Y]}else{var T=L.getDataUI(k);E=Wg(T,k.s("edge.points")),s=k.s("edge.segments"),s&&s.size()||(s=df(E)),E=E._as,Y=hl(k,T,a),C=E[Y]}if(s&&(v=s.get(a)),2===v||1===v||5===v){var R=E[Y+1];5===v&&(R=E[0]);var d=Ep(C,_,R);return d}return _},Te=function(c,f,I,x){var X=f/2,E=I/2,D=Vc(c,-X,-E,x),q=Vc(c,X,-E,x),G=Vc(c,-X,E,x),H=Vc(c,X,E,x),d=Vc(c,0,-E,x),C=Vc(c,X,0,x),k=Vc(c,0,E,x),o=Vc(c,-X,0,x);return[D,q,G,H,d,C,k,o]},Ep=function(g,e,L){var f={x:e.x-g.x,y:e.y-g.y},G={x:L.x-g.x,y:L.y-g.y},d=a(Z(L.x-g.x,2)+Z(L.y-g.y,2)),n={x:G.x/d,y:G.y/d},W=f.x*n.x+f.y*n.y,J={x:n.x*W,y:n.y*W};return{x:g.x+J.x,y:g.y+J.y}},Vc=function(s,x,J,N){var E=t(N)*x-o(N)*J,Q=o(N)*x+t(N)*J;return s?{x:s.x+E,y:s.y+Q}:{x:E,y:Q}},Uj=function(x,q){return q>2*x?x:q/2},To=function(M,T,A,n){var r=k(M,T);return A=n?l(A,r):Uj(A,r),r?A/=r:A=0,{x:M.x+(T.x-M.x)*A,y:M.y+(T.y-M.y)*A}},Oj=function(y,I){var S,M,Z=y.gv,g=y._data,Q=g._40I,c=g._41I,D=g.s("edge.offset"),j=g.s("edge.source.position"),n=g.s("edge.target.position"),z=g.s("edge.source.offset.x"),V=g.s("edge.source.offset.y"),L=g.s("edge.target.offset.x"),x=g.s("edge.target.offset.y"),N=g.s("edge.source.anchor.x"),e=g.s("edge.source.anchor.y"),C=g.s("edge.target.anchor.x"),K=g.s("edge.target.anchor.y");if(I?(S=O.getEdgeAgentPosition(Z,Q,j,z,V,N,e),M=O.getEdgeAgentPosition(Z,c,n,L,x,C,K)):(S=O.getEdgeAgentPosition(Z,Q,j,0,0,N,e),M=O.getEdgeAgentPosition(Z,c,n,0,0,C,K)),"points"===g.s("edge.type")&&D&&!g.s("edge.center")&&S){var h=g.s("edge.points")||new w,k=h.size(),r=To(S,k?h.get(0):M,D,k),U=To(M,k?h.get(k-1):S,D,k);S=r,M=U}return[S,M]},Wg=function(g,F,d){var J=g._78o,U=g._data,L=U.s("edge.type"),P=[J.sourcePoint,J.targetPoint];return"points"===L?d&&(P=Oj(g)):P=J.center?L?d?Oj(g):Oj(g,!0):d?Oj(g):[J.c1,J.c2]:d?Oj(g):Oj(g,!0),F=new w(F?F._as:h),F.add(P[0],0),F.add(P[1]),F},ac=function(p){return p=new w(p._as),p.removeAt(0),p.removeAt(p.size()-1),p},df=function(P){P._as||(P=new w(P));var k=new w;k.add(1);for(var B=1;B<P.size();B++)k.add(2);return k},lc=function(X,t){return{x:(X.x+t.x)/2,y:(X.y+t.y)/2}},kl=function(D,i){return{x:D.x+1*(i.x-D.x)/4,y:D.y+1*(i.y-D.y)/4}},Wr=function(m,b){return{x:m.x+3*(b.x-m.x)/4,y:m.y+3*(b.y-m.y)/4}},mm=function(h,N,C,X){var w=N.x+N.width/2,m=N.y+N.height/2,M=a(w*w+m*m),P=u(m,w)+C;return{x:X.x+M*t(P),y:X.y+M*o(P)}},qm=G.validateImpl,jf=G.isRectEditable,$k=G.isPointEditable,ah=G._42,mp=F._79o,Bk=N._79o,Dl=F._48O,Yl=F._47O,Vm=s._48O,Ap=s._80o,Nc=F._80o,qe=s.getSelectWidth,Gm=s._47O,Ai=N._47O,bg=G.isEditable,Vi=["northwest","north","northeast","east","southeast","south","southwest","west"],hf=function(T,C,O,d,g,B,m,J,n,G){var v=T.x,Q=T.y,_=T.width,f=T.height,a={x:v+_/2,y:Q+f/2};d=d||0,C=Vc(a,C.x-a.x,C.y-a.y,-d),m&&!J&&(C.x+=n,C.y+=G);var c=.01;if("northwest"===O?(C.x+g>v+_-c&&(C.x=v+_-g-c),C.y+g>Q+f-c&&(C.y=Q+f-g-c),T=W(C,{x:v+_,y:Q+f})):"north"===O?(C.y+g>Q+f-c&&(C.y=Q+f-g-c),T=W({x:v,y:C.y},{x:v+_,y:Q+f})):"northeast"===O?(C.x<v+g+c&&(C.x=v+g+c),C.y+g>Q+f-c&&(C.y=Q+f-g-c),T=W({x:v,y:C.y},{x:C.x,y:Q+f})):"west"===O?(C.x+g>v+_-c&&(C.x=v+_-g-c),T=W({x:C.x,y:Q},{x:v+_,y:Q+f})):"east"===O?(C.x<v+g+c&&(C.x=v+g+c),T=W({x:v,y:Q},{x:C.x,y:Q+f})):"southwest"===O?(C.x+g>v+_-c&&(C.x=v+_-g-c),C.y<Q+g+c&&(C.y=Q+g+c),T=W({x:C.x,y:Q},{x:v+_,y:C.y})):"south"===O?(C.y<Q+g+c&&(C.y=Q+g+c),T=W({x:v,y:Q},{x:v+_,y:C.y})):"southeast"===O&&(C.x<v+g+c&&(C.x=v+g+c),C.y<Q+g+c&&(C.y=Q+g+c),T=W({x:v,y:Q},C)),"keepRatio"===B&&(!m&&J||m&&!J)&&("northeast"===O||"southeast"===O||"northwest"===O||"southwest"===O)){var I=T.width,E=T.height,e=I/_,A=E/f,F=l(e,A);T.width=_*F,T.height=f*F,"northeast"===O?T.y=Q+(f-T.height):"northwest"===O?(T.y=Q+(f-T.height),T.x=v+(_-T.width)):"southwest"===O&&(T.x=v+(_-T.width))}T.x-=a.x,T.y-=a.y;var U=mm(h,T,d,a);return T.x=U.x-T.width/2,T.y=U.y-T.height/2,T},pf=function(J,v,U,i){var G=J.getRotation(),N=v,C=N.x,A=N.y,R=N.width,B=N.height,X={x:C+N.width/2,y:A+N.height/2};i=Vc(X,i.x-X.x,i.y-X.y,-G),"northwest"===U?N=W(i,{x:C+R,y:A+B}):"north"===U?N=W({x:C,y:i.y},{x:C+R,y:A+B}):"northeast"===U?N=W({x:C,y:i.y},{x:i.x,y:A+B}):"west"===U?N=W({x:i.x,y:A},{x:C+R,y:A+B}):"east"===U?N=W({x:C,y:A},{x:i.x,y:A+B}):"southwest"===U?N=W({x:i.x,y:A},{x:C+R,y:i.y}):"south"===U?N=W({x:C,y:A},{x:C+R,y:i.y}):"southeast"===U&&(N=W({x:C,y:A},i)),J.setRect(N),N.x-=X.x,N.y-=X.y;var Q=mm(J,N,G,X);J.p(Q.x,Q.y)},Vn=function(W,e,t,L,u,a,P,x){var B=h;a?(B=Vc(h,u.x-e.x,u.y-e.y,-t),B.x-=P.x,B.y-=P.y):B=Vc(h,u.x-e.x,u.y-e.y,0);var O={x:e.x+B.x,y:e.y+B.y};x&&(O=x(O.x,O.y)),O.e=W.getPoints().get(L).e,W.setPoint(L,O);var D=W.getWidth(),V=W.getHeight(),m=W.p().x-D/2,c=W.p().y-V/2;m-=e.x,c-=e.y;var E=mm(W,{x:m,y:c,width:D,height:V},t,e);W.p(E.x,E.y)},hl=function(K,l,H){var T,A;if(K instanceof j?(T=K.getPoints(),A=K.getSegments()):K instanceof g&&"points"===K.s("edge.type")&&(T=K.s("edge.points"),A=K.s("edge.segments"),T=Wg(l,T)),A&&A.size()||(A=df(T)),K instanceof j&&K.isClosePath()&&A.indexOf(5)<0&&(A=new w(A._as),A.add(5)),A)for(var Z=-1,S=0;S<A.size();S++){if(S===H)return Z;var m=A.get(S);1===m?Z+=1:2===m?Z+=1:3===m?Z+=2:4===m&&(Z+=3)}},Pn=function(Y,r,C){var N,t;if(Y instanceof j?(N=Y.getPoints(),t=Y.getSegments()):Y instanceof g&&"points"===Y.s("edge.type")&&(N=Y.s("edge.points"),t=Y.s("edge.segments"),N=Wg(r,N)),t&&t.size()||(t=df(N)),t)for(var x=-1,l=0;l<t.size();l++){var c=t.get(l);if(1===c?x+=1:2===c?x+=1:3===c?x+=2:4===c&&(x+=3),x===C)return l}},Wq=function(T,k){var D=[T[0]-k[0],T[1]-k[1],T[2]-k[2]];return D},Sd=function(){var W=new d(16);return W[0]=1,W[1]=0,W[2]=0,W[3]=0,W[4]=0,W[5]=1,W[6]=0,W[7]=0,W[8]=0,W[9]=0,W[10]=1,W[11]=0,W[12]=0,W[13]=0,W[14]=0,W[15]=1,W},Dg=function(K,j){var S=K[0],x=K[1],O=K[2];return K[0]=j[0]*S+j[4]*x+j[8]*O+j[12],K[1]=j[1]*S+j[5]*x+j[9]*O+j[13],K[2]=j[2]*S+j[6]*x+j[10]*O+j[14],K},yd=function(i,$){if($){var z=o($),F=t($),G=i[0],W=i[1],u=i[2],M=i[3],g=i[8],x=i[9],H=i[10],T=i[11];i[0]=G*F-g*z,i[1]=W*F-x*z,i[2]=u*F-H*z,i[3]=M*F-T*z,i[8]=G*z+g*F,i[9]=W*z+x*F,i[10]=u*z+H*F,i[11]=M*z+T*F}},Rf=function(u,a){for(var K=u.s("grid.row.count"),D=u.s("grid.column.count"),n=0;K>n;n++)for(var R=0;D>R;R++){var d=u.getCellRect(n,R);if(v(d,a))return{rowIndex:n,columnIndex:R,rect:d,grid:u}}return null},bm=function(L,y,D,j,C,P){var T={},v=D-L,V=j-y,h=n.sqrt(v*v+V*V),o=v/h,G=V/h,$=(-L+C)*o+(-y+P)*G;return 0>=$?(T.x=L,T.y=y):$>=h?(T.x=D,T.y=j):(T.x=L+$*o,T.y=y+$*G),v=C-T.x,V=P-T.y,T.z=n.sqrt(v*v+V*V),T},oq=function(Z,u){var P,n,$,w,s,x,t,b,q=Z.getPoints(),j=Z.getSegments(),p=Z.p(),J=Z.getRotation();if(!j||!(j.indexOf(3)>0||j.indexOf(4)>0)){for(b=0;b<=q.size()-1;b++)if(b===q.size()-1?(s=q.get(0),w=q.get(b)):(w=q.get(b),s=q.get(b+1)),w=Vc(p,w.x-p.x,w.y-p.y,J),s=Vc(p,s.x-p.x,s.y-p.y,J),x=bm(w.x,w.y,s.x,s.y,u.x,u.y),t=x.z,t<(Z.s("shape.border.width")||10)){n=w,$=s,P=b;break}if(P!=h){var f=bm(n.x,n.y,$.x,$.y,u.x,u.y),c=k(n,f);return{attachIndex:P,attachOffset:c}}}},ql=function(R){for(var m=R._data,Y=m.p(),v=m.getRotation(),$=m.getPoints(),u=h,g=[],F=0;F<$.size();F++)u=$.get(F),g.push(Vc(Y,u.x-Y.x,u.y-Y.y,v));R._55O.$15l=g};X.setImage("xeditinteractor_parentIcon",r),X.setImage("xeditinteractor_hostIcon",U),X.setImage("xeditinteractor_edgeIcon",f),X.setImage("xeditinteractor_removeIcon",vk),X.setImage("xeditinteractor_sourceIcon",eg),X.setImage("xeditinteractor_targetIcon",Ah),X.setImage("xeditinteractor_elevationIcon",bb),X.setImage("xeditinteractor_tallIcon",Id),G._editPointSize=$?24:9,G._edgeHelpers=["parent","remove","source","target"],G._leftTopHelpers=["parent"],G._rightTopHelpers=["host"],G._leftBottomHelpers=["edge"],G._rightBottomHelpers=["remove"],Vi=Vi.concat(Vi).concat(Vi),N._79o=function(){var Y=this,x=Y.gv,V=x.getZoom(),g=x._editInteractor,j=Bk.call(Y);if(!j)return null;var Q=Oj(Y,!0),y=Q[0],k=Q[1],J={x:j.x,y:j.y,width:j.width,height:j.height},t=W(y,k);if(g instanceof T.XEditInteractor){J=P(J,t);var I=Y._55O,e=x.getEditPointSize()/V+2,C=0;I&&I._43O&&(C+=e/2,p(J,C))}return J},N._47O=function(o){var A=this,h=A.gv,m=h._editInteractor;m instanceof T.XEditInteractor||Ai.call(A,o)},N.rectIntersects=function(J){var o=this,F=o._data,g=o.gv,n=g.getZoom(),k=o._55O,H=g._editInteractor;if(H instanceof T.XEditInteractor&&g.isEditable(F)&&k&&k._43O&&"points"===F.s("edge.type")){var O=F.s("edge.points"),G=F.s("edge.segments");O=Wg(o,O),G&&G.size()||(G=df(O)),O=O._as;var y=!1,v=$?5:1,N=J.x+v,D=J.y+v,B={x:N,y:D};if(H._edge===F&&H._hoverSegmentIndex>=0){var w=g._editInteractor._hoverSegmentIndex,U=G.get(w),A=hl(F,o,w),i=h;if(A!=h&&A>=0){var I=O[A],l=g.getSegmentHoverWidth()/n;if(2===U||1===U){var R=O[A+1];i=Im(new Am(I.x,I.y),new Am(R.x,R.y),new Am(B.x-l,B.y-l),new Am(B.x+2*l,B.y+2*l)),i.$62l===e&&(y=!0)}else if(3===U){var W=O[A+1],R=O[A+2];i=Eo(new Am(I.x,I.y),new Am(W.x,W.y),new Am(R.x,R.y),new Am(B.x-l,B.y-l),new Am(B.x+2*l,B.y+2*l)),i.$62l===e&&(y=!0)}else if(4===U){var u=O[A+1],j=O[A+2];R=O[A+3],i=cm(new Am(I.x,I.y),new Am(u.x,u.y),new Am(j.x,j.y),new Am(R.x,R.y),new Am(B.x-l,B.y-l),new Am(B.x+2*l,B.y+2*l)),i.$62l===e&&(y=!0)}}}if(y)return!0}return h},F._47O=function(M){var z=this,Q=z.gv,i=Q._editInteractor;i instanceof T.XEditInteractor||Yl.call(z,M)},F.rectIntersects=function(d){var y=this,v=y._data,B=y.gv,x=B.getZoom(),m=y._55O,s=B._editInteractor;if(s instanceof T.XEditInteractor&&B.isEditable(v)&&m&&m._43O){var V=m.$15l,X=!1,t=$?5:1,H=d.x+t,M=d.y+t,Y={x:H,y:M};if(V&&V.length===v.getPoints().size()||(ql(y),V=m.$15l),s._shape===v&&s._hoverSegmentIndex>=0){var k=v.getSegments();k&&k.size()||(k=df(V));var i=B._editInteractor._hoverSegmentIndex,z=k.get(i),n=hl(v,y,i),U=h;if(n!=h&&n>=0){var K=V[n],g=B.getSegmentHoverWidth()/x;if(2===z||1===z){var F=V[n+1];U=Im(new Am(K.x,K.y),new Am(F.x,F.y),new Am(Y.x-g,Y.y-g),new Am(Y.x+2*g,Y.y+2*g)),U.$62l===e&&(X=!0)}else if(3===z){var S=V[n+1],F=V[n+2];U=Eo(new Am(K.x,K.y),new Am(S.x,S.y),new Am(F.x,F.y),new Am(Y.x-g,Y.y-g),new Am(Y.x+2*g,Y.y+2*g)),U.$62l===e&&(X=!0)}else if(4===z){var C=V[n+1],r=V[n+2];F=V[n+3],U=cm(new Am(K.x,K.y),new Am(C.x,C.y),new Am(r.x,r.y),new Am(F.x,F.y),new Am(Y.x-g,Y.y-g),new Am(Y.x+2*g,Y.y+2*g)),U.$62l===e&&(X=!0)}}}if(X)return!0}return h},F._48O=function(){var B=this,d=B.gv,M=d._editInteractor;M instanceof T.XEditInteractor?(s._48O.call(B),B._55O._43O&&ql(B)):Dl.call(B)},F._79o=function(){var D=this,d=D.gv,Z=d.getZoom(),W=d._editInteractor,x=mp.call(D);if(x){var r={x:x.x,y:x.y,width:x.width,height:x.height};if(W instanceof T.XEditInteractor){var R=D._55O,P=d.getEditPointSize()/Z+2,V=0;R&&R._43O&&(V+=P/2,p(r,V))}return r}},s._47O=function(Y){var g=this,e=g.gv,o=e._editInteractor;if(o instanceof T.XEditInteractor);else{var a=g._55O;a&&a._98o&&Gm.call(g,Y)}},s.getSelectWidth=function(){var Y=this,D=Y.gv,f=D._editInteractor,S=Y._data;return D.isEditable(S)&&f instanceof T.XEditInteractor?0:qe.call(Y)},s._80o=function(C){var e=this,Q=e.gv._editInteractor;if(Ap.call(e,C),Q&&Q._debug){C.save(),C.beginPath(),C.lineWidth=1,C.strokeStyle="green";var H=e._79o();H&&(C.rect(H.x,H.y,H.width,H.height),C.stroke()),C.restore()}},F._80o=function(s){var U=this,x=U.gv._editInteractor;if(Nc.call(U,s),x&&x._debug){s.save(),s.beginPath(),s.lineWidth=1,s.strokeStyle="green";var c=U._79o();s.rect(c.x,c.y,c.width,c.height),s.stroke(),s.restore()}},s._48O=function(){var E=this,j=E.gv,h=E._data,r=j._editInteractor,c=E._55O,P=h.p(),G=h.getRotation();if(r instanceof T.XEditInteractor){if(c._42O){var J=Te(P,h.getWidth(),h.getHeight(),G),l=J[0],A=J[1],V=J[2],d=J[3],e=J[4],n=J[5],X=J[6],K=J[7];c.$45l=[l,e,A,n,d,X,V,K]}}else Vm.call(E)},G.getResizeMode=function(){return this.$25l||"normal"},G.setResizeMode=function(n){var J=this.$25l;this.$25l=n,this.fp("resizeMode",J,n)},G.getSnapAngle=function(){return this.$26l||Math.PI/36},G.setSnapAngle=function(T){var m=this.$26l;this.$26l=T,this.fp("snapAngle",m,T)},G.getSnapSpacing=function(){return this.$27l},G.setSnapSpacing=function(G){var b=this.$27l;this.$27l=G,this.fp("snapSpacing",b,G)},G.getPointSnapSpacing=function(){return this._pointSnapSpacing},G.setPointSnapSpacing=function(N){var B=this._pointSnapSpacing;this._pointSnapSpacing=N,this.fp("pointSnapSpacing",B,N)},G.setHelperEditableFunc=function(_){var n=this._helperEditableFunc;this._helperEditableFunc=_,this.fp("helperEditableFunc",n,_)},G.getHelperEditableFunc=function(){return this._helperEditableFunc},G.setLeftTopHelpers=function(N){var k=this._leftTopHelpers;this._leftTopHelpers=N,this.fp("leftTopHelpers",k,N)},G.getLeftTopHelpers=function(){return this._leftTopHelpers},G.setLeftTopHelpersAlign=function(K){var C=this._leftTopHelpersAlign;this._leftTopHelpersAlign=K,this.fp("leftTopHelpersAlign",C,K)},G.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},G.setRightTopHelpers=function(H){var f=this._rightTopHelpers;this._rightTopHelpers=H,this.fp("rightTopHelpers",f,H)},G.getRightTopHelpers=function(){return this._rightTopHelpers},G.setRightTopHelpersAlign=function(j){var Q=this._rightTopHelpersAlign;this._rightTopHelpersAlign=j,this.fp("rightTopHelpersAlign",Q,j)},G.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},G.setLeftBottomHelpers=function(k){var G=this._leftBottomHelpers;this._leftBottomHelpers=k,this.fp("leftBottomHelpers",G,k)},G.getLeftBottomHelpers=function(){return this._leftBottomHelpers},G.setLeftBottomHelpersAlign=function(N){var K=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=N,this.fp("leftBottomHelpersAlign",K,N)},G.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},G.setRightBottomHelpers=function(r){var J=this._rightBottomHelpers;this._rightBottomHelpers=r,this.fp("rightBottomHelpers",J,r)},G.getRightBottomHelpers=function(){return this._rightBottomHelpers},G.setRightBottomHelpersAlign=function(P){var t=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=P,this.fp("rightBottomHelpersAlign",t,P)},G.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},G.setEdgeHelpers=function(V){var l=this._edgeHelpers;this._edgeHelpers=V,this.fp("edgeHelpers",l,V)},G.getEdgeHelpers=function(){return this._edgeHelpers},G.isHelperEditable=function(q,Q){return q instanceof g&&("host"===Q||"edge"===Q||"elevation"===Q||"tall"===Q)?!1:q instanceof b&&("source"===Q||"target"===Q)?!1:"pointElevation"===Q?this._helperEditableFunc?this._helperEditableFunc(q,Q):!1:this._helperEditableFunc?this._helperEditableFunc(q,Q):!0},G.getEditHelperSize=function(){return this._editHelperSize||($?28:16)},G.setEditHelperSize=function(y){var P=this._editHelperSize;this._editHelperSize=y,this.fp("editHelperSize",P,y)},G.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},G.setEditRectBorderColor=function(q){var S=this.$28l;this.$28l=q,this.fp("editRectBorderColor",S,q)},G.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},G.setNodeBorderColor=function(Q){var Y=this.$29l;this.$29l=Q,this.fp("nodeBorderColor",Y,Q)},G.getEditRectBorderStyle=function(){return this.$30l||"dashed"},G.setEditRectBorderStyle=function(S){var w=this.$30l;this.$30l=S,this.fp("editRectBorderStyle",w,S)},G.getControlPointBackground=function(){return this.$31l||"#ff0"},G.setControlPointBackground=function(E){var B=this.$31l;this.$31l=E,this.fp("controlPointBackground",B,E)},G.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},G.setControlPointBorderColor=function(N){var p=this.$32l;this.$32l=N,this.fp("controlPointBorderColor",p,N)},G.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},G.setJoinPointBackground=function(R){var p=this.$33l;this.$33l=R,this.fp("joinPointBackground",p,R)},G.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},G.setJoinPointBorderColor=function(I){var y=this.$34l;this.$34l=I,this.fp("joinPointBorderColor",y,I)},G.getDirectionLineColor=function(){return this.$35l||"#888"},G.setDirectionLineColor=function(k){var T=this.$35l;this.$35l=k,this.fp("directionLineColor",T,k)},G.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},G.setSegmentHoverColor=function(N){var g=this.$36l;this.$36l=N,this.fp("segmentHoverColor",g,N)},G.getSegmentHoverWidth=function(){return this.$22l||($?16:8)},G.setSegmentHoverWidth=function(B){var T=this.$22l;this.$22l=B,this.fp("segmentHoverWidth",T,B)},G.getSnapPointBorderColor=function(){return this.$38l||"#f00"},G.setSnapPointBorderColor=function(E){var m=this.$38l;this.$38l=E,this.fp("snapPointBorderColor",m,E)},G.getEditRectPadding=function(){return this.$39l!=h?this.$39l:6},G.setEditRectPadding=function(Z){var Q=this.$39l;this.$39l=Z,this.fp("editRectPading",Q,Z)},G.isRectEditable=function(n){var X=this,F=X._editInteractor;return F instanceof T.XEditInteractor?X._rectEditableFunc?X._rectEditableFunc(n):!0:jf.call(X,n)},G.isPointEditable=function(V){var k=this,P=k._editInteractor;return P instanceof T.XEditInteractor?k._pointEditableFunc?k._pointEditableFunc(V):!0:$k.call(k,V)},G.validateImpl=function(){var F=this,D=F.$14l,C=F._editInteractor;if(D){var e=F.getWidth(),f=F.getHeight();(e!==D.clientWidth||f!==D.clientHeight)&&(C&&(C._68I=1),O.setCanvas(D,e,f),F._32I=1)}qm.call(this)},G.isEditable=function(U){var m=bg.call(this,U),W=this._editInteractor;if(W instanceof T.XEditInteractor&&U instanceof g){if(!U.s("2d.editable"))return!1;var y=this.getEditableFunc();m=y?y(U):!0}return m},G._42=function(N,o){var t=this,r=t._editInteractor;ah.call(t,N,o),r instanceof T.XEditInteractor&&r._68I&&r._42()},G.isSnapPoint=function(){return!0};var ic=function(y){arguments.length>0&&this.$58l(y)},zd=ic.prototype;zd.$58l=function(m){this.$62l=m,this.points=new Array},zd.$56l=function(K){this.points.push(K)},zd.$57l=function(S){this.points=this.points.concat(S)};var Am=function(H,F){arguments.length>0&&this.$58l(H,F)},Pb=Am.prototype;Pb.$58l=function(N,E){this.x=N,this.y=E},Pb.add=function(l){return new Am(this.x+l.x,this.y+l.y)},Pb.addEquals=function(c){return this.x+=c.x,this.y+=c.y,this},Pb.$55l=function(J){return new Am(this.x*J,this.y*J)},Pb.eq=function(E){return this.x==E.x&&this.y==E.y},Pb.lt=function(u){return this.x<u.x&&this.y<u.y},Pb.lte=function(m){return this.x<=m.x&&this.y<=m.y},Pb.gt=function(Y){return this.x>Y.x&&this.y>Y.y},Pb.gte=function(L){return this.x>=L.x&&this.y>=L.y},Pb.lerp=function(c,$){return new Am(this.x+(c.x-this.x)*$,this.y+(c.y-this.y)*$)},Pb.distanceFrom=function(i){var p=this.x-i.x,R=this.y-i.y;return a(p*p+R*R)},Pb.min=function(B){return new Am(l(this.x,B.x),l(this.y,B.y))},Pb.max=function(h){return new Am(i(this.x,h.x),i(this.y,h.y))},Pb.toString=function(){return this.x+","+this.y};var qp=function(){this.$58l(arguments)},wi=qp.prototype;qp.TO=1e-6,qp.AC=6,wi.$58l=function(h){this.co=new Array;for(var x=h.length-1;x>=0;x--)this.co.push(h[x])},wi.$55l=function(T){for(var U=new qp,Y=0;Y<=this.$50l()+T.$50l();Y++)U.co.push(0);for(var Y=0;Y<=this.$50l();Y++)for(var A=0;A<=T.$50l();A++)U.co[Y+A]+=this.co[Y]*T.co[A];return U},wi.$59l=function(){for(var o=this.$50l();o>=0&&B(this.co[o])<=qp.TO;o--)this.co.pop()},wi.$50l=function(){return this.co.length-1},wi.$51l=function(){var T;switch(this.$59l(),this.$50l()){case 0:T=new Array;break;case 1:T=this.$52l();break;case 2:T=this.$53l();break;case 3:T=this.$54l();break;case 4:T=this.$63l();break;default:T=new Array}return T},wi.$52l=function(){var y=new Array,h=this.co[1];return 0!=h&&y.push(-this.co[0]/h),y},wi.$53l=function(){var C=new Array;if(2==this.$50l()){var g=this.co[2],W=this.co[1]/g,S=this.co[0]/g,v=W*W-4*S;if(v>0){var t=a(v);C.push(.5*(-W+t)),C.push(.5*(-W-t))}else 0==v&&C.push(.5*-W)}return C},wi.$63l=function(){var w=new Array;if(4==this.$50l()){var x=this.co[4],I=this.co[3]/x,o=this.co[2]/x,C=this.co[1]/x,W=this.co[0]/x,X=new qp(1,-o,I*C-4*W,-I*I*W+4*o*W-C*C).$54l(),J=X[0],$=I*I/4-o+J;if(B($)<=qp.TO&&($=0),$>0){var N=a($),U=3*I*I/4-N*N-2*o,T=(4*I*o-8*C-I*I*I)/(4*N),c=U+T,M=U-T;if(B(c)<=qp.TO&&(c=0),B(M)<=qp.TO&&(M=0),c>=0){var g=a(c);w.push(-I/4+(N+g)/2),w.push(-I/4+(N-g)/2)}if(M>=0){var g=a(M);w.push(-I/4+(g-N)/2),w.push(-I/4-(g+N)/2)}}else if(0>$);else{var T=J*J-4*W;if(T>=-qp.TO){if(0>T&&(T=0),T=2*a(T),U=3*I*I/4-2*o,U+T>=qp.TO){var O=a(U+T);w.push(-I/4+O/2),w.push(-I/4-O/2)}if(U-T>=qp.TO){var O=a(U-T);w.push(-I/4+O/2),w.push(-I/4-O/2)}}}}return w},wi.$54l=function(){var M=new Array;if(3==this.$50l()){var n=this.co[3],p=this.co[2]/n,E=this.co[1]/n,G=this.co[0]/n,O=(3*E-p*p)/3,S=(2*p*p*p-9*E*p+27*G)/27,N=p/3,W=S*S/4+O*O*O/27,F=S/2;if(B(W)<=qp.TO&&(W=0),W>0){var b,P,f=a(W);b=-F+f,P=b>=0?Z(b,1/3):-Z(-b,1/3),b=-F-f,b>=0?P+=Z(b,1/3):P-=Z(-b,1/3),M.push(P-N)}else if(0>W){var I=a(-O/3),h=u(a(-W),-F)/3,J=t(h),A=o(h),R=a(3);M.push(2*I*J-N),M.push(-I*(J+R*A)-N),M.push(-I*(J-R*A)-N)}else{var b;b=F>=0?-Z(F,1/3):Z(-F,1/3),M.push(2*b-N),M.push(-b-N)}}return M};var Cp=function(k,L){arguments.length>0&&this.$58l(k,L)},Aq=Cp.prototype;Aq.$58l=function(m,B){this.x=m,this.y=B},Aq.length=function(){return a(this.x*this.x+this.y*this.y)},Aq.$60l=function(B){return this.x*B.x+this.y*B.y};var cq=function(D,K,x,j){var V,u=(j.x-x.x)*(D.y-x.y)-(j.y-x.y)*(D.x-x.x),k=(K.x-D.x)*(D.y-x.y)-(K.y-D.y)*(D.x-x.x),T=(j.y-x.y)*(K.x-D.x)-(j.x-x.x)*(K.y-D.y);if(0!=T){var Z=u/T,A=k/T;Z>=0&&1>=Z&&A>=0&&1>=A?(V=new ic(e),V.points.push(new Am(D.x+Z*(K.x-D.x),D.y+Z*(K.y-D.y)))):V=new ic(m)}else V=0==u||0==k?new ic("C"):new ic("P");return V},Cb=function(L,h,b,$,j){var f,I,r,t,s,Q,c,z=$.min(j),n=$.max(j),k=new ic(m);f=h.$55l(-2),r=L.add(f.add(b)),f=L.$55l(-2),I=h.$55l(2),t=f.add(I),s=new Am(L.x,L.y),c=new Cp($.y-j.y,j.x-$.x),Q=$.x*j.y-j.x*$.y;for(var K=new qp(c.$60l(r),c.$60l(t),c.$60l(s)+Q).$51l(),g=0;g<K.length;g++){var F=K[g];if(F>=0&&1>=F){var V=L.lerp(h,F),E=h.lerp(b,F),O=V.lerp(E,F);$.x==j.x?z.y<=O.y&&O.y<=n.y&&(k.$62l=e,k.$56l(O)):$.y==j.y?z.x<=O.x&&O.x<=n.x&&(k.$62l=e,k.$56l(O)):O.gte(z)&&O.lte(n)&&(k.$62l=e,k.$56l(O))}}return k},Eo=function(j,R,a,v,X){var V=v.min(X),I=v.max(X),U=new Am(I.x,V.y),W=new Am(V.x,I.y),F=Cb(j,R,a,V,U),r=Cb(j,R,a,U,I),w=Cb(j,R,a,I,W),J=Cb(j,R,a,W,V),f=new ic(m);return f.$57l(F.points),f.$57l(r.points),f.$57l(w.points),f.$57l(J.points),f.points.length>0&&(f.$62l=e),f},Nm=function(M,t,L,i,v,y){var W,G,s,g,w,o,S,q,N,r,P=v.min(y),H=v.max(y),k=new ic(m);W=M.$55l(-1),G=t.$55l(3),s=L.$55l(-3),g=W.add(G.add(s.add(i))),w=new Cp(g.x,g.y),W=M.$55l(3),G=t.$55l(-6),s=L.$55l(3),g=W.add(G.add(s)),o=new Cp(g.x,g.y),W=M.$55l(-3),G=t.$55l(3),s=W.add(G),S=new Cp(s.x,s.y),q=new Cp(M.x,M.y),r=new Cp(v.y-y.y,y.x-v.x),N=v.x*y.y-y.x*v.y;for(var U=new qp(r.$60l(w),r.$60l(o),r.$60l(S),r.$60l(q)+N).$51l(),Z=0;Z<U.length;Z++){var c=U[Z];if(c>=0&&1>=c){var Q=M.lerp(t,c),z=t.lerp(L,c),D=L.lerp(i,c),B=Q.lerp(z,c),b=z.lerp(D,c),T=B.lerp(b,c);v.x==y.x?P.y<=T.y&&T.y<=H.y&&(k.$62l=e,k.$56l(T)):v.y==y.y?P.x<=T.x&&T.x<=H.x&&(k.$62l=e,k.$56l(T)):T.gte(P)&&T.lte(H)&&(k.$62l=e,k.$56l(T))}}return k},cm=function(a,p,w,U,F,h){var s=F.min(h),z=F.max(h),D=new Am(z.x,s.y),I=new Am(s.x,z.y),V=Nm(a,p,w,U,s,D),K=Nm(a,p,w,U,D,z),Z=Nm(a,p,w,U,z,I),l=Nm(a,p,w,U,I,s),L=new ic(m);return L.$57l(V.points),L.$57l(K.points),L.$57l(Z.points),L.$57l(l.points),L.points.length>0&&(L.$62l=e),L},Im=function(V,i,q,K){var k=q.min(K),n=q.max(K),P=new Am(n.x,k.y),a=new Am(k.x,n.y),E=cq(k,P,V,i),B=cq(P,n,V,i),U=cq(n,a,V,i),l=cq(a,k,V,i),L=new ic(m);return L.$57l(E.points),L.$57l(B.points),L.$57l(U.points),L.$57l(l.points),L.points.length>0&&(L.$62l=e),L},Ok=T.XEditInteractor=function(u){var r=this,w=r._view=document.createElement("canvas");w.className="editCanvas",w.style.position="absolute",Ok.superClass.constructor.call(r,u)};X.def(Ok,T.Interactor,{ms_edit:1,setUp:function(){var V=this,N=V.gv,O=N.getView(),w=V._view;Ok.superClass.setUp.call(V),N.setEditInteractor(V),N.$14l=w,N._79O?O.insertBefore(w,N._79O):O.appendChild(w);var u=V.$49l=V.$11l.bind(V);N.dm().md(u),N.sm().ms(u),N.mp(u)},tearDown:function(){var b=this,f=b.gv,M=f.getView(),w=b.$49l;Ok.superClass.tearDown.call(b),f.setEditInteractor(h),f.$14l=h,M.removeChild(b._view),f.dm().umd(w),f.sm().ums(w),f.ump(w)},clear:function(){var f=this,m=f.gv;delete f._hoverSegmentIndex,delete f._edge,delete f._shape,delete m._editing,delete f.$10l,delete f.$13l,delete f.$9l,delete f._removePointIndex,delete f._lp,f.$12l="",delete f.$40l,delete f.$67l,delete f.$72l,delete f.$73l,delete f.$75l,delete f.$1l,delete f.$3l,delete f.$2l,delete f.$92l,delete f.$93l,delete f.$94l,f.clearDragging()},handle_keydown:function(e){this.$48l!==e.shiftKey&&(this.$48l=e.shiftKey,this.handle_mousemove(e,Y,!0))},handle_keyup:function($){this.$48l!==$.shiftKey&&(this.$48l=$.shiftKey,this.handle_mousemove($,Y,!0))},handle_touchstart:function(s){this.handle_mousemove(s),this.handle_mousedown(s)},handle_mousedown:function(I){Q(I);var B=this,h=B.$13l,w=B.gv,K=w.dm(),m=w.sm(),d=w.getZoom(),R=w.lp(I),W=X.isDoubleClick(I),F=X.isLeftButton(I),u=B.$7l,J=B._shape,V=B._hoverSegmentIndex,C=B._edge,k=B.$87l,t=B.$88l,a=function(){B._68I||k===B.$87l&&t===B.$88l||B.$43l()};if(7!==B.$67l&&(delete B.$87l,delete B.$88l),F&&(J||C)&&V>=0&&W&&(J&&m.contains(J)||C&&m.contains(C))){var N=vn.call(B,J||C,V,R);return B.addShapePoint(J||C,V,N),S(function(){B.handle_mousemove(I)},40),void 0}if(F&&(J||C)&&B._removePointIndex>=0&&W)return B.removeShapePoint(),B.$5l=1,S(function(){B.handle_mousemove(I)},40),void 0;if(!F||!w._editing)return a(),void 0;if(J&&h>=0){var v=J.getPoints().get(h),p=J.p(),x=Vc(p,v.x-p.x,v.y-p.y,-u+J.getRotation());Z=Vc(p,R.x-p.x,R.y-p.y,-u),B.$24l={x:Z.x-x.x,y:Z.y-x.y},B.startDragging(I),K.beginTransaction(),B.fi({kind:"beginEditPoint",event:I,data:J,index:h}),B.$88l=h,B.$87l=J}else if(B.$10l){var y=w.sm().getSelection(),g=B.$6l,o=B.$1l={},e=B.$3l={},O=B.$16l[H[B.$10l]],i={x:g.x,y:g.y},D={x:g.x+g.width/2,y:g.y+g.height/2};B.$24l={x:R.x-O.x/d,y:R.y-O.y/d},B.$2l=z(B.$8l),B.$4l=z(g),y.each(function(r){if(r instanceof b){var h=r.p(),O=r.getWidth(),_=r.getHeight(),v=Vc(D,h.x-D.x,h.y-D.y,-u);o[r.getId()]={x:h.x-O/2,y:h.y-_/2,width:O,height:_},e[r.getId()]={x:(v.x-i.x)/g.width,y:(v.y-i.y)/g.height}}}),B.startDragging(I),K.beginTransaction(),B.fi({kind:"beginEditRect",event:I,direction:B.$10l})}else if(C&&h>=0){var r=Wg(w.getDataUI(C),C.s("edge.points")),v=r.get(h);B.$24l={x:R.x-v.x,y:R.y-v.y},B.startDragging(I),K.beginTransaction(),B.fi({kind:"beginEditPoint",event:I,data:C,index:h}),B.$88l=h,B.$87l=C}else if(B.$40l){var g=B.$6l,D={x:g.x+g.width/2,y:g.y+g.height/2},_=z(B.$23l);_.x/=d,_.y/=d;var q=Vc(D,_.x-D.x,_.y-D.y,-u),Z=Vc(D,R.x-D.x,R.y-D.y,-u);B.$24l={x:Z.x-q.x,y:Z.y-q.y},B.startDragging(I),K.beginTransaction(),B.fi({kind:"beginEditRotation",event:I,data:B._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(B.$67l)>=0){var L=B.$67l;(7===L||8===L||9===L)&&K.beginTransaction(),B.startDragging(I)}else if(B.$71l&&W&&B.$79l(B.$71l,R)){var n=m.toSelection();K.beginTransaction(),n.each(function(N){K.remove(N)}),K.endTransaction()}a()},$11l:function(){var _=this,Y=_.gv;Y._editing&&(_.$13l==h||_._shape==h&&_._edge==h)&&(_.$73l==h||1!==_.$67l&&5!==_.$67l&&6!==_.$67l)||(_.$5l=1),_._68I=1},$46l:function(D){var k=this,o=k.gv,r=o.lp(D),z=[];return sl(o,function(N){var i=o.getDataUI(N);if(i){var O=i._79o();v(O,r)&&z.push(N)}}),z},$47l:function(h){var W=this,R=W.$13l,t=W.gv.dm();W.$10l?(W.fi({kind:"endEditRect",event:h,direction:W.$10l}),t.endTransaction()):W._shape&&R>=0?(W.fi({kind:"endEditPoint",event:h,data:W._shape,index:R}),t.endTransaction()):W._edge&&R>=0?(W.fi({kind:"endEditPoint",event:h,data:W._edge,index:R}),t.endTransaction()):W.$23l&&W.$40l&&(W.fi({kind:"endEditRotation",event:h}),t.endTransaction())},handleWindowTouchEnd:function(f){this.handleWindowMouseUp(f)},handleWindowMouseUp:function(w){var Q=this,r=Q.gv,m=r.dm(),P=Q._shape,n=Q._edge,f=Q.$13l,T=Q.$40l,U=Q.$9l,d=Q.$10l,_=Q.$67l;if((P||n)&&f>=0&&U>=0){var R,s;if(P){var B=P.p(),x=P.getRotation();R=P.getPoints(),s=R.get(U),Vn(P,B,x,f,s,!1)}else if(R=Wg(r.getDataUI(n),n.s("edge.points"),!0),s=R.get(U),0===f){var p=R.get(0);n.s("edge.source.offset.x",s.x-p.x),n.s("edge.source.offset.y",s.y-p.y)}else if(f===R.size()-1){var L=R.get(R.size()-1);n.s("edge.target.offset.x",s.x-L.x),n.s("edge.target.offset.y",s.y-L.y)}else"points"===n.s("edge.type")&&(R.set(f,s),n.s("edge.points",ac(R)))}Q.$47l(w);var a=Q.$73l;1===_?(m.beginTransaction(),a?r.sm().each(function(U){if(U.setHost&&r.isHelperEditable(U,"host")){U.setHost(a);
var S=Q.$75l,v=Q.$74l;S&&(U.s("attach.row.index",S.rowIndex),U.s("attach.column.index",S.columnIndex)),v&&(U.s("attach.index",v.attachIndex),U.s("attach.offset",v.attachOffset),U.s("attach.offset.relative",!1),U.s("attach.offset.opposite",!1))}}):r.sm().each(function(J){J.setHost&&r.isHelperEditable(J,"host")&&(J.setHost(h),J.s("attach.row.index",Y),J.s("attach.column.index",Y),J.s("attach.index",Y),J.s("attach.offset",Y),J.s("attach.offset.relative",!1),J.s("attach.offset.opposite",!1))}),m.endTransaction()):2===_?(m.beginTransaction(),a?r.sm().each(function(D){D.setParent&&r.isHelperEditable(D,"parent")&&D.setParent(a)}):r.sm().each(function(G){G.setParent&&r.isHelperEditable(G,"parent")&&G.setParent(h)}),m.endTransaction()):3===_?a&&(m.beginTransaction(),r.sm().each(function(E){if(r.isHelperEditable(E,"edge")&&E instanceof b&&a instanceof b){var y=new C.Edge;m.add(y),y.setSource(E),y.setTarget(a),Q.onEdgeCreated&&Q.onEdgeCreated(w,y)}}),m.endTransaction()):5===_||6===_?a&&(m.beginTransaction(),r.sm().each(function(t){t instanceof g&&a instanceof b&&(5===_&&r.isHelperEditable(t,"source")?t.setSource(a):6===_&&r.isHelperEditable(t,"source")&&t.setTarget(a))}),m.endTransaction()):(7===_||8===_||9===_)&&m.endTransaction(),(d||T)&&Q.$43l(!0),$?(Q.clear(),delete Q.$64l,Q._68I||Q.$43l()):(Q.handle_mousemove(w,!0),_&&!Q._68I&&Q.$43l())},handleWindowTouchMove:function(r){this.handleWindowMouseMove(r)},handleWindowMouseMove:function(j){this._78I(j)},handle_mousemove:function(z,s,u){if(!this._pause){if(!u){var o=$?rr(z):z;this.$61l={clientX:o.clientX,clientY:o.clientY}}if(s===!0||!V()){var x=this,w=x.gv,m=!1,G=h;x.clear(),w.sm().size()>0&&(G=w.lp(u?x.$61l:z),m=x._79I(z,G)),m&&(w._editing=1),x.$12l!==x.$65l&&(x.$65l=x.$12l,x.setCursor(x.$12l)),x.$40l!==x.$64l&&(x.$64l=x.$40l,x._68I||x.$43l()),x._hoverSegmentIndex!==x.$66l&&(x.$66l=x._hoverSegmentIndex,x._68I||x.$43l())}}},_78I:function(l){this.autoScroll(l);var C=this,w=C.gv,s=w.lp(l),e=w.getZoom(),L=C.$13l;if((C._shape||C._edge)&&L>=0){var i,H,R,o=C._shape,I=C._edge,N=C.$24l,n=w.getPointSnapSpacing(),A=function(N,L){return n==h||isNaN(n)?{x:N,y:L}:{x:q(N/n)*n,y:q(L/n)*n}};if(o){i=o.getPoints();var p=o.p(),Y=o.getRotation(),F=0;H=Vc(p,s.x-p.x,s.y-p.y,-Y),Vn(o,p,Y,L,s,!0,N,A),C.fi({kind:"betweenEditPoint",event:l,data:o,index:L})}else if(I){i=Wg(w.getDataUI(I),I.s("edge.points"),!0),s.x-=N.x,s.y-=N.y,H=s;var v,m,d=I.s("edge.offset"),T=i.size(),_=T>2;if(0===L){var O=i.get(0);d&&(O=To(O,i.get(1),-d,_),s=To(s,i.get(1),-d,_)),v=s.x-O.x,m=s.y-O.y,R=A(v,m),I.s("edge.source.offset.x",R.x),I.s("edge.source.offset.y",R.y)}else if(L===T-1){var V=i.get(T-1);d&&(V=To(V,i.get(T-2),-d,_),s=To(s,i.get(T-2),-d,_)),v=s.x-V.x,m=s.y-V.y,R=A(v,m),I.s("edge.target.offset.x",R.x),I.s("edge.target.offset.y",R.y)}else"points"===I.s("edge.type")&&(R=A(s.x,s.y),R.e=i.get(L).e,i.set(L,R),I.s("edge.points",ac(i)));C.fi({kind:"betweenEditPoint",event:l,data:I,index:L})}if(delete C.$9l,w.isSnapPoint(o)||w.isSnapPoint(I))for(F=0;F<i.size();F++)if(F!==L){var U=i.get(F);if(k(U,H)<w.getEditPointSize()/e){C.$9l=F;break}}}else if(C.$10l){var N=C.$24l;s.x-=N.x,s.y-=N.y;var z=w.sm().getSelection(),G=C.$1l,r=C.$7l,t=C.$10l,Q=C.$4l,x=C.$2l,J=w.getEditRectPadding()/e,Z=2*J,E=w.getSnapSpacing(),W=E!=h&&!isNaN(E),$=hf(x,s,t,r,2*J,w.getResizeMode(),W,!0),f=C.$6l;if(W){var D=$.width-Z,y=$.height-Z,P=q(D/E)*E,oo=q(y/E)*E,bm=P-D,Ib=oo-y;("west"===t||"northwest"===t||"southwest"===t)&&(bm=-bm),("north"===t||"northwest"===t||"northeast"===t)&&(Ib=-Ib),$=hf(x,s,t,r,2*J,w.getResizeMode(),W,!1,bm,Ib)}C.$8l=$,f.x=$.x+J,f.y=$.y+J,f.width=$.width-Z,f.height=$.height-Z;var el=$.x+$.width/2,fm=$.y+$.height/2,Qm=f.x,Lh=f.y,gb=f.width/Q.width,xs=f.height/Q.height;z.each(function(q){if(q instanceof b&&w.isEditable(q)&&w.isRectEditable(q)){var l=G[q.getId()],J=C.$3l[q.getId()],Y={x:l.x+l.width/2,y:l.y+l.height/2},W=0,m=0,v=t,F=180*B(r-q.getRotation())/c;"northeast"===t?F>=315||45>F?(W=l.width*gb+l.x,m=l.height*(1-xs)+l.y,v="northeast"):F>=45&&135>F?(W=l.width*(1-xs)+l.x,m=l.height*(1-gb)+l.y,v="northwest"):F>=135&&225>F?(W=l.width*(1-gb)+l.x,m=l.height*xs+l.y,v="southwest"):(W=l.width*xs+l.x,m=l.height*gb+l.y,v="southeast"):"north"===t?F>=315||45>F?(m=l.height*(1-xs)+l.y,v="north"):F>=45&&135>F?(W=l.width*(1-xs)+l.x,v="west"):F>=135&&225>F?(m=l.height*xs+l.y,v="south"):(W=l.width*xs+l.x,v="east"):"northwest"===t?F>=315||45>F?(W=l.width*(1-gb)+l.x,m=l.height*(1-xs)+l.y,v="northwest"):F>=45&&135>F?(W=l.width*(1-xs)+l.x,m=l.height*gb+l.y,v="southwest"):F>=135&&225>F?(W=l.width*gb+l.x,m=l.height*xs+l.y,v="southeast"):(W=l.width*xs+l.x,m=l.height*(1-gb)+l.y,v="northeast"):"west"===t?F>=315||45>F?(W=l.width*(1-gb)+l.x,v="west"):F>=45&&135>F?(m=l.height*gb+l.y,v="south"):F>=135&&225>F?(W=l.width*gb+l.x,v="east"):(m=l.height*(1-gb)+l.y,v="north"):"southwest"===t?F>=315||45>F?(W=l.width*(1-gb)+l.x,m=l.height*xs+l.y,v="southwest"):F>=45&&135>F?(W=l.width*xs+l.x,m=l.height*gb+l.y,v="southeast"):F>=135&&225>F?(W=l.width*gb+l.x,m=l.height*(1-xs)+l.y,v="northeast"):(W=l.width*(1-xs)+l.x,m=l.height*(1-gb)+l.y,v="northwest"):"east"===t?F>=315||45>F?(W=l.width*gb+l.x,v="east"):F>=45&&135>F?(m=l.height*(1-gb)+l.y,v="north"):F>=135&&225>F?(W=l.width*(1-gb)+l.x,v="west"):(m=l.height*gb+l.y,v="south"):"south"===t?F>=315||45>F?(m=l.height*xs+l.y,v="south"):F>=45&&135>F?(W=l.width*xs+l.x,v="east"):F>=135&&225>F?(m=l.height*(1-xs)+l.y,v="north"):(W=l.width*(1-xs)+l.x,v="west"):"southeast"===t&&(F>=315||45>F?(W=l.width*gb+l.x,m=l.height*xs+l.y,v="southeast"):F>=45&&135>F?(W=l.width*xs+l.x,m=l.height*(1-gb)+l.y,v="northeast"):F>=135&&225>F?(W=l.width*(1-gb)+l.x,m=l.height*(1-xs)+l.y,v="northwest"):(W=l.width*(1-xs)+l.x,m=l.height*gb+l.y,v="southwest"));var o=Vc(Y,W-Y.x,m-Y.y,q.getRotation());pf(q,l,v,{x:o.x,y:o.y});var s=Qm+f.width*J.x,K=Lh+f.height*J.y,M={x:s,y:K};M=Vc({x:el,y:fm},M.x-el,M.y-fm,r),q.p(M.x,M.y)}}),C.fi({kind:"betweenEditRect",event:l,direction:t})}else if(C.$23l&&C.$40l){var Ro=C.$8l,ck=Ro.width,cf=Ro.height,p={x:Ro.x+ck/2,y:Ro.y+cf/2},N=C.$24l,mo=C.$23l,Pn=mo.x/e-p.x,yh=mo.y/e-p.y,am=a(Pn*Pn+yh*yh),Qi=Math.asin(N.x/am),Wn=w.sm().getSelection(),ij=K+u(s.y-p.y,s.x-p.x)-Qi,Nb=w.getSnapAngle(),ij=q(ij/Nb)*Nb;0>ij&&(ij+=M);var Li=ij-C.$7l,kp=[p.x,0,p.y];Wn.each(function(S){if(w.isEditable(S)&&w.isRotationEditable(S)&&w.isVisible(S)){var e=Wq(S.p3(),kp),D=Sd();yd(D,-Li),S.setRotation(S.getRotation()+Li),Dg(e,D),S.p3(kp[0]+e[0],kp[1]+e[1],kp[2]+e[2])}}),C.$7l=ij,C.fi({kind:"betweenEditRotation",event:l})}else if([1,2,3,5,6].indexOf(C.$67l)>=0)C.$72l=l,C.$78l||(C.$78l=1,S(function(){X.isDragging()&&C.$43l(),delete C.$78l},12));else if(7===C.$67l){if(C.$87l instanceof j){var o=C.$87l,gh=C.$88l,$g=X.clone(o.getPoints().get(gh)),hb=s.y-$g.y;$g.e||($g.e=0),C.$92l||(C.$92l=$g.e),$g.e=C.$92l-hb,o.setPoint(gh,$g)}else if(C.$87l instanceof g){var I=C.$87l,gh=C.$88l,i=Wg(w.getDataUI(I),I.s("edge.points")),$g=i.get(gh),hb=s.y-$g.y;$g.e||($g.e=0),C.$92l||(C.$92l=$g.e),$g.e=C.$92l-hb,i.set(gh,$g),I.s("edge.points",ac(i))}}else if(8===C.$67l){var Wn=w.sm().getSelection(),Bc=C.$93l;Bc||(Bc=C.$93l={}),Wn.each(function(j){if(j.p3){var q=j.p3(),i=Bc[j.getId()];i==h&&(i=Bc[j.getId()]=q[1]),j.p3([q[0],i-(s.y-C.$90l.y/e),q[2]])}})}else if(9===C.$67l){var Wn=w.sm().getSelection(),Ih=C.$94l;Ih||(Ih=C.$94l={}),Wn.each(function(I){if(I.s3){var V=I.s3(),W=Ih[I.getId()];W==h&&(W=Ih[I.getId()]=V[1]);var c=W-(s.y-C.$91l.y/e);0>c&&(c=.01),I.s3([V[0],c,V[2]])}})}},$79l:function(K,J){var p=this,A=p.gv,b=A.getZoom(),w=A.getEditHelperSize(),s=K.x/b,f=K.y/b,V=w/b,j=V/2;return v({x:s-j,y:f-j,width:V,height:V},J)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(I,h){for(var D=this,E=D.gv,V=E.getZoom(),S=E.getEditPointSize(),p=S/V,N=p/2,W=D.$46l(I),q=0;q<W.length;q++){var G,C,m=W[q],Y=E.getDataUI(m);if(Y&&Y._55O){var k=Y._55O;if(k._43O&&m instanceof g){if(G=m.s("edge.points"),G=Wg(Y,G),C=m.s("edge.segments"),C&&C.size()||(C=df(G)),D.$42l(m,h,G._as,C,"edge"))return!0;if("points"===m.s("edge.type")&&D.$41l(m,h,G._as,C,"edge"))return}if(k._43O&&m instanceof j&&k.$15l&&k.$15l.length===m.getPoints().size()){if(G=k.$15l,C=m.getSegments(),C&&C.size()||(C=df(G)),D.$42l(m,h,G,C,"shape"))return!0;if(D.$41l(m,h,G,C,"shape"))return}}}if(D.$16l){var G,x=D.$16l,f=x[3].x-x[7].x,Q=x[3].y-x[7].y,r=a(f*f+Q*Q),U=x[1].x-x[5].x,z=x[1].y-x[5].y,A=a(U*U+z*z),B={x:h.x*V,y:h.y*V};if(D._80I(B,0,x[0],"northwest",r,A)||D._80I(B,1,x[1],"north",r,A)||D._80I(B,2,x[2],"northeast",r,A)||D._80I(B,7,x[7],"west",r,A)||D._80I(B,3,x[3],"east",r,A)||D._80I(B,6,x[6],"southwest",r,A)||D._80I(B,5,x[5],"south",r,A)||D._80I(B,4,x[4],"southeast",r,A))return!0}if(D.$23l){var t=D.$23l,X=t.x/V,s=t.y/V;if(v({x:X-N,y:s-N,width:p,height:p},h))return D.$40l=1,D.$12l=D.getHelperCursor("rotation")||"crosshair",!0}return D.$68l&&D.$79l(D.$68l,h)?(D.$67l=1,D.$12l=D.getHelperCursor("host")||"crosshair",!0):D.$69l&&D.$79l(D.$69l,h)?(D.$67l=2,D.$12l=D.getHelperCursor("parent")||"crosshair",!0):D.$70l&&D.$79l(D.$70l,h)?(D.$67l=3,D.$12l=D.getHelperCursor("edge")||"crosshair",!0):D.$71l&&D.$79l(D.$71l,h)?(D.$67l=4,D.$12l=D.getHelperCursor("remove")||"crosshair",!0):D.$82l&&D.$79l(D.$82l,h)?(D.$67l=5,D.$12l=D.getHelperCursor("source")||"crosshair",!0):D.$83l&&D.$79l(D.$83l,h)?(D.$67l=6,D.$12l=D.getHelperCursor("target")||"crosshair",!0):D._pointElevationHelperPoint&&D.$79l(D._pointElevationHelperPoint,h)?(D.$67l=7,D.$12l=D.getHelperCursor("pointElevation")||"crosshair",!0):D.$90l&&D.$79l(D.$90l,h)?(D.$67l=8,D.$12l=D.getHelperCursor("elevation")||"crosshair",!0):D.$91l&&D.$79l(D.$91l,h)?(D.$67l=9,D.$12l=D.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(g,K,E,x,l,C){var y=this,z=y.gv,q=z.getEditPointSize(),V=q/2,w=z.sm(),A=z.isDirectionEditable;if(A&&1===w.size()){var B=w.ld();if(A=A.bind(z),B instanceof b){if(!A(B,x))return!1;if("east"===x){if(A(B,"northeast")&&A(B,"southeast")&&2*q>=C)return!1}else if("west"===x){if(A(B,"northwest")&&A(B,"southwest")&&2*q>=C)return!1}else if("north"===x){if(A(B,"northwest")&&A(B,"northeast")&&2*q>=l)return!1}else if("south"===x&&A(B,"southwest")&&A(B,"southeast")&&2*q>=l)return!1}}else{if(2*q>=l&&("north"===x||"south"===x))return!1;if(2*q>=C&&("east"===x||"west"===x))return!1}if(v({x:E.x-V,y:E.y-V,width:q,height:q},g)){if(y.$10l!==x){var s=180*y.$7l/c,j="";s>=337.5||22.5>s?j="north":s>=22.5&&67.5>s?j="northeast":s>=67.5&&112.5>s?j="east":s>=112.5&&157.5>s?j="southeast":s>=157.5&&202.5>s?j="south":s>=202.5&&247.5>s?j="southwest":s>=247.5&&292.5>s?j="west":s>=292.5&&337.5>s&&(j="northwest");var t=Vi.indexOf(j),j=Vi[K-(1-t)+8];switch(j){case"northwest":y.$12l="nwse-resize";break;case"northeast":y.$12l="nesw-resize";break;case"southwest":y.$12l="nesw-resize";break;case"southeast":y.$12l="nwse-resize";break;case"north":y.$12l="ns-resize";break;case"east":y.$12l="ew-resize";break;case"south":y.$12l="ns-resize";break;case"west":y.$12l="ew-resize"}y.$10l=x}return!0}return!1},$42l:function(Y,G,s,R,i){var L,y=this,u=y.gv,H=u.getEditPointSize(),w=H/u.getZoom(),S=-1,d={x:G.x,y:G.y,width:0,height:0},D=function(H){"shape"===i?y._shape=Y:y._edge=Y,y._removePointIndex=H},b=function(L){"shape"===i?y._shape=Y:y._edge=Y,y.$13l=L,y.$12l="crosshair"};for(p(d,w/2),S=s.length-1,L=R.size()-1;L>=0;L--){var I=R.get(L);if(1===I||2===I)S-=1;else if(3===I){var P=s[S-1];if(v(d,P))return b(S-1),!0;S-=2}else if(4===I){var e=s[S-1],T=s[S-2];if(v(d,e))return b(S-1),!0;if(v(d,T))return b(S-2),!0;S-=3}}for(S=s.length-1,L=R.size()-1;L>=0;L--){var I=R.get(L),t=s[S];if(v(d,t))return D(S),b(S),!0;1===I||2===I?S-=1:3===I?S-=2:4===I&&(S-=3)}return!1},$41l:function(V,s,L,H,n){var g=this,T=g.gv,f=-1,l=0,U={x:s.x,y:s.y,width:0,height:0},K=function(v,e){g._hoverSegmentIndex=e,g._lp=s,"shape"===n?g._shape=V:g._edge=V};for(p(U,T.getSegmentHoverWidth()/2/T.getZoom()),V instanceof j&&V.isClosePath()&&H.indexOf(5)<0&&(H=new w(H._as),H.add(5));l<H.size();l++){var F=H.get(l);if(1===F){var $=L[f],k=L[f+1];if($){var G=Im(new Am($.x,$.y),new Am(k.x,k.y),new Am(U.x,U.y),new Am(U.x+U.width,U.y+U.height));if(G.$62l===e&&G.points.length>0)return K(G,l),!0}f+=1}else if(2===F){var $=L[f],k=L[f+1],G=Im(new Am($.x,$.y),new Am(k.x,k.y),new Am(U.x,U.y),new Am(U.x+U.width,U.y+U.height));if(G.$62l===e&&G.points.length>0)return K(G,l),!0;f+=1}else if(3===F){var $=L[f],d=L[f+1],x=L[f+2],G=Eo(new Am($.x,$.y),new Am(d.x,d.y),new Am(x.x,x.y),new Am(U.x,U.y),new Am(U.x+U.width,U.y+U.height));if(G.$62l===e)return K(G,l),!0;f+=2}else if(4===F){var $=L[f],A=L[f+1],W=L[f+2],x=L[f+3],G=cm(new Am($.x,$.y),new Am(A.x,A.y),new Am(W.x,W.y),new Am(x.x,x.y),new Am(U.x,U.y),new Am(U.x+U.width,U.y+U.height));if(G.$62l===e)return K(G,l),!0;f+=3}else if(5===F){var $=L[f],k=L[0];if($){var G=Im(new Am($.x,$.y),new Am(k.x,k.y),new Am(U.x,U.y),new Am(U.x+U.width,U.y+U.height));if(G.$62l===e&&G.points.length>0)return K(G,l),!0}}}return!1},addShapePoint:function(t,v,A){var o=this,X=o.gv,x=X.dm();if(x.beginTransaction(),0===arguments.length&&(t=o._shape||o._edge,v=o._hoverSegmentIndex,A=o._lp),t instanceof j||t instanceof g){var r=hl(t,X.getDataUI(t),v);if(!isNaN(v)&&A&&!isNaN(r)){var m=A;if(t instanceof j){var Z=t.p(),F=t.getRotation(),R=t.toSegments();R&&R.size()||(R=df(t.getPoints())),t.isClosePath()&&R.indexOf(5)<0&&(R=new w(R._as),R.add(5));var K=R.get(v),S="addPoint",y="removePointAt";if(2===K||1===K){var a={x:m.x,y:m.y};R.add(K,v),a=Vc(Z,a.x-Z.x,a.y-Z.y,-F),t[S](a,r+1)}else if(3===K){var q=t.getPoints(),s=q.get(r),C=q.get(r+2),a={x:m.x,y:m.y};a=Vc(Z,a.x-Z.x,a.y-Z.y,-F);var J=lc(s,a),p=lc(a,C);R.removeAt(v),R.add(3,v),R.add(3,v),t.setPoint(r+1,a),t[S](p,r+2),t[S](J,r+1)}else if(4===K){var q=t.getPoints(),s=q.get(r),C=q.get(r+3),a={x:m.x,y:m.y};a=Vc(Z,a.x-Z.x,a.y-Z.y,-F);var J=kl(s,a),p=Wr(s,a),O=kl(a,C),k=Wr(a,C);R.removeAt(v),R.add(4,v),R.add(4,v),t[y](r+1),t[y](r+1),t[S](a,r+1),t[S](k,r+2),t[S](O,r+2),t[S](p,r+1),t[S](J,r+1)}else if(5===K){var a={x:m.x,y:m.y};R.add(2,v),a=Vc(Z,a.x-Z.x,a.y-Z.y,-F),t[S](a,r+1)}t.isClosePath()&&R.remove(5),t.setSegments(R);var W=t.getWidth(),I=t.getHeight(),h=t.p().x-W/2,l=t.p().y-I/2;h-=Z.x,l-=Z.y;var d=mm(t,{x:h,y:l,width:W,height:I},F,Z);t.p(d.x,d.y)}else if(t instanceof g){if("points"!==t.s("edge.type"))return x.endTransaction(),void 0;var q=t.s("edge.points");R=t.s("edge.segments"),q=Wg(X.getDataUI(t),q),R&&R.size()||(R=df(q)),R=new w(R._as.slice(0)),q=new w(q._as.slice(0));var K=R.get(v);if(2===K||1===K){var a={x:m.x,y:m.y};R.add(K,v),q.add(a,r+1)}else if(3===K){var s=q.get(r),C=q.get(r+2),a={x:m.x,y:m.y},J=lc(s,a),p=lc(a,C);R.removeAt(v),R.add(3,v),R.add(3,v),q.set(r+1,a),q.add(p,r+2),q.add(J,r+1)}else if(4===K){var s=q.get(r),C=q.get(r+3),a={x:m.x,y:m.y},J=kl(s,a),p=Wr(s,a),O=kl(a,C),k=Wr(a,C);R.removeAt(v),R.add(4,v),R.add(4,v),q.removeAt(r+1),q.removeAt(r+1),q.add(a,r+1),q.add(k,r+2),q.add(O,r+2),q.add(p,r+1),q.add(J,r+1)}t.s("edge.points",ac(q)),t.s("edge.segments",R)}}}x.endTransaction()},removeShapePoint:function(C,n){var P=this,b="removeAt",B=P.gv,e=B.dm();if(e.beginTransaction(),0===arguments.length&&(C=P._shape||P._edge,n=P._removePointIndex),n>=0&&(C instanceof j||C instanceof g)){var M=Pn(C,P.gv.getDataUI(C),n),v=n;if(C instanceof j){var X=C.p(),L=C.toSegments();L&&L.size()||(L=df(C.getPoints()));var c=L.get(M),V="removePointAt";if(1===c&&0===v)if(C.getPoints().size()>1){var R=L.get(M+1);L[b](M+1),3===R?C[V](v+1):4===R&&(C[V](v+2),C[V](v+1)),C[V](v)}else C.dm().remove(C);else 2===c||1===c?(L[b](M),C[V](v)):3===c?(L[b](M),C[V](v),C[V](v-1)):4===c&&(L[b](M),C[V](v),C[V](v-1),C[V](v-2));C.setSegments(L);var u=C.getWidth(),H=C.getHeight(),a=C.p().x-u/2,J=C.p().y-H/2;a-=X.x,J-=X.y;var Z=mm(C,{x:a,y:J,width:u,height:H},C.getRotation(),X);C.p(Z.x,Z.y)}else if(C instanceof g){if("points"!==C.s("edge.type"))return e.endTransaction(),void 0;var k=C.s("edge.points");if(L=C.s("edge.segments"),k&&(k=Wg(P.gv.getDataUI(C),k),L&&L.size()||(L=df(k))),0===n||n===k.size()-1)return e.endTransaction(),void 0;L=new w(L._as.slice(0)),k=new w(k._as.slice(0));var c=L.get(M);2===c||1===c?(L[b](M),k[b](v)):3===c?(L[b](M),k[b](v),k[b](v-1)):4===c&&(L[b](M),k[b](v),k[b](v-1),k[b](v-2)),C.s("edge.segments",L),C.s("edge.points",ac(k))}}e.endTransaction()},changeShapeSegment:function(C,$,d){var A=this,U=A.gv,x=U.dm();if(x.beginTransaction(),1!==arguments.length||isNaN(C)||(d=C,C=A._shape||A._edge,$=A._hoverSegmentIndex),C instanceof j||C instanceof g){var T=hl(C,A.gv.getDataUI(C),$);if(!isNaN($)&&!isNaN(T))if(C instanceof j){var n=C.p(),M=C.toSegments();M&&M.size()||(M=df(C.getPoints()));var B=M.get($),Y=C.toPoints();if(1===d||2===d)1===B||2===B?M.set($,d):3===B?(M.set($,d),Y.removeAt(T+1)):4===B&&(M.set($,d),Y.removeAt(T+1),Y.removeAt(T+1));else if(3===d){var q=function(){var R=Y.get(T),_=Y.get(T+1),y=lc(R,_);M.set($,3),Y.add(y,T+1)};2===B||1===B?q():4===B&&(Y.removeAt(T+1),Y.removeAt(T+1),q())}else if(4===d){var S=function(){var e=Y.get(T),w=Y.get(T+1),H=kl(e,w),D=Wr(e,w);M.set($,4),Y.add(H,T+1),Y.add(D,T+2)};2===B||1===B?S():3===B&&(Y.removeAt(T+1),S())}C.setSegments(M),C.setPoints(Y);var e=C.getWidth(),Z=C.getHeight(),R=C.p().x-e/2,u=C.p().y-Z/2;R-=n.x,u-=n.y;var y=new mm(C,{x:R,y:u,width:e,height:Z},C.getRotation(),n);C.p(y.x,y.y)}else if(C instanceof g){if("points"!==C.s("edge.type"))return x.endTransaction(),void 0;var Y=C.s("edge.points");M=C.s("edge.segments"),Y&&(Y=Wg(A.gv.getDataUI(C),Y),M&&M.size()||(M=df(Y))),M=new w(M._as.slice(0)),Y=new w(Y._as.slice(0));var B=M.get($);if(1===d||2===d)1===B||2===B?M.set($,d):3===B?(M.set($,d),Y.removeAt(T+1)):4===B&&(M.set($,d),Y.removeAt(T+1),Y.removeAt(T+1));else if(3===d){var q=function(){var r=Y.get(T),t=Y.get(T+1),F=lc(r,t);M.set($,3),Y.add(F,T+1)};2===B||1===B?q():4===B&&(Y.removeAt(T+1),Y.removeAt(T+1),q())}else if(4===d){var S=function(){var O=Y.get(T),V=Y.get(T+1),I=kl(O,V),N=Wr(O,V);M.set($,4),Y.add(I,T+1),Y.add(N,T+2)};2===B||1===B?S():3===B&&(Y.removeAt(T+1),S())}C.s("edge.points",ac(Y)),C.s("edge.segments",M)}}x.endTransaction()},getDefaultSegments:function(L){var I=this.gv,e=I.getDataUI(L);if(L instanceof g){var k=L.s("edge.points");return k=Wg(e,k),df(k)}if(L instanceof j){var k=L.getPoints(),N=L.getSegments();return N&&N.size()>0?N:df(k)}},$43l:function(p){var E=this;p&&(E.$5l=1),E._68I=1,E._42()},_42:function(){var u=this;if(u._68I){delete u._68I;var q=u.gv,F=u.$5l,v=q.getZoom(),n=q.getEditPointSize(),K=n/2,Q=new w,s=u._view,$=u._edge,N=u._shape,c=s.getContext("2d"),A=q.tx(),o=q.ty(),x=h,S=q.getEditPointBackground(),B=q.getControlPointBackground(),I=q.getControlPointBorderColor(),l=q.getEditPointBorderColor(),Y=q.getEditRectBorderColor(),U=q.getDirectionLineColor(),Z=q.getSegmentHoverColor(),e=q.getSnapPointBorderColor(),V=q.getJoinPointBackground(),D=q.getJoinPointBorderColor(),m=q.getSegmentHoverWidth(),i=[5,5],H=q.getEditRectBorderStyle();Xp(q,function(c){q.isSelected(c)&&q.isVisible(c)&&Q.add(c)}),c.clearRect(0,0,J(s.width),J(s.height)),c.save(),O.translateAndScale(c,A,o,1);var t=h,r={x:0,y:0,width:0,height:0},G=0,k=0,f=0,T=0,d=0,E=0,Jg=0,$k=0,ul=0,nq=0,ob=[];if(F?(delete u.$6l,delete u.$8l,delete u.$7l,delete u.$16l,delete u.$23l):(t=u.$6l,x=u.$7l),delete u.$68l,delete u.$69l,delete u.$71l,delete u.$70l,delete u.$82l,delete u.$83l,delete u._pointElevationHelperPoint,delete u.$90l,delete u.$91l,delete u.$75l,delete u.$74l,Q.each(function($){var J=q.getDataUI($);if(J){var u=J._55O;if(q.isEditable($))u._56O&&$ instanceof b&&k++,ob.push($),u._42O&&$ instanceof b&&G++,q.isHelperEditable($,"host")&&T++,q.isHelperEditable($,"parent")&&f++,q.isHelperEditable($,"remove")&&d++,q.isHelperEditable($,"edge")&&E++,q.isHelperEditable($,"source")&&Jg++,q.isHelperEditable($,"target")&&$k++,q.isHelperEditable($,"elevation")&&ul++,q.isHelperEditable($,"tall")&&nq++;else if($ instanceof L&&$.isExpanded()){var t=!0,H=q.getEditableFunc();H&&(t=H($)),t&&(q.isHelperEditable($,"host")&&T++,q.isHelperEditable($,"parent")&&f++,q.isHelperEditable($,"remove")&&d++,q.isHelperEditable($,"edge")&&E++,q.isHelperEditable($,"source")&&Jg++,q.isHelperEditable($,"target")&&$k++,q.isHelperEditable($,"elevation")&&ul++,q.isHelperEditable($,"tall")&&nq++,ob.push($))}}}),c.beginPath(),c.lineWidth=1,c.strokeStyle=q.getNodeBorderColor(),ob.forEach(function(U){var w=q.getDataUI(U),R=w._55O;if(F)if(x==h&&(x=U instanceof g?0:U instanceof L&&U.isExpanded()?0:U.getRotation(),u.$7l=x),t==h){var S,M,K;if(U instanceof L&&U.isExpanded()||U instanceof g){var V=q.getDataUIBounds(U);M=V.width,K=V.height,S={x:V.x+M/2,y:V.y+K/2}}else S=U.p(),M=U.getWidth(),K=U.getHeight();t={x:S.x,y:S.y,width:0,height:0},r.x=S.x-M/2,r.y=S.y-K/2,r.width=M,r.height=K,t=P(t,r)}else{var S,M,K,J,o=t.x+t.width/2,e=t.y+t.height/2,T={x:o,y:e};if(U instanceof L&&U.isExpanded()||U instanceof g){J=0;var V=q.getDataUIBounds(U);M=V.width,K=V.height,S={x:V.x+M/2,y:V.y+K/2}}else S=U.p(),M=U.getWidth(),K=U.getHeight(),J=U.getRotation();var s={x:S.x-M/2,y:S.y-K/2,width:M,height:K},y={x:s.x,y:s.y},m={x:s.x+s.width,y:s.y},D={x:s.x,y:s.y+s.height},i={x:s.x+s.width,y:s.y+s.height},y=Vc(S,y.x-S.x,y.y-S.y,J),D=Vc(S,D.x-S.x,D.y-S.y,J),i=Vc(S,i.x-S.x,i.y-S.y,J),m=Vc(S,m.x-S.x,m.y-S.y,J),B=-x,C=Vc(T,y.x-T.x,y.y-T.y,B),H=Vc(T,m.x-T.x,m.y-T.y,B),$=Vc(T,D.x-T.x,D.y-T.y,B),A=Vc(T,i.x-T.x,i.y-T.y,B),f=W([C,H,$,A]);t=P(t,f),t.x-=o,t.y-=e;var a=mm(h,t,x,T);t.x=a.x-t.width/2,t.y=a.y-t.height/2}if(G>1&&q.isEditable(U)&&q.isRectEditable(U)&&U instanceof b){var z=U.getRect(),_=R.$45l,I=$j(_[0],v),O=$j(_[2],v),l=$j(_[4],v),Y=$j(_[6],v);U.getRotation()?(c.moveTo(I.x,I.y),c.lineTo(O.x,O.y),c.lineTo(l.x,l.y),c.lineTo(Y.x,Y.y),c.lineTo(I.x,I.y)):c.rect(z.x*v,z.y*v,z.width*v,z.height*v)}}),c.stroke(),t){u.$6l=z(t),p(t,q.getEditRectPadding()/v);var Xq={x:t.x+t.width/2,y:t.y+t.height/2},Db=Te(Xq,t.width,t.height,x),mh=Db[0],si=Db[1],we=Db[2],Sk=Db[3],Ug=Db[4],vo=Db[5],El=Db[6],Nc=Db[7];if(mh=$j(Db[0],v),si=$j(Db[1],v),we=$j(Db[2],v),Sk=$j(Db[3],v),Ug=$j(Db[4],v),vo=$j(Db[5],v),El=$j(Db[6],v),Nc=$j(Db[7],v),u.$8l=t,G>0&&(u.$16l=[mh,Ug,si,vo,Sk,El,we,Nc],c.beginPath(),c.lineWidth=1,c.strokeStyle=Y,"dashed"===H&&c.setLineDash&&c.setLineDash(i),c.moveTo(mh.x,mh.y),c.lineTo(si.x,si.y),c.lineTo(Sk.x,Sk.y),c.lineTo(we.x,we.y),c.lineTo(mh.x,mh.y),c.stroke(),"dashed"===H&&c.setLineDash&&c.setLineDash([])),c.beginPath(),c.lineWidth=1,c.fillStyle=S,c.strokeStyle=l,G>0){var $d=vo.x-Nc.x,kl=vo.y-Nc.y,oh=a($d*$d+kl*kl),Yh=Ug.x-El.x,es=Ug.y-El.y,_q=a(Yh*Yh+es*es),ve=2*n;if(q.isDirectionEditable&&1===ob.length){var gd=ob[0],Hc=q.getDataUI(gd),on=Hc._55O,bp=q.isDirectionEditable.bind(q);if(on._42O){var bh,Xo,Mc,Ym;bp(gd,"northwest")&&(bh=!0,c.rect(mh.x-K,mh.y-K,n,n)),bp(gd,"northeast")&&(Xo=!0,c.rect(si.x-K,si.y-K,n,n)),bp(gd,"southwest")&&(Mc=!0,c.rect(we.x-K,we.y-K,n,n)),bp(gd,"southeast")&&(Ym=!0,c.rect(Sk.x-K,Sk.y-K,n,n)),bp(gd,"north")&&(bh&&Xo?oh>ve&&c.rect(Ug.x-K,Ug.y-K,n,n):c.rect(Ug.x-K,Ug.y-K,n,n)),bp(gd,"south")&&(Ym&&Mc?oh>ve&&c.rect(El.x-K,El.y-K,n,n):c.rect(El.x-K,El.y-K,n,n)),bp(gd,"west")&&(Mc&&bh?_q>ve&&c.rect(Nc.x-K,Nc.y-K,n,n):c.rect(Nc.x-K,Nc.y-K,n,n)),bp(gd,"east")&&(Ym&&Xo?_q>ve&&c.rect(vo.x-K,vo.y-K,n,n):c.rect(vo.x-K,vo.y-K,n,n))}}else oh>ve&&(c.rect(Ug.x-K,Ug.y-K,n,n),c.rect(El.x-K,El.y-K,n,n)),_q>ve&&(c.rect(vo.x-K,vo.y-K,n,n),c.rect(Nc.x-K,Nc.y-K,n,n)),c.rect(mh.x-K,mh.y-K,n,n),c.rect(si.x-K,si.y-K,n,n),c.rect(we.x-K,we.y-K,n,n),c.rect(Sk.x-K,Sk.y-K,n,n)}if(k>0){var Vo=u.$23l=Vc(Ug,0,2*-n,x);c.moveTo(Vo.x+K,Vo.y),c.arc(Vo.x,Vo.y,K,0,M,!1)}c.fill(),c.stroke(),u.$40l&&u.$44l(c,t,x);var Kk,km,Oc=q.getLeftTopHelpers(),jj=q.getRightTopHelpers(),fc=q.getLeftBottomHelpers(),fs=q.getRightBottomHelpers(),lj=q.getEdgeHelpers(),An=q.getEditHelperSize(),kq=An/2,Jc=function(X,W,r,l){"leftTop"===W?(Kk=t.x*v-An-K-("h"===l?r*(An+K):0)-1,km=t.y*v-An-K-("v"===l?r*(An+K):0)-1):"rightTop"===W?(Kk=(t.x+t.width)*v+K+("h"===l?r*(An+K):0)+1,km=t.y*v-An-K-("v"===l?r*(An+K):0)-1):"leftBottom"===W?(Kk=t.x*v-An-K-("h"===l?r*(An+K):0)-1,km=(t.y+t.height)*v+K+("v"===l?r*(An+K):0)+1):"rightBottom"===W&&(Kk=(t.x+t.width)*v+K+("h"===l?r*(An+K):0)+1,km=(t.y+t.height)*v+K+("v"===l?r*(An+K):0)+1);var M=Kk+kq,G=km+kq,h=(t.x+t.width/2)*v,O=(t.y+t.height/2)*v,j=Vc({x:h,y:O},M-h,G-O,x);if("host"===X){if(T>0)return u.$77l(c,x,j),!0}else if("edge"===X){if(E>0)return u.$80l(c,x,j),!0}else if("remove"===X){if(d>0)return ob&&1===ob.length&&ob[0]instanceof g?u.$81l(c,x,{x:h+An/2+5,y:O}):u.$81l(c,x,j),!0}else if("parent"===X){if(f>0)return ob&&1===ob.length&&ob[0]instanceof g?u.$76l(c,x,{x:h-An/2-5,y:O}):u.$76l(c,x,j),!0}else if("elevation"===X){if(ul>0)return u.$85l(c,x,j),!0}else if("tall"===X){if(nq>0)return u.$86l(c,x,j),!0}else if("source"===X||"target"===X){var F=ob[0],A=q.getDataUI(F),R=Oj(A,!0),N=R[0],o=R[1];if(Jg&&"source"===X)return u.$84l(c,t,N,!0,F.isLooped(),W,r,l),!0;if($k&&"target"===X)return u.$84l(c,t,o,!1,F.isLooped(),W,r,l),!0}};if(Oc&&Oc.length>0){var go=0;Oc.forEach(function(Q){Jc(Q,"leftTop",go,q.getLeftTopHelpersAlign()||"h")&&go++})}if(jj&&jj.length>0){var go=0;jj.forEach(function(Q){Jc(Q,"rightTop",go,q.getRightTopHelpersAlign()||"h")&&go++})}if(fc&&fc.length>0){var go=0;fc.forEach(function(J){Jc(J,"leftBottom",go,q.getLeftBottomHelpersAlign()||"h")&&go++})}if(fs&&fs.length>0){var go=0;fs.forEach(function(A){Jc(A,"rightBottom",go,q.getRightBottomHelpersAlign()||"h")&&go++})}if(lj&&lj.length>0&&((Jg||$k)&&ob&&1===ob.length&&ob[0]instanceof g?!0:!1)){var go=0;lj.forEach(function(N){Jc(N,"edge",go,"h")&&go++})}if(u.$72l){var Mn,ls=u.$67l,rk=u.$68l,Jl=u.$69l,jc=(u.$71l,u.$70l),xs=u.$82l,pg=u.$83l;if(1===ls?Mn=rk:2===ls?Mn=Jl:3===ls?Mn=jc:5===ls?Mn=xs:6===ls&&(Mn=pg),Mn){var Sr=q.lp(u.$72l),ne=q.getDataAt(u.$72l);if(ne&&ne instanceof b){var Li,bi,He;if(u.$73l=ne,1===ls)if(ne instanceof C.Grid)Li=u.$75l=Rf(ne,Sr);else if(ne instanceof C.Shape){He=u.$74l=oq(ne,Sr);var Gh=ne.getPoints();if(He){var ti=He.attachIndex,ri=hl(ne,q.getDataUI(ne),ti)+1,dq=ri+1>=Gh.size()?0:ri+1,Ul=Gh.get(ri),Mf=Gh.get(dq),xd=ne.p(),Pl=ne.getRotation();Ul=Vc(xd,Ul.x-xd.x,Ul.y-xd.y,Pl),Mf=Vc(xd,Mf.x-xd.x,Mf.y-xd.y,Pl),c.beginPath(),c.strokeStyle=Z,c.lineWidth=m,c.moveTo(Ul.x*v,Ul.y*v),c.lineTo(Mf.x*v,Mf.y*v),c.stroke()}}Li?bi=Li.rect:(bi=X.clone(q.getDataUIBounds(ne)),X.grow(bi,2)),c.beginPath(),c.rect(bi.x*v,bi.y*v,bi.width*v,bi.height*v),c.strokeStyle=1===ls||4===ls||6===ls?y:R,c.lineWidth=2,c.setLineDash&&c.setLineDash([8,8]),c.stroke()}else delete u.$73l;Sr.x=Sr.x*v,Sr.y=Sr.y*v;var Do=Qn(Mn.x,Mn.y,Sr.x,Sr.y),tj=Vc(Mn,Sr.x-Mn.x,Sr.y-Mn.y,-Do),oj=tj.x-Mn.x;c.save(),c.translate(Mn.x,Mn.y),c.rotate(Do),_.width=oj,_.height=40;var pr=R;(1===ls||4===ls||6===ls)&&(pr=y),_.comps[0].gradientColor=pr,X.drawImage(c,_,0,-20,oj,40),c.restore()}}}if(Q.each(function(d){var O=q.getDataUI(d);if(O){var H,z,t=O._55O,l=O._78o;if(t&&t._43O&&d instanceof j?(H=t.$15l,z=d.getSegments(),z&&z.size()||(z=df(H)),d.isClosePath()&&z.indexOf(5)<0&&(z=new w(z._as),z.add(5))):t&&l&&t._43O&&(H=d.s("edge.points"),z=d.s("edge.segments"),H=Wg(O,H),z&&z.size()||(z=df(H)),H&&(H=H._as)),H&&z){var s=0,o=z.size(),Y=u._hoverSegmentIndex;H=H.slice(0);for(var g=0;g<H.length;g++)H[g]=$j(H[g],v);c.beginPath(),c.strokeStyle=U,c.lineWidth=1,s=0;for(var g=0;o>g;g++){var Q=z.get(g);if(1===Q||2===Q)s++;else if(3===Q){var L=H[s-1],G=H[s],x=H[s+1];c.moveTo(L.x,L.y),c.lineTo(G.x,G.y),c.lineTo(x.x,x.y),s+=2}else if(4===Q){var L=H[s-1],a=H[s],n=H[s+1],x=H[s+2];c.moveTo(L.x,L.y),c.lineTo(a.x,a.y),c.moveTo(n.x,n.y),c.lineTo(x.x,x.y),s+=3}}if(c.stroke(),N===d||$===d&&"points"===$.s("edge.type")){c.beginPath(),s=0,c.strokeStyle=Z,c.lineWidth=m;for(var g=0;o>g;g++){var Q=z.get(g);if(1===Q||2===Q){if(Y===g){var L=H[s-1],x=H[s];c.moveTo(L.x,L.y),c.lineTo(x.x,x.y);break}s++}else if(3===Q){if(Y===g){var L=H[s-1],G=H[s],x=H[s+1];c.moveTo(L.x,L.y),c.quadraticCurveTo(G.x,G.y,x.x,x.y);break}s+=2}else if(4===Q){if(Y===g){var L=H[s-1],a=H[s],n=H[s+1],x=H[s+2];c.moveTo(L.x,L.y),c.bezierCurveTo(a.x,a.y,n.x,n.y,x.x,x.y);break}s+=3}else if(5===Q&&Y===g){var L=H[s-1],x=H[0];c.moveTo(L.x,L.y),c.lineTo(x.x,x.y);break}}c.stroke()}c.beginPath(),s=0,c.strokeStyle=D,c.lineWidth=1,c.fillStyle=V;for(var g=0;o>g;g++){var Q=z.get(g);if(1===Q||2===Q){var x=H[s];c.moveTo(x.x+K,x.y),c.arc(x.x,x.y,K,0,M,!0),s++}else if(3===Q){var x=H[s+1];c.moveTo(x.x+K,x.y),c.arc(x.x,x.y,K,0,M,!0),s+=2}else if(4===Q){var x=H[s+2];c.moveTo(x.x+K,x.y),c.arc(x.x,x.y,K,0,M,!0),s+=3}}c.fill(),c.stroke(),c.beginPath(),s=0,c.strokeStyle=I,c.lineWidth=1,c.fillStyle=B;for(var g=0;o>g;g++){var Q=z.get(g);if(1===Q||2===Q)s++;else if(3===Q){var G=H[s];c.moveTo(G.x+K,G.y),c.arc(G.x,G.y,K,0,M,!0),s+=2}else if(4===Q){var a=H[s],n=H[s+1];c.moveTo(a.x+K,a.y),c.arc(a.x,a.y,K,0,M,!0),c.moveTo(n.x+K,n.y),c.arc(n.x,n.y,K,0,M,!0),s+=3}}if(c.fill(),c.stroke(),c.beginPath(),s=0,c.strokeStyle=e,c.lineWidth=2,(N===d||$===d)&&u.$9l!=h){var x=H[u.$9l];c.moveTo(x.x+K,x.y),c.arc(x.x,x.y,K,0,M,!0),c.stroke()}}}}),u.$87l&&q.sm().contains(u.$87l)){var Kg,Wb=u.$87l,tp=u.$88l,An=q.getEditHelperSize(),kq=An/2;if(q.isHelperEditable(Wb,"pointElevation"))if(Wb instanceof j){var tf=Wb.getPosition();Kg=X.clone(Wb.getPoints().get(tp)),Kg=Vc({x:tf.x,y:tf.y},Kg.x-tf.x,Kg.y-tf.y,Wb.getRotation()),Kg.x*=v,Kg.y*=v,c.translate(Kg.x,Kg.y),X.drawImage(c,X.getImage("xeditinteractor_elevationIcon"),kq,-kq,An,An),c.translate(-Kg.x,-Kg.y),u._pointElevationHelperPoint={x:Kg.x+An,y:Kg.y}}else if(Wb instanceof g){var Fi=Wg(q.getDataUI(Wb),Wb.s("edge.points")),Kg=X.clone(Fi.get(tp));Kg.x*=v,Kg.y*=v,c.translate(Kg.x,Kg.y),X.drawImage(c,X.getImage("xeditinteractor_elevationIcon"),kq,-kq,An,An),c.translate(-Kg.x,-Kg.y),u._pointElevationHelperPoint={x:Kg.x+An,y:Kg.y}}}c.restore(),u.$5l=0}},$89l:function(S,U,D,H){S.save();var e=this,W=e.gv,C=W.getEditHelperSize(),x=C/2;S.beginPath(),S.translate(D.x,D.y),S.rotate(U),X.drawImage(S,H,-x,-x,C,C),S.restore()},$85l:function(U,r,b){var N=this;N.$90l=b,N.$89l(U,r,b,X.getImage("xeditinteractor_elevationIcon"))},$86l:function(c,B,Z){var N=this;N.$91l=Z,N.$89l(c,B,Z,X.getImage("xeditinteractor_tallIcon"))},$77l:function(t,n,j){var N=this;N.$68l=j,N.$89l(t,n,j,X.getImage("xeditinteractor_hostIcon"))},$80l:function($,G,S){var u=this;u.$70l=S,u.$89l($,G,S,X.getImage("xeditinteractor_edgeIcon"))},$81l:function(n,m,e){var V=this;V.$71l=e,V.$89l(n,m,e,X.getImage("xeditinteractor_removeIcon"))},$76l:function(C,i,T){var V=this;V.$69l=T,V.$89l(C,i,T,X.getImage("xeditinteractor_parentIcon"))},$84l:function(a,R,j,q,i){var J,K=this,h=K.gv,A=h.getZoom(),L=h.getEditHelperSize(),Z=L/2;j.x*=A,j.y*=A,i&&(q?j.x-=Z+5:j.x+=Z+5),j.y-=L-2,q?(K.$82l=j,J=X.getImage("xeditinteractor_sourceIcon")):(K.$83l=j,J=X.getImage("xeditinteractor_targetIcon")),a.beginPath(),a.translate(j.x,j.y),X.drawImage(a,J,-Z,-Z,L,L),a.translate(-j.x,-j.y)},$44l:function(Q,S,P){Q.save();var Y=this.gv.getZoom(),G=a(Z(S.width,2)+Z(S.height,2))/2*Y+10,J=G,F=J+8,i=J+18,X=P,V=S.x+S.width/2,$=S.y+S.height/2;Q.translate(V*Y,$*Y),Q.beginPath(),Q.strokeStyle="rgb(150, 150, 150)";for(var U=0,T=0,R=0,L=0,n=0,j=0;360>j;j++)U=j*c/180,0===j%5&&(T=t(U)*J,R=o(U)*J,L=t(U)*F,n=o(U)*F,Q.moveTo(T,R),Q.lineTo(L,n)),0===j%45&&(T=t(U)*J,R=o(U)*J,L=t(U)*i,n=o(U)*i,Q.moveTo(T,R),Q.lineTo(L,n));Q.stroke(),Q.beginPath(),Q.rotate(-K),Q.beginPath(),Q.fillStyle="rgba(255, 0, 0, 0.1)",Q.strokeStyle="rgb(157, 157, 157)",Q.moveTo(0,0),Q.arc(0,0,i,0,P,!1),Q.fill(),Q.beginPath(),Q.moveTo(0+i,0),Q.arc(0,0,i,0,P,!1),Q.stroke(),Q.rotate(K),Q.font="bold 12px Verdana, Arial";var W=20*o(X),x=20*t(X),E=q(180*X/c)+"°";Q.textAlign="center",Q.textBaseline="middle",Q.beginPath();var h=Q.measureText("365.°").width;Q.fillStyle="white",Q.rect(W-h/2,-x-10,h,20),Q.fill(),Q.beginPath(),Q.fillStyle="rgb(79,79,79)",Q.fillText(E,W,-x),Q.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);