!function(p,z,i){"use strict";var P=p.ht;P.Astar={},function(n){var z=n();p.AStar=z.astar,p.AStar.Graph=z.Graph}(function(){function x(D){for(var M=D,T=[];M.parent;)T.unshift(M),M=M.parent;return T}function f(){return new I(function(K){return K.f})}function F(d,w){w=w||{},this.nodes=[],this.diagonal=!!w.diagonal,this.grid=[];for(var W=0;W<d.length;W++){this.grid[W]=[];for(var V=0,t=d[W];V<t.length;V++){var e=new T(W,V,t[V]);this.grid[W][V]=e,this.nodes.push(e)}}this.$13x()}function T(Y,e,P){this.x=Y,this.y=e,this.weight=P}function I(a){this.content=[],this.scoreFunction=a}var d={search:function(O,M,j,C){O.$6x(),C=C||{};var c=C.heuristic;c||(c=O.diagonal?d.$4x.diagonal:d.$4x.manhattan);var P=C.closest||!1,m=C.punish,H=f(),v=M;for(M.h=c(M,j),O.$7x(M),H.push(M);H.size()>0;){var q=H.pop();if(q===j)return x(q);q.closed=!0;for(var e=O.neighbors(q),I=0,U=e.length;U>I;++I){var w=e[I];if(!w.closed&&!w.$9x()){var A=q.g+w.getCost(q,m),Y=w.visited;(!Y||A<w.g)&&(w.visited=!0,w.parent=q,w.h=w.h||c(w,j),w.g=A,w.f=w.g+w.h,O.$7x(w),P&&(w.h<v.h||w.h===v.h&&w.g<v.g)&&(v=w),Y?H.$10x(w):H.push(w))}}}return P?x(v):[]},$4x:{manhattan:function(c,n){var l=Math.abs(n.x-c.x),v=Math.abs(n.y-c.y);return l+v},diagonal:function(C,e){var u=1,t=Math.sqrt(2),$=Math.abs(e.x-C.x),y=Math.abs(e.y-C.y);return u*($+y)+(t-2*u)*Math.min($,y)}},$5x:function(M){M.f=0,M.g=0,M.h=0,M.visited=!1,M.closed=!1,M.parent=null}};return F.prototype.$13x=function(){this.dirtyNodes=[];for(var s=0;s<this.nodes.length;s++)d.$5x(this.nodes[s])},F.prototype.$6x=function(){for(var W=0;W<this.dirtyNodes.length;W++)d.$5x(this.dirtyNodes[W]);this.dirtyNodes=[]},F.prototype.$7x=function(Y){this.dirtyNodes.push(Y)},F.prototype.neighbors=function(V){var P=[],Y=V.x,l=V.y,j=this.grid;return j[Y-1]&&j[Y-1][l]&&P.push(j[Y-1][l]),j[Y+1]&&j[Y+1][l]&&P.push(j[Y+1][l]),j[Y]&&j[Y][l-1]&&P.push(j[Y][l-1]),j[Y]&&j[Y][l+1]&&P.push(j[Y][l+1]),this.diagonal&&(j[Y-1]&&j[Y-1][l-1]&&P.push(j[Y-1][l-1]),j[Y+1]&&j[Y+1][l-1]&&P.push(j[Y+1][l-1]),j[Y-1]&&j[Y-1][l+1]&&P.push(j[Y-1][l+1]),j[Y+1]&&j[Y+1][l+1]&&P.push(j[Y+1][l+1])),P},F.prototype.toString=function(){for(var L=[],o=this.grid,V=0;V<o.length;V++){for(var H=[],h=o[V],p=0;p<h.length;p++)H.push(h[p].weight);L.push(H.join(" "))}return L.join("\n")},T.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},T.prototype.getCost=function(C,l){var d;if(d=C&&C.x!=this.x&&C.y!=this.y?1.41421*this.weight:this.weight,l){var K=C;if(!K)return d;var R=K.parent;return R?Math.abs(R.x+this.x-2*K.x)>1e-5?d+l:Math.abs(R.y+this.y-2*K.y)>1e-5?d+l:d:d}},T.prototype.$9x=function(){return 0===this.weight},I.prototype={push:function(h){this.content.push(h),this.$11x(this.content.length-1)},pop:function(){var Z=this.content[0],h=this.content.pop();return this.content.length>0&&(this.content[0]=h,this.$12x(0)),Z},remove:function(j){var R=this.content.indexOf(j),A=this.content.pop();R!==this.content.length-1&&(this.content[R]=A,this.scoreFunction(A)<this.scoreFunction(j)?this.$11x(R):this.$12x(R))},size:function(){return this.content.length},$10x:function(D){this.$11x(this.content.indexOf(D))},$11x:function(C){for(var S=this.content[C];C>0;){var X=(C+1>>1)-1,_=this.content[X];if(!(this.scoreFunction(S)<this.scoreFunction(_)))break;this.content[X]=S,this.content[C]=_,C=X}},$12x:function(A){for(var O=this.content.length,n=this.content[A],I=this.scoreFunction(n);;){var m,M=A+1<<1,R=M-1,w=null;if(O>R){var f=this.content[R];m=this.scoreFunction(f),I>m&&(w=R)}if(O>M){var X=this.content[M],$=this.scoreFunction(X);(null===w?I:m)>$&&(w=M)}if(null===w)break;this.content[A]=this.content[w],this.content[w]=n,A=w}}},{astar:d,Graph:F}});var w=P.Astar.Finder=function(w,T){var g=this;g.gv=w,g.$13x(T),g.refreshMap()};w.prototype={},w.prototype.constructor=w,z.defineProperties(w.prototype,{_debugInfo:{get:function(){return this.gv._astarDebugInfo},set:function(B){this.gv._astarDebugInfo=B}}}),w.prototype.$13x=function(B){var H=this,t=H.$14x={};B=B||{};var v=B.gridSize||10;t.gridSizeX=B.gridSizeX||v,t.gridSizeY=B.gridSizeY||v,t.rect=B.rect,t.filter=B.filter,t.extendBlocks=B.extendBlocks||3,t.fastOverlap=B.fastOverlap===i?!0:B.fastOverlap,t.nodeRectExtend=B.nodeRectExtend||0,t.diagonal=B.diagonal===i?!0:B.diagonal,t.turnPunish=B.turnPunish===i?.1:B.turnPunish,t.simplify=B.simplify===i?!0:B.simplify,t.toGridCenter=B.toGridCenter===i?!1:B.toGridCenter,t.closest=B.closest===i?!0:B.closest},w.prototype.refreshMap=function(){var s,h=this,w=h.$14x,M=w.gridSizeX,d=w.gridSizeY,e=w.extendBlocks;w.rect?s=w.rect:(s=h.$15x(),P.Default.grow(s,M*e,d*e)),P.Default.grow(s,M,d);var b=Math.floor(s.x/M)*M,o=Math.floor(s.y/d)*d,r=Math.ceil(s.width/M),j=Math.ceil(s.height/d),V=r*M,Y=j*d;h.$16x={x:b,y:o,w:V,h:Y,gridX:M,gridY:d,xLen:r,yLen:j},h.$17x(),h.$21x()},w.prototype.$15x=function(){var q=this.gv;if(q instanceof P.graph.GraphView)return q.getContentRect();var m,X=P.Default.unionRect;return q.dm().each(function(a){q.isVisible(a)&&a.getRect&&(m=X(m,a.getRect()))}),m},w.prototype.$17x=function(){var G,I,j,q,h=this,F=h.$16x,m=F.xLen,U=F.yLen;for(G=new Array(m),j=0;m>j;j++)for(G[j]=I=new Array(U),q=U;q--;)I[q]=1;var f=h.$14x.filter;for(h.gv.dm().each(function(t){f&&f(t)===!1||(!h._debugInfo||t!==h._debugInfo.grid&&t!=h._debugInfo.path)&&h.$1cw(G,t)}),j=0;m>j;j++)G[j][0]=1,G[j][U-1]=1;for(q=0;U>q;q++)G[0][q]=1,G[m-1][q]=1;h.grid=G;var p=new AStar.Graph(G,{diagonal:h.$14x.diagonal});h.graph=p},w.prototype.$18x=function(P,p,Q,e,v,x,S,N){var K=this.$19x,g=K(Q-P,v-S,e-p,x-N);if(1e-6>=g&&g>=-1e-6)return!1;var Z=K(v-P,v-S,x-p,x-N)/g;if(0>Z||Z>1)return!1;var u=K(Q-P,v-P,e-p,x-p)/g;return 0>u||u>1?!1:!0},w.prototype.$19x=function(m,s,z,O){return m*O-s*z},w.prototype.$1aw=function(g,o,Z,x){for(var L=[-(o[1]-g[1]),o[0]-g[0]],q=L[0]*(Z[0]-g[0])+L[1]*(Z[1]-g[1])>=0,m=0,R=x.length;R>m;m+=2)if(L[0]*(x[m]-g[0])+L[1]*(x[m+1]-g[1])>=0===q)return!1;return!0},w.prototype.$1bw=function(x,k){for(var Q,f,F=this,K=0,S=x.length;S>K;K+=2)if(Q=K===S-2?0:K+2,f=Q===S-2?0:Q+2,F.$1aw([x[K],x[K+1]],[x[Q],x[Q+1]],[x[f],x[f+1]],k))return!1;for(var K=0,S=k.length;S>K;K+=2)if(Q=K===S-2?0:K+2,f=Q===S-2?0:Q+2,F.$1aw([k[K],k[K+1]],[k[Q],k[Q+1]],[k[f],k[f+1]],x))return!1;return!0},w.prototype.$1cw=function(H,x){if(x.getRect){var F=this,I=x.getRect();P.Default.grow(I,F.$14x.nodeRectExtend);var y,g,B,$,G,r,X,U,i,O,M,q=F.$1dw({x:I.x,y:I.y}),b=F.$1dw({x:I.x+I.width,y:I.y+I.height}),A=F.$14x.fastOverlap;if(!A){var N=x.getCorners();X=[],N.forEach(function(s){X.push(s.x,s.y)}),O=F.$14x.gridSizeX/2,M=F.$14x.gridSizeY/2}for(g=Math.max(0,q.x),B=Math.min(b.x,H.length-1),G=Math.max(0,q.y),r=Math.min(b.y,H.length?H[0].length-1:-1),y=g;B>=y;y++)for($=G;r>=$;$++)if(A)H[y][$]=0;else{i=F.$1ew({x:y,y:$});var V=i.x-O,Q=i.x+O,s=i.y-M,C=i.y+M;U=[V,s,V,C,Q,C,Q,s],F.$1bw(X,U)&&(H[y][$]=0)}}},w.prototype.$1dw=function(Q,U){var o=this,c=o.$16x,H=(Q.x-c.x)/c.gridX,P=(Q.y-c.y)/c.gridY;return U!==!1&&(H=Math.round(H),P=Math.round(P)),{x:H,y:P}},w.prototype.$1ew=function(u){var c=this,i=c.$16x;return{x:u.x*i.gridX+i.x,y:u.y*i.gridY+i.y}},w.prototype.$1fw=function(P){var c=this,$=c.$16x,I=$.xLen,M=$.yLen;if(P.x>=0&&P.x<I&&P.y>=0&&P.y<M)return P;var A={x:P.x,y:P.y};return A.x<0?A.x=0:A.x>=I&&(A.x=I-1),A.y<0?A.y=0:A.y>=M&&(A.y=M-1),A},w.prototype.findPath=function(v,F){var S,t,H,W,G=this,Y=G.$1dw(v),b=G.$1dw(F);if(H=G.$1fw(Y),W=G.$1fw(b),H!==Y&&W!==b){var V=G.$16x,C=V.x-V.gridX/2,M=V.y-V.gridY/2,r=C+V.gridX*V.xLen,a=M+V.gridY*V.yLen;if(!(G.$18x(v.x,v.y,F.x,F.y,C,M,r,M)||G.$18x(v.x,v.y,F.x,F.y,r,M,r,a)||G.$18x(v.x,v.y,F.x,F.y,r,a,C,a)||G.$18x(v.x,v.y,F.x,F.y,C,a,C,M)))return[v,F]}H!==Y&&(S=!0,Y=H),W!==b&&(t=!0,b=W);var X=G.graph.grid[Y.x][Y.y],B=G.graph.grid[b.x][b.y],J=AStar.search(G.graph,X,B,{closest:G.$14x.closest,punish:G.$14x.turnPunish});if(!J||!J.length)return null;var T=[];T.push(v),S&&T.push(G.$1ew(J[0]));for(var m=1,g=J.length;g-1>m;m++)T.push(G.$1ew(J[m]));if(t)T.push(G.$1ew(J[g-1])),T.push(F);else{var s=J[g-1];b.x!==s.x||b.y!==s.y||G.$14x.toGridCenter?T.push(G.$1ew(s)):T.push(F)}return G.$14x.simplify&&(T=G.simplifyPath(T)),G.$20x=T,G.$21x(),T},w.prototype.debugOn=function(d){this.debugFlag=!0,this.debugSettings=d||{},this.$21x()},w.prototype.simplifyPath=function(l){var S=l.length;if(2>=S)return l;var L,n,X=[l[0],l[1]],w=X[0],p=X[1],d=1e-5;for(L=2;S>L;L++)n=l[L],Math.abs((p.x-w.x)*(n.y-w.y)-(p.y-w.y)*(n.x-w.x))<d?p=X[X.length-1]=n:(w=p,p=n,X.push(n));return X},w.prototype.$21x=function(){var K=this;if(K.$22x(),this.debugFlag){var j=K.grid;if(j){var x,F=K.gv;if(K.debugSettings.$16x!==!1){x=[];for(var R,G,B,c,I,X=[],i=K.$14x.gridSizeX/2,s=K.$14x.gridSizeY/2,n=j.length,N=n?j[0].length:0,q=1;n-1>q;q++)for(var U=1;N-1>U;U++)j[q][U]||(R=K.$1ew({x:q,y:U}),G=R.x-i,B=R.x+i,c=R.y-s,I=R.y+s,x.push({x:G,y:c},{x:G,y:I},{x:B,y:I},{x:B,y:c}),X.push(1,2,2,2,5));var m=new P.Shape;m.s("shape.border.color","rgba(50, 50, 50, 0.2)"),m.s("shape.border.width",1),m.s("shape.background","rgba(200, 50, 100, 0.2)"),m.s("2d.editable",!1),m.s("2d.selectable",!1),m.setPoints(x),m.setSegments(X),K._debugInfo={grid:m},F.dm().add(m)}K.debugSettings.path!==!1&&(x=new P.Shape,K.$20x&&(x.setPoints(K.$20x),x.s("shape.border.color","red"),x.s("shape.border.width",1),x.s("2d.editable",!1),x.s("2d.selectable",!1),x.s("shape.background",null),K._debugInfo||(K._debugInfo={}),K._debugInfo.path=x,F.dm().add(x)))}}},w.prototype.debugOff=function(){this.debugFlag=!1,this.$22x()},w.prototype.$22x=function(){var t=this;if(t._debugInfo){var _=t._debugInfo.grid,w=t._debugInfo.path,d=t.gv;_&&d.dm().remove(_),w&&d.dm().remove(w),t._debugInfo=null}}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);