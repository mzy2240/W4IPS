!function(c){"use strict";var H="ht",M=c[H],J=function(){return document},p=function(){return J().body},k=function(T,x,m){T.style.setProperty(x,m,null)},S=function(v){return J().createElement(v)},U=function(){return S("div")},l=function(){var h=S("canvas");return h},Q=function(i,t){k(i,"-webkit-transform",t),k(i,"-ms-transform",t),k(i,"transform",t)},F=function(X,Q){k(X,"-webkit-transform-origin",Q),k(X,"-ms-transform-origin",Q),k(X,"transform-origin",Q)},I=function(d,u){d.appendChild(u)},g=function(Z,B){Z.removeChild(B)},v=c.parseInt,h=M.Default,W=h.eventListenerOptionsFalse,O=(h.eventListenerOptionsTrue,function(T,Z,o,L){T.addEventListener(Z,o,L?W:W)}),d=h.getInternal(),w=Math.PI,j="white-space",n="visibility",q="left",K="top",D="width",P="height",C="position",$="display",a="z-index",e="px",_="0 0",B="absolute",z="visible",L="hidden",E="none",N="block",i="nowrap",Y="rgba(0, 0, 0, 0.005)";h.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var R=M.graph.GraphView.prototype,A=R._42;R.adjustHtmlNodeIndex=!0,R._42=function(h,z){if(A.call(this,h,z),this.adjustHtmlNodeIndex)for(var X=this.getDataModel()._datas._as,$=X.length,d=1,s=0;$>s;s++){var j=X[s];if(j instanceof x){var q=this.getDataUI(j);k(q.$2f,a,d+""),k(q.$3f,a,d+1+""),d+=2}}};var s=M.HtmlNodeUI=function(S,f){var R=this;s.superClass.constructor.call(R,S,f);var h=R.$2f=U(),V=R.$3f=l();k(h,C,B),k(h,n,L),k(h,j,i),V.draggable=!1,k(V,C,B),k(V,$,E),F(V,_),O(h,"change",function(K){var b=K.target,D=b.bind||b.getAttribute("bind"),o=b.type&&"checkbox"===b.type?b.checked:b.value,V=f.getContext();D&&V&&(V[D]=o,R.$4f=JSON.stringify(V))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(N){O(h,N,this.$9f.bind(this))},R)};h.def(s,d.ui().NodeUI,{_visible:!0,$11f:function(){var y=this,_=y.$3f,I=y._data,Z=I.getDraggerImageWidth(),S=I.getDraggerImageHeight(),A=I.getDraggerImage(),m=d.initContext(_);m.beginPath(),d.setCanvas(_,Z,S),d.translateAndScale(m,0,0,1),m.clearRect(0,0,Z,S),h.drawImage(m,h.getImage(A),0,0,Z,S),m.restore()},_80o:function(Z){s.superClass._80o.call(this,Z);var h=this,S=h._data,O=S._padding,F=2*O,_=h.$2f,p=h.$3f,f=h.gv,X=f.getZoom(),o=f.getTranslateX(),G=f.getTranslateY(),i=f.getView(),M=h._83o,V=S._width,W=S._height,R=M.position,j=M.rotation,u=(V-F)/S.$5f*X,m=(W-F)/S.$6f*X,J=h._html,H=S._html,r=S.getHtmlType();if("html"===r){var y=S.getContext()||{},c=h.$4f,b=S.$10f,d=JSON.stringify(y);J&&c&&J===H&&c===d||(h.$4f=d,h._html=H,_.innerHTML=b?b(y):H)}else if(null!=r){var l=S.getHtml();"ht"===r&&(l=l.getView()),J&&J===l&&_.contains(J)||(h._html=l,_.innerHTML="",I(_,l))}if(!_.parentNode){var t=f.$1f;if(!t){var A=U();k(A,C,B),k(A,a,"0"),t=f.$1f=A;var g=f._canvas.nextSibling;g?i.insertBefore(A,g):I(i,A)}I(t,_),I(t,p),S.onContentInitialized&&S.onContentInitialized(_)}if(S._scalable){var x=S.$5f,T=S.$6f;Q(_,"rotate("+180*(j/w)+"deg) scale("+u+","+m+")"),k(_,D,""),k(_,P,""),k(_,q,(R.x-x/X/2)*X+o+e),k(_,K,(R.y-T/X/2)*X+G+e)}else{var Tc=v(_.style.width),Ln=v(_.style.height),tk=v((V-F)*X),Mk=v((W-F)*X),le="100%",rp=_.children[0];k(rp,D,le),k(rp,P,le),(Tc!==tk||Ln!==Mk)&&(k(_,D,tk+e),k(_,P,Mk+e),"ht"===r&&H.invalidate()),Q(_,"rotate("+180*(j/w)+"deg)"),k(_,q,(R.x-tk/X/2)*X+o+e),k(_,K,(R.y-Mk/X/2)*X+G+e)}var Fc=h.dragRect;f.isMovable(S)&&f.isSelected(S)&&Fc?(Z.save(),Z.fillStyle=Y,Z.fillRect(Fc.x,Fc.y,Fc.width,Fc.height),Z.restore(),k(p,q,Fc.x*X+o+e),k(p,K,Fc.y*X+G+e),Q(p,"scale("+X+","+X+")"),k(p,$,N),h.$11f()):k(p,$,E),k(_,n,this._visible?z:L)},dispose:function(){var e=this.gv.$1f;this.$2f.parentNode===e&&e.removeChild(this.$2f),this.$3f.parentNode===e&&e.removeChild(this.$3f)},_84o:function(D){this._visible=D,k(this.$2f,n,D?z:L),k(this.$3f,$,D?N:E)},_3O:function(){var x=this,b=x.gv,r=x._data;s.superClass._3O.call(x);var O=r.getRect();b.isEditable(r)&&(x.dragRect={x:O.x+O.width+r._padding,y:O.y+10,width:r.getDraggerImageWidth(),height:r.getDraggerImageHeight()},x._68o(x.dragRect))},rectIntersects:function(K){var Q=this._79o();return M.Default.intersection(Q,K)?!0:void 0},$9f:function(b){var e=this.gv,l=this._data;e.sm().contains(l)&&b.stopPropagation()}});var x=M.HtmlNode=function(){x.superClass.constructor.call(this)};M.Default.def(x,M.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:M.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(K){var t=this,I=t._html;t._html=K,"html"===t.getHtmlType()&&"Handlebars"in c&&(t.$10f=Handlebars.compile(K)),t.$13f(),t.fp("html",I,K)},setContext:function(F){var A=this,$=A._context;A._context=F,A.fp("context",$,F),A.$13f()},setScalable:function(b){var M=this,c=M._scalable;M._scalable=b,M.fp("scalable",c,b),M.$13f()},getHtmlType:function(){var o=this._html;return o?"string"==typeof o?"html":o.getView?"ht":"dom":null},$13f:function(){var S=this,K=S._html,E=S.$10f;if(K){var Z=U(),v=!1,$=S.getHtmlType();if(k(Z,C,B),k(Z,j,i),k(Z,n,L),"html"===$?(Z.innerHTML=E?E(S.getContext()||{}):K,v=!0):"ht"===$?(I(Z,K.getView()),v=!0):"dom"===$&&(I(Z,K),v=!0),v){var o=2*S._padding;I(p(),Z),S.$5f=Z.scrollWidth,S.$6f=Z.scrollHeight,S._width=S.$5f+o,S._height=S.$6f+o,S._originWidth=S._width,S._originHeight=S._height,g(p(),Z)}}},getUIClass:function(){return M.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);