!function(u){"use strict";function l(R){var L,j,d,y,Q,f,w,Y=[],V=0;L=v.createDiv(),L.style.overflow="hidden";var n=R.getView();n.insertBefore(L,R.getCanvas()),j=W.Default.createDiv(),j.style.WebkitTransformStyle="preserve-3d",j.style.MozTransformStyle="preserve-3d",j.style.transformStyle="preserve-3d",L.appendChild(j),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(F){var E=F.style;n.addEventListener(F.event,function(){L.style.pointerEvents=E})}),this.updateWebView=function(){var x=R.getCanvas(),U=1*x.style.width.slice(0,-2),t=1*x.style.height.slice(0,-2);(Y[0]!==U||Y[1]!==t)&&(Y[0]=U,Y[1]=t,L.style.width=U+"px",L.style.height=t+"px",j.style.width=U+"px",j.style.height=t+"px");var G=R._projectMatrix[5]*Y[1]/2;G!==d&&(d=G,L.style.WebkitPerspective=d+"px",L.style.MozPerspective=d+"px",L.style.perspective=d+"px"),f="translateZ("+d+"px)"+T(R._viewMatrix);var N=f+"translate("+Y[0]/2+"px,"+Y[1]/2+"px)";y===N||Q||(j.style.WebkitTransform=N,j.style.MozTransform=N,j.style.transform=N,y=N),V++,w=!1,R.dm().each(function(O){O.isWebView&&S(O)});for(var C,s=j.children,q=[],p=0,r=s.length;r>p;p++)C=s[p],C._isHtWebView&&C._renderCookie!==V&&q.push(C);q.length&&q.forEach(function(O){j.removeChild(O)})};var A=new Array(16),S=function($){var t=$.getAttach();if(t){t.parentElement!==j&&j.appendChild(t),t._renderCookie=V,w=!0;var q=$.getFinalScale3d(),U=$._prefrenceSize;U&&U[0]?U[1]||(U[1]=U[0]/q[0]*q[1]):U=[q[0],q[1]],t.style.width=U[0]+"px",t.style.height=U[1]+"px";var H=1/U[0],R=1/U[1],n=1,I=$.mat;A[0]=I[0]*H,A[1]=I[1]*H,A[2]=I[2]*H,A[3]=I[3]*H,A[4]=I[4]*R,A[5]=I[5]*R,A[6]=I[6]*R,A[7]=I[7]*R,A[8]=I[8]*n,A[9]=I[9]*n,A[10]=I[10]*n,A[11]=I[11]*n,A[12]=I[12],A[13]=I[13],A[14]=I[14],A[15]=I[15];var D=G(A,Q?"translate("+Y[0]/2+"px,"+Y[1]/2+"px)"+f:""),K=t.$a2;K!==D&&(t.$a2=D,t.style.WebkitTransform=D,t.style.MozTransform=D,t.style.transform=D)}}}function s(w){return Math.abs(w)<1e-10?0:w}function T(D){var Z=D;return"matrix3d("+s(Z[0])+","+s(-Z[1])+","+s(Z[2])+","+s(Z[3])+","+s(Z[4])+","+s(-Z[5])+","+s(Z[6])+","+s(Z[7])+","+s(Z[8])+","+s(-Z[9])+","+s(Z[10])+","+s(Z[11])+","+s(Z[12])+","+s(-Z[13])+","+s(Z[14])+","+s(Z[15])+")"}function G(v,p){var Y=v,x="matrix3d("+s(Y[0])+","+s(Y[1])+","+s(Y[2])+","+s(Y[3])+","+s(-Y[4])+","+s(-Y[5])+","+s(-Y[6])+","+s(-Y[7])+","+s(Y[8])+","+s(Y[9])+","+s(Y[10])+","+s(Y[11])+","+s(Y[12])+","+s(Y[13])+","+s(Y[14])+","+s(Y[15])+")";return"translate(-50%,-50%)"+(p||"")+x}var Y="ht",W=u[Y],v=W.Default,H=v.getInternal(),N=H.superCall,f=W.graph3d.Graph3dView,C=f.prototype.validateImpl;f.prototype.validateImpl=function(){C.call(this);var h=this._webViewRenderer;h||(h=this._webViewRenderer=new l(this)),h.updateWebView()};var i=W.WebView3d=function(){var c=this;N(i,c),c.s({shape3d:"billboard","shape3d.reverse.flip":!0})},h=[1,1,1,1],b=[0,0,0,0];v.def(Y+"."+"WebView3d",W.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(k,T,h){if(!k)return this.detachDOM();if("string"==typeof k){var v=document.createElement("iframe");v.src=k,k=v}var M=k.style;M.position="absolute",M.border=0,M.outline=0,M.padding=0,M.margin=0,k._isHtWebView=!0,this.setAttach(k),this._prefrenceSize=[T,h],this.s("shape3d.blend",b)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(c){this.a("defaultBgColor",c),this.getAttach()||this.s("shape3d.blend",c)},getBgColor:function(){return this.a("defaultBgColor")||h}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);